{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"\u6b22\u8fce\u6765\u5230\u6211\u7684\u4e2a\u4eba\u535a\u5ba2","text":"<p>\u6700\u8fd1\u51e0\u5929\u521a\u521a\u5c06\u535a\u5ba2\u8f6c\u5230mkdocs\uff0c\u56e0\u6b64\u5185\u5bb9\u8fd8\u6bd4\u8f83\u5c11\u3002\u4ee5\u540e\u6216\u8bb8\u4f1a\u9010\u6e10\u66f4\u65b0\u4e00\u4e9b\u6280\u672f\u6587\u7ae0/\u5b9e\u7528\u5de5\u5177/\u9879\u76ee\u3002</p> <p>last updated: 2025/11/4</p>"},{"location":"CP/","title":"\u7b97\u6cd5\u7ade\u8d5b","text":"<p>\u8fd9\u4e2a\u90e8\u5206\u5c06\u6536\u5f55\u4e00\u4e9b\u6211\u6253\u7b97\u6cd5\u7ade\u8d5b\u671f\u95f4\u5199\u8fc7\u7684\u9898\u89e3\u548c\u535a\u5ba2\uff0c\u76ee\u524d\u5c1a\u672a\u6574\u7406\u5b8c\u3002</p>"},{"location":"CP/templates/","title":"\u7b97\u6cd5\u6a21\u677f","text":"<p>\u8fd9\u662f\u62112025\u5e74\u7f51\u7edc\u8d5b\u65f6\u4f7f\u7528\u7684\u677f\u5b50\uff0c\u6709\u4e9b\u5c01\u88c5\u7a0b\u5ea6\u8fc7\u9ad8\u5bfc\u81f4\u4ee3\u7801\u91cf\u6bd4\u8f83\u5927\uff0c\u53ef\u80fd\u4e0d\u9002\u5408\u7ebf\u4e0b\u6bd4\u8d5b\u3002\u8fc7\u4e8e\u7b80\u5355\uff08\u6216\u8005\u8bf4\u662f\u6211\u5f88\u719f\u6089\uff09\u7684\u7b97\u6cd5\u6ca1\u6709\u6536\u5f55\u8fdb\u6765\u3002</p>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/","title":"5 \u51e0\u4f55\uff08by WIDA\uff09","text":""},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#51","title":"5.1 \u5e93\u5b9e\u6570\u7c7b\u5b9e\u73b0\uff08\u53cc\u7cbe\u5ea6\uff09","text":"<pre><code>using Real = int;\nusing Point = complex&lt;Real&gt;;\n\nReal cross(const Point &amp;a, const Point &amp;b) {\n    return (conj(a) * b).imag();\n} \nReal dot(const Point &amp;a, const Point &amp;b) {\n    return (conj(a) * b).real();\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#52","title":"5.2 \u5e73\u9762\u51e0\u4f55\u5fc5\u8981\u521d\u59cb\u5316","text":""},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#521","title":"5.2.1 \u5b57\u7b26\u4e32\u8bfb\u5165\u6d6e\u70b9\u6570","text":"<pre><code>const int Knum = 4;\nint read(int k = Knum) {\n    string s;\n    cin &gt;&gt; s;\n\n    int num = 0;\n    int it = s.find('.');\n    if (it != -1) { // \u5b58\u5728\u5c0f\u6570\u70b9\n        num = s.size() - it - 1; // \u8ba1\u7b97\u5c0f\u6570\u4f4d\u6570\n        s.erase(s.begin() + it); // \u5220\u9664\u5c0f\u6570\u70b9\n    }\n    for (int i = 1; i &lt;= k - num; i++) { // \u8865\u5168\u5c0f\u6570\u4f4d\u6570\n        s += '0';\n    }\n    return stoi(s); \n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#522","title":"5.2.2 \u9884\u7f6e\u51fd\u6570","text":"<pre><code>using ld = long double;\nconst ld PI = acos(-1);\nconst ld EPS = 1e-7;\nconst ld INF = numeric_limits&lt;ld&gt;::max();\n#define cc(x) cout &lt;&lt; fixed &lt;&lt; setprecision(x);\n\nld fgcd(ld x, ld y) { // \u5b9e\u6570\u57dfgcd\n    return abs(y) &lt; EPS ? abs(x) : fgcd(y, fmod(x, y));\n}\ntemplate&lt;class T, class S&gt; bool equal(T x, S y) {\n    return -EPS &lt; x - y &amp;&amp; x - y &lt; EPS;\n}\ntemplate&lt;class T&gt; int sign(T x) {\n    if (-EPS &lt; x &amp;&amp; x &lt; EPS) return 0;\n    return x &lt; 0 ? -1 : 1;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#523","title":"5.2.3 \u70b9\u7ebf\u5c01\u88c5","text":"<pre><code>template&lt;class T&gt; struct Point { // \u5728C++17\u4e0b\u4f7f\u7528 emplace_back \u7ed1\u5b9a\u53ef\u80fd\u4f1a\u5bfc\u81f4CE\uff01\n    T x, y;\n    Point(T x_ = 0, T y_ = 0) : x(x_), y(y_) {} // \u521d\u59cb\u5316\n    template&lt;class U&gt; operator Point&lt;U&gt;() { // \u81ea\u52a8\u7c7b\u578b\u5339\u914d\n        return Point&lt;U&gt;(U(x), U(y));\n    }\n    Point &amp;operator+=(Point p) &amp; { return x += p.x, y += p.y, *this; }\n    Point &amp;operator+=(T t) &amp; { return x += t, y += t, *this; }\n    Point &amp;operator-=(Point p) &amp; { return x -= p.x, y -= p.y, *this; }\n    Point &amp;operator-=(T t) &amp; { return x -= t, y -= t, *this; }\n    Point &amp;operator*=(T t) &amp; { return x *= t, y *= t, *this; }\n    Point &amp;operator/=(T t) &amp; { return x /= t, y /= t, *this; }\n    Point operator-() const { return Point(-x, -y); }\n    friend Point operator+(Point a, Point b) { return a += b; }\n    friend Point operator+(Point a, T b) { return a += b; }\n    friend Point operator-(Point a, Point b) { return a -= b; }\n    friend Point operator-(Point a, T b) { return a -= b; }\n    friend Point operator*(Point a, T b) { return a *= b; }\n    friend Point operator*(T a, Point b) { return b *= a; }\n    friend Point operator/(Point a, T b) { return a /= b; }\n    friend bool operator&lt;(Point a, Point b) {\n        return equal(a.x, b.x) ? a.y &lt; b.y - EPS : a.x &lt; b.x - EPS;\n    }\n    friend bool operator&gt;(Point a, Point b) { return b &lt; a; }\n    friend bool operator==(Point a, Point b) { return !(a &lt; b) &amp;&amp; !(b &lt; a); }\n    friend bool operator!=(Point a, Point b) { return a &lt; b || b &lt; a; }\n    friend auto &amp;operator&gt;&gt;(istream &amp;is, Point &amp;p) {\n        return is &gt;&gt; p.x &gt;&gt; p.y;\n    }\n    friend auto &amp;operator&lt;&lt;(ostream &amp;os, Point p) {\n        return os &lt;&lt; \"(\" &lt;&lt; p.x &lt;&lt; \", \" &lt;&lt; p.y &lt;&lt; \")\";\n    }\n};\ntemplate&lt;class T&gt; struct Line {\n    Point&lt;T&gt; a, b;\n    Line(Point&lt;T&gt; a_ = Point&lt;T&gt;(), Point&lt;T&gt; b_ = Point&lt;T&gt;()) : a(a_), b(b_) {}\n    template&lt;class U&gt; operator Line&lt;U&gt;() { // \u81ea\u52a8\u7c7b\u578b\u5339\u914d\n        return Line&lt;U&gt;(Point&lt;U&gt;(a), Point&lt;U&gt;(b));\n    }\n    friend auto &amp;operator&lt;&lt;(ostream &amp;os, Line l) {\n        return os &lt;&lt; \"&lt;\" &lt;&lt; l.a &lt;&lt; \", \" &lt;&lt; l.b &lt;&lt; \"&gt;\";\n    }\n};\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#524","title":"5.2.4 \u53c9\u4e58","text":"<p>\u5b9a\u4e49\u516c\u5f0f \\(a\\times b=|a||b|\\sin \\theta\\)\u3002</p> <pre><code>template&lt;class T&gt; T cross(Point&lt;T&gt; a, Point&lt;T&gt; b) { // \u53c9\u4e58\n    return a.x * b.y - a.y * b.x;\n}\ntemplate&lt;class T&gt; T cross(Point&lt;T&gt; p1, Point&lt;T&gt; p2, Point&lt;T&gt; p0) { // \u53c9\u4e58 (p1 - p0) x (p2 - p0);\n    return cross(p1 - p0, p2 - p0);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#525","title":"5.2.5 \u70b9\u4e58","text":"<p>\u5b9a\u4e49\u516c\u5f0f \\(a\\times b=|a||b|\\cos \\theta\\)\u3002</p> <pre><code>template&lt;class T&gt; T dot(Point&lt;T&gt; a, Point&lt;T&gt; b) { // \u70b9\u4e58\n    return a.x * b.x + a.y * b.y;\n}\ntemplate&lt;class T&gt; T dot(Point&lt;T&gt; p1, Point&lt;T&gt; p2, Point&lt;T&gt; p0) { // \u70b9\u4e58 (p1 - p0) * (p2 - p0);\n    return dot(p1 - p0, p2 - p0);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#526","title":"5.2.6 \u6b27\u51e0\u91cc\u5f97\u8ddd\u79bb\u516c\u5f0f","text":"<p>\u6700\u5e38\u7528\u7684\u8ddd\u79bb\u516c\u5f0f\u3002\u9700\u8981\u6ce8\u610f\uff0c\u5f00\u6839\u53f7\u4f1a\u4e22\u5931\u7cbe\u5ea6\uff0c\u5982\u65e0\u5f3a\u5236\u8981\u6c42\uff0c\u5148\u4e0d\u8981\u5f00\u6839\u53f7\uff0c\u7559\u5230\u6700\u540e\u4e00\u6b65\u4e00\u8d77\u5f00\u3002</p> <pre><code>template &lt;class T&gt; ld dis(T x1, T y1, T x2, T y2) {\n    ld val = (x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2);\n    return sqrt(val);\n}\ntemplate &lt;class T&gt; ld dis(Point&lt;T&gt; a, Point&lt;T&gt; b) {\n    return dis(a.x, a.y, b.x, b.y);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#527","title":"5.2.7 \u66fc\u54c8\u987f\u8ddd\u79bb\u516c\u5f0f","text":"<pre><code>template &lt;class T&gt; T dis1(Point&lt;T&gt; p1, Point&lt;T&gt; p2) { // \u66fc\u54c8\u987f\u8ddd\u79bb\u516c\u5f0f\n    return abs(p1.x - p2.x) + abs(p1.y - p2.y);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#528","title":"5.2.8 \u5c06\u5411\u91cf\u8f6c\u6362\u4e3a\u5355\u4f4d\u5411\u91cf","text":"<pre><code>Point&lt;ld&gt; standardize(Point&lt;ld&gt; vec) { // \u8f6c\u6362\u4e3a\u5355\u4f4d\u5411\u91cf\n    return vec / sqrt(vec.x * vec.x + vec.y * vec.y);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#529","title":"5.2.9 \u5411\u91cf\u65cb\u8f6c","text":"<p>\u5c06\u5f53\u524d\u5411\u91cf\u79fb\u52a8\u81f3\u539f\u70b9\u540e\u987a\u65f6\u9488\u65cb\u8f6c \\(90^{\\circ}\\) \uff0c\u5373\u83b7\u53d6\u5782\u76f4\u4e8e\u5f53\u524d\u5411\u91cf\u7684\u3001\u8d77\u70b9\u4e3a\u539f\u70b9\u7684\u5411\u91cf\u3002\u5728\u8ba1\u7b97\u5782\u7ebf\u65f6\u975e\u5e38\u6709\u7528\u3002\u4f8b\u5982\uff0c\u8981\u60f3\u83b7\u53d6\u70b9 \\(a\\) \u7ed5\u70b9 \\(o\\) \u987a\u65f6\u9488\u65cb\u8f6c \\(90^{\\circ}\\) \u540e\u7684\u70b9\uff0c\u53ef\u4ee5\u8fd9\u6837\u4e66\u5199\u4ee3\u7801\uff1a<code>auto ans = o + rotate(o, a);</code> \uff1b\u5982\u679c\u662f\u9006\u65f6\u9488\u65cb\u8f6c\uff0c\u90a3\u4e48\u53ea\u9700\u66f4\u6539\u7b26\u53f7\u5373\u53ef\uff1a<code>auto ans = o - rotate(o, a);</code> \u3002</p> <pre><code>template&lt;class T&gt; Point&lt;T&gt; rotate(Point&lt;T&gt; p1, Point&lt;T&gt; p2) { // \u65cb\u8f6c\n    Point&lt;T&gt; vec = p1 - p2;\n    return {-vec.y, vec.x};\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#53","title":"5.3 \u5e73\u9762\u89d2\u5ea6\u4e0e\u5f27\u5ea6","text":""},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#531","title":"5.3.1 \u5f27\u5ea6\u89d2\u5ea6\u76f8\u4e92\u8f6c\u6362","text":"<pre><code>ld toDeg(ld x) { // \u5f27\u5ea6\u8f6c\u89d2\u5ea6\n    return x * 180 / PI;\n}\nld toArc(ld x) { // \u89d2\u5ea6\u8f6c\u5f27\u5ea6\n    return PI / 180 * x;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#532","title":"5.3.2 \u6b63\u5f26\u5b9a\u7406","text":"<p>\\(\\dfrac{a}{\\sin A}=\\dfrac{b}{\\sin B}=\\dfrac{c}{\\sin C}=2R\\) \uff0c\u5176\u4e2d \\(R\\) \u4e3a\u4e09\u89d2\u5f62\u5916\u63a5\u5706\u534a\u5f84\uff1b</p>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#533","title":"5.3.3 \u4f59\u5f26\u5b9a\u7406\uff08\u5df2\u77e5\u4e09\u89d2\u5f62\u4e09\u8fb9\uff0c\u6c42\u89d2\uff09","text":"<p>\\(\\cos C=\\dfrac{a^2+b^2-c^2}{2ab},\\cos B=\\dfrac{a^2+c^2-b^2}{2ac},\\cos A=\\dfrac{b^2+c^2-a^2}{2bc}\\)\u3002\u53ef\u4ee5\u501f\u6b64\u63a8\u5bfc\u51fa\u4e09\u89d2\u5f62\u9762\u79ef\u516c\u5f0f \\(S_{\\triangle ABC}=\\dfrac{ab\\cdot\\sin C}{2}=\\dfrac{bc\\cdot\\sin A}{2}=\\dfrac{ac\\cdot\\sin B}{2}\\)\u3002</p> <p>\u6ce8\u610f\uff0c\u8ba1\u7b97\u683c\u5f0f\u662f\uff1a\u7531 \\(b,c,a\\) \u4e09\u8fb9\u6c42 \\(\\angle A\\)\uff1b\u7531 \\(a, c, b\\) \u4e09\u8fb9\u6c42 \\(\\angle B\\)\uff1b\u7531 \\(a, b, c\\) \u4e09\u8fb9\u6c42 \\(\\angle C\\)\u3002</p> <pre><code>ld angle(ld a, ld b, ld c) { // \u4f59\u5f26\u5b9a\u7406\n    ld val = acos((a * a + b * b - c * c) / (2.0 * a * b)); // \u8ba1\u7b97\u5f27\u5ea6\n    return val;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#534","title":"5.3.4 \u6c42\u4e24\u5411\u91cf\u7684\u5939\u89d2","text":"<p>\u80fd\u591f\u8ba1\u7b97 \\([0^{\\circ},180^{\\circ}]\\) \u533a\u95f4\u7684\u89d2\u5ea6\u3002</p> <pre><code>ld angle(Point&lt;ld&gt; a, Point&lt;ld&gt; b) {\n    ld val = abs(cross(a, b));\n    return abs(atan2(val, a.x * b.x + a.y * b.y));\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#535","title":"5.3.5 \u5411\u91cf\u65cb\u8f6c\u4efb\u610f\u89d2\u5ea6","text":"<p>\u9006\u65f6\u9488\u65cb\u8f6c\uff0c\u8f6c\u6362\u516c\u5f0f\uff1a\\(\\left\\{\\begin{matrix} x'=x\\cos \\theta-y\\sin \\theta \\\\  y'=x\\sin \\theta+y\\cos \\theta \\end{matrix}\\right.\\)</p> <pre><code>Point&lt;ld&gt; rotate(Point&lt;ld&gt; p, ld rad) {\n    return {p.x * cos(rad) - p.y * sin(rad), p.x * sin(rad) + p.y * cos(rad)};\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#536","title":"5.3.6 \u70b9\u7ed5\u70b9\u65cb\u8f6c\u4efb\u610f\u89d2\u5ea6","text":"<p>\u9006\u65f6\u9488\u65cb\u8f6c\uff0c\u8f6c\u6362\u516c\u5f0f\uff1a\\(\\left\\{\\begin{matrix} x'=(x_0-x_1)\\cos\\theta+(y_0-y_1)\\sin\\theta+x_1 \\\\  y'=(x_1-x_0)\\sin\\theta+(y_0-y_1)\\cos\\theta+y_1 \\end{matrix}\\right.\\)</p> <pre><code>Point&lt;ld&gt; rotate(Point&lt;ld&gt; a, Point&lt;ld&gt; b, ld rad) {\n    ld x = (a.x - b.x) * cos(rad) + (a.y - b.y) * sin(rad) + b.x;\n    ld y = (b.x - a.x) * sin(rad) + (a.y - b.y) * cos(rad) + b.y;\n    return {x, y};\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#54","title":"5.4 \u5e73\u9762\u70b9\u7ebf\u76f8\u5173","text":""},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#541","title":"5.4.1 \u70b9\u662f\u5426\u5728\u76f4\u7ebf\u4e0a\uff08\u4e09\u70b9\u662f\u5426\u5171\u7ebf\uff09","text":"<pre><code>template&lt;class T&gt; bool onLine(Point&lt;T&gt; a, Point&lt;T&gt; b, Point&lt;T&gt; c) {\n    return sign(cross(b, a, c)) == 0;\n}\ntemplate&lt;class T&gt; bool onLine(Point&lt;T&gt; p, Line&lt;T&gt; l) {\n    return onLine(p, l.a, l.b);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#542","title":"5.4.2 \u70b9\u662f\u5426\u5728\u5411\u91cf\uff08\u76f4\u7ebf\uff09\u5de6\u4fa7","text":"<p>\u9700\u8981\u6ce8\u610f\uff0c\u5411\u91cf\u7684\u65b9\u5411\u4f1a\u5f71\u54cd\u7b54\u6848\uff1b\u70b9\u5728\u5411\u91cf\u4e0a\u65f6\u4e0d\u89c6\u4e3a\u5728\u5de6\u4fa7\u3002</p> <pre><code>template&lt;class T&gt; bool pointOnLineLeft(Pt p, Lt l) {\n    return cross(l.b, p, l.a) &gt; 0;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#543","title":"5.4.3 \u4e24\u70b9\u662f\u5426\u5728\u76f4\u7ebf\u540c\u4fa7/\u5f02\u4fa7","text":"<pre><code>template&lt;class T&gt; bool pointOnLineSide(Pt p1, Pt p2, Lt vec) {\n    T val = cross(p1, vec.a, vec.b) * cross(p2, vec.a, vec.b);\n    return sign(val) == 1;\n}\ntemplate&lt;class T&gt; bool pointNotOnLineSide(Pt p1, Pt p2, Lt vec) {\n    T val = cross(p1, vec.a, vec.b) * cross(p2, vec.a, vec.b);\n    return sign(val) == -1;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#544","title":"5.4.4 \u4e24\u76f4\u7ebf\u76f8\u4ea4\u4ea4\u70b9","text":"<p>\u5728\u4f7f\u7528\u524d\u9700\u8981\u5148\u5224\u65ad\u76f4\u7ebf\u662f\u5426\u5e73\u884c\u3002</p> <pre><code>Pd lineIntersection(Ld l1, Ld l2) {\n    ld val = cross(l2.b - l2.a, l1.a - l2.a) / cross(l2.b - l2.a, l1.a - l1.b);\n    return l1.a + (l1.b - l1.a) * val;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#545","title":"5.4.5 \u4e24\u76f4\u7ebf\u662f\u5426\u5e73\u884c/\u5782\u76f4/\u76f8\u540c","text":"<pre><code>template&lt;class T&gt; bool lineParallel(Lt p1, Lt p2) {\n    return sign(cross(p1.a - p1.b, p2.a - p2.b)) == 0;\n}\ntemplate&lt;class T&gt; bool lineVertical(Lt p1, Lt p2) {\n    return sign(dot(p1.a - p1.b, p2.a - p2.b)) == 0;\n}\ntemplate&lt;class T&gt; bool same(Line&lt;T&gt; l1, Line&lt;T&gt; l2) {\n    return lineParallel(Line{l1.a, l2.b}, {l1.b, l2.a}) &amp;&amp;\n           lineParallel(Line{l1.a, l2.a}, {l1.b, l2.b}) &amp;&amp; lineParallel(l1, l2);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#546","title":"5.4.6 \u70b9\u5230\u76f4\u7ebf\u7684\u6700\u8fd1\u8ddd\u79bb\u4e0e\u6700\u8fd1\u70b9","text":"<pre><code>pair&lt;Pd, ld&gt; pointToLine(Pd p, Ld l) {\n    Pd ans = lineIntersection({p, p + rotate(l.a, l.b)}, l);\n    return {ans, dis(p, ans)};\n}\n</code></pre> <p>\u5982\u679c\u53ea\u9700\u8981\u8ba1\u7b97\u6700\u8fd1\u8ddd\u79bb\uff0c\u4e0b\u65b9\u7684\u5199\u6cd5\u53ef\u4ee5\u51cf\u5c11\u4e66\u5199\u7684\u4ee3\u7801\u91cf\uff0c\u6548\u679c\u4e00\u81f4\u3002</p> <pre><code>template&lt;class T&gt; ld disPointToLine(Pt p, Lt l) {\n    ld ans = cross(p, l.a, l.b);\n    return abs(ans) / dis(l.a, l.b); // \u9762\u79ef\u9664\u4ee5\u5e95\u8fb9\u957f\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#547","title":"5.4.7 \u70b9\u662f\u5426\u5728\u7ebf\u6bb5\u4e0a","text":"<pre><code>template&lt;class T&gt; bool pointOnSegment(Pt p, Lt l) { // \u7aef\u70b9\u4e5f\u7b97\u4f5c\u5728\u76f4\u7ebf\u4e0a\n    return sign(cross(p, l.a, l.b)) == 0 &amp;&amp; min(l.a.x, l.b.x) &lt;= p.x &amp;&amp; p.x &lt;= max(l.a.x, l.b.x) &amp;&amp;\n           min(l.a.y, l.b.y) &lt;= p.y &amp;&amp; p.y &lt;= max(l.a.y, l.b.y);\n}\ntemplate&lt;class T&gt; bool pointOnSegment(Pt p, Lt l) { // \u7aef\u70b9\u4e0d\u7b97\n    return pointOnSegment(p, l) &amp;&amp; min(l.a.x, l.b.x) &lt; p.x &amp;&amp; p.x &lt; max(l.a.x, l.b.x) &amp;&amp;\n           min(l.a.y, l.b.y) &lt; p.y &amp;&amp; p.y &lt; max(l.a.y, l.b.y);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#548","title":"5.4.8 \u70b9\u5230\u7ebf\u6bb5\u7684\u6700\u8fd1\u8ddd\u79bb\u4e0e\u6700\u8fd1\u70b9","text":"<pre><code>pair&lt;Pd, ld&gt; pointToSegment(Pd p, Ld l) {\n    if (sign(dot(p, l.b, l.a)) == -1) { // \u7279\u5224\u5230\u4e24\u7aef\u70b9\u7684\u8ddd\u79bb\n        return {l.a, dis(p, l.a)};\n    } else if (sign(dot(p, l.a, l.b)) == -1) {\n        return {l.b, dis(p, l.b)};\n    }\n    return pointToLine(p, l);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#549","title":"5.4.9 \u70b9\u5728\u76f4\u7ebf\u4e0a\u7684\u6295\u5f71\u70b9\uff08\u5782\u8db3\uff09","text":"<pre><code>Pd project(Pd p, Ld l) { // \u6295\u5f71\n    Pd vec = l.b - l.a;\n    ld r = dot(vec, p - l.a) / (vec.x * vec.x + vec.y * vec.y);\n    return l.a + vec * r;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5410","title":"5.4.10 \u7ebf\u6bb5\u7684\u4e2d\u5782\u7ebf","text":"<pre><code>template&lt;class T&gt; Lt midSegment(Lt l) {\n    Pt mid = (l.a + l.b) / 2; // \u7ebf\u6bb5\u4e2d\u70b9\n    return {mid, mid + rotate(l.a, l.b)};\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5411","title":"5.4.11 \u4e24\u7ebf\u6bb5\u662f\u5426\u76f8\u4ea4\u53ca\u4ea4\u70b9","text":"<p>\u8be5\u6269\u5c55\u7248\u53ef\u4ee5\u540c\u65f6\u8fd4\u56de\u76f8\u4ea4\u72b6\u6001\u548c\u4ea4\u70b9\uff0c\u5206\u4e3a\u56db\u79cd\u60c5\u51b5\uff1a\\(0\\) \u4ee3\u8868\u4e0d\u76f8\u4ea4\uff1b\\(1\\) \u4ee3\u8868\u666e\u901a\u76f8\u4ea4\uff1b\\(2\\) \u4ee3\u8868\u91cd\u53e0\uff08\u4ea4\u4e8e\u4e24\u4e2a\u70b9\uff09\uff1b\\(3\\) \u4ee3\u8868\u76f8\u4ea4\u4e8e\u7aef\u70b9\u3002\u9700\u8981\u6ce8\u610f\uff0c\u90e8\u5206\u8fd0\u7b97\u53ef\u80fd\u4f1a\u4f7f\u7528\u5230\u76f4\u7ebf\u6c42\u4ea4\u70b9\uff0c\u6b64\u65f6\u52a1\u5fc5\u4fdd\u8bc1\u53d8\u91cf\u7c7b\u578b\u4e3a\u6d6e\u70b9\u6570\uff01</p> <pre><code>template&lt;class T&gt; tuple&lt;int, Pt, Pt&gt; segmentIntersection(Lt l1, Lt l2) {\n    auto [s1, e1] = l1;\n    auto [s2, e2] = l2;\n    auto A = max(s1.x, e1.x), AA = min(s1.x, e1.x);\n    auto B = max(s1.y, e1.y), BB = min(s1.y, e1.y);\n    auto C = max(s2.x, e2.x), CC = min(s2.x, e2.x);\n    auto D = max(s2.y, e2.y), DD = min(s2.y, e2.y);\n    if (A &lt; CC || C &lt; AA || B &lt; DD || D &lt; BB) {\n        return {0, {}, {}};\n    }\n    if (sign(cross(e1 - s1, e2 - s2)) == 0) {\n        if (sign(cross(s2, e1, s1)) != 0) {\n            return {0, {}, {}};\n        }\n        Pt p1(max(AA, CC), max(BB, DD));\n        Pt p2(min(A, C), min(B, D));\n        if (!pointOnSegment(p1, l1)) {\n            swap(p1.y, p2.y);\n        }\n        if (p1 == p2) {\n            return {3, p1, p2};\n        } else {\n            return {2, p1, p2};\n        }\n    }\n    auto cp1 = cross(s2 - s1, e2 - s1);\n    auto cp2 = cross(s2 - e1, e2 - e1);\n    auto cp3 = cross(s1 - s2, e1 - s2);\n    auto cp4 = cross(s1 - e2, e1 - e2);\n    if (sign(cp1 * cp2) == 1 || sign(cp3 * cp4) == 1) {\n        return {0, {}, {}};\n    }\n    // \u4f7f\u7528\u4e0b\u65b9\u51fd\u6570\u65f6\u8bf7\u4f7f\u7528\u6d6e\u70b9\u6570\n    Pd p = lineIntersection(l1, l2);\n    if (sign(cp1) != 0 &amp;&amp; sign(cp2) != 0 &amp;&amp; sign(cp3) != 0 &amp;&amp; sign(cp4) != 0) {\n        return {1, p, p};\n    } else {\n        return {3, p, p};\n    }\n}\n</code></pre> <p>\u5982\u679c\u4e0d\u9700\u8981\u6c42\u4ea4\u70b9\uff0c\u90a3\u4e48\u4f7f\u7528\u5feb\u901f\u6392\u65a5+\u8de8\u7acb\u5b9e\u9a8c\u5373\u53ef\uff0c\u5176\u4e2d\u91cd\u53e0\u3001\u76f8\u4ea4\u4e8e\u7aef\u70b9\u5747\u89c6\u4e3a\u76f8\u4ea4\u3002</p> <pre><code>template&lt;class T&gt; bool segmentIntersection(Lt l1, Lt l2) {\n    auto [s1, e1] = l1;\n    auto [s2, e2] = l2;\n    auto A = max(s1.x, e1.x), AA = min(s1.x, e1.x);\n    auto B = max(s1.y, e1.y), BB = min(s1.y, e1.y);\n    auto C = max(s2.x, e2.x), CC = min(s2.x, e2.x);\n    auto D = max(s2.y, e2.y), DD = min(s2.y, e2.y);\n    return A &gt;= CC &amp;&amp; B &gt;= DD &amp;&amp; C &gt;= AA &amp;&amp; D &gt;= BB &amp;&amp;\n           sign(cross(s1, s2, e1) * cross(s1, e1, e2)) == 1 &amp;&amp;\n           sign(cross(s2, s1, e2) * cross(s2, e2, e1)) == 1;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#55","title":"5.5 \u5e73\u9762\u5706\u76f8\u5173\uff08\u6d6e\u70b9\u6570\u5904\u7406\uff09","text":""},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#551","title":"5.5.1 \u70b9\u5230\u5706\u7684\u6700\u8fd1\u70b9","text":"<p>\u540c\u65f6\u8fd4\u56de\u6700\u8fd1\u70b9\u4e0e\u6700\u8fd1\u8ddd\u79bb\u3002\u9700\u8981\u6ce8\u610f\uff0c\u5f53\u70b9\u4e3a\u5706\u5fc3\u65f6\uff0c\u8fd9\u6837\u7684\u70b9\u6709\u65e0\u6570\u4e2a\uff0c\u6b64\u65f6\u6211\u4eec\u89c6\u4f5c\u8f93\u5165\u9519\u8bef\uff0c\u76f4\u63a5\u8fd4\u56de\u5706\u5fc3\u3002</p> <pre><code>pair&lt;Pd, ld&gt; pointToCircle(Pd p, Pd o, ld r) {\n    Pd U = o, V = o;\n    ld d = dis(p, o);\n    if (sign(d) == 0) { // p \u4e3a\u5706\u5fc3\u65f6\u8fd4\u56de\u5706\u5fc3\u672c\u8eab\n        return {o, 0};\n    }\n    ld val1 = r * abs(o.x - p.x) / d;\n    ld val2 = r * abs(o.y - p.y) / d * ((o.x - p.x) * (o.y - p.y) &lt; 0 ? -1 : 1);\n    U.x += val1, U.y += val2;\n    V.x -= val1, V.y -= val2;\n    if (dis(U, p) &lt; dis(V, p)) {\n        return {U, dis(U, p)};\n    } else {\n        return {V, dis(V, p)};\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#552","title":"5.5.2 \u6839\u636e\u5706\u5fc3\u89d2\u83b7\u53d6\u5706\u4e0a\u67d0\u70b9","text":"<p>\u5c06\u5706\u4e0a\u6700\u53f3\u4fa7\u7684\u70b9\u4ee5\u5706\u5fc3\u4e3a\u65cb\u8f6c\u4e2d\u5fc3\uff0c\u9006\u65f6\u9488\u65cb\u8f6c <code>rad</code> \u5ea6\u3002</p> <pre><code>Point&lt;ld&gt; getPoint(Point&lt;ld&gt; p, ld r, ld rad) {\n    return {p.x + cos(rad) * r, p.y + sin(rad) * r};\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#553","title":"5.5.3 \u76f4\u7ebf\u662f\u5426\u4e0e\u5706\u76f8\u4ea4\u53ca\u4ea4\u70b9","text":"<p>\\(0\\) \u4ee3\u8868\u4e0d\u76f8\u4ea4\uff1b\\(1\\) \u4ee3\u8868\u76f8\u5207\uff1b\\(2\\) \u4ee3\u8868\u76f8\u4ea4\u3002</p> <pre><code>tuple&lt;int, Pd, Pd&gt; lineCircleCross(Ld l, Pd o, ld r) {\n    Pd P = project(o, l);\n    ld d = dis(P, o), tmp = r * r - d * d;\n    if (sign(tmp) == -1) {\n        return {0, {}, {}};\n    } else if (sign(tmp) == 0) {\n        return {1, P, {}};\n    }\n    Pd vec = standardize(l.b - l.a) * sqrt(tmp);\n    return {2, P + vec, P - vec};\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#554","title":"5.5.4 \u7ebf\u6bb5\u662f\u5426\u4e0e\u5706\u76f8\u4ea4\u53ca\u4ea4\u70b9","text":"<p>\\(0\\) \u4ee3\u8868\u4e0d\u76f8\u4ea4\uff1b\\(1\\) \u4ee3\u8868\u76f8\u5207\uff1b\\(2\\) \u4ee3\u8868\u76f8\u4ea4\u4e8e\u4e00\u4e2a\u70b9\uff1b\\(3\\) \u4ee3\u8868\u76f8\u4ea4\u4e8e\u4e24\u4e2a\u70b9\u3002</p> <pre><code>tuple&lt;int, Pd, Pd&gt; segmentCircleCross(Ld l, Pd o, ld r) {\n    auto [type, U, V] = lineCircleCross(l, o, r);\n    bool f1 = pointOnSegment(U, l), f2 = pointOnSegment(V, l);\n    if (type == 1 &amp;&amp; f1) {\n        return {1, U, {}};\n    } else if (type == 2 &amp;&amp; f1 &amp;&amp; f2) {\n        return {3, U, V};\n    } else if (type == 2 &amp;&amp; f1) {\n        return {2, U, {}};\n    } else if (type == 2 &amp;&amp; f2) {\n        return {2, V, {}};\n    } else {\n        return {0, {}, {}};\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#555","title":"5.5.5 \u4e24\u5706\u662f\u5426\u76f8\u4ea4\u53ca\u4ea4\u70b9","text":"<p>\\(0\\) \u4ee3\u8868\u5185\u542b\uff1b\\(1\\) \u4ee3\u8868\u76f8\u79bb\uff1b\\(2\\) \u4ee3\u8868\u76f8\u5207\uff1b\\(3\\) \u4ee3\u8868\u76f8\u4ea4\u3002</p> <pre><code>tuple&lt;int, Pd, Pd&gt; circleIntersection(Pd p1, ld r1, Pd p2, ld r2) {\n    ld x1 = p1.x, x2 = p2.x, y1 = p1.y, y2 = p2.y, d = dis(p1, p2);\n    if (sign(abs(r1 - r2) - d) == 1) {\n        return {0, {}, {}};\n    } else if (sign(r1 + r2 - d) == -1) {\n        return {1, {}, {}};\n    }\n    ld a = r1 * (x1 - x2) * 2, b = r1 * (y1 - y2) * 2, c = r2 * r2 - r1 * r1 - d * d;\n    ld p = a * a + b * b, q = -a * c * 2, r = c * c - b * b;\n    ld cosa, sina, cosb, sinb;\n    if (sign(d - (r1 + r2)) == 0 || sign(d - abs(r1 - r2)) == 0) {\n        cosa = -q / p / 2;\n        sina = sqrt(1 - cosa * cosa);\n        Point&lt;ld&gt; p0 = {x1 + r1 * cosa, y1 + r1 * sina};\n        if (sign(dis(p0, p2) - r2)) {\n            p0.y = y1 - r1 * sina;\n        }\n        return {2, p0, p0};\n    } else {\n        ld delta = sqrt(q * q - p * r * 4);\n        cosa = (delta - q) / p / 2;\n        cosb = (-delta - q) / p / 2;\n        sina = sqrt(1 - cosa * cosa);\n        sinb = sqrt(1 - cosb * cosb);\n        Pd ans1 = {x1 + r1 * cosa, y1 + r1 * sina};\n        Pd ans2 = {x1 + r1 * cosb, y1 + r1 * sinb};\n        if (sign(dis(ans1, p1) - r2)) ans1.y = y1 - r1 * sina;\n        if (sign(dis(ans2, p2) - r2)) ans2.y = y1 - r1 * sinb;\n        if (ans1 == ans2) ans1.y = y1 - r1 * sina;\n        return {3, ans1, ans2};\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#556","title":"5.5.6 \u4e24\u5706\u76f8\u4ea4\u9762\u79ef","text":"<p>\u4e0a\u8ff0\u6240\u8a00\u56db\u79cd\u76f8\u4ea4\u60c5\u51b5\u5747\u53ef\u8ba1\u7b97\uff0c\u4e4b\u6240\u4ee5\u4e0d\u4f7f\u7528\u4e09\u89d2\u5f62\u9762\u79ef\u8ba1\u7b97\u516c\u5f0f\u662f\u56e0\u4e3a\u5728\u8ba1\u7b97\u8fc7\u7a0b\u4e2d\u4f1a\u51fa\u73b0\u201c\u8d1f\u6570\u201d\u9762\u79ef\uff08\u6247\u5f62\u9762\u79ef\u4e0e\u4e09\u89d2\u5f62\u9762\u79ef\u7684\u7b26\u53f7\u5173\u7cfb\u4f1a\u968f\u5706\u7684\u4f4d\u7f6e\u5173\u7cfb\u53d1\u751f\u53d8\u5316\uff09\uff0c\u6545\u516c\u5f0f\u5168\u90e8\u91cd\u65b0\u63a8\u5bfc\uff0c\u8fd9\u91cc\u91c7\u7528\u7684\u662f\u6247\u5f62\u9762\u79ef\u51cf\u53bb\u6247\u5f62\u5185\u90e8\u7684\u90a3\u4e2a\u4e09\u89d2\u5f62\u7684\u9762\u79ef\u3002</p> <pre><code>ld circleIntersectionArea(Pd p1, ld r1, Pd p2, ld r2) {\n    ld x1 = p1.x, x2 = p2.x, y1 = p1.y, y2 = p2.y, d = dis(p1, p2);\n    if (sign(abs(r1 - r2) - d) &gt;= 0) {\n        return PI * min(r1 * r1, r2 * r2);\n    } else if (sign(r1 + r2 - d) == -1) {\n        return 0;\n    }\n    ld theta1 = angle(r1, dis(p1, p2), r2);\n    ld area1 = r1 * r1 * (theta1 - sin(theta1 * 2) / 2);\n    ld theta2 = angle(r2, dis(p1, p2), r1);\n    ld area2 = r2 * r2 * (theta2 - sin(theta2 * 2) / 2);\n    return area1 + area2;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#557","title":"5.5.7 \u4e09\u70b9\u786e\u5b9a\u4e00\u5706","text":"<pre><code>tuple&lt;int, Pd, ld&gt; getCircle(Pd A, Pd B, Pd C) {\n    if (onLine(A, B, C)) { // \u7279\u5224\u4e09\u70b9\u5171\u7ebf\n        return {0, {}, 0};\n    }\n    Ld l1 = midSegment(Line{A, B});\n    Ld l2 = midSegment(Line{A, C});\n    Pd O = lineIntersection(l1, l2);\n    return {1, O, dis(A, O)};\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#558","title":"5.5.8 \u6c42\u89e3\u70b9\u5230\u5706\u7684\u5207\u7ebf\u6570\u91cf\u4e0e\u5207\u70b9","text":"<pre><code>pair&lt;int, vector&lt;Point&lt;ld&gt;&gt;&gt; tangent(Point&lt;ld&gt; p, Point&lt;ld&gt; A, ld r) {\n    vector&lt;Point&lt;ld&gt;&gt; ans; // \u50a8\u5b58\u5207\u70b9\n    Point&lt;ld&gt; u = A - p;\n    ld d = sqrt(dot(u, u));\n    if (d &lt; r) {\n        return {0, {}};\n    } else if (sign(d - r) == 0) { // \u70b9\u5728\u5706\u4e0a\n        ans.push_back(u);\n        return {1, ans};\n    } else {\n        ld ang = asin(r / d);\n        ans.push_back(getPoint(A, r, -ang));\n        ans.push_back(getPoint(A, r, ang));\n        return {2, ans};\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#559","title":"5.5.9 \u6c42\u89e3\u4e24\u5706\u7684\u5185\u516c\u3001\u5916\u516c\u5207\u7ebf\u6570\u91cf\u4e0e\u5207\u70b9","text":"<p>\u540c\u65f6\u8fd4\u56de\u516c\u5207\u7ebf\u6570\u91cf\u4ee5\u53ca\u6bcf\u4e2a\u5706\u7684\u5207\u70b9\u3002</p> <pre><code>tuple&lt;int, vector&lt;Point&lt;ld&gt;&gt;, vector&lt;Point&lt;ld&gt;&gt;&gt; tangent(Point&lt;ld&gt; A, ld Ar, Point&lt;ld&gt; B, ld Br) {\n    vector&lt;Point&lt;ld&gt;&gt; a, b; // \u50a8\u5b58\u5207\u70b9\n    if (Ar &lt; Br) {\n        swap(Ar, Br);\n        swap(A, B);\n        swap(a, b);\n    }\n    int d = disEx(A, B), dif = Ar - Br, sum = Ar + Br;\n    if (d &lt; dif * dif) { // \u5185\u542b\uff0c\u65e0\n        return {0, {}, {}};\n    }\n    ld base = atan2(B.y - A.y, B.x - A.x);\n    if (d == 0 &amp;&amp; Ar == Br) { // \u5b8c\u5168\u91cd\u5408\uff0c\u65e0\u6570\u6761\u5916\u516c\u5207\u7ebf\n        return {-1, {}, {}};\n    }\n    if (d == dif * dif) { // \u5185\u5207\uff0c1\u6761\u5916\u516c\u5207\u7ebf\n        a.push_back(getPoint(A, Ar, base));\n        b.push_back(getPoint(B, Br, base));\n        return {1, a, b};\n    }\n    ld ang = acos(dif / sqrt(d));\n    a.push_back(getPoint(A, Ar, base + ang)); // \u4fdd\u5e952\u6761\u5916\u516c\u5207\u7ebf\n    a.push_back(getPoint(A, Ar, base - ang));\n    b.push_back(getPoint(B, Br, base + ang));\n    b.push_back(getPoint(B, Br, base - ang));\n    if (d == sum * sum) { // \u5916\u5207\uff0c\u591a1\u6761\u5185\u516c\u5207\u7ebf\n        a.push_back(getPoint(A, Ar, base));\n        b.push_back(getPoint(B, Br, base + PI));\n    } else if (d &gt; sum * sum) { // \u76f8\u79bb\uff0c\u591a2\u6761\u5185\u516c\u5207\u7ebf\n        ang = acos(sum / sqrt(d));\n        a.push_back(getPoint(A, Ar, base + ang));\n        a.push_back(getPoint(A, Ar, base - ang));\n        b.push_back(getPoint(B, Br, base + ang + PI));\n        b.push_back(getPoint(B, Br, base - ang + PI));\n    }\n    return {a.size(), a, b};\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#56","title":"5.6 \u5e73\u9762\u4e09\u89d2\u5f62\u76f8\u5173\uff08\u6d6e\u70b9\u6570\u5904\u7406\uff09","text":""},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#561","title":"5.6.1 \u4e09\u89d2\u5f62\u9762\u79ef","text":"<pre><code>ld area(Point&lt;ld&gt; a, Point&lt;ld&gt; b, Point&lt;ld&gt; c) {\n    return abs(cross(b, c, a)) / 2;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#562","title":"5.6.2 \u4e09\u89d2\u5f62\u5916\u5fc3","text":"<p>\u4e09\u89d2\u5f62\u5916\u63a5\u5706\u7684\u5706\u5fc3\uff0c\u5373\u4e09\u89d2\u5f62\u4e09\u8fb9\u5782\u76f4\u5e73\u5206\u7ebf\u7684\u4ea4\u70b9\u3002</p> <pre><code>template&lt;class T&gt; Pt center1(Pt p1, Pt p2, Pt p3) { // \u5916\u5fc3\n    return lineIntersection(midSegment({p1, p2}), midSegment({p2, p3}));\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#563","title":"5.6.3 \u4e09\u89d2\u5f62\u5185\u5fc3","text":"<p>\u4e09\u89d2\u5f62\u5185\u5207\u5706\u7684\u5706\u5fc3\uff0c\u4e5f\u662f\u4e09\u89d2\u5f62\u4e09\u4e2a\u5185\u89d2\u7684\u89d2\u5e73\u5206\u7ebf\u7684\u4ea4\u70b9\u3002\u5176\u5230\u4e09\u89d2\u5f62\u4e09\u8fb9\u7684\u8ddd\u79bb\u76f8\u7b49\u3002</p> <pre><code>Pd center2(Pd p1, Pd p2, Pd p3) { // \u5185\u5fc3\n    #define atan2(p) atan2(p.y, p.x) // \u6ce8\u610f\u5148\u540e\u987a\u5e8f\n    Line&lt;ld&gt; U = {p1, {}}, V = {p2, {}};\n    ld m, n, alpha;\n    m = atan2((p2 - p1));\n    n = atan2((p3 - p1));\n    alpha = (m + n) / 2;\n    U.b = {p1.x + cos(alpha), p1.y + sin(alpha)};\n    m = atan2((p1 - p2));\n    n = atan2((p3 - p2));\n    alpha = (m + n) / 2;\n    V.b = {p2.x + cos(alpha), p2.y + sin(alpha)};\n    return lineIntersection(U, V);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#564","title":"5.6.4 \u4e09\u89d2\u5f62\u5782\u5fc3","text":"<p>\u4e09\u89d2\u5f62\u7684\u4e09\u6761\u9ad8\u7ebf\u6240\u5728\u76f4\u7ebf\u7684\u4ea4\u70b9\u3002\u9510\u89d2\u4e09\u89d2\u5f62\u7684\u5782\u5fc3\u5728\u4e09\u89d2\u5f62\u5185\uff1b\u76f4\u89d2\u4e09\u89d2\u5f62\u7684\u5782\u5fc3\u5728\u76f4\u89d2\u9876\u70b9\u4e0a\uff1b\u949d\u89d2\u4e09\u89d2\u5f62\u7684\u5782\u5fc3\u5728\u4e09\u89d2\u5f62\u5916\u3002</p> <pre><code>Pd center3(Pd p1, Pd p2, Pd p3) { // \u5782\u5fc3\n    Ld U = {p1, p1 + rotate(p2, p3)}; // \u5782\u7ebf\n    Ld V = {p2, p2 + rotate(p1, p3)};\n    return lineIntersection(U, V);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#57","title":"5.7 \u5e73\u9762\u76f4\u7ebf\u65b9\u7a0b\u8f6c\u6362","text":""},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#571","title":"5.7.1 \u6d6e\u70b9\u6570\u8ba1\u7b97\u76f4\u7ebf\u7684\u659c\u7387","text":"<p>\u4e00\u822c\u5f88\u5c11\u4f7f\u7528\u5230\u8fd9\u4e2a\u51fd\u6570\uff0c\u56e0\u4e3a\u659c\u7387\u7684\u53d6\u503c\u4e0d\u53ef\u63a7\uff08\u4f8b\u5982\u63a5\u8fd1\u5e73\u884c\u4e8e \\(x,y\\) \u8f74\u65f6\uff09\u3002\u9700\u8981\u6ce8\u610f\uff0c\u5f53\u76f4\u7ebf\u5e73\u884c\u4e8e \\(y\\) \u8f74\u65f6\u659c\u7387\u4e3a <code>inf</code> \u3002</p> <pre><code>template &lt;class T&gt; ld slope(Pt p1, Pt p2) { // \u659c\u7387\uff0c\u6ce8\u610f inf \u7684\u60c5\u51b5\n    return (p1.y - p2.y) / (p1.x - p2.x);\n}\ntemplate &lt;class T&gt; ld slope(Lt l) {\n    return slope(l.a, l.b);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#572","title":"5.7.2 \u5206\u6570\u7cbe\u786e\u8ba1\u7b97\u76f4\u7ebf\u7684\u659c\u7387","text":"<p>\u8c03\u7528\u5206\u6570\u56db\u5219\u8fd0\u7b97\u7cbe\u786e\u8ba1\u7b97\u659c\u7387\uff0c\u8fd4\u56de\u6700\u7b80\u5206\u6570\uff0c\u53ea\u9002\u7528\u4e8e\u6574\u6570\u8ba1\u7b97\u3002</p> <pre><code>template&lt;class T&gt; Frac&lt;T&gt; slopeEx(Pt p1, Pt p2) {\n    Frac&lt;T&gt; U = p1.y - p2.y;\n    Frac&lt;T&gt; V = p1.x - p2.x;\n    return U / V; // \u8c03\u7528\u5206\u6570\u7cbe\u786e\u8ba1\u7b97\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#573","title":"5.7.3 \u4e24\u70b9\u5f0f\u8f6c\u4e00\u822c\u5f0f","text":"<p>\u8fd4\u56de\u7531\u4e09\u4e2a\u6574\u6570\u6784\u6210\u7684\u65b9\u7a0b\uff0c\u5728\u8f93\u5165\u8f83\u5927\u65f6\u53ef\u80fd\u627e\u4e0d\u5230\u8f83\u5c0f\u7684\u6ee1\u8db3\u9898\u610f\u7684\u4e00\u7ec4\u6574\u6570\u89e3\u3002\u53ef\u4ee5\u5904\u7406\u5e73\u884c\u4e8e \\(x,y\\) \u8f74\u3001\u4e24\u70b9\u5171\u70b9\u7684\u60c5\u51b5\u3002</p> <pre><code>template&lt;class T&gt; tuple&lt;T, T, T&gt; getfun(Lt p) {\n    T A = p.a.y - p.b.y, B = p.b.x - p.a.x, C = p.a.x * A + p.a.y * B;\n    if (A &lt; 0) { // \u7b26\u53f7\u8c03\u6574\n        A = -A, B = -B, C = -C;\n    } else if (A == 0) {\n        if (B &lt; 0) {\n            B = -B, C = -C;\n        } else if (B == 0 &amp;&amp; C &lt; 0) {\n            C = -C;\n        }\n    }\n    if (A == 0) { // \u6570\u503c\u8ba1\u7b97\n        if (B == 0) {\n            C = 0; // \u5171\u70b9\u7279\u5224\n        } else {\n            T g = fgcd(abs(B), abs(C));\n            B /= g, C /= g;\n        }\n    } else if (B == 0) {\n        T g = fgcd(abs(A), abs(C));\n        A /= g, C /= g;\n    } else {\n        T g = fgcd(fgcd(abs(A), abs(B)), abs(C));\n        A /= g, B /= g, C /= g;\n    }\n    return tuple{A, B, C}; // Ax + By = C\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#574","title":"5.7.4 \u4e00\u822c\u5f0f\u8f6c\u4e24\u70b9\u5f0f","text":"<p>\u7531\u4e8e\u6574\u6570\u70b9\u53ef\u80fd\u5f88\u5927\u6216\u8005\u4e0d\u5b58\u5728\uff0c\u6545\u76f4\u63a5\u91c7\u7528\u6d6e\u70b9\u6570\uff1b\u5982\u679c\u4e0e \\(x,y\\) \u8f74\u6709\u4ea4\u70b9\u5219\u53d6\u4ea4\u70b9\u3002\u53ef\u4ee5\u5904\u7406\u5e73\u884c\u4e8e \\(x,y\\) \u8f74\u7684\u60c5\u51b5\u3002</p> <pre><code>Line&lt;ld&gt; getfun(int A, int B, int C) { // Ax + By = C\n    ld x1 = 0, y1 = 0, x2 = 0, y2 = 0;\n    if (A &amp;&amp; B) { // \u6b63\u5e38\n        if (C) {\n            x1 = 0, y1 = 1. * C / B;\n            y2 = 0, x2 = 1. * C / A;\n        } else { // \u8fc7\u539f\u70b9\n            x1 = 1, y1 = 1. * -A / B;\n            x2 = 0, y2 = 0;\n        }\n    } else if (A &amp;&amp; !B) { // \u5782\u76f4\n        if (C) {\n            y1 = 0, x1 = 1. * C / A;\n            y2 = 1, x2 = x1;\n        } else {\n            x1 = 0, y1 = 1;\n            x2 = 0, y2 = 0;\n        }\n    } else if (!A &amp;&amp; B) { // \u6c34\u5e73\n        if (C) {\n            x1 = 0, y1 = 1. * C / B;\n            x2 = 1, y2 = y1;\n        } else {\n            x1 = 1, y1 = 0;\n            x2 = 0, y2 = 0;\n        }\n    } else { // \u4e0d\u5408\u6cd5\uff0c\u8bf7\u7279\u5224\n        assert(false);\n    }\n    return {{x1, y1}, {x2, y2}};\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#575-x","title":"5.7.5 \u629b\u7269\u7ebf\u4e0e x \u8f74\u662f\u5426\u76f8\u4ea4\u53ca\u4ea4\u70b9","text":"<p>\\(0\\) \u4ee3\u8868\u6ca1\u6709\u4ea4\u70b9\uff1b\\(1\\) \u4ee3\u8868\u76f8\u5207\uff1b\\(2\\) \u4ee3\u8868\u6709\u4e24\u4e2a\u4ea4\u70b9\u3002</p> <pre><code>tuple&lt;int, ld, ld&gt; getAns(ld a, ld b, ld c) {\n    ld delta = b * b - a * c * 4;\n    if (delta &lt; 0.) {\n        return {0, 0, 0};\n    }\n    delta = sqrt(delta);\n    ld ans1 = -(delta + b) / 2 / a;\n    ld ans2 = (delta - b) / 2 / a;\n    if (ans1 &gt; ans2) {\n        swap(ans1, ans2);\n    }\n    if (sign(delta) == 0) {\n        return {1, ans2, 0};\n    }\n    return {2, ans1, ans2};\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#58","title":"5.8 \u5e73\u9762\u591a\u8fb9\u5f62","text":""},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#581","title":"5.8.1 \u4e24\u5411\u91cf\u6784\u6210\u7684\u5e73\u9762\u56db\u8fb9\u5f62\u6709\u5411\u9762\u79ef","text":"<pre><code>template&lt;class T&gt; T areaEx(Point&lt;T&gt; p1, Point&lt;T&gt; p2, Point&lt;T&gt; p3) {\n    return cross(b, c, a);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#582","title":"5.8.2 \u5224\u65ad\u56db\u4e2a\u70b9\u80fd\u5426\u7ec4\u6210\u77e9\u5f62/\u6b63\u65b9\u5f62","text":"<p>\u53ef\u4ee5\u5904\u7406\u6d6e\u70b9\u6570\u3001\u5171\u70b9\u7684\u60c5\u51b5\u3002\u8fd4\u56de\u5206\u4e3a\u4e09\u79cd\u60c5\u51b5\uff1a\\(2\\) \u4ee3\u8868\u6784\u6210\u6b63\u65b9\u5f62\uff1b\\(1\\) \u4ee3\u8868\u6784\u6210\u77e9\u5f62\uff1b\\(0\\) \u4ee3\u8868\u5176\u4ed6\u60c5\u51b5\u3002</p> <pre><code>template&lt;class T&gt; int isSquare(vector&lt;Pt&gt; x) {\n    sort(x.begin(), x.end());\n    if (equal(dis(x[0], x[1]), dis(x[2], x[3])) &amp;&amp; sign(dis(x[0], x[1])) &amp;&amp;\n        equal(dis(x[0], x[2]), dis(x[1], x[3])) &amp;&amp; sign(dis(x[0], x[2])) &amp;&amp;\n        lineParallel(Lt{x[0], x[1]}, Lt{x[2], x[3]}) &amp;&amp;\n        lineParallel(Lt{x[0], x[2]}, Lt{x[1], x[3]}) &amp;&amp;\n        lineVertical(Lt{x[0], x[1]}, Lt{x[0], x[2]})) {\n        return equal(dis(x[0], x[1]), dis(x[0], x[2])) ? 2 : 1;\n    }\n    return 0;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#583","title":"5.8.3 \u70b9\u662f\u5426\u5728\u4efb\u610f\u591a\u8fb9\u5f62\u5185","text":"<p>\u5c04\u7ebf\u6cd5\u5224\u5b9a\uff0c\\(t\\) \u4e3a\u7a7f\u8d8a\u6b21\u6570\uff0c\u5f53\u5176\u4e3a\u5947\u6570\u65f6\u5373\u4ee3\u8868\u70b9\u5728\u591a\u8fb9\u5f62\u5185\u90e8\uff1b\u8fd4\u56de \\(2\\) \u4ee3\u8868\u70b9\u5728\u591a\u8fb9\u5f62\u8fb9\u754c\u4e0a\u3002</p> <pre><code>template&lt;class T&gt; int pointInPolygon(Point&lt;T&gt; a, vector&lt;Point&lt;T&gt;&gt; p) {\n    int n = p.size();\n    for (int i = 0; i &lt; n; i++) {\n        if (pointOnSegment(a, Line{p[i], p[(i + 1) % n]})) {\n            return 2;\n        }\n    }\n    int t = 0;\n    for (int i = 0; i &lt; n; i++) {\n        auto u = p[i], v = p[(i + 1) % n];\n        if (u.x &lt; a.x &amp;&amp; v.x &gt;= a.x &amp;&amp; pointOnLineLeft(a, Line{v, u})) {\n            t ^= 1;\n        }\n        if (u.x &gt;= a.x &amp;&amp; v.x &lt; a.x &amp;&amp; pointOnLineLeft(a, Line{u, v})) {\n            t ^= 1;\n        }\n    }\n    return t == 1;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#584","title":"5.8.4 \u7ebf\u6bb5\u662f\u5426\u5728\u4efb\u610f\u591a\u8fb9\u5f62\u5185\u90e8","text":"<pre><code>template&lt;class T&gt;\nbool segmentInPolygon(Line&lt;T&gt; l, vector&lt;Point&lt;T&gt;&gt; p) {\n// \u7ebf\u6bb5\u4e0e\u591a\u8fb9\u5f62\u8fb9\u754c\u4e0d\u76f8\u4ea4\u4e14\u4e24\u7aef\u70b9\u90fd\u5728\u591a\u8fb9\u5f62\u5185\u90e8\n#define L(x, y) pointOnLineLeft(x, y)\n    int n = p.size();\n    if (!pointInPolygon(l.a, p)) return false;\n    if (!pointInPolygon(l.b, p)) return false;\n    for (int i = 0; i &lt; n; i++) {\n        auto u = p[i];\n        auto v = p[(i + 1) % n];\n        auto w = p[(i + 2) % n];\n        auto [t, p1, p2] = segmentIntersection(l, Line(u, v));\n        if (t == 1) return false;\n        if (t == 0) continue;\n        if (t == 2) {\n            if (pointOnSegment(v, l) &amp;&amp; v != l.a &amp;&amp; v != l.b) {\n                if (cross(v - u, w - v) &gt; 0) {\n                    return false;\n                }\n            }\n        } else {\n            if (p1 != u &amp;&amp; p1 != v) {\n                if (L(l.a, Line(v, u)) || L(l.b, Line(v, u))) {\n                    return false;\n                }\n            } else if (p1 == v) {\n                if (l.a == v) {\n                    if (L(u, l)) {\n                        if (L(w, l) &amp;&amp; L(w, Line(u, v))) {\n                            return false;\n                        }\n                    } else {\n                        if (L(w, l) || L(w, Line(u, v))) {\n                            return false;\n                        }\n                    }\n                } else if (l.b == v) {\n                    if (L(u, Line(l.b, l.a))) {\n                        if (L(w, Line(l.b, l.a)) &amp;&amp; L(w, Line(u, v))) {\n                            return false;\n                        }\n                    } else {\n                        if (L(w, Line(l.b, l.a)) || L(w, Line(u, v))) {\n                            return false;\n                        }\n                    }\n                } else {\n                    if (L(u, l)) {\n                        if (L(w, Line(l.b, l.a)) || L(w, Line(u, v))) {\n                            return false;\n                        }\n                    } else {\n                        if (L(w, l) || L(w, Line(u, v))) {\n                            return false;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    return true;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#585","title":"5.8.5 \u4efb\u610f\u591a\u8fb9\u5f62\u7684\u9762\u79ef","text":"<pre><code>template&lt;class T&gt; ld area(vector&lt;Point&lt;T&gt;&gt; P) {\n    int n = P.size();\n    ld ans = 0;\n    for (int i = 0; i &lt; n; i++) {\n        ans += cross(P[i], P[(i + 1) % n]);\n    }\n    return ans / 2.0;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#586","title":"5.8.6 \u76ae\u514b\u5b9a\u7406","text":"<p>\u7ed8\u5236\u5728\u65b9\u683c\u7eb8\u4e0a\u7684\u591a\u8fb9\u5f62\u9762\u79ef\u516c\u5f0f\u53ef\u4ee5\u8868\u793a\u4e3a \\(S=n+\\dfrac{s}{2}-1\\) \uff0c\u5176\u4e2d \\(n\\) \u8868\u793a\u591a\u8fb9\u5f62\u5185\u90e8\u7684\u70b9\u6570\u3001\\(s\\) \u8868\u793a\u591a\u8fb9\u5f62\u8fb9\u754c\u4e0a\u7684\u70b9\u6570\u3002\u4e00\u6761\u7ebf\u6bb5\u4e0a\u7684\u70b9\u6570\u4e3a \\(\\gcd(|x_1-x_2|,|y_1-y_2|)+1\\)\u3002</p>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#587","title":"5.8.7 \u4efb\u610f\u591a\u8fb9\u5f62\u4e0a/\u5185\u7684\u7f51\u683c\u70b9\u4e2a\u6570\uff08\u4ec5\u80fd\u5904\u7406\u6574\u6570\uff09","text":"<p>\u76ae\u514b\u5b9a\u7406\u7528\u3002</p> <pre><code>int onPolygonGrid(vector&lt;Point&lt;int&gt;&gt; p) { // \u591a\u8fb9\u5f62\u4e0a\n    int n = p.size(), ans = 0;\n    for (int i = 0; i &lt; n; i++) {\n        auto a = p[i], b = p[(i + 1) % n];\n        ans += gcd(abs(a.x - b.x), abs(a.y - b.y));\n    }\n    return ans;\n}\nint inPolygonGrid(vector&lt;Point&lt;int&gt;&gt; p) { // \u591a\u8fb9\u5f62\u5185\n    int n = p.size(), ans = 0;\n    for (int i = 0; i &lt; n; i++) {\n        auto a = p[i], b = p[(i + 1) % n], c = p[(i + 2) % n];\n        ans += b.y * (a.x - c.x);\n    }\n    ans = abs(ans);\n    return (ans - onPolygonGrid(p)) / 2 + 1;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#59","title":"5.9 \u4e8c\u7ef4\u51f8\u5305","text":""},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#591-andrew","title":"5.9.1 \u83b7\u53d6\u4e8c\u7ef4\u9759\u6001\u51f8\u5305\uff08Andrew\u7b97\u6cd5\uff09","text":"<p><code>flag</code> \u7528\u4e8e\u5224\u5b9a\u51f8\u5305\u8fb9\u4e0a\u7684\u70b9\u3001\u91cd\u590d\u7684\u9876\u70b9\u662f\u5426\u8981\u52a0\u5165\u5230\u51f8\u5305\u4e2d\uff0c\u4e3a \\(0\\) \u65f6\u4ee3\u8868\u52a0\u5165\u51f8\u5305\uff08\u4e0d\u4e25\u683c\uff09\uff1b\u4e3a \\(1\\) \u65f6\u4e0d\u52a0\u5165\u51f8\u5305\uff08\u4e25\u683c\uff09\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(\\mathcal O(N\\log N)\\) \u3002</p> <pre><code>template&lt;class T&gt; vector&lt;Point&lt;T&gt;&gt; staticConvexHull(vector&lt;Point&lt;T&gt;&gt; A, int flag = 1) {\n    int n = A.size();\n    if (n &lt;= 2) { // \u7279\u5224\n        return A;\n    }\n    vector&lt;Point&lt;T&gt;&gt; ans(n * 2);\n    sort(A.begin(), A.end());\n    int now = -1;\n    for (int i = 0; i &lt; n; i++) { // \u7ef4\u62a4\u4e0b\u51f8\u5305\n        while (now &gt; 0 &amp;&amp; cross(A[i], ans[now], ans[now - 1]) &lt;= 0) {\n            now--;\n        }\n        ans[++now] = A[i];\n    }\n    int pre = now;\n    for (int i = n - 2; i &gt;= 0; i--) { // \u7ef4\u62a4\u4e0a\u51f8\u5305\n        while (now &gt; pre &amp;&amp; cross(A[i], ans[now], ans[now - 1]) &lt;= 0) {\n            now--;\n        }\n        ans[++now] = A[i];\n    }\n    ans.resize(now);\n    return ans;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#592","title":"5.9.2 \u4e8c\u7ef4\u52a8\u6001\u51f8\u5305","text":"<p>\u56fa\u5b9a\u4e3a <code>int</code> \u578b\uff0c\u9700\u8981\u91cd\u65b0\u4e66\u5199 <code>Line</code> \u51fd\u6570\uff0c<code>cmp</code> \u7528\u4e8e\u5224\u5b9a\u8fb9\u754c\u60c5\u51b5\u3002\u53ef\u4ee5\u5904\u7406\u5982\u4e0b\u4e24\u4e2a\u8981\u6c42\uff1a</p> <ul> <li>\u52a8\u6001\u63d2\u5165\u70b9 \\((x,y)\\) \u5230\u5f53\u524d\u51f8\u5305\u4e2d\uff1b</li> <li>\u5224\u65ad\u70b9 \\((x,y)\\) \u662f\u5426\u5728\u51f8\u5305\u4e0a\u6216\u662f\u5728\u5185\u90e8\uff08\u5305\u62ec\u8fb9\u754c\uff09\u3002</li> </ul> <pre><code>template&lt;class T&gt; bool turnRight(Pt a, Pt b) {\n    return cross(a, b) &lt; 0 || (cross(a, b) == 0 &amp;&amp; dot(a, b) &lt; 0);\n}\nstruct Line {\n    static int cmp;\n    mutable Point&lt;int&gt; a, b;\n    friend bool operator&lt;(Line x, Line y) {\n        return cmp ? x.a &lt; y.a : turnRight(x.b, y.b);\n    }\n    friend auto &amp;operator&lt;&lt;(ostream &amp;os, Line l) {\n        return os &lt;&lt; \"&lt;\" &lt;&lt; l.a &lt;&lt; \", \" &lt;&lt; l.b &lt;&lt; \"&gt;\";\n    }\n};\n\nint Line::cmp = 1;\nstruct UpperConvexHull : set&lt;Line&gt; {\n    bool contains(const Point&lt;int&gt; &amp;p) const {\n        auto it = lower_bound({p, 0});\n        if (it != end() &amp;&amp; it-&gt;a == p) return true;\n        if (it != begin() &amp;&amp; it != end() &amp;&amp; cross(prev(it)-&gt;b, p - prev(it)-&gt;a) &lt;= 0) {\n            return true;\n        }\n        return false;\n    }\n    void add(const Point&lt;int&gt; &amp;p) {\n        if (contains(p)) return;\n        auto it = lower_bound({p, 0});\n        for (; it != end(); it = erase(it)) {\n            if (turnRight(it-&gt;a - p, it-&gt;b)) {\n                break;\n            }\n        }\n        for (; it != begin() &amp;&amp; prev(it) != begin(); erase(prev(it))) {\n            if (turnRight(prev(prev(it))-&gt;b, p - prev(prev(it))-&gt;a)) {\n                break;\n            }\n        }\n        if (it != begin()) {\n            prev(it)-&gt;b = p - prev(it)-&gt;a;\n        }\n        if (it == end()) {\n            insert({p, {0, -1}});\n        } else {\n            insert({p, it-&gt;a - p});\n        }\n    }\n};\nstruct ConvexHull {\n    UpperConvexHull up, low;\n    bool empty() const {\n        return up.empty();\n    }\n    bool contains(const Point&lt;int&gt; &amp;p) const {\n        Line::cmp = 1;\n        return up.contains(p) &amp;&amp; low.contains(-p);\n    }\n    void add(const Point&lt;int&gt; &amp;p) {\n        Line::cmp = 1;\n        up.add(p);\n        low.add(-p);\n    }\n    bool isIntersect(int A, int B, int C) const {\n        Line::cmp = 0;\n        if (empty()) return false;\n        Point&lt;int&gt; k = {-B, A};\n        if (k.x &lt; 0) k = -k;\n        if (k.x == 0 &amp;&amp; k.y &lt; 0) k.y = -k.y;\n        Point&lt;int&gt; P = up.upper_bound({{0, 0}, k})-&gt;a;\n        Point&lt;int&gt; Q = -low.upper_bound({{0, 0}, k})-&gt;a;\n        return sign(A * P.x + B * P.y - C) * sign(A * Q.x + B * Q.y - C) &gt; 0;\n    }\n    friend ostream &amp;operator&lt;&lt;(ostream &amp;out, const ConvexHull &amp;ch) {\n        for (const auto &amp;line : ch.up) out &lt;&lt; \"(\" &lt;&lt; line.a.x &lt;&lt; \",\" &lt;&lt; line.a.y &lt;&lt; \")\";\n        cout &lt;&lt; \"/\";\n        for (const auto &amp;line : ch.low) out &lt;&lt; \"(\" &lt;&lt; -line.a.x &lt;&lt; \",\" &lt;&lt; -line.a.y &lt;&lt; \")\";\n        return out;\n    }\n};\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#593","title":"5.9.3 \u70b9\u4e0e\u51f8\u5305\u7684\u4f4d\u7f6e\u5173\u7cfb","text":"<p>\\(0\\) \u4ee3\u8868\u70b9\u5728\u51f8\u5305\u5916\u9762\uff1b\\(1\\) \u4ee3\u8868\u5728\u51f8\u58f3\u4e0a\uff1b\\(2\\) \u4ee3\u8868\u5728\u51f8\u5305\u5185\u90e8\u3002</p> <pre><code>template&lt;class T&gt; int contains(Point&lt;T&gt; p, vector&lt;Point&lt;T&gt;&gt; A) {\n    int n = A.size();\n    bool in = false;\n    for (int i = 0; i &lt; n; i++) {\n        Point&lt;T&gt; a = A[i] - p, b = A[(i + 1) % n] - p;\n        if (a.y &gt; b.y) {\n            swap(a, b);\n        }\n        if (a.y &lt;= 0 &amp;&amp; 0 &lt; b.y &amp;&amp; cross(a, b) &lt; 0) {\n            in = !in;\n        }\n        if (cross(a, b) == 0 &amp;&amp; dot(a, b) &lt;= 0) {\n            return 1;\n        }\n    }\n    return in ? 2 : 0;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#594","title":"5.9.4 \u95f5\u53ef\u592b\u65af\u57fa\u548c","text":"<p>\u8ba1\u7b97\u4e24\u4e2a\u51f8\u5305\u5408\u6210\u7684\u5927\u51f8\u5305\u3002</p> <pre><code>template&lt;class T&gt; vector&lt;Point&lt;T&gt;&gt; mincowski(vector&lt;Point&lt;T&gt;&gt; P1, vector&lt;Point&lt;T&gt;&gt; P2) {\n    int n = P1.size(), m = P2.size();\n    vector&lt;Point&lt;T&gt;&gt; V1(n), V2(m);\n    for (int i = 0; i &lt; n; i++) {\n        V1[i] = P1[(i + 1) % n] - P1[i];\n    }\n    for (int i = 0; i &lt; m; i++) {\n        V2[i] = P2[(i + 1) % m] - P2[i];\n    }\n    vector&lt;Point&lt;T&gt;&gt; ans = {P1.front() + P2.front()};\n    int t = 0, i = 0, j = 0;\n    while (i &lt; n &amp;&amp; j &lt; m) {\n        Point&lt;T&gt; val = sign(cross(V1[i], V2[j])) &gt; 0 ? V1[i++] : V2[j++];\n        ans.push_back(ans.back() + val);\n    }\n    while (i &lt; n) ans.push_back(ans.back() + V1[i++]);\n    while (j &lt; m) ans.push_back(ans.back() + V2[j++]);\n    return ans;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#595","title":"5.9.5 \u534a\u5e73\u9762\u4ea4","text":"<p>\u8ba1\u7b97\u591a\u6761\u76f4\u7ebf\u5de6\u8fb9\u5e73\u9762\u90e8\u5206\u7684\u4ea4\u96c6\u3002</p> <pre><code>template&lt;class T&gt; vector&lt;Point&lt;T&gt;&gt; halfcut(vector&lt;Line&lt;T&gt;&gt; lines) {\n    sort(lines.begin(), lines.end(), [&amp;](auto l1, auto l2) {\n        auto d1 = l1.b - l1.a;\n        auto d2 = l2.b - l2.a;\n        if (sign(d1) != sign(d2)) {\n            return sign(d1) == 1;\n        }\n        return cross(d1, d2) &gt; 0;\n    });\n    deque&lt;Line&lt;T&gt;&gt; ls;\n    deque&lt;Point&lt;T&gt;&gt; ps;\n    for (auto l : lines) {\n        if (ls.empty()) {\n            ls.push_back(l);\n            continue;\n        }\n        while (!ps.empty() &amp;&amp; !pointOnLineLeft(ps.back(), l)) {\n            ps.pop_back();\n            ls.pop_back();\n        }\n        while (!ps.empty() &amp;&amp; !pointOnLineLeft(ps[0], l)) {\n            ps.pop_front();\n            ls.pop_front();\n        }\n        if (cross(l.b - l.a, ls.back().b - ls.back().a) == 0) {\n            if (dot(l.b - l.a, ls.back().b - ls.back().a) &gt; 0) {\n                if (!pointOnLineLeft(ls.back().a, l)) {\n                    assert(ls.size() == 1);\n                    ls[0] = l;\n                }\n                continue;\n            }\n            return {};\n        }\n        ps.push_back(lineIntersection(ls.back(), l));\n        ls.push_back(l);\n    }\n    while (!ps.empty() &amp;&amp; !pointOnLineLeft(ps.back(), ls[0])) {\n        ps.pop_back();\n        ls.pop_back();\n    }\n    if (ls.size() &lt;= 2) {\n        return {};\n    }\n    ps.push_back(lineIntersection(ls[0], ls.back()));\n    return vector(ps.begin(), ps.end());\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#510","title":"5.10 \u4e09\u7ef4\u51e0\u4f55\u5fc5\u8981\u521d\u59cb\u5316","text":""},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5101","title":"5.10.1 \u70b9\u7ebf\u9762\u5c01\u88c5","text":"<pre><code>struct Point3 {\n    ld x, y, z;\n    Point3(ld x_ = 0, ld y_ = 0, ld z_ = 0) : x(x_), y(y_), z(z_) {}\n    Point3 &amp;operator+=(Point3 p) &amp; {\n        return x += p.x, y += p.y, z += p.z, *this;\n    }\n    Point3 &amp;operator-=(Point3 p) &amp; {\n        return x -= p.x, y -= p.y, z -= p.z, *this;\n    }\n    Point3 &amp;operator*=(Point3 p) &amp; {\n        return x *= p.x, y *= p.y, z *= p.z, *this;\n    }\n    Point3 &amp;operator*=(ld t) &amp; {\n        return x *= t, y *= t, z *= t, *this;\n    }\n    Point3 &amp;operator/=(ld t) &amp; {\n        return x /= t, y /= t, z /= t, *this;\n    }\n    friend Point3 operator+(Point3 a, Point3 b) { return a += b; }\n    friend Point3 operator-(Point3 a, Point3 b) { return a -= b; }\n    friend Point3 operator*(Point3 a, Point3 b) { return a *= b; }\n    friend Point3 operator*(Point3 a, ld b) { return a *= b; }\n    friend Point3 operator*(ld a, Point3 b) { return b *= a; }\n    friend Point3 operator/(Point3 a, ld b) { return a /= b; }\n    friend auto &amp;operator&gt;&gt;(istream &amp;is, Point3 &amp;p) {\n        return is &gt;&gt; p.x &gt;&gt; p.y &gt;&gt; p.z;\n    }\n    friend auto &amp;operator&lt;&lt;(ostream &amp;os, Point3 p) {\n        return os &lt;&lt; \"(\" &lt;&lt; p.x &lt;&lt; \", \" &lt;&lt; p.y &lt;&lt; \", \" &lt;&lt; p.z &lt;&lt; \")\";\n    }\n};\nstruct Line3 {\n    Point3 a, b;\n};\nstruct Plane {\n    Point3 u, v, w;\n};\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5102","title":"5.10.2 \u5176\u4ed6\u51fd\u6570","text":"<pre><code>ld len(P3 p) { // \u539f\u70b9\u5230\u5f53\u524d\u70b9\u7684\u8ddd\u79bb\u8ba1\u7b97\n    return sqrt(p.x * p.x + p.y * p.y + p.z * p.z);\n}\nP3 crossEx(P3 a, P3 b) { // \u53c9\u4e58\n    P3 ans;\n    ans.x = a.y * b.z - a.z * b.y;\n    ans.y = a.z * b.x - a.x * b.z;\n    ans.z = a.x * b.y - a.y * b.x;\n    return ans;\n}\nld cross(P3 a, P3 b) {\n    return len(crossEx(a, b));\n}\nld dot(P3 a, P3 b) { // \u70b9\u4e58\n    return a.x * b.x + a.y * b.y + a.z * b.z;\n}\nP3 getVec(Plane s) { // \u83b7\u53d6\u5e73\u9762\u6cd5\u5411\u91cf\n    return crossEx(s.u - s.v, s.v - s.w);\n}\nld dis(P3 a, P3 b) { // \u4e09\u7ef4\u6b27\u51e0\u91cc\u5f97\u8ddd\u79bb\u516c\u5f0f\n    ld val = (a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y) + (a.z - b.z) * (a.z - b.z);\n    return sqrt(val);\n}\nP3 standardize(P3 vec) { // \u5c06\u4e09\u7ef4\u5411\u91cf\u8f6c\u6362\u4e3a\u5355\u4f4d\u5411\u91cf\n    return vec / len(vec);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#511","title":"5.11 \u4e09\u7ef4\u70b9\u7ebf\u9762\u76f8\u5173","text":""},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5111","title":"5.11.1 \u7a7a\u95f4\u4e09\u70b9\u662f\u5426\u5171\u7ebf","text":"<p>\u5176\u4e2d\u7b2c\u4e8c\u4e2a\u51fd\u6570\u662f\u4e13\u95e8\u7528\u6765\u5224\u65ad\u7ed9\u5b9a\u7684\u4e09\u4e2a\u70b9\u80fd\u5426\u6784\u6210\u5e73\u9762\u7684\uff0c\u56e0\u4e3a\u4e0d\u5171\u7ebf\u7684\u4e09\u70b9\u624d\u80fd\u6784\u6210\u5e73\u9762\u3002</p> <pre><code>bool onLine(P3 p1, P3 p2, P3 p3) { // \u4e09\u70b9\u662f\u5426\u5171\u7ebf\n    return sign(cross(p1 - p2, p3 - p2)) == 0;\n}\nbool onLine(Plane s) {\n    return onLine(s.u, s.v, s.w);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5112","title":"5.11.2 \u56db\u70b9\u662f\u5426\u5171\u9762","text":"<pre><code>bool onPlane(P3 p1, P3 p2, P3 p3, P3 p4) { // \u56db\u70b9\u662f\u5426\u5171\u9762\n    ld val = dot(getVec({p1, p2, p3}), p4 - p1);\n    return sign(val) == 0;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5113","title":"5.11.3 \u7a7a\u95f4\u70b9\u662f\u5426\u5728\u7ebf\u6bb5\u4e0a","text":"<pre><code>bool pointOnSegment(P3 p, L3 l) {\n    return sign(cross(p - l.a, p - l.b)) == 0 &amp;&amp; min(l.a.x, l.b.x) &lt;= p.x &amp;&amp;\n           p.x &lt;= max(l.a.x, l.b.x) &amp;&amp; min(l.a.y, l.b.y) &lt;= p.y &amp;&amp; p.y &lt;= max(l.a.y, l.b.y) &amp;&amp;\n           min(l.a.z, l.b.z) &lt;= p.z &amp;&amp; p.z &lt;= max(l.a.z, l.b.z);\n}\nbool pointOnSegmentEx(P3 p, L3 l) { // pointOnSegment\u53bb\u9664\u7aef\u70b9\u7248\n    return sign(cross(p - l.a, p - l.b)) == 0 &amp;&amp; min(l.a.x, l.b.x) &lt; p.x &amp;&amp;\n           p.x &lt; max(l.a.x, l.b.x) &amp;&amp; min(l.a.y, l.b.y) &lt; p.y &amp;&amp; p.y &lt; max(l.a.y, l.b.y) &amp;&amp;\n           min(l.a.z, l.b.z) &lt; p.z &amp;&amp; p.z &lt; max(l.a.z, l.b.z);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5114","title":"5.11.4 \u7a7a\u95f4\u4e24\u70b9\u662f\u5426\u5728\u7ebf\u6bb5\u540c\u4fa7","text":"<p>\u5f53\u7ed9\u5b9a\u7684\u4e24\u70b9\u4e0e\u7ebf\u6bb5\u4e0d\u5171\u9762\u3001\u70b9\u5728\u7ebf\u6bb5\u4e0a\u65f6\u8fd4\u56de \\(false\\) \u3002</p> <pre><code>bool pointOnSegmentSide(P3 p1, P3 p2, L3 l) {\n    if (!onPlane(p1, p2, l.a, l.b)) { // \u7279\u5224\u4e0d\u5171\u9762\n        return 0;\n    }\n    ld val = dot(crossEx(l.a - l.b, p1 - l.b), crossEx(l.a - l.b, p2 - l.b));\n    return sign(val) == 1;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5115","title":"5.11.5 \u4e24\u70b9\u662f\u5426\u5728\u5e73\u9762\u540c\u4fa7","text":"<p>\u70b9\u5728\u5e73\u9762\u4e0a\u65f6\u8fd4\u56de \\(false\\) \u3002</p> <pre><code>bool pointOnPlaneSide(P3 p1, P3 p2, Plane s) {\n    ld val = dot(getVec(s), p1 - s.u) * dot(getVec(s), p2 - s.u);\n    return sign(val) == 1;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5116","title":"5.11.6 \u7a7a\u95f4\u4e24\u76f4\u7ebf\u662f\u5426\u5e73\u884c/\u5782\u76f4","text":"<pre><code>bool lineParallel(L3 l1, L3 l2) {\n    return sign(cross(l1.a - l1.b, l2.a - l2.b)) == 0;\n}\nbool lineVertical(L3 l1, L3 l2) {\n    return sign(dot(l1.a - l1.b, l2.a - l2.b)) == 0;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5117","title":"5.11.7 \u4e24\u5e73\u9762\u662f\u5426\u5e73\u884c/\u5782\u76f4","text":"<pre><code>bool planeParallel(Plane s1, Plane s2) {\n    ld val = cross(getVec(s1), getVec(s2));\n    return sign(val) == 0;\n}\nbool planeVertical(Plane s1, Plane s2) {\n    ld val = dot(getVec(s1), getVec(s2));\n    return sign(val) == 0;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5118","title":"5.11.8 \u7a7a\u95f4\u4e24\u76f4\u7ebf\u662f\u5426\u662f\u540c\u4e00\u6761","text":"<pre><code>bool same(L3 l1, L3 l2) {\n    return lineParallel(l1, l2) &amp;&amp; lineParallel({l1.a, l2.b}, {l1.b, l2.a});\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5119","title":"5.11.9 \u4e24\u5e73\u9762\u662f\u5426\u662f\u540c\u4e00\u4e2a","text":"<pre><code>bool same(Plane s1, Plane s2) {\n    return onPlane(s1.u, s2.u, s2.v, s2.w) &amp;&amp; onPlane(s1.v, s2.u, s2.v, s2.w) &amp;&amp;\n           onPlane(s1.w, s2.u, s2.v, s2.w);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#51110","title":"5.11.10 \u76f4\u7ebf\u662f\u5426\u4e0e\u5e73\u9762\u5e73\u884c","text":"<pre><code>bool linePlaneParallel(L3 l, Plane s) {\n    ld val = dot(l.a - l.b, getVec(s));\n    return sign(val) == 0;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#51111","title":"5.11.11 \u7a7a\u95f4\u4e24\u7ebf\u6bb5\u662f\u5426\u76f8\u4ea4","text":"<pre><code>bool segmentIntersection(L3 l1, L3 l2) { // \u91cd\u53e0\u3001\u76f8\u4ea4\u4e8e\u7aef\u70b9\u5747\u89c6\u4e3a\u76f8\u4ea4\n    if (!onPlane(l1.a, l1.b, l2.a, l2.b)) { // \u7279\u5224\u4e0d\u5171\u9762\n        return 0;\n    }\n    if (!onLine(l1.a, l1.b, l2.a) || !onLine(l1.a, l1.b, l2.b)) {\n        return !pointOnSegmentSide(l1.a, l1.b, l2) &amp;&amp; !pointOnSegmentSide(l2.a, l2.b, l1);\n    }\n    return pointOnSegment(l1.a, l2) || pointOnSegment(l1.b, l2) || pointOnSegment(l2.a, l1) ||\n           pointOnSegment(l2.b, l2);\n}\nbool segmentIntersection1(L3 l1, L3 l2) { // \u91cd\u53e0\u3001\u76f8\u4ea4\u4e8e\u7aef\u70b9\u4e0d\u89c6\u4e3a\u76f8\u4ea4\n    return onPlane(l1.a, l1.b, l2.a, l2.b) &amp;&amp; !pointOnSegmentSide(l1.a, l1.b, l2) &amp;&amp;\n           !pointOnSegmentSide(l2.a, l2.b, l1);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#51112","title":"5.11.12 \u7a7a\u95f4\u4e24\u76f4\u7ebf\u662f\u5426\u76f8\u4ea4\u53ca\u4ea4\u70b9","text":"<p>\u5f53\u4e24\u76f4\u7ebf\u4e0d\u5171\u9762\u3001\u4e24\u76f4\u7ebf\u5e73\u884c\u65f6\u8fd4\u56de \\(false\\) \u3002</p> <pre><code>pair&lt;bool, P3&gt; lineIntersection(L3 l1, L3 l2) {\n    if (!onPlane(l1.a, l1.b, l2.a, l2.b) || lineParallel(l1, l2)) {\n        return {0, {}};\n    }\n    auto [s1, e1] = l1;\n    auto [s2, e2] = l2;\n    ld val = 0;\n    if (!onPlane(l1.a, l1.b, {0, 0, 0}, {0, 0, 1})) {\n        val = ((s1.x - s2.x) * (s2.y - e2.y) - (s1.y - s2.y) * (s2.x - e2.x)) /\n              ((s1.x - e1.x) * (s2.y - e2.y) - (s1.y - e1.y) * (s2.x - e2.x));\n    } else if (!onPlane(l1.a, l1.b, {0, 0, 0}, {0, 1, 0})) {\n        val = ((s1.x - s2.x) * (s2.z - e2.z) - (s1.z - s2.z) * (s2.x - e2.x)) /\n              ((s1.x - e1.x) * (s2.z - e2.z) - (s1.z - e1.z) * (s2.x - e2.x));\n    } else {\n        val = ((s1.y - s2.y) * (s2.z - e2.z) - (s1.z - s2.z) * (s2.y - e2.y)) /\n              ((s1.y - e1.y) * (s2.z - e2.z) - (s1.z - e1.z) * (s2.y - e2.y));\n    }\n    return {1, s1 + (e1 - s1) * val};\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#51113","title":"5.11.13 \u76f4\u7ebf\u4e0e\u5e73\u9762\u662f\u5426\u76f8\u4ea4\u53ca\u4ea4\u70b9","text":"<p>\u5f53\u76f4\u7ebf\u4e0e\u5e73\u9762\u5e73\u884c\u3001\u7ed9\u5b9a\u7684\u70b9\u6784\u4e0d\u6210\u5e73\u9762\u65f6\u8fd4\u56de \\(false\\) \u3002</p> <pre><code>pair&lt;bool, P3&gt; linePlaneCross(L3 l, Plane s) {\n    if (linePlaneParallel(l, s)) {\n        return {0, {}};\n    }\n    P3 vec = getVec(s);\n    P3 U = vec * (s.u - l.a), V = vec * (l.b - l.a);\n    ld val = (U.x + U.y + U.z) / (V.x + V.y + V.z);\n    return {1, l.a + (l.b - l.a) * val};\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#51114","title":"5.11.14 \u4e24\u5e73\u9762\u662f\u5426\u76f8\u4ea4\u53ca\u4ea4\u7ebf","text":"<p>\u5f53\u4e24\u5e73\u9762\u5e73\u884c\u3001\u4e24\u5e73\u9762\u4e3a\u540c\u4e00\u4e2a\u65f6\u8fd4\u56de \\(false\\) \u3002</p> <pre><code>pair&lt;bool, L3&gt; planeIntersection(Plane s1, Plane s2) {\n    if (planeParallel(s1, s2) || same(s1, s2)) {\n        return {0, {}};\n    }\n    P3 U = linePlaneParallel({s2.u, s2.v}, s1) ? linePlaneCross({s2.v, s2.w}, s1).second\n                                               : linePlaneCross({s2.u, s2.v}, s1).second;\n    P3 V = linePlaneParallel({s2.w, s2.u}, s1) ? linePlaneCross({s2.v, s2.w}, s1).second\n                                               : linePlaneCross({s2.w, s2.u}, s1).second;\n    return {1, {U, V}};\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#51115","title":"5.11.15 \u70b9\u5230\u76f4\u7ebf\u7684\u6700\u8fd1\u70b9\u4e0e\u6700\u8fd1\u8ddd\u79bb","text":"<pre><code>pair&lt;ld, P3&gt; pointToLine(P3 p, L3 l) {\n    ld val = cross(p - l.a, l.a - l.b) / dis(l.a, l.b); // \u9762\u79ef\u9664\u4ee5\u5e95\u8fb9\u957f\n    ld val1 = dot(p - l.a, l.a - l.b) / dis(l.a, l.b);\n    return {val, l.a + val1 * standardize(l.a - l.b)};\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#51116","title":"5.11.16 \u70b9\u5230\u5e73\u9762\u7684\u6700\u8fd1\u70b9\u4e0e\u6700\u8fd1\u8ddd\u79bb","text":"<pre><code>pair&lt;ld, P3&gt; pointToPlane(P3 p, Plane s) {\n    P3 vec = getVec(s);\n    ld val = dot(vec, p - s.u);\n    val = abs(val) / len(vec); // \u9762\u79ef\u9664\u4ee5\u5e95\u8fb9\u957f\n    return {val, p - val * standardize(vec)};\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#51117","title":"5.11.17 \u7a7a\u95f4\u4e24\u76f4\u7ebf\u7684\u6700\u8fd1\u8ddd\u79bb\u4e0e\u6700\u8fd1\u70b9\u5bf9","text":"<pre><code>tuple&lt;ld, P3, P3&gt; lineToLine(L3 l1, L3 l2) {\n    P3 vec = crossEx(l1.a - l1.b, l2.a - l2.b); // \u8ba1\u7b97\u540c\u65f6\u5782\u76f4\u4e8e\u4e24\u76f4\u7ebf\u7684\u5411\u91cf\n    ld val = abs(dot(l1.a - l2.a, vec)) / len(vec);\n    P3 U = l1.b - l1.a, V = l2.b - l2.a;\n    vec = crossEx(U, V);\n    ld p = dot(vec, vec);\n    ld t1 = dot(crossEx(l2.a - l1.a, V), vec) / p;\n    ld t2 = dot(crossEx(l2.a - l1.a, U), vec) / p;\n    return {val, l1.a + (l1.b - l1.a) * t1, l2.a + (l2.b - l2.a) * t2};\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#512","title":"5.12 \u4e09\u7ef4\u89d2\u5ea6\u4e0e\u5f27\u5ea6","text":""},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5121-cos","title":"5.12.1 \u7a7a\u95f4\u4e24\u76f4\u7ebf\u5939\u89d2\u7684 cos \u503c","text":"<p>\u4efb\u610f\u4f4d\u7f6e\u7684\u7a7a\u95f4\u4e24\u76f4\u7ebf\u3002</p> <pre><code>ld lineCos(L3 l1, L3 l2) {\n    return dot(l1.a - l1.b, l2.a - l2.b) / len(l1.a - l1.b) / len(l2.a - l2.b);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5122-cos","title":"5.12.2 \u7a7a\u95f4\u4e24\u5e73\u9762\u5939\u89d2\u7684 cos \u503c","text":"<pre><code>ld planeCos(Plane s1, Plane s2) {\n    P3 U = getVec(s1), V = getVec(s2);\n    return dot(U, V) / len(U) / len(V);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5123-sin","title":"5.12.3 \u76f4\u7ebf\u4e0e\u5e73\u9762\u5939\u89d2\u7684 sin \u503c","text":"<pre><code>ld linePlaneSin(L3 l, Plane s) {\n    P3 vec = getVec(s);\n    return dot(l.a - l.b, vec) / len(l.a - l.b) / len(vec);\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#513","title":"5.13 \u7a7a\u95f4\u591a\u8fb9\u5f62","text":""},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5131-n","title":"5.13.1 \u6b63N\u68f1\u9525\u4f53\u79ef\u516c\u5f0f","text":"<p>\u68f1\u9525\u901a\u7528\u4f53\u79ef\u516c\u5f0f \\(V=\\dfrac{1}{3}Sh\\) \uff0c\u5f53\u5176\u6070\u597d\u662f\u68f1\u957f\u4e3a \\(l\\) \u7684\u6b63 \\(n\\) \u68f1\u9525\u65f6\uff0c\u6709\u516c\u5f0f \\(\\displaystyle V=\\frac{l^3\\cdot n}{12\\tan \\frac{\\pi}{n}}\\cdot\\sqrt{1-\\frac{1}{4\\cdot \\sin^2\\frac{\\pi}{n}}}\\)\u3002</p> <pre><code>ld V(ld l, int n) { // \u6b63n\u68f1\u9525\u4f53\u79ef\u516c\u5f0f\n    return l * l * l * n / (12 * tan(PI / n)) * sqrt(1 - 1 / (4 * sin(PI / n) * sin(PI / n)));\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5132","title":"5.13.2 \u56db\u9762\u4f53\u4f53\u79ef","text":"<pre><code>ld V(P3 a, P3 b, P3 c, P3 d) {\n    return abs(dot(d - a, crossEx(b - a, c - a))) / 6;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5133","title":"5.13.3 \u70b9\u662f\u5426\u5728\u7a7a\u95f4\u4e09\u89d2\u5f62\u4e0a","text":"<p>\u70b9\u4f4d\u4e8e\u8fb9\u754c\u4e0a\u65f6\u8fd4\u56de \\(false\\) \u3002</p> <pre><code>bool pointOnTriangle(P3 p, P3 p1, P3 p2, P3 p3) {\n    return pointOnSegmentSide(p, p1, {p2, p3}) &amp;&amp; pointOnSegmentSide(p, p2, {p1, p3}) &amp;&amp;\n           pointOnSegmentSide(p, p3, {p1, p2});\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5134","title":"5.13.4 \u7ebf\u6bb5\u662f\u5426\u4e0e\u7a7a\u95f4\u4e09\u89d2\u5f62\u76f8\u4ea4\u53ca\u4ea4\u70b9","text":"<p>\u53ea\u6709\u4ea4\u70b9\u5728\u7a7a\u95f4\u4e09\u89d2\u5f62\u5185\u90e8\u65f6\u624d\u89c6\u4f5c\u76f8\u4ea4\u3002</p> <pre><code>pair&lt;bool, P3&gt; segmentOnTriangle(P3 l, P3 r, P3 p1, P3 p2, P3 p3) {\n    P3 x = crossEx(p2 - p1, p3 - p1);\n    if (sign(dot(x, r - l)) == 0) {\n        return {0, {}};\n    }\n    ld t = dot(x, p1 - l) / dot(x, r - l);\n    if (t &lt; 0 || t - 1 &gt; 0) { // \u4e0d\u5728\u7ebf\u6bb5\u4e0a\n        return {0, {}};\n    }\n    bool type = pointOnTriangle(l + (r - l) * t, p1, p2, p3);\n    if (type) {\n        return {1, l + (r - l) * t};\n    } else {\n        return {0, {}};\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5135","title":"5.13.5 \u7a7a\u95f4\u4e09\u89d2\u5f62\u662f\u5426\u76f8\u4ea4","text":"<p>\u76f8\u4ea4\u7ebf\u6bb5\u5728\u7a7a\u95f4\u4e09\u89d2\u5f62\u5185\u90e8\u65f6\u624d\u89c6\u4f5c\u76f8\u4ea4\u3002</p> <pre><code>bool triangleIntersection(vector&lt;P3&gt; a, vector&lt;P3&gt; b) {\n    for (int i = 0; i &lt; 3; i++) {\n        if (segmentOnTriangle(b[i], b[(i + 1) % 3], a[0], a[1], a[2]).first) {\n            return 1;\n        }\n        if (segmentOnTriangle(a[i], a[(i + 1) % 3], b[0], b[1], b[2]).first) {\n            return 1;\n        }\n    }\n    return 0;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#514","title":"5.14 \u5e38\u7528\u7ed3\u8bba","text":""},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5141","title":"5.14.1 \u5e73\u9762\u51e0\u4f55\u7ed3\u8bba\u5f52\u6863","text":"<ul> <li><code>hypot</code> \u51fd\u6570\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\u76f4\u89d2\u4e09\u89d2\u5f62\u7684\u659c\u8fb9\u957f\uff1b</li> <li>\u8fb9\u5fc3\u8ddd\u662f\u6307\u6b63\u591a\u8fb9\u5f62\u7684\u5916\u63a5\u5706\u5706\u5fc3\u5230\u6b63\u591a\u8fb9\u5f62\u67d0\u4e00\u8fb9\u7684\u8ddd\u79bb\uff0c\u8fb9\u957f\u4e3a \\(s\\) \u7684\u6b63 \\(n\\) \u89d2\u5f62\u7684\u8fb9\u5fc3\u8ddd\u516c\u5f0f\u4e3a \\(\\displaystyle a=\\frac{t}{2\\cdot\\tan \\frac{\\pi}{n}}\\) \uff0c\u5916\u63a5\u5706\u534a\u5f84\u4e3a \\(R\\) \u7684\u6b63 \\(n\\) \u89d2\u5f62\u7684\u8fb9\u5fc3\u8ddd\u516c\u5f0f\u4e3a \\(a=R\\cdot \\cos \\dfrac{\\pi}{n}\\) \uff1b</li> <li>\u4e09\u89d2\u5f62\u5916\u63a5\u5706\u534a\u5f84\u4e3a \\(\\dfrac{a}{2\\sin A}=\\dfrac{abc}{4S}\\) \uff0c\u5176\u4e2d \\(S\\) \u4e3a\u4e09\u89d2\u5f62\u9762\u79ef\uff0c\u5185\u5207\u5706\u534a\u5f84\u4e3a \\(\\dfrac{2S}{a+b+c}\\)\uff1b</li> <li>\u7531\u5c0f\u6b63\u4e09\u89d2\u5f62\u62fc\u6210\u7684\u5927\u6b63\u4e09\u89d2\u5f62\uff0c\u8017\u8d39\u7684\u5c0f\u4e09\u89d2\u5f62\u6570\u91cf\u5373\u4e3a\u6784\u6210\u4e00\u6761\u8fb9\u7684\u5c0f\u4e09\u89d2\u5f62\u6570\u91cf\u7684\u5e73\u65b9\u3002\u5982\u4e0b\u56fe\uff0c\u603b\u6570\u91cf\u5373\u4e3a \\(4^2\\) See\u3002</li> </ul> <p> - \u6b63 \\(n\\) \u8fb9\u5f62\u5706\u5fc3\u89d2\u4e3a \\(\\dfrac{360^{\\circ}}{n}\\) \uff0c\u5706\u5468\u89d2\u4e3a \\(\\dfrac{180^{\\circ}}{n}\\) \u3002\u5b9a\u4e49\u6b63 \\(n\\) \u8fb9\u5f62\u4e0a\u7684\u4e09\u4e2a\u9876\u70b9 \\(A,B\\) \u548c \\(C\\)\uff08\u53ef\u4ee5\u4e0d\u76f8\u90bb\uff09\uff0c\u4f7f\u5f97 \\(\\angle ABC=\\theta\\) \uff0c\u5f53 \\(n\\le 360\\) \u65f6\uff0c\\(\\theta\\) \u53ef\u4ee5\u53d6 \\(1^{\\circ}\\) \u5230 \\(179^{\\circ}\\) \u95f4\u7684\u4efb\u4f55\u4e00\u4e2a\u6574\u6570 See\u3002 - \u67d0\u4e00\u70b9 \\(B\\) \u5230\u76f4\u7ebf \\(AC\\) \u7684\u8ddd\u79bb\u516c\u5f0f\u4e3a \\(\\dfrac{|\\vec{BA}\\times \\vec{BC}|}{|AC|}\\) \uff0c\u7b49\u4ef7\u4e8e \\(\\dfrac{|aX+bY+c|}{\\sqrt{a^2+b^2}}\\)\u3002 - <code>atan(y / x)</code> \u51fd\u6570\u4ec5\u7528\u4e8e\u8ba1\u7b97\u7b2c\u4e00\u3001\u56db\u8c61\u9650\u7684\u503c\uff0c\u800c <code>atan2(y, x)</code> \u5219\u5141\u8bb8\u8ba1\u7b97\u6240\u6709\u56db\u4e2a\u8c61\u9650\u7684\u6b63\u53cd\u5207\uff0c\u5728\u4f7f\u7528\u8fd9\u4e2a\u51fd\u6570\u65f6\uff0c\u9700\u8981\u5c3d\u91cf\u4fdd\u8bc1 \\(x\\) \u548c \\(y\\) \u7684\u7c7b\u578b\u4e3a\u6574\u6570\u578b\uff0c\u5982\u679c\u4f7f\u7528\u6d6e\u70b9\u6570\uff0c\u5b9e\u6d4b\u4f1a\u6162\u5341\u500d\u3002 - \u5728\u5e73\u9762\u4e0a\u6709\u5947\u6570\u4e2a\u70b9 \\(A_0,A_1,\\dots,A_n\\) \u4ee5\u53ca\u4e00\u4e2a\u70b9 \\(X_0\\) \uff0c\u6784\u9020 \\(X_1\\) \u4f7f\u5f97 \\(X_0,X_1\\) \u5173\u4e8e \\(A_0\\) \u5bf9\u79f0\u3001\u6784\u9020 \\(X_2\\) \u4f7f\u5f97 \\(X_1,X_2\\) \u5173\u4e8e \\(A_1\\) \u5bf9\u79f0\u3001\u2026\u2026\u3001\u6784\u9020 \\(X_j\\) \u4f7f\u5f97 \\(X_{j-1},X_j\\) \u5173\u4e8e \\(A_{(j-1)\\mod n}\\) \u5bf9\u79f0\u3002\u90a3\u4e48\u5468\u671f\u4e3a \\(2n\\) \uff0c\u5373 \\(A_0\\) \u4e0e \\(A_{2n}\\) \u5171\u70b9\u3001\\(A_1\\) \u4e0e \\(A_{2n+1}\\) \u5171\u70b9 See \u3002 - \u5df2\u77e5 \\(A\\ (x_A, y_A)\\) \u548c \\(X\\ (x_X,y_X)\\) \u4e24\u70b9\u53ca\u8fd9\u4e24\u70b9\u7684\u5750\u6807\uff0c\u6784\u9020 \\(Y\\) \u4f7f\u5f97 \\(X,Y\\) \u5173\u4e8e \\(A\\) \u5bf9\u79f0\uff0c\u90a3\u4e48 \\(Y\\) \u7684\u5750\u6807\u4e3a \\((2\\cdot x_A-x_X,2\\cdot y_A-y_X)\\) \u3002 - \u6d77\u4f26\u516c\u5f0f\uff1a\u5df2\u77e5\u4e09\u89d2\u5f62\u4e09\u8fb9\u957f \\(a,b\\) \u548c \\(c\\) \uff0c\u5b9a\u4e49 \\(p=\\dfrac{a+b+c}{2}\\) \uff0c\u5219 \\(S_{\\triangle}=\\sqrt{p(p-a)(p-b)(p-c)}\\) \uff0c\u5728\u4f7f\u7528\u65f6\u9700\u8981\u6ce8\u610f\u8d8a\u754c\u95ee\u9898\uff0c\u672c\u8d28\u662f\u94c5\u9524\u5b9a\u7406\uff0c\u4e00\u822c\u591a\u4f7f\u7528\u53c9\u4e58\u8ba1\u7b97\u4e09\u89d2\u5f62\u9762\u79ef\u800c\u4e0d\u4f7f\u7528\u8be5\u516c\u5f0f\u3002 - \u68f1\u53f0\u4f53\u79ef \\(V=\\frac{1}{3}(S_1+S_2+\\sqrt{S_1S_2})\\cdot h\\)\uff0c\u5176\u4e2d \\(S_1,S_2\\) \u4e3a\u4e0a\u4e0b\u5e95\u9762\u79ef\u3002 - \u6b63\u68f1\u53f0\u4fa7\u9762\u79ef \\(\\frac{1}{2}(C_1+C_2)\\cdot L\\)\uff0c\u5176\u4e2d \\(C_1,C_2\\) \u4e3a\u4e0a\u4e0b\u5e95\u5468\u957f\uff0c\\(L\\) \u4e3a\u659c\u9ad8\uff08\u4e0a\u4e0b\u5e95\u5bf9\u5e94\u7684\u5e73\u884c\u8fb9\u7684\u8ddd\u79bb\uff09\u3002 - \u7403\u9762\u79ef \\(4\\pi r^2\\)\uff0c\u4f53\u79ef \\(\\frac{4}{3}\\pi r^3\\)\u3002 - \u6b63\u4e09\u89d2\u5f62\u9762\u79ef \\(\\dfrac{\\sqrt 3 a^2}{4}\\)\uff0c\u6b63\u56db\u9762\u4f53\u9762\u79ef \\(\\dfrac{\\sqrt 2 a^3}{12}\\)\u3002 - \u8bbe\u6247\u5f62\u5bf9\u5e94\u7684\u5706\u5fc3\u89d2\u5f27\u5ea6\u4e3a \\(\\theta\\) \uff0c\u5219\u9762\u79ef\u4e3a \\(S=\\frac{\\theta}{2}\\cdot R^2\\) \u3002</p>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5142","title":"5.14.2 \u7acb\u4f53\u51e0\u4f55\u7ed3\u8bba\u5f52\u6863","text":"<ul> <li>\u5df2\u77e5\u5411\u91cf \\(\\vec{r}=\\{x,y,z\\}\\) \uff0c\u5219\u8be5\u5411\u91cf\u7684\u4e09\u4e2a\u65b9\u5411\u4f59\u5f26\u4e3a \\(\\cos \\alpha =\\dfrac{x}{|\\vec r|}=\\dfrac{x}{\\sqrt{x^2+y^2+z^2}}; \\ \\cos \\beta = \\dfrac{y}{|\\vec r|};\\ \\cos \\gamma =\\dfrac{z}{|\\vec r|}\\) \u3002\u5176\u4e2d \\(\\alpha,\\beta,\\gamma\\in [0,\\pi]\\) \uff0c\\(\\cos^2\\alpha+\\cos^2\\beta+\\cos^2\\gamma=1\\) \u3002</li> </ul>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#515","title":"5.15 \u5e38\u7528\u4f8b\u9898","text":""},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5151","title":"5.15.1 \u5c06\u5e73\u9762\u67d0\u70b9\u65cb\u8f6c\u4efb\u610f\u89d2\u5ea6","text":"<p>\u9898\u610f\uff1a\u7ed9\u5b9a\u5e73\u9762\u4e0a\u4e00\u70b9 \\((a,b)\\) \uff0c\u8f93\u51fa\u5c06\u5176\u9006\u65f6\u9488\u65cb\u8f6c \\(d\\) \u5ea6\u4e4b\u540e\u7684\u5750\u6807\u3002</p> <pre><code>signed main() {\n    int a, b, d;\n    cin &gt;&gt; a &gt;&gt; b &gt;&gt; d;\n\n    ld l = hypot(a, b); // \u5e93\u51fd\u6570\uff0c\u6c42\u76f4\u89d2\u4e09\u89d2\u5f62\u7684\u659c\u8fb9\n    ld alpha = atan2(b, a) + toArc(d);\n\n    cout &lt;&lt; l * cos(alpha) &lt;&lt; \" \" &lt;&lt; l * sin(alpha) &lt;&lt; endl;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5152-set","title":"5.15.2 \u5e73\u9762\u6700\u8fd1\u70b9\u5bf9\uff08set\u89e3\uff09","text":"<p>\u501f\u52a9 <code>set</code> \uff0c\u5728\u4e25\u683c \\(\\mathcal O(N\\log N)\\) \u590d\u6742\u5ea6\u5185\u6c42\u89e3\uff0c\u6bd4\u5e38\u89c1\u7684\u5206\u6cbb\u6cd5\u7a0d\u5feb\u3002</p> <pre><code>template&lt;class T&gt; T sqr(T x) {\n    return x * x;\n}\n\nusing V = Point&lt;int&gt;;\nsigned main() {\n    int n;\n    cin &gt;&gt; n;\n\n    vector&lt;V&gt; in(n);\n    for (auto &amp;it : in) {\n        cin &gt;&gt; it;\n    }\n\n    int dis = disEx(in[0], in[1]); // \u8bbe\u5b9a\u9608\u503c\n    sort(in.begin(), in.end());\n\n    set&lt;V&gt; S;\n    for (int i = 0, h = 0; i &lt; n; i++) {\n        V now = {in[i].y, in[i].x};\n        while (dis &amp;&amp; dis &lt;= sqr(in[i].x - in[h].x)) { // \u5220\u9664\u8d85\u8fc7\u9608\u503c\u7684\u70b9\n            S.erase({in[h].y, in[h].x});\n            h++;\n        }\n        auto it = S.lower_bound(now);\n        for (auto k = it; k != S.end() &amp;&amp; sqr(k-&gt;x - now.x) &lt; dis; k++) {\n            dis = min(dis, disEx(*k, now));\n        }\n        if (it != S.begin()) {\n            for (auto k = prev(it); sqr(k-&gt;x - now.x) &lt; dis; k--) {\n                dis = min(dis, disEx(*k, now));\n                if (k == S.begin()) break;\n            }\n        }\n        S.insert(now);\n    }\n    cout &lt;&lt; sqrt(dis) &lt;&lt; endl;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5153","title":"5.15.3 \u5e73\u9762\u82e5\u5e72\u70b9\u80fd\u6784\u6210\u7684\u6700\u5927\u56db\u8fb9\u5f62\u7684\u9762\u79ef\uff08\u7b80\u5355\u7248\uff0c\u66b4\u529b\u679a\u4e3e\uff09","text":"<p>\u9898\u610f\uff1a\u5e73\u9762\u4e0a\u5b58\u5728\u82e5\u5e72\u4e2a\u70b9\uff0c\u4fdd\u8bc1\u6ca1\u6709\u4e24\u70b9\u91cd\u5408\u3001\u6ca1\u6709\u4e09\u70b9\u5171\u7ebf\uff0c\u4f60\u9700\u8981\u4ece\u4e2d\u9009\u51fa\u56db\u4e2a\u70b9\uff0c\u4f7f\u5f97\u5b83\u4eec\u6784\u6210\u7684\u56db\u8fb9\u5f62\u9762\u79ef\u662f\u6700\u5927\u7684\uff0c\u6ce8\u610f\u8fd9\u91cc\u80fd\u7ec4\u6210\u7684\u56db\u8fb9\u5f62\u53ef\u4ee5\u4e0d\u662f\u51f8\u56db\u8fb9\u5f62\u3002</p> <p>\u66b4\u529b\u679a\u4e3e\u5176\u4e2d\u4e00\u6761\u5bf9\u89d2\u7ebf\u540e\u679a\u4e3e\u5269\u4f59\u4e24\u4e2a\u70b9\uff0c\\(\\mathcal O(N^3)\\) \u3002</p> <pre><code>signed main() {\n    int n;\n    cin &gt;&gt; n;\n    vector&lt;Pi&gt; in(n);\n    for (auto &amp;it : in) {\n        cin &gt;&gt; it;\n    }\n    ld ans = 0;\n    for (int i = 0; i &lt; n; i++) {\n        for (int j = i + 1; j &lt; n; j++) { // \u679a\u4e3e\u5bf9\u89d2\u7ebf\n            ld l = 0, r = 0;\n            for (int k = 0; k &lt; n; k++) { // \u679a\u4e3e\u7b2c\u4e09\u70b9\n                if (k == i || k == j) continue;\n                if (pointOnLineLeft(in[k], {in[i], in[j]})) {\n                    l = max(l, triangleS(in[k], in[j], in[i]));\n                } else {\n                    r = max(r, triangleS(in[k], in[j], in[i]));\n                }\n            }\n            if (l * r != 0) { // \u786e\u4fdd\u6784\u6210\u7684\u662f\u56db\u8fb9\u5f62\n                ans = max(ans, l + r);\n            }\n        }\n    }\n    cout &lt;&lt; ans &lt;&lt; endl;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5154","title":"5.15.4 \u5e73\u9762\u82e5\u5e72\u70b9\u80fd\u6784\u6210\u7684\u6700\u5927\u56db\u8fb9\u5f62\u7684\u9762\u79ef\uff08\u56f0\u96be\u7248\uff0c\u5206\u7c7b\u8ba8\u8bba+\u65cb\u8f6c\u5361\u58f3\uff09","text":"<p>\u9898\u610f\uff1a\u5e73\u9762\u4e0a\u5b58\u5728\u82e5\u5e72\u4e2a\u70b9\uff0c\u53ef\u80fd\u5b58\u5728\u591a\u70b9\u91cd\u5408\u3001\u5171\u7ebf\u7684\u60c5\u51b5\uff0c\u4f60\u9700\u8981\u4ece\u4e2d\u9009\u51fa\u56db\u4e2a\u70b9\uff0c\u4f7f\u5f97\u5b83\u4eec\u6784\u6210\u7684\u56db\u8fb9\u5f62\u9762\u79ef\u662f\u6700\u5927\u7684\uff0c\u6ce8\u610f\u8fd9\u91cc\u80fd\u7ec4\u6210\u7684\u56db\u8fb9\u5f62\u53ef\u4ee5\u4e0d\u662f\u51f8\u56db\u8fb9\u5f62\u3001\u53ef\u4ee5\u662f\u9000\u5316\u7684\u56db\u8fb9\u5f62\u3002</p> <p>\u5f53\u51f8\u5305\u5927\u5c0f \\(\\le 2\\) \u65f6\uff0c\u8bf4\u660e\u662f\u9000\u5316\u7684\u56db\u8fb9\u5f62\uff0c\u7b54\u6848\u76f4\u63a5\u4e3a \\(0\\) \uff1b\u5927\u5c0f\u6070\u597d\u4e3a \\(3\\) \u65f6\uff0c\u8bf4\u660e\u662f\u51f9\u56db\u8fb9\u5f62\uff0c\u6211\u4eec\u679a\u4e3e\u4e0d\u5728\u51f8\u5305\u4e0a\u7684\u90a3\u4e00\u70b9\uff0c\u5c06\u4e24\u4e2a\u4e09\u89d2\u5f62\u9762\u79ef\u76f8\u51cf\u65e2\u53ef\u5f97\u5230\u7b54\u6848\uff1b\u5927\u5c0f\u6070\u597d\u4e3a \\(4\\) \u65f6\uff0c\u8bf4\u660e\u662f\u51f8\u56db\u8fb9\u5f62\uff0c\u4f7f\u7528\u65cb\u8f6c\u5361\u58f3\u6c42\u89e3\u3002</p> <pre><code>using V = Point&lt;int&gt;;\nsigned main() {\n    int Task = 1;\n    for (cin &gt;&gt; Task; Task; Task--) {\n        int n;\n        cin &gt;&gt; n;\n\n        vector&lt;V&gt; in_(n);\n        for (auto &amp;it : in_) {\n            cin &gt;&gt; it;\n        }\n        auto in = staticConvexHull(in_, 0);\n        n = in.size();\n\n        int ans = 0;\n        if (n &gt; 3) {\n            ans = rotatingCalipers(in);\n        } else if (n == 3) {\n            int area = triangleAreaEx(in[0], in[1], in[2]);\n            for (auto it : in_) {\n                if (it == in[0] || it == in[1] || it == in[2]) continue;\n                int Min = min({triangleAreaEx(it, in[0], in[1]), triangleAreaEx(it, in[0], in[2]), triangleAreaEx(it, in[1], in[2])});\n                ans = max(ans, area - Min);\n            }\n        }\n\n        cout &lt;&lt; ans / 2;\n        if (ans % 2) {\n            cout &lt;&lt; \".5\";\n        }\n        cout &lt;&lt; endl;\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5155","title":"5.15.5 \u7ebf\u6bb5\u5c06\u591a\u8fb9\u5f62\u5207\u5272\u4e3a\u51e0\u4e2a\u90e8\u5206","text":"<p>\u9898\u610f\uff1a\u7ed9\u5b9a\u5e73\u9762\u4e0a\u4e00\u7ebf\u6bb5\u4e0e\u4e00\u4e2a\u4efb\u610f\u591a\u8fb9\u5f62\uff0c\u6c42\u89e3\u7ebf\u6bb5\u5c06\u591a\u8fb9\u5f62\u5207\u5272\u4e3a\u51e0\u4e2a\u90e8\u5206\uff1b\u4fdd\u8bc1\u7ebf\u6bb5\u7684\u7aef\u70b9\u4e0d\u5728\u591a\u8fb9\u5f62\u5185\u3001\u591a\u8fb9\u5f62\u8fb9\u4e0a\uff0c\u591a\u8fb9\u5f62\u9876\u70b9\u4e0d\u4f4d\u4e8e\u7ebf\u6bb5\u4e0a\uff0c\u591a\u8fb9\u5f62\u7684\u8fb9\u4e0d\u4e0e\u7ebf\u6bb5\u91cd\u53e0\uff1b\u591a\u8fb9\u5f62\u7aef\u70b9\u6309\u9006\u65f6\u9488\u987a\u5e8f\u7ed9\u51fa\u3002\u4e0b\u65b9\u7684\u51e0\u4e2a\u6837\u4f8b\u5747\u5408\u6cd5\uff0c\u7b54\u6848\u5747\u4e3a \\(3\\) \u3002</p> <p></p> <p>\u5f53\u7ebf\u6bb5\u5207\u5272\u591a\u8fb9\u5f62\u65f6\uff0c\u672c\u8d28\u662f\u4e0e\u591a\u8fb9\u5f62\u7684\u8fb9\u4ea4\u4e8e\u4e24\u4e2a\u70b9\u3001\u6216\u8005\u8bf4\u662f\u4e0e\u591a\u8fb9\u5f62\u7684\u4e24\u6761\u8fb9\u76f8\u4ea4\uff0c\u8bbe\u4ea4\u70b9\u6570\u76ee\u4e3a \\(x\\) \uff0c\u90a3\u4e48\u7b54\u6848\u5373\u4e3a \\(\\frac{x}{2}+1\\) \u3002\u4e8e\u662f\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8ba1\u7b97\u4ea4\u70b9\u6570\u91cf\u5373\u53ef\uff0c\u5148\u5224\u65ad\u67d0\u4e00\u6761\u8fb9\u662f\u5426\u4e0e\u7ebf\u6bb5\u76f8\u4ea4\uff0c\u518d\u5224\u65ad\u8fb9\u7684\u4e24\u4e2a\u7aef\u70b9\u662f\u5426\u4f4d\u4e8e\u7ebf\u6bb5\u4e24\u4fa7\u3002</p> <pre><code>signed main() {\n    Pi s, e;\n    cin &gt;&gt; s &gt;&gt; e; // \u8bfb\u5165\u7ebf\u6bb5\n\n    int n;\n    cin &gt;&gt; n;\n    vector&lt;Pi&gt; in(n);\n    for (auto &amp;it : in) {\n        cin &gt;&gt; it; // \u8bfb\u5165\u591a\u8fb9\u5f62\u7aef\u70b9\n    }\n\n    int cnt = 0;\n    for (int i = 0; i &lt; n; i++) {\n        Pi x = in[i], y = in[(i + 1) % n];\n        cnt += (pointNotOnLineSide(x, y, {s, e}) &amp;&amp; segmentIntersection(Line{x, y}, {s, e}));\n    }\n    cout &lt;&lt; cnt / 2 + 1 &lt;&lt; endl;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5156","title":"5.15.6 \u5e73\u9762\u82e5\u5e72\u70b9\u80fd\u5426\u6784\u6210\u51f8\u5305\uff08\u66b4\u529b\u679a\u4e3e\uff09","text":"<p>\u9898\u610f\uff1a\u7ed9\u5b9a\u5e73\u9762\u4e0a\u82e5\u5e72\u4e2a\u70b9\uff0c\u5224\u65ad\u5176\u662f\u5426\u6784\u6210\u51f8\u5305 See \u3002</p> <p>\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u51f8\u5305\u6a21\u677f\uff0c\u4f46\u662f\u4ee3\u7801\u8f83\u957f\uff1b\u5728\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u66b4\u529b\u679a\u4e3e\u8bd5\u70b9\uff0c\u4e5f\u80fd\u4ee5 \\(\\mathcal O(N)\\) \u7684\u590d\u6742\u5ea6\u901a\u8fc7\u3002\u5f53\u4e24\u4e2a\u5411\u91cf\u7684\u53c9\u4e58 \\(\\le0\\) \u65f6\u8bf4\u660e\u5176\u5939\u89d2\u5927\u4e8e\u7b49\u4e8e \\(180\\degree\\) \uff0c\u4f7f\u7528\u8fd9\u4e00\u70b9\u5373\u53ef\u5224\u5b9a\u3002</p> <pre><code>signed main() {\n    int n;\n    cin &gt;&gt; n;\n\n    vector&lt;Point&lt;ld&gt;&gt; in(n);\n    for (auto &amp;it : in) {\n        cin &gt;&gt; it;\n    }\n\n    for (int i = 0; i &lt; n; i++) {\n        auto A = in[(i - 1 + n) % n];\n        auto B = in[i];\n        auto C = in[(i + 1) % n];\n        if (cross(A - B, C - B) &gt; 0) {\n            cout &lt;&lt; \"No\\n\";\n            return 0;\n        }\n    }\n    cout &lt;&lt; \"Yes\\n\";\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5157","title":"5.15.7 \u51f8\u5305\u4e0a\u7684\u70b9\u80fd\u6784\u6210\u7684\u6700\u5927\u4e09\u89d2\u5f62\uff08\u66b4\u529b\u679a\u4e3e\uff09","text":"<p>\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u51f8\u5305\u6a21\u677f\uff0c\u4f46\u662f\u4ee3\u7801\u8f83\u957f\uff1b\u5728\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u66b4\u529b\u679a\u4e3e\u8bd5\u70b9\uff0c\u4e5f\u80fd\u4ee5 \\(\\mathcal O(N)\\) \u7684\u590d\u6742\u5ea6\u901a\u8fc7\u3002</p> <p>\u53e6\u5916\u8865\u5145\u4e00\u70b9\u6027\u8d28\uff1a\u6240\u6c42\u4e09\u89d2\u5f62\u7684\u53cd\u4e92\u8865\u4e09\u89d2\u5f62\u4e00\u5b9a\u5305\u542b\u4e86\u51f8\u5305\u4e0a\u7684\u6240\u6709\u70b9\uff08\u53ef\u4ee5\u5728\u8fb9\u754c\uff09\u3002\u901a\u4fd7\u7684\u8bf4\uff0c\u6784\u6210\u7684\u4e09\u89d2\u5f62\u662f\u8fd9\u4e2a\u53cd\u4e92\u8865\u4e09\u89d2\u5f62\u7684\u4e2d\u70b9\u4e09\u89d2\u5f62\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u70b9 \\(A\\) \u4e0d\u5728 \\(\\triangle BCE\\) \u7684\u53cd\u4e92\u8865\u4e09\u89d2\u5f62\u5185\u90e8\uff0c\u6545 \\(\\triangle BCE\\) \u4e0d\u662f\u6700\u5927\u4e09\u89d2\u5f62\uff1b\\(\\triangle ACE\\) \u624d\u662f\u3002</p> <p></p> <p></p> <pre><code>signed main() {\n    int n;\n    cin &gt;&gt; n;\n\n    vector&lt;Point&lt;int&gt;&gt; in(n);\n    for (auto &amp;it : in) {\n        cin &gt;&gt; it;\n    }\n\n    #define S(x, y, z) triangleAreaEx(in[x], in[y], in[z])\n\n    int i = 0, j = 1, k = 2;\n    while (true) {\n        int val = S(i, j, k);\n        if (S((i + 1) % n, j, k) &gt; val) {\n            i = (i + 1) % n;\n        } else if (S((i - 1 + n) % n, j, k) &gt; val) {\n            i = (i - 1 + n) % n;\n        } else if (S(i, (j + 1) % n, k) &gt; val) {\n            j = (j + 1) % n;\n        } else if (S(i, (j - 1 + n) % n, k) &gt; val) {\n            j = (j - 1 + n) % n;\n        } else if (S(i, j, (k + 1) % n) &gt; val) {\n            k = (k + 1) % n;\n        } else if (S(i, j, (k - 1 + n) % n) &gt; val) {\n            k = (k - 1 + n) % n;\n        } else {\n            break;\n        }\n    }\n    cout &lt;&lt; i + 1 &lt;&lt; \" \" &lt;&lt; j + 1 &lt;&lt; \" \" &lt;&lt; k + 1 &lt;&lt; endl;\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5158","title":"5.15.8 \u51f8\u5305\u4e0a\u7684\u70b9\u80fd\u6784\u6210\u7684\u6700\u5927\u56db\u89d2\u5f62\u7684\u9762\u79ef\uff08\u65cb\u8f6c\u5361\u58f3\uff09","text":"<p>\u7531\u4e8e\u662f\u51f8\u5305\u4e0a\u7684\u70b9\uff0c\u6240\u4ee5\u4fdd\u8bc1\u4e86\u56db\u8fb9\u5f62\u4e00\u5b9a\u662f\u51f8\u56db\u8fb9\u5f62\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 \\(\\mathcal O(N^2)\\) \u3002</p> <pre><code>template&lt;class T&gt; T rotatingCalipers(vector&lt;Point&lt;T&gt;&gt; &amp;p) {\n    #define S(x, y, z) triangleAreaEx(p[x], p[y], p[z])\n    int n = p.size();\n    T ans = 0;\n    auto nxt = [&amp;](int i) -&gt; int {\n        return i == n - 1 ? 0 : i + 1;\n    };\n    for (int i = 0; i &lt; n; i++) {\n        int p1 = nxt(i), p2 = nxt(nxt(nxt(i)));\n        for (int j = nxt(nxt(i)); nxt(j) != i; j = nxt(j)) {\n            while (nxt(p1) != j &amp;&amp; S(i, j, nxt(p1)) &gt; S(i, j, p1)) {\n                p1 = nxt(p1);\n            }\n            if (p2 == j) {\n                p2 = nxt(p2);\n            }\n            while (nxt(p2) != i &amp;&amp; S(i, j, nxt(p2)) &gt; S(i, j, p2)) {\n                p2 = nxt(p2);\n            }\n            ans = max(ans, S(i, j, p1) + S(i, j, p2));\n        }\n    }\n    return ans;\n    #undef S\n}\n</code></pre>"},{"location":"CP/templates/%E5%87%A0%E4%BD%95/#5159","title":"5.15.9 \u5224\u65ad\u4e00\u4e2a\u51f8\u5305\u662f\u5426\u5b8c\u5168\u5728\u53e6\u4e00\u4e2a\u51f8\u5305\u5185","text":"<p>\u9898\u610f\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u51f8\u591a\u8fb9\u5f62 \\(A\\) \u548c\u4e00\u4e2a\u51f8\u591a\u8fb9\u5f62 \\(B\\) \uff0c\u8be2\u95ee \\(B\\) \u662f\u5426\u88ab \\(A\\) \u5305\u542b\uff0c\u5206\u522b\u5224\u65ad\u4e25\u683c/\u4e0d\u4e25\u683c\u5305\u542b\u3002\u4f8b\u9898\u3002</p> <p>\u8003\u8651\u4e25\u683c\u5305\u542b\uff0c\u4f7f\u7528 \\(A\\) \u70b9\u96c6\u8ba1\u7b97\u51fa\u51f8\u5305 \\(T_1\\) \uff0c\u4f7f\u7528 \\(A,B\\) \u4e24\u4e2a\u70b9\u96c6\u8ba1\u7b97\u51fa\u4e0d\u4e25\u683c\u51f8\u5305 \\(T_2\\) \uff0c\u5982\u679c\u5305\u542b\uff0c\u90a3\u4e48 \\(T_1\\) \u5e94\u8be5\u4e0e \\(T_2\\) \u5b8c\u5168\u76f8\u7b49\uff1b\u8003\u8651\u4e0d\u4e25\u683c\u5305\u542b\uff0c\u5728\u8ba1\u7b97\u51f8\u5305 \\(T_2\\) \u65f6\u4e25\u683c\u5373\u53ef\u3002\u6700\u7ec8\u4ee5 \\(\\mathcal O(N)\\) \u590d\u6742\u5ea6\u6c42\u89e3\uff0c\u4e14\u4ee3\u7801\u4e0d\u7b97\u5f88\u957f\u3002</p>"},{"location":"CP/templates/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/","title":"10 \u52a8\u6001\u89c4\u5212","text":""},{"location":"CP/templates/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#101-lis","title":"10.1 \u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217 LIS","text":"<pre><code>// \u8fd4\u56de\u6700\u957f\u5355\u8c03\u4e0a\u5347\u5b50\u5e8f\u5217, O(nlogn)\nvector&lt;int&gt; LIS(vector&lt;int&gt;&amp; arr) {\n    int len = arr.size() - 1;  // 1-base\n    int ans = 0;\n    vector&lt;int&gt; low(2);\n    low[1] = arr[1], ans = 1;\n    for (int i = 2; i &lt;= len; i++) {\n        if (arr[i] &gt; low[ans]) {\n            low.push_back(arr[i]);\n            ans++;\n        } else {\n            int p = lower_bound(low.begin() + 1, low.end(), arr[i]) - low.begin();\n            low[p] = arr[i];\n        }\n    }\n    return move(low);\n}\n</code></pre>"},{"location":"CP/templates/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#102-dp","title":"10.2 \u6362\u6839dp","text":"<pre><code>void link(int x, int y) { // \u5b50\u6811y\u7684\u8d21\u732e\u5e76\u5165\u7ed3\u70b9x\n    dp[x] += dp[y];\n}\nvoid cut(int x, int y) { // \u7ed3\u70b9x\u5220\u9664\u5b50\u6811y\u7684\u8d21\u732e\n    dp[x] -= dp[y];\n}\nvoid dfs1(int x, int fa, vector&lt;vector&lt;int&gt;&gt; &amp;g) { // \u7edf\u8ba1\u5b50\u6811\u5bf9\u6839\u7684\u8d21\u732e\n    dp[x] = 1;\n    for (y : g[x]) {\n        if (y == fa) continue;\n        dfs1(y, x, g);\n        link(x, y);\n    }\n}\nvoid dfs2(int x, int fa, vector&lt;vector&lt;int&gt;&gt; &amp;g) {\n    ans[x] = dp[x]; // \u8fdb\u5165\u7ed3\u70b9\u65f6\uff0c\u7edf\u8ba1\u7b54\u6848\n    for (int y : g[x]) {\n        if (y == fa) continue;\n        cut(x, y), link(y, x); // \u6362\u6839\n        dfs2(y, x, g);\n        cut(y, x), link(x, y); // \u56de\u6eaf\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#103-sosdp","title":"10.3 SOSdp","text":"<p>\\(O(n\\cdot 2^n)\\) \u5904\u7406\u5b50\u96c6\uff0c\u8d85\u96c6\u7684\u548c\u3002</p> <pre><code>void sum_over_subsets_dp() {\n    // 1. \u521d\u59cb\u5316 DP \u6570\u7ec4\n    // F[mask] \u7684\u521d\u59cb\u503c\u5c31\u662f A[mask] \u672c\u8eab\uff0c\u56e0\u4e3a mask \u662f\u81ea\u8eab\u7684\u5b50\u96c6\n    for (int mask = 0; mask &lt; (1 &lt;&lt; N); ++mask) {\n        F[mask] = A[mask];\n    }\n\n    // 2. \u6309\u4f4d\u8fdb\u884c DP\n    // \u5916\u5c42\u5faa\u73af\u904d\u5386\u6bcf\u4e00\u4f4d (\u7ef4\u5ea6)\n    for (int i = 0; i &lt; N; ++i) {\n        // \u5185\u5c42\u5faa\u73af\u904d\u5386\u6240\u6709 mask\n        for (int mask = 0; mask &lt; (1 &lt;&lt; N); ++mask) {\n            // \u5982\u679c mask \u7684\u7b2c i \u4f4d\u662f 1\n            // \u90a3\u4e48 F[mask] \u7684\u503c\u9700\u8981\u52a0\u4e0a F[mask ^ (1 &lt;&lt; i)] \u7684\u8d21\u732e\n            // mask ^ (1 &lt;&lt; i) \u662f mask \u53bb\u6389\u7b2c i \u4f4d\u7684\u7ed3\u679c\uff0c\u662f mask \u7684\u4e00\u4e2a\u5b50\u96c6\n            if (mask &amp; (1 &lt;&lt; i)) {\n                F[mask] += F[mask ^ (1 &lt;&lt; i)];\n            }\n        }\n    }\n}\n\nvoid sum_over_supersets_dp() {\n    // 1. \u521d\u59cb\u5316\n    for (int mask = 0; mask &lt; (1 &lt;&lt; N); ++mask) {\n        F[mask] = A[mask];\n    }\n\n    // 2. \u6309\u4f4d\u8fdb\u884c DP\n    for (int i = 0; i &lt; N; ++i) {\n        // \u5185\u5c42\u5faa\u73af mask \u9700\u8981\u4ece\u5927\u5230\u5c0f\n        for (int mask = (1 &lt;&lt; N) - 1; mask &gt;= 0; --mask) {\n            // \u5982\u679c mask \u7684\u7b2c i \u4f4d\u662f 0\n            // \u90a3\u4e48 F[mask] \u7684\u503c\u9700\u8981\u52a0\u4e0a F[mask | (1 &lt;&lt; i)] \u7684\u8d21\u732e\n            // mask | (1 &lt;&lt; i) \u662f mask \u52a0\u4e0a\u7b2c i \u4f4d\u7684\u7ed3\u679c\uff0c\u662f mask \u7684\u4e00\u4e2a\u8d85\u96c6\n            if (!(mask &amp; (1 &lt;&lt; i))) {\n                F[mask] += F[mask | (1 &lt;&lt; i)];\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E5%9B%BE%E8%AE%BA/","title":"6 \u56fe\u8bba","text":""},{"location":"CP/templates/%E5%9B%BE%E8%AE%BA/#61-dijkstra","title":"6.1 \u8fea\u6770\u65af\u7279\u62c9 Dijkstra","text":"<pre><code>using pii = pair&lt;int, int&gt;;\nusing graph = vector&lt;vector&lt;pii&gt;&gt;;\nconstexpr int INF = 1e18;\n\nvector&lt;int&gt; dijkstra(graph &amp;g, int s) {\n    vector&lt;int&gt; dist(g.size(), INF);\n    priority_queue&lt;pii, vector&lt;pii&gt;, greater&lt;pii&gt;&gt; pq;\n    dist[s] = 0;\n    pq.emplace(0, s);\n    while (!pq.empty()) {\n        auto [d, u] = pq.top(); pq.pop();\n        if (dist[u] &lt; d) continue;\n        for (auto [w, v] : g[u]) {\n            if (dist[v] &gt; dist[u] + w) {\n                dist[v] = dist[u] + w;\n                pq.emplace(dist[v], v);\n            }\n        }\n    }\n    return dist;\n}\n</code></pre>"},{"location":"CP/templates/%E5%9B%BE%E8%AE%BA/#62-spfa","title":"6.2 \u5224\u65ad\u8d1f\u73af SPFA","text":"<p>\u7528\u4e8e\u5224\u65ad\u8d1f\u73af\u662f\u5426\u5b58\u5728\uff0c\u6709\u8d1f\u73af return true\uff0c\u5426\u5219 return false</p> <pre><code>bool SPFA(int start, graph &amp;g) {\n    int n = (int)g.size();\n    vector&lt;int&gt; dist(n, INT_MAX), in_cnt(n, 0);\n    bitset&lt;MAXN&gt; vis; // vector&lt;bool&gt; vis(n);\n    queue&lt;int&gt; q;\n    dist[start] = 0;\n    q.push(start);\n    vis[start] = true;\n    while (!q.empty()) {\n        int now = q.front();\n        q.pop();\n        vis[now] = false;\n        for (auto &amp;[dis, to] : g[now]) {\n            if (dist[now] + dis &lt; dist[to]) {\n                dist[to] = dist[now] + dis;\n                if (!vis[to]) {\n                    q.push(to);\n                    in_cnt[to]++;\n                    if (in_cnt[to] &gt;= (int)g.size()) {\n                        return true;\n                    }\n                    vis[to] = true;\n                }\n            }\n        }\n    }\n    return false;\n}\n</code></pre>"},{"location":"CP/templates/%E5%9B%BE%E8%AE%BA/#63-toposort","title":"6.3 \u62d3\u6251\u6392\u5e8f TopoSort","text":"<p>\u8f93\u5165\u56fe\uff0c\u5165\u5ea6\uff0c\u8282\u70b9\u6570\uff0c\u8fd4\u56de\u62d3\u6251\u5e8f</p> <pre><code>using vvi = vector&lt;vector&lt;int&gt;&gt;;\nvector&lt;int&gt; topoSort(vvi &amp;g, vector&lt;int&gt; indeg) {\n    queue&lt;int&gt; q;\n    for (size_t i = 0; i &lt; indeg.size(); ++i) {\n        if (indeg[i] == 0) q.push(i);\n    }\n    vector&lt;int&gt; res;\n    res.reserve(g.size());\n    while (!q.empty()) {\n        int u = q.front();\n        res.emplace_back(u);\n        q.pop();\n        for (int v : g[u]) {\n            indeg[v]--;\n            if (indeg[v] == 0) {\n                q.push(v);\n            }\n        }\n    }\n    assert(res.size() == g.size());\n    return res;\n}\n</code></pre>"},{"location":"CP/templates/%E5%9B%BE%E8%AE%BA/#64","title":"6.4 \u5f3a\u8fde\u901a\u5206\u91cf","text":"<p>\u7f29\u70b9\u540e\uff0c\u4ecetot\u52301\u5c31\u662f\u62d3\u6251\u5e8f\uff0c\u65e0\u9700\u518d\u8fdb\u884c\u62d3\u6251\u6392\u5e8f\u3002</p> <pre><code>// Luogu P3387\n#include &lt;bits/stdc++.h&gt;\n#define int long long\nusing namespace std;\nusing vvi = vector&lt;vector&lt;int&gt;&gt;;\nconstexpr int N = 1e4 + 5;\nconstexpr int M = 1e5 + 5;\nint dfn[N], low[N], tim;\nint stk[N], instk[N], tp;\nvoid stkPush(int x) { stk[++tp] = x; instk[x] = 1; }\nint stkPop() { int y = stk[tp--]; instk[y] = 0; return y; }\nint id[N], tot;\nvoid tarjan(int x, const vvi &amp;g) {\n    dfn[x] = low[x] = ++tim;\n    stkPush(x);\n    for (int y : g[x]) {\n        if (!dfn[y]) tarjan(y, g), low[x] = min(low[x], low[y]);\n        else if (instk[y]) low[x] = min(low[x], dfn[y]);\n    }\n    if (low[x] == dfn[x]) {\n        tot++;\n        while (stk[tp + 1] != x) id[stkPop()] = tot;\n    }\n}\nint n, m, a[N], b[N], f[N], ans;  // b \u4e3a\u65b0\u56fe\u7684\u70b9\u6743\uff0cf\u4e3ax\u65b0\u56fe\u4e2d\u5230\u70b9x\u7684\u8def\u5f84\u70b9\u6743\u6700\u5927\u548c\nsigned main() {\n    ios::sync_with_stdio(false), cin.tie(nullptr);\n    cin &gt;&gt; n &gt;&gt; m;\n    for (int i = 1; i &lt;= n; i++) cin &gt;&gt; a[i];\n    vvi g(n + 1);\n    for (int i = 1; i &lt;= m; i++) {\n        int u, v;\n        cin &gt;&gt; u &gt;&gt; v;\n        g[u].emplace_back(v);\n    }\n    for (int i = 1; i &lt;= n; i++)\n        if (!dfn[i]) tarjan(i, g);\n    vvi h(tot + 1);\n    for (int i = 1; i &lt;= n; i++) {\n        for (int j : g[i]) { // \u7f29\u70b9\n            int x = id[i], y = id[j];\n            if (x != y) h[x].emplace_back(y);\n        }\n    }\n    for (int i = 1; i &lt;= n; i++) b[id[i]] += a[i];\n    for (int i = 1; i &lt;= tot; i++) { // DAG dp\n        f[i] = b[i];\n        for (int j : h[i]) f[i] = max(f[i], b[i] + f[j]);\n        ans = max(ans, f[i]);\n    }\n    cout &lt;&lt; ans &lt;&lt; \"\\n\";\n}\n</code></pre>"},{"location":"CP/templates/%E5%9B%BE%E8%AE%BA/#65","title":"6.5 \u70b9\u53cc\u8fde\u901a\u5206\u91cf+\u5272\u70b9","text":"<pre><code>// Luogu P8435\n#include &lt;bits/stdc++.h&gt;\n#define int long long\nusing namespace std;\nusing vvi = vector&lt;vector&lt;int&gt;&gt;;\nconstexpr int N = 5e5 + 5;\nconstexpr int M = 2e6 + 5;\nint dfn[N], low[N], tim;\nint stk[N], tp;\nvvi dcc(N);\nint n, m, tot;\nbool cut[N];\nvoid tarjan(int x, int fa, const vvi &amp;g) {\n    dfn[x] = low[x] = ++tim;\n    stk[++tp] = x;\n    int child = 0; \n    for (int y : g[x]) {\n        if (!dfn[y]) {\n            tarjan(y, x, g), low[x] = min(low[x], low[y]);\n            if (low[y] &gt;= dfn[x]) {\n                child++, tot++;\n                if (fa != 0 or child &gt; 1) cut[x] = true;\n                while (stk[tp+1] != y) dcc[tot].emplace_back(stk[tp--]);\n                dcc[tot].emplace_back(x);\n            }\n        } else if (y != fa)\n            low[x] = min(low[x], dfn[y]);\n    }\n    if (fa == 0 and child == 0) dcc[++tot].emplace_back(x);  \n}\nsigned main() {\n    ios::sync_with_stdio(false), cin.tie(nullptr);\n    cin &gt;&gt; n &gt;&gt; m;\n    vvi g(n + 1);\n    for (int i = 1; i &lt;= m; i++) {\n        int u, v;\n        cin &gt;&gt; u &gt;&gt; v;\n        g[u].emplace_back(v), g[v].emplace_back(u);\n    }\n    for (int i = 1; i &lt;= n; i++)\n        if (!dfn[i]) tarjan(i, 0, g);\n    cout &lt;&lt; tot &lt;&lt; \"\\n\";\n    for (int i = 1; i &lt;= tot; i++) {\n        cout &lt;&lt; dcc[i].size();\n        for (int j : dcc[i]) cout &lt;&lt; \" \" &lt;&lt; j;\n        cout &lt;&lt; \"\\n\";\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E5%9B%BE%E8%AE%BA/#66","title":"6.6 \u8fb9\u53cc\u8fde\u901a\u5206\u91cf+\u5272\u8fb9","text":"<pre><code>// Luogu P8436\n#include &lt;bits/stdc++.h&gt;\n#define int long long\nusing namespace std;\nconstexpr int N = 5e5 + 5;\nconstexpr int M = 2e6 + 5;\nstruct Edge {\n    int to, nex;\n} e[M * 2];\nint head[N], cnt = 1;\nvoid add_edge(int x, int y) {\n    e[++cnt] = {y, head[x]};\n    head[x] = cnt;\n}\nint dfn[N], low[N], tim;\nint stk[N], tp;\nint id[N], tot, bri[M * 2];\nvoid tarjan(int x, int eid) {\n    dfn[x] = low[x] = ++tim;\n    stk[++tp] = x;\n    for (int i = head[x]; i; i = e[i].nex) {\n        int y = e[i].to;\n        if (!dfn[y]) {\n            tarjan(y, i), low[x] = min(low[x], low[y]);\n            bri[i] = bri[i ^ 1] = (low[y] &gt; dfn[x]);\n        } else if (i != (eid ^ 1))\n            low[x] = min(low[x], dfn[y]);\n    }\n    if (low[x] == dfn[x]) {\n        ++tot;\n        while (stk[tp + 1] != x) id[stk[tp--]] = tot;\n    }\n}\nsigned main() {\n    ios::sync_with_stdio(false), cin.tie(nullptr);\n    int n, m;\n    cin &gt;&gt; n &gt;&gt; m;\n    for (int i = 1; i &lt;= m; i++) {\n        int u, v;\n        cin &gt;&gt; u &gt;&gt; v;\n        add_edge(u, v), add_edge(v, u);\n    }\n    for (int i = 1; i &lt;= n; i++)\n        if (!dfn[i]) tarjan(i, 0);\n    cout &lt;&lt; tot &lt;&lt; \"\\n\";\n    vector&lt;vector&lt;int&gt;&gt; dcc(tot + 1);\n    for (int i = 1; i &lt;= n; i++) \n        dcc[id[i]].emplace_back(i);\n    for (int i = 1; i &lt;= tot; i++) {\n        cout &lt;&lt; dcc[i].size();\n        for (int j : dcc[i]) cout &lt;&lt; \" \" &lt;&lt; j;\n        cout &lt;&lt; \"\\n\";\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E5%9B%BE%E8%AE%BA/#67","title":"6.7 \u6700\u5927\u6d41","text":"<p>Dinic\u591a\u8def\u589e\u5e7f\u3002\u521d\u59cb\u6b63\u5411\u8fb9c\uff0c\u53cd\u5411\u8fb90\u3002</p> <pre><code>constexpr int N = 1000005;\nconstexpr int M = 1000005;\nconstexpr int INF = 1e18;\nint n, m, S, T, ans, tot; // tot \u4e3a\u603b\u7684\u7ed3\u70b9\u4e2a\u6570\nstruct Edge {int to, c, nex;} e[M*2];\nint head[N], cnt = 1;\nvoid add(int u, int v, int c) {\n    e[++cnt] = {v, c, head[u]};\n    head[u] = cnt;\n}\nvoid add_edge(int u, int v, int c) {\n    add(u, v, c); add(v, u, 0);\n}\nint dep[N];\nbool bfs() { // \u5206\u5c42\n    fill(dep, dep+1+tot, 0);\n    queue&lt;int&gt; q;\n    q.push(S); dep[S] = 1; \n    while (!q.empty()) {\n        int u = q.front(); q.pop();\n        for (int i = head[u]; i; i = e[i].nex) {\n            int v = e[i].to;\n            if (!dep[v] and e[i].c) {\n                dep[v] = dep[u] + 1;\n                q.push(v);\n            }\n        }\n    }\n    return dep[T] != 0;\n}\nint cur[N];\nint dfs(int u, int fin) { // \u591a\u8def\u589e\u5e7f\n    if (u == T) return fin;\n    int fout = 0;\n    for (int &amp;i = cur[u]; i and fin; i = e[i].nex) {\n        int v = e[i].to;\n        if (dep[v] &gt; dep[u] and e[i].c) {\n            int f = dfs(v, min(fin, e[i].c));\n            fin -= f, fout += f;\n            e[i].c -= f, e[i^1].c += f;\n        }\n    }\n    if (fout == 0) dep[u] = 0;\n    return fout;\n}\nint dinic() {\n    int flow = 0;\n    while (bfs()) {\n        copy(head, head+1+tot, cur);\n        flow += dfs(S, INF);\n    }\n    return flow;\n}\n</code></pre>"},{"location":"CP/templates/%E5%9B%BE%E8%AE%BA/#68","title":"6.8 \u8d39\u7528\u6d41","text":"<p>\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\uff0cSPFA+Dinic\u3002</p> <pre><code>constexpr int N = 5e3 + 5;\nconstexpr int M = 5e4 + 5;\nconstexpr int INF = 1e9;\nint n, m, S, T;\nstruct Edge {\n    int to, cap, cost, nex;\n} e[M*2];\nint head[N], cnt = 1, tot;\nvoid add_edge(int u, int v, int cap, int cost) {\n    e[++cnt] = {v, cap, cost, head[u]};\n    head[u] = cnt;\n}\nint dist[N], in[N];\nbool spfa() {\n    fill(dist, dist+1+tot, INF);\n    fill(in, in+1+tot, 0);\n    queue&lt;int&gt; q;\n    q.emplace(S); dist[S] = 0; in[S] = 1;\n    while (!q.empty()) {\n        int u = q.front(); q.pop(); in[u] = 0;\n        for (int i = head[u]; i; i = e[i].nex) {\n            int v = e[i].to;\n            if (dist[u] + e[i].cost &lt; dist[v] and e[i].cap) {\n                dist[v] = dist[u] + e[i].cost;\n                if (!in[v]) q.push(v), in[v] = 1;\n            }\n        }\n    }\n    return dist[T] != INF;\n}\nint cur[N];\nint dfs(int u, int fin) {\n    if (u == T) return fin;\n    int fout = 0;\n    in[u] = 1;\n    for (int &amp;i = cur[u]; i and fin; i = e[i].nex) {\n        int v = e[i].to;\n        if (!in[v] and dist[v] == dist[u] + e[i].cost and e[i].cap) {\n            int f = dfs(v, min(fin, e[i].cap));\n            fin -= f, fout += f;\n            e[i].cap -= f, e[i^1].cap += f;\n        }\n    }\n    in[u] = 0;\n    if (fout == 0) dist[u] = 0;\n    return fout;\n}\npair&lt;int, int&gt; dinic() {\n    int flow = 0, cost = 0;\n    while (spfa()) {\n        copy(head, head+1+tot, cur);\n        int f = dfs(S, INF);\n        flow += f, cost += f * dist[T];\n    }\n    return {flow, cost};\n}\n</code></pre>"},{"location":"CP/templates/%E5%A4%9A%E9%A1%B9%E5%BC%8F/","title":"4 \u591a\u9879\u5f0f","text":""},{"location":"CP/templates/%E5%A4%9A%E9%A1%B9%E5%BC%8F/#41-ntt","title":"4.1 NTT","text":"<p>init\u9700\u8981\u4f20\u5165\u5377\u79ef\u7684\u6700\u957f\u957f\u5ea6\uff0cN\u9700\u8981\u6bd4\u5927\u4e8e\u8fd9\u4e2a\u957f\u5ea6\u76842\u7684\u5e42\u66f4\u5927\u3002</p> <pre><code>#include &lt;bits/stdc++.h&gt;\n#define int long long\nusing namespace std;\nconstexpr int RN = 1e6 + 5;\nconstexpr int N = (1 &lt;&lt; (__lg(2 * RN) + 1)) + 5;\nconstexpr int p = 998244353;\ninline int add(const int &amp;x, const int &amp;y) { return x + y &gt;= p ? x + y - p : x + y; }\ninline int dec(const int &amp;x, const int &amp;y) { return x &lt; y ? x - y + p : x - y; }\n\ninline int power(int a, int t) {\n    int res = 1;\n    while (t) {\n        if (t &amp; 1) res = res * a % p;\n        a = a * a % p;\n        t &gt;&gt;= 1;\n    }\n    return res;\n}\n\nint siz;\nint rev[N], rt[N], inv[N], fac[N], ifac[N];\n\nvoid init(int n) {  // \u4f20\u5165\u6700\u957f\u5377\u79ef\u957f\u5ea6\n    int lim = 1;\n    while (lim &lt; n) lim &lt;&lt;= 1, ++siz;\n    for (int i = 0; i != lim; ++i) rev[i] = (rev[i &gt;&gt; 1] &gt;&gt; 1) | ((i &amp; 1) &lt;&lt; (siz - 1));\n    int w = power(3, (p - 1) &gt;&gt; siz);\n    fac[0] = ifac[0] = rt[lim &gt;&gt; 1] = 1;\n    for (int i = (lim &gt;&gt; 1) + 1; i != lim; ++i) rt[i] = rt[i - 1] * w % p;\n    for (int i = (lim &gt;&gt; 1) - 1; i; --i) rt[i] = rt[i &lt;&lt; 1];\n\n    for (int i = 1; i &lt;= n; ++i) fac[i] = fac[i - 1] * i % p;\n    ifac[n] = power(fac[n], p - 2);\n    for (int i = n - 1; i; --i) ifac[i] = ifac[i + 1] * (i + 1) % p;\n    for (int i = 1; i &lt;= n; ++i) inv[i] = fac[i - 1] * ifac[i] % p;\n}\n\ninline void dft(int *f, int n) {\n    static unsigned long long a[N];\n    int x, shift = siz - __builtin_ctz(n);\n    for (int i = 0; i != n; ++i) a[rev[i] &gt;&gt; shift] = f[i];\n    for (int mid = 1; mid != n; mid &lt;&lt;= 1)\n        for (int j = 0; j != n; j += (mid &lt;&lt; 1))\n            for (int k = 0; k != mid; ++k) {\n                x = a[j | k | mid] * rt[mid | k] % p;\n                a[j | k | mid] = a[j | k] + p - x;\n                a[j | k] += x;\n            }\n    for (int i = 0; i != n; ++i) f[i] = a[i] % p;\n}\n\ninline void idft(int *f, int n) {\n    reverse(f + 1, f + n);\n    dft(f, n);\n    int x = p - ((p - 1) &gt;&gt; __builtin_ctz(n));\n    for (int i = 0; i != n; ++i) f[i] = f[i] * x % p;\n}\n\ninline void conv(int *f, int fn, int *g, int gn, int *r) {\n    int len = fn + gn - 1, lim = 1;\n    while (lim &lt; len) lim &lt;&lt;= 1;\n    dft(f, lim);\n    dft(g, lim);\n    for (int i = 0; i &lt; lim; ++i) r[i] = f[i] * g[i] % p;\n    idft(r, lim);\n}\n\ninline int getlen(int n) { return 1 &lt;&lt; (32 - __builtin_clz(n)); }\n\ninline void inverse(const int *f, int n, int *r) {\n    static int g[N], h[N], st[30];\n    memset(g, 0, getlen(n &lt;&lt; 1) * sizeof(int));\n    int lim = 1, top = 0;\n    while (n) {\n        st[++top] = n;\n        n &gt;&gt;= 1;\n    }\n    g[0] = 1;\n    while (top--) {\n        n = st[top + 1];\n        while (lim &lt;= (n &lt;&lt; 1)) lim &lt;&lt;= 1;\n        memcpy(h, f, (n + 1) * sizeof(int));\n        memset(h + n + 1, 0, (lim - n) * sizeof(int));\n        dft(g, lim), dft(h, lim);\n        for (int i = 0; i != lim; ++i) g[i] = g[i] * (2 - g[i] * h[i] % p + p) % p;\n        idft(g, lim);\n        memset(g + n + 1, 0, (lim - n) * sizeof(int));\n    }\n    memcpy(r, g, (n + 1) * sizeof(int));\n}\n\ninline void log(const int *f, int n, int *r) {\n    static int g[N], h[N];\n    inverse(f, n, g);\n    for (int i = 0; i != n; ++i) h[i] = f[i + 1] * (i + 1) % p;\n    h[n] = 0;\n    int lim = getlen(n &lt;&lt; 1);\n    memset(g + n + 1, 0, (lim - n) * sizeof(int));\n    memset(h + n + 1, 0, (lim - n) * sizeof(int));\n    dft(g, lim), dft(h, lim);\n    for (int i = 0; i != lim; ++i) g[i] = g[i] * h[i] % p;\n    idft(g, lim);\n    for (int i = 1; i &lt;= n; ++i) r[i] = g[i - 1] * inv[i] % p;\n    r[0] = 0;\n}\n\ninline void exp(const int *f, int n, int *r) {\n    static int g[N], h[N], st[30];\n    memset(g, 0, getlen(n &lt;&lt; 1) * sizeof(int));\n    int lim = 1, top = 0;\n    while (n) {\n        st[++top] = n;\n        n &gt;&gt;= 1;\n    }\n    g[0] = 1;\n    while (top--) {\n        n = st[top + 1];\n        while (lim &lt;= (n &lt;&lt; 1)) lim &lt;&lt;= 1;\n        memcpy(h, g, (n + 1) * sizeof(int));\n        memset(h + n + 1, 0, (lim - n) * sizeof(int));\n        log(g, n, g);\n        for (int i = 0; i &lt;= n; ++i) g[i] = dec(f[i], g[i]);\n        g[0] = add(g[0], 1);\n        dft(g, lim), dft(h, lim);\n        for (int i = 0; i != lim; ++i) g[i] = g[i] * h[i] % p;\n        idft(g, lim);\n        memset(g + n + 1, 0, (lim - n) * sizeof(int));\n    }\n    memcpy(r, g, (n + 1) * sizeof(int));\n}\n</code></pre>"},{"location":"CP/templates/%E5%A4%9A%E9%A1%B9%E5%BC%8F/#42-fft","title":"4.2 FFT","text":"<p>\u4e09\u6b21\u53d8\u4e24\u6b21\u5377\u79ef\u3002</p> <pre><code>#include &lt;bits/stdc++.h\nusing namespace std;\nusing cp = complex&lt;double&gt;;\nusing vp = vector&lt;cp&gt;;\nusing vi = vector&lt;int&gt;;\nvi rev;    \nvoid init_rev(int limit) {\n    rev.resize(limit);\n    for (int i = 0; i &lt; limit; ++i) rev[i] = (rev[i / 2] / 2 + (i % 2) * limit / 2);\n}\nvoid FFT(vp &amp;x, int limit, bool inv = false) {\n    for (int i = 0; i &lt; limit; ++i)\n        if (i &lt; rev[i]) swap(x[i], x[rev[i]]);\n    for (int len = 1; len &lt; limit; len &lt;&lt;= 1) {\n        cp wn(cos(PI / len), (-2 * inv + 1) * sin(PI / len));\n        for (int i = 0; i &lt; limit; i += 2 * len) {\n            cp w(1);\n            for (int j = i; j &lt; i + len; j++, w *= wn) {\n                cp u = x[j], v = w * x[j + len];\n                x[j] = u + v, x[j + len] = u - v;\n            }\n        }\n    }\n    if (!inv) return;\n    for (auto &amp;i : x) i /= limit;\n}\nvi operator*(const vi &amp;a, const vi &amp;b) {\n    int len = a.size() + b.size() - 1;\n    int limit = 1LL &lt;&lt; __lg(len);\n    if (limit &lt; len) limit &lt;&lt;= 1;\n    init_rev(limit);\n    vp c(limit);\n    for (size_t i = 0; i &lt; limit; i++) {\n        c[i] = (double)(i&lt;a.size() ? a[i] : 0LL) + I * (double)(i&lt;b.size() ? b[i] : 0LL);\n    }\n    FFT(c, limit);\n    for (int i = 0; i &lt; limit; ++i) c[i] = c[i] * c[i];\n    FFT(c, limit, true);\n    vi res(len);\n    for (size_t i = 0; i &lt; len; i++) {\n        res[i] = (int)(0.5 * c[i].imag() + 0.5);\n    }\n    return res;\n}\n</code></pre>"},{"location":"CP/templates/%E5%AD%97%E7%AC%A6%E4%B8%B2/","title":"9 \u5b57\u7b26\u4e32","text":""},{"location":"CP/templates/%E5%AD%97%E7%AC%A6%E4%B8%B2/#91","title":"9.1 \u5b57\u7b26\u4e32\u54c8\u5e0c","text":"<pre><code>constexpr int MOD = 1610612741;  // 212370440130137957LL \u8fd9\u4e2a\u6570\u867d\u5927\u4f46\u662f\u4e58\u6cd5\u4f1a\u6ea2\u51fa\nconstexpr int base = 131;\n\n// \u5355\u54c8\u5e0c\u6cd5\u83b7\u5f97\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u54c8\u5e0c\u503c\null getHash(string &amp;s) {\n    ull res = 0;\n    for (int i = 0; i &lt; s.length(); i++) {\n        res = (base * res + (ull)s[i]) % MOD;\n    }\n    return res;\n}\n</code></pre>"},{"location":"CP/templates/%E5%AD%97%E7%AC%A6%E4%B8%B2/#92","title":"9.2 \u533a\u95f4\u56de\u6587\u67e5\u8be2","text":"<p>\u4f9d\u9760\u5b57\u7b26\u4e32\u54c8\u5e0c\u503c\u7684\u524d\u7f00\u548c\u4e0e\u540e\u7f00\u548c</p> <pre><code>using ull = unsigned long long;\nconstexpr int MAXN = 2E5 + 5;\nconstexpr ull MOD = 1610612741;\nconstexpr ull base = 131;\nclass MyStr {\n   private:\n    int n;\n    char s[MAXN];\n    ull pre[MAXN], suf[MAXN];\n    void init() {\n        pwb[0] = 1;\n        for (int i = 1; i &lt; MAXN; i++) {\n            pwb[i] = pwb[i - 1] * base % MOD;\n        }\n    }\n    ull hashL(int l, int r) { return (pre[r] - pre[l - 1] * pwb[r - l + 1] % MOD + MOD) % MOD; }\n    ull hashR(int l, int r) { return (suf[l] - suf[r + 1] * pwb[r - l + 1] % MOD + MOD) % MOD; }\n\n   public:\n    ull pwb[MAXN];  // power of base : pwb[i]\u5373base\u7684i\u6b21\u5e42\n    MyStr() { init(); }\n    // \u5efa\u7acb\u54c8\u5e0c\uff0c\u6bcf\u6b21\u8bfb\u5165\u65b0\u7684\u5b57\u7b26\u4e32\u5c31\u8981\u8c03\u7528\u4e00\u4e0b\u4ee5\u66f4\u65b0\u54c8\u5e0c\u503c\n    void build(int n, char str[]) {\n        pre[0] = suf[n + 1] = 0;\n        for (int i = 1; i &lt;= n; i++) {\n            int j = n - i + 1;\n            pre[i] = (pre[i - 1] * base + (ull)str[i]) % MOD;\n            suf[j] = (suf[j + 1] * base + (ull)str[j]) % MOD;\n        }\n    }\n    // \u5224\u65ad[l, r]\u5b50\u4e32\u662f\u5426\u662f\u56de\u6587\n    bool isPalindrome(int l, int r) {\n        ull lef = hashL(l, r);\n        ull rig = hashR(l, r);\n        return lef == rig;\n    }\n} my_str;\n</code></pre>"},{"location":"CP/templates/%E5%AD%97%E7%AC%A6%E4%B8%B2/#93-kmp","title":"9.3 KMP\u7b97\u6cd5","text":"<pre><code>vector&lt;int&gt; GetPre(string &amp;s){\n    int n = s.length();\n    vector&lt;int&gt; nxt(n, 0);\n    int j = 0;\n    for(int i = 1; i &lt; n; i++){\n        j = nxt[i - 1];\n        while(j &gt; 0 &amp;&amp; s[i] != s[j]){\n            j = nxt[j - 1];//\u4e0a\u4e00\u9879\u7684\u524d\u540e\u7f00\u521a\u597d\u4e0d\u7b49\u5904\n        }\n        if(s[i] == s[j]) j++;\n        nxt[i] = j;\n    }\n    return move(nxt);\n}\n\n\nvector&lt;int&gt; KMP(string &amp;s, string &amp;patt){\n    int siz1 = s.size(), siz2 = patt.size();\n    string temp = patt + \"!\" + s;\n    vector&lt;int&gt; nxt = GetPre(temp), ans;\n\n    for(int i = 2 * siz2 - 1; i &lt; nxt.size(); i++){\n        if(nxt[i] == siz2){\n            ans.push_back(i - 2 * siz2);\n        }\n    }\n    return move(ans);\n}\n</code></pre>"},{"location":"CP/templates/%E5%AD%97%E7%AC%A6%E4%B8%B2/#94-manacher","title":"9.4 Manacher\u7b97\u6cd5","text":"<p>\u8ba1\u7b97\u5b57\u7b26\u4e32\u7684\u6700\u957f\u56de\u6587\u5b50\u4e32\u957f\u5ea6\u3002\u7ebf\u6027dp\uff0c\u4ece\u5bf9\u79f0\u4e2d\u5fc3\u5411\u4e24\u8fb9\u6269\u5c55\u3002</p> <pre><code>int manacher(string &amp;s) {\n    string t = \"^ \";\n    for (auto c : s) t += c, t += \" \";\n    t += \"!\";\n    int n = (int)t.size();\n    vector&lt;int&gt; p(n, 0);\n    int c = 0, r = 0; // c\u4e3a\u5f53\u524d\u4e2d\u5fc3\uff0cr\u4e3a\u5f53\u524d\u4e2d\u5fc3\u7684\u6700\u53f3\u8fb9\u754c\n    for (int i = 1; i &lt; n - 1; ++i) {\n        if (i &lt;= r) p[i] = min(r - i, p[2*c - i]);\n        while (t[i - p[i] - 1] == t[i + p[i] + 1]) p[i]++;\n        if (i + p[i] &gt; r) r = i + p[i], c = i;\n    }\n    return *max_element(p.begin(), p.end());\n}\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/","title":"8 \u6570\u636e\u7ed3\u6784","text":""},{"location":"CP/templates/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#81","title":"8.1 \u6269\u5c55\u6811\u72b6\u6570\u7ec4","text":"<p>\u6ce8\u610f\uff0c\u88ab\u67e5\u8be2\u7684\u503c\u90fd\u5e94\u8be5\u5c0f\u4e8e\u7b49\u4e8e \\(N\\) \uff0c\u5426\u5219\u4f1a\u8d8a\u754c\uff1b\u5982\u679c\u79bb\u6563\u5316\u4e0d\u53ef\u4f7f\u7528\uff0c\u5219\u9700\u8981\u4f7f\u7528\u5e73\u8861\u6811\u66ff\u4ee3\u3002</p> <pre><code>struct BIT {\n    int n;\n    vector&lt;int&gt; w;\n    BIT(int n) : n(n), w(n + 1) {}\n    void add(int x, int v) {\n        for (; x &lt;= n; x += x &amp; -x) {\n            w[x] += v;\n        }\n    }\n    int kth(int x) { // \u67e5\u627e\u7b2c k \u5c0f\u7684\u503c\n        int ans = 0;\n        for (int i = __lg(n); i &gt;= 0; i--) {\n            int val = ans + (1 &lt;&lt; i);\n            if (val &lt; n &amp;&amp; w[val] &lt; x) {\n                x -= w[val];\n                ans = val;\n            }\n        }\n        return ans + 1;\n    }\n    int get(int x) { // \u67e5\u627e x \u7684\u6392\u540d\n        int ans = 1;\n        for (x--; x; x -= x &amp; -x) {\n            ans += w[x];\n        }\n        return ans;\n    }\n    int pre(int x) { return kth(get(x) - 1); } // \u67e5\u627e x \u7684\u524d\u9a71\n    int suf(int x) { return kth(get(x + 1)); } // \u67e5\u627e x \u7684\u540e\u7ee7\n};\nconst int N = 10000000; // \u53ef\u4ee5\u7528\u4e8e\u5728\u7ebf\u5904\u7406\u5e73\u8861\u4e8c\u53c9\u6811\u7684\u5168\u90e8\u8981\u6c42\nsigned main() {\n    BIT bit(N + 1); // \u5728\u7ebf\u5904\u7406\u4e0d\u80fd\u591f\u79bb\u6563\u5316\uff0c\u4e00\u5b9a\u8981\u5f00\u5230\u6bd4\u6700\u5927\u503c\u66f4\u5927\n    int n;\n    cin &gt;&gt; n;\n    for (int i = 1; i &lt;= n; i++) {\n        int op, x;\n        cin &gt;&gt; op &gt;&gt; x;\n        if (op == 1) bit.add(x, 1); // \u63d2\u5165 x\n        else if (op == 2) bit.add(x, -1); // \u5220\u9664\u4efb\u610f\u4e00\u4e2a x\n        else if (op == 3) cout &lt;&lt; bit.get(x) &lt;&lt; \"\\n\"; // \u67e5\u8be2 x \u7684\u6392\u540d\n        else if (op == 4) cout &lt;&lt; bit.kth(x) &lt;&lt; \"\\n\"; // \u67e5\u8be2\u6392\u540d\u4e3a x \u7684\u6570\n        else if (op == 5) cout &lt;&lt; bit.pre(x) &lt;&lt; \"\\n\"; // \u6c42\u5c0f\u4e8e x \u7684\u6700\u5927\u503c\uff08\u524d\u9a71\uff09\n        else if (op == 6) cout &lt;&lt; bit.suf(x) &lt;&lt; \"\\n\"; // \u6c42\u5927\u4e8e x \u7684\u6700\u5c0f\u503c\uff08\u540e\u7ee7\uff09\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#82","title":"8.2 \u53ef\u6301\u4e45\u5316\u7ebf\u6bb5\u6811\uff08\u4e3b\u5e2d\u6811\uff09","text":"<p>\u5355\u70b9\u6539\uff0c\u5355\u70b9\u67e5\u3002</p> <pre><code>#include &lt;bits/stdc++.h&gt;\n#define int long long\n#define mid ((l+r)&gt;&gt;1)\nusing namespace std;\nconstexpr int N = 1e6 + 5;\nconstexpr int M = 25 * N;\nint a[N], n, m;\nint ls[M], rs[M], val[M];\nint root[N], tot;\nvoid build(int &amp;u, int l, int r) {\n    u = ++tot;\n    if (l == r) {\n        val[u] = a[l];\n        return;\n    }\n    build(ls[u], l, mid);\n    build(rs[u], mid+1, r);\n}\nvoid change(int &amp;u, int v, int l, int r, int p, int c) {\n    u = ++tot;\n    ls[u] = ls[v], rs[u] = rs[v], val[u] = val[v];\n    if (l == r) {\n        val[u] = c;\n        return;\n    }\n    if (p &lt;= mid) change(ls[u], ls[v], l, mid, p, c);\n    else change(rs[u], rs[v], mid+1, r, p, c);\n}\nint query(int u, int l, int r, int p) {\n    if (l == r) return val[u];\n    if (p &lt;= mid) return query(ls[u], l, mid, p);\n    else return query(rs[u], mid+1, r, p);\n}\nsigned main() {\n    ios::sync_with_stdio(false), cin.tie(nullptr);\n    cin &gt;&gt; n &gt;&gt; m;\n    for (int i = 1; i &lt;= n; i++) {\n        cin &gt;&gt; a[i];\n    }\n    build(root[0], 1, n);\n    for (int i = 1; i &lt;= m; i++) {\n        int v, op, p, c;\n        cin &gt;&gt; v &gt;&gt; op &gt;&gt; p;\n        if (op == 1) {\n            cin &gt;&gt; c;\n            change(root[i], root[v], 1, n, p, c);\n        } else if (op == 2) {\n            root[i] = root[v];\n            cout &lt;&lt; query(root[i], 1, n, p) &lt;&lt; \"\\n\";\n        }\n    }\n}\n</code></pre> <p>\u5355\u70b9\u6539\uff0c\u4e8c\u5206\u67e5\uff08\u9759\u6001\u533a\u95f4\u7b2ck\u5c0f\uff09</p> <pre><code>#include &lt;bits/stdc++.h&gt;\n#define int long long\n#define ls(u) w[u].l\n#define rs(u) w[u].r\n#define mid ((l+r)&gt;&gt;1)\nusing namespace std;\nconstexpr int N = 1e6 + 5;\nint n, m, a[N], b[N];\nstruct Node {\n    int l, r, sum;\n} w[N*25];\nint root[N], tot;\nvoid pushup(int u) {\n    w[u].sum = w[ls(u)].sum + w[rs(u)].sum;\n}\nvoid change(int &amp;u, int v, int l, int r, int p) {\n    u = ++tot;\n    w[u] = w[v];\n    if (l == r) {\n        w[u].sum++;\n        return;\n    }\n    if (p &lt;= mid) change(ls(u), ls(v), l, mid, p);\n    else change(rs(u), rs(v), mid+1, r, p);\n    pushup(u);\n}\nint query(int L, int R, int l, int r, int k) {\n    int sum = w[ls(R)].sum - w[ls(L)].sum;\n    if (l == r) return l;\n    if (sum &gt;= k) return query(ls(L), ls(R), l, mid, k);\n    else return query(rs(L), rs(R), mid+1, r, k - sum);\n}\nsigned main() {\n    ios::sync_with_stdio(false), cin.tie(nullptr);\n    cin &gt;&gt; n &gt;&gt; m;\n    for (int i = 1; i &lt;= n; i++) {\n        cin &gt;&gt; a[i];\n        b[i] = a[i];\n    }\n    sort(b+1,b+1+n);\n    auto ed = unique(b+1,b+1+n);\n    for (int i = 1; i &lt;= n; i++) {\n        int t = lower_bound(b+1,ed,a[i]) - b;\n        // cerr &lt;&lt; t &lt;&lt; \" \";\n        change(root[i], root[i-1], 1, n, t);\n    }\n    // cerr &lt;&lt; \"\\n\";\n    for (int i = 1; i &lt;= m; i++) {\n        int L, R, k;\n        cin &gt;&gt; L &gt;&gt; R &gt;&gt; k;\n        int idx = query(root[L-1], root[R], 1, n, k);\n        // cerr &lt;&lt; idx &lt;&lt; \"\\n\";\n        cout &lt;&lt; b[idx] &lt;&lt; \"\\n\";\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#83-by-jiangly","title":"8.3 \u91cd\u94fe\u5256\u5206 (by Jiangly)","text":"<pre><code>struct HLD {\n    int n;\n    vector&lt;int&gt; siz, top, dep, parent, in, out, seq;\n    vector&lt;vector&lt;int&gt;&gt; adj;\n    int cur;\n\n    HLD() {}\n    HLD(int n) {\n        init(n);\n    }\n    void init(int n) {\n        this-&gt;n = n;\n        siz.resize(n);\n        top.resize(n);\n        dep.resize(n);\n        parent.resize(n);\n        in.resize(n);\n        out.resize(n);\n        seq.resize(n);\n        cur = 0;\n        adj.assign(n, {});\n    }\n    void addEdge(int u, int v) {\n        adj[u].push_back(v);\n        adj[v].push_back(u);\n    }\n    void work(int root = 0) {\n        top[root] = root;\n        dep[root] = 0;\n        parent[root] = -1;\n        dfs1(root);\n        dfs2(root);\n    }\n    void dfs1(int u) {\n        if (parent[u] != -1) {\n            adj[u].erase(find(adj[u].begin(), adj[u].end(), parent[u]));\n        }\n\n        siz[u] = 1;\n        for (auto &amp;v : adj[u]) {\n            parent[v] = u;\n            dep[v] = dep[u] + 1;\n            dfs1(v);\n            siz[u] += siz[v];\n            if (siz[v] &gt; siz[adj[u][0]]) {\n                swap(v, adj[u][0]);\n            }\n        }\n    }\n    void dfs2(int u) {\n        in[u] = cur++;\n        seq[in[u]] = u;\n        for (auto v : adj[u]) {\n            top[v] = v == adj[u][0] ? top[u] : v;\n            dfs2(v);\n        }\n        out[u] = cur;\n    }\n    int lca(int u, int v) {\n        while (top[u] != top[v]) {\n            if (dep[top[u]] &gt; dep[top[v]]) {\n                u = parent[top[u]];\n            } else {\n                v = parent[top[v]];\n            }\n        }\n        return dep[u] &lt; dep[v] ? u : v;\n    }\n\n    int dist(int u, int v) {\n        return dep[u] + dep[v] - 2 * dep[lca(u, v)];\n    }\n\n    int jump(int u, int k) {\n        if (dep[u] &lt; k) {\n            return -1;\n        }\n\n        int d = dep[u] - k;\n\n        while (dep[top[u]] &gt; d) {\n            u = parent[top[u]];\n        }\n\n        return seq[in[u] - dep[u] + d];\n    }\n\n    bool isAncester(int u, int v) {\n        return in[u] &lt;= in[v] &amp;&amp; in[v] &lt; out[u];\n    }\n\n    int rootedParent(int u, int v) {\n        swap(u, v);\n        if (u == v) {\n            return u;\n        }\n        if (!isAncester(u, v)) {\n            return parent[u];\n        }\n        auto it = upper_bound(adj[u].begin(), adj[u].end(), v, [&amp;](int x, int y) {\n            return in[x] &lt; in[y];\n        }) - 1;\n        return *it;\n    }\n\n    int rootedSize(int u, int v) {\n        if (u == v) {\n            return n;\n        }\n        if (!isAncester(v, u)) {\n            return siz[v];\n        }\n        return n - siz[rootedParent(u, v)];\n    }\n\n    int rootedLca(int a, int b, int c) {\n        return lca(a, b) ^ lca(b, c) ^ lca(c, a);\n    }\n};\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#84-st","title":"8.4 ST\u8868","text":"<pre><code>struct ST {\n    vector&lt;vector&lt;int&gt;&gt; st;\n    ST (const vector&lt;int&gt;&amp; arr) {\n        int n = arr.size();\n        st.assign(__lg(n) + 1, vector&lt;int&gt;(n)); // \u7ef4\u5ea6\u5c0f\u7684\u653e\u524d\u9762\n        for (int i = 0; i &lt; n; ++i) st[0][i] = arr[i];\n        for (int j = 1; 1 &lt;&lt; j &lt;= n; ++j) {\n            for (int i = 0; i + (1 &lt;&lt; j) &lt;= n; ++i) {\n                st[j][i] = max(st[j - 1][i], st[j - 1][i + (1 &lt;&lt; (j - 1))]);\n            }\n        }\n    }\n    int query(int l, int r) { // [l, r]\n        int k = __lg(r - l + 1);\n        return max(st[k][l], st[k][r - (1 &lt;&lt; k) + 1]);\n    }\n};\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#85-trie","title":"8.5 \u5b57\u5178\u6811 Trie","text":"<p>\u5b57\u7b26\u4e32\u7684\u63d2\u5165\u548c\u67e5\u8be2\uff0c01\u5b57\u5178\u6811\u7ef4\u62a4\u5f02\u6216\u6781\u503c</p> <pre><code>class Trie\n{\nprivate:\n    int amount;\n    vector&lt;vector&lt;int&gt;&gt; son;\n    vector&lt;int&gt; cnt, prefix_cnt;\n    // flag\u4e3atrue\u8868\u793a \u67e5\u8be2\u8be5\u5b57\u7b26\u4e32\u6570\u91cf\n    // flag\u4e3afalse\u8868\u793a \u67e5\u8be2\u4ee5\u8be5\u5b57\u7b26\u4e32\u4e3a\u524d\u7f00\u7684\u5b57\u7b26\u4e32\u7684\u6570\u91cf\n    int query(const string &amp;str, bool flag)\n    {\n        int p = 0, image;\n        for (auto ch : str)\n        {\n            image = f(ch);\n            if (!son[p][image])\n                return 0;\n            p = son[p][image];\n        }\n        return flag ? cnt[p] : prefix_cnt[p];\n    }\n    function&lt;int(char)&gt; f;\n\npublic:\n    // f\u7684\u8fd4\u56de\u503c\u5e94\u8be5\u5728[0, n)\u8303\u56f4\u5185\n    Trie(function&lt;int(char)&gt; function, int n) : son(1, vector&lt;int&gt;(n)), cnt(1), prefix_cnt(1) { f = function, amount = n; }\n    void insert(const string &amp;str)\n    {\n        int p = 0, image;\n        for (auto ch : str)\n        {\n            image = f(ch);\n            if (!son[p][image])\n            {\n                son[p][image] = son.size();\n                vector&lt;int&gt; temp(amount);\n                son.push_back(temp), cnt.push_back(0), prefix_cnt.push_back(0);\n            }\n            p = son[p][image];\n            prefix_cnt[p]++;\n        }\n        cnt[p]++;\n    }\n    int queryAmount(const string &amp;str) { return query(str, true); }\n    int queryPrefixAmount(const string &amp;str) { return query(str, false); }\n};\n\nint f(char ch)\n{\n    if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'z')\n        return ch - 'a';\n    else if (ch &gt;= 'A' &amp;&amp; ch &lt;= 'Z')\n        return ch - 'A' + 26;\n    assert(ch &gt;= '0' &amp;&amp; ch &lt;= '9');\n    return ch - '0' + 52;\n}\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#86","title":"8.6 \u6839\u53f7\u5206\u5757","text":"<pre><code>struct Sqrt {\n    int block_size;\n    vector&lt;int&gt; nums;\n    vector&lt;long long&gt; blocks;\n    Sqrt(int sqrtn, vector&lt;int&gt; &amp;arr) : block_size(sqrtn), blocks(sqrtn, 0) {\n        nums = arr;\n        for (int i = 0; i &lt; nums.size(); i++) { blocks[i / block_size] += nums[i]; }\n    }\n\n    /** O(1) update to set nums[x] to v */\n    void update(int x, int v) {\n        blocks[x / block_size] -= nums[x];\n        nums[x] = v;\n        blocks[x / block_size] += nums[x];\n    }\n\n    /** O(sqrt(n)) query for sum of [0, r) */\n    long long query(int r) {\n        long long res = 0;\n        for (int i = 0; i &lt; r / block_size; i++) { res += blocks[i]; }\n        for (int i = (r / block_size) * block_size; i &lt; r; i++) { res += nums[i]; }\n        return res;\n    }\n\n    /** O(sqrt(n)) query for sum of [l, r) */\n    long long query(int l, int r) { return query(r) - query(l - 1); }\n};\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#87","title":"8.7 \u83ab\u961f","text":"<p>\u5982\u679c\u4fee\u6539\u53ef\u4ee5\u505a\u5230 \\(O(1)\\) \u5e76\u4e14\u53ef\u4ee5\u79bb\u7ebf\u67e5\u8be2\u7684\u8bdd\u53ef\u4ee5\u8003\u8651\uff0c\u590d\u6742\u5ea6 \\(O(n \\sqrt n)\\)</p> <pre><code>// \u8be2\u95ee\u533a\u95f4\u5185\u6709\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u6570\nint cmp(query a, query b) {\n    return (belong[a.l] ^ belong[b.l]) ? belong[a.l] &lt; belong[b.l] : \n    ((belong[a.l] &amp; 1) ? a.r &lt; b.r : a.r &gt; b.r);\n}\nvoid add(int pos) {\n    if(!cnt[aa[pos]]) ++now;\n    ++cnt[aa[pos]];\n}\nvoid del(int pos) {\n    --cnt[aa[pos]];\n    if(!cnt[aa[pos]]) --now;\n}\nsort(q + 1, q + m + 1, cmp);\nint l = 1, r = 0;\nfor(int i = 1; i &lt;= q; ++i) {//\u5bf9\u4e8e\u6bcf\u6b21\u8be2\u95ee\n        int ql, qr;\n        scanf(\"%d%d\", &amp;ql, &amp;qr);//\u8f93\u5165\u8be2\u95ee\u7684\u533a\u95f4\n        while(l &lt; ql) del(l++);//\u5982\u5de6\u6307\u9488\u5728\u67e5\u8be2\u533a\u95f4\u5de6\u65b9\uff0c\u5de6\u6307\u9488\u5411\u53f3\u79fb\u76f4\u5230\u4e0e\u67e5\u8be2\u533a\u95f4\u5de6\u7aef\u70b9\u91cd\u5408\n        while(l &gt; ql) add(--l);//\u5982\u5de6\u6307\u9488\u5728\u67e5\u8be2\u533a\u95f4\u5de6\u7aef\u70b9\u53f3\u65b9\uff0c\u5de6\u6307\u9488\u5de6\u79fb\n        while(r &lt; qr) add(++r);//\u53f3\u6307\u9488\u5728\u67e5\u8be2\u533a\u95f4\u53f3\u7aef\u70b9\u5de6\u65b9\uff0c\u53f3\u6307\u9488\u53f3\u79fb\n        while(r &gt; qr) del(r--);//\u5426\u5219\u5de6\u79fb\n        printf(\"%d\\n\", now);//\u8f93\u51fa\u7edf\u8ba1\u7ed3\u679c\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#88","title":"8.8 \u7b1b\u5361\u5c14\u6811","text":"<p>\u8fd9\u662f\u4e00\u79cd\u952e\u6ee1\u8db3\u5e73\u8861\u4e8c\u53c9\u6811\u6027\u8d28\uff0c\u503c\u6ee1\u8db3\u5806\u6027\u8d28\u7684\u4e8c\u53c9\u6811\uff0c\u7528\u4e8e\u67d0\u4e9b\u5e8f\u5217\u4e0a\u7684\u8ba1\u6570\u95ee\u9898\u3002</p> <pre><code>int stk[N], tp;\nint p[N], ls[N], rs[N], n;\nvoid build_tree() { // \u5c0f\u6839\u5806\n    for (int i = 1; i &lt;= n; i++) {\n        int j = 0;\n        while (tp and p[stk[tp]] &gt; p[i]) j = stk[tp--];\n        ls[i] = j;\n        if (tp) rs[stk[tp]] = i;\n        stk[++tp] = i;\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#89-by-jiangly","title":"8.9 \u53ef\u64a4\u9500\u5e76\u67e5\u96c6 (by Jiangly)","text":"<p>\u653e\u5f03\u8def\u5f84\u538b\u7f29\uff0c\u4fdd\u7559\u6309\u79e9\u5408\u5e76\u3002find\u590d\u6742\u5ea6\u4e3a \\(O(\\log n)\\)\uff0c\u56de\u6eafrevert\u590d\u6742\u5ea6\u4e3a \\(O(k)\\)\u3002\u7528\u4e8e\u7ebf\u6bb5\u6811\u5206\u6cbb\u3002</p> <pre><code>struct DSU {O(k)\n    vector&lt;int&gt; siz;\n    vector&lt;int&gt; f;\n    vector&lt;array&lt;int, 2&gt;&gt; his;\n\n    DSU(int n) : siz(n + 1, 1), f(n + 1) {\n        iota(f.begin(), f.end(), 0);\n    }\n\n    int find(int x) {\n        while (f[x] != x) {\n            x = f[x];\n        }\n        return x;\n    }\n\n    bool merge(int x, int y) {\n        x = find(x);\n        y = find(y);\n        if (x == y) {\n            return false;\n        }\n        if (siz[x] &lt; siz[y]) {\n            swap(x, y);\n        }\n        his.push_back({x, y});\n        siz[x] += siz[y];\n        f[y] = x;\n        return true;\n    }\n\n    int time() {\n        return his.size();\n    }\n\n    void revert(int tm) {\n        while (his.size() &gt; tm) {\n            auto [x, y] = his.back();\n            his.pop_back();\n            f[y] = y;\n            siz[x] -= siz[y];\n        }\n    }\n};\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#810","title":"8.10 \u674e\u8d85\u7ebf\u6bb5\u6811","text":"<p>\u63d2\u5165\u7ebf\u6bb5\uff0c\u67e5\u8be2\u67d0\u4e00\u70b9\u5904\u7684\u6700\u5c0f\u503c\u3002</p> <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\nusing ll = long long;\n\nconst ll INF_LL = (ll)4e18;     // \u7528\u4f5c\u201c\u6b63\u65e0\u7a77\u201d\uff0c\u6700\u5c0f\u503c\u6a21\u677f\u4f7f\u7528\u6b63\u65e0\u7a77\u4f5c\u4e3a\u5360\u4f4d\nconst ll X_L = -1000000000LL;   // \u67e5\u8be2 x \u7684\u5de6\u7aef\u70b9\uff08\u6839\u636e\u9898\u610f\u8c03\u6574\uff09\nconst ll X_R =  1000000000LL;   // \u67e5\u8be2 x \u7684\u53f3\u7aef\u70b9\uff08\u6839\u636e\u9898\u610f\u8c03\u6574\uff09\n\n// -----------------\n// \u7ebf\uff1a y = m*x + b\n// -----------------\nstruct Line {\n    ll m, b;\n    // \u9ed8\u8ba4\u6784\u9020\u4f7f\u7528 b = +INF\uff08\u6700\u5c0f\u503c\u6a21\u677f\uff09\n    Line(ll _m = 0, ll _b = INF_LL) : m(_m), b(_b) {}\n\n    // \u8bc4\u4f30\u51fd\u6570\uff0c\u7528 __int128 \u9632\u6b62\u6ea2\u51fa\n    ll eval(ll x) const {\n        __int128 t = (__int128)m * x + (__int128)b;\n        if (t &gt; (__int128)INF_LL) return INF_LL;\n        if (t &lt; -(__int128)INF_LL) return -INF_LL;\n        return (ll)t;\n    }\n};\n\n/* =============================\n   \u8282\u70b9\u7ed3\u6784\u4e0e\u6839\u6307\u9488\uff08\u52a8\u6001\u8282\u70b9\uff09\n   ============================= */\nstruct Node {\n    Line ln;\n    Node *l = nullptr, *r = nullptr;\n    Node(const Line&amp; _ln) : ln(_ln), l(nullptr), r(nullptr) {}\n};\n\nNode* root = nullptr;\n\n// -----------------\n// \u5728\u533a\u95f4 [l,r] \u7684\u5b50\u6811 node \u4e2d\u63d2\u5165\u4e00\u6761\u7ebf\uff08\u5168\u57df/\u6bb5\u63d2\u5165\u4f1a\u8c03\u7528\u5b83\uff09\n// \u6700\u5c0f\u503c\u7248\uff1a\u6bd4\u8f83\u4f7f\u7528 '&lt;'\n// -----------------\nvoid add_line(Line nw, Node*&amp; node, ll l = X_L, ll r = X_R){\n    if (!node){\n        node = new Node(nw);\n        return;\n    }\n    ll mid = (l + r) &gt;&gt; 1;\n    // ---------- \u5982\u679c\u8981\u6539\u6210\u6700\u5927\u503c\u7248\uff1a\u628a\u4e0b\u9762\u4e24\u5904 '&lt;' \u6539\u4e3a '&gt;' ----------\n    bool lef = nw.eval(l) &lt; node-&gt;ln.eval(l);    // &lt;-- change '&lt;' -&gt; '&gt;' for max\n    bool m   = nw.eval(mid) &lt; node-&gt;ln.eval(mid); // &lt;-- change '&lt;' -&gt; '&gt;' for max\n    // --------------------------------------------------------------------\n    if (m) swap(nw, node-&gt;ln);\n    if (l == r) return;\n    if (lef != m) add_line(nw, node-&gt;l, l, mid);\n    else add_line(nw, node-&gt;r, mid + 1, r);\n}\n\n// wrapper\uff1a\u5168\u5c40\u63d2\u7ebf\ninline void add_line(Line ln){\n    add_line(ln, root, X_L, X_R);\n}\n\n// \u5728\u533a\u95f4 [Lq,Rq] \u4e0a\u63d2\u5165\u7ebf\u6bb5\uff08\u7ebf\u53ea\u5728\u8be5\u533a\u95f4\u751f\u6548\uff09\nvoid add_segment(Line nw, Node*&amp; node, ll Lq, ll Rq, ll l = X_L, ll r = X_R){\n    if (Rq &lt; l || r &lt; Lq) return;\n    if (Lq &lt;= l &amp;&amp; r &lt;= Rq){\n        add_line(nw, node, l, r);\n        return;\n    }\n    ll mid = (l + r) &gt;&gt; 1;\n    // \u5360\u4f4d\u8282\u70b9\uff1a\u6700\u5c0f\u503c\u7248\u4f7f\u7528\u9ed8\u8ba4 Line(0, +INF)\n    if (!node) node = new Node(Line(0, INF_LL)); // &lt;-- \u5982\u679c\u6539\u4e3a\u6700\u5927\u503c\u7248\uff0c\u8fd9\u91cc\u8981\u628a INF_LL \u6362\u6210 NEG_INF\uff08\u89c1\u4e0b\uff09\n    add_segment(nw, node-&gt;l, Lq, Rq, l, mid);\n    add_segment(nw, node-&gt;r, Lq, Rq, mid + 1, r);\n}\ninline void add_segment(Line nw, ll Lq, ll Rq){\n    add_segment(nw, root, Lq, Rq, X_L, X_R);\n}\n\n// \u67e5\u8be2\u70b9 x \u7684\u6700\u5c0f\u503c\uff08\u82e5\u8282\u70b9\u4e3a\u7a7a\u8fd4\u56de INF\uff09\nll query(ll x, Node* node, ll l = X_L, ll r = X_R){\n    if (!node) return INF_LL; // &lt;-- \u5982\u679c\u6539\u4e3a\u6700\u5927\u503c\u7248\uff0c\u8fd9\u91cc\u8981\u8fd4\u56de NEG_INF\n    ll res = node-&gt;ln.eval(x);\n    if (l == r) return res;\n    ll mid = (l + r) &gt;&gt; 1;\n    if (x &lt;= mid) {\n        // ---------- \u6539\u4e3a\u6700\u5927\u503c\u65f6\u628a min -&gt; max ----------\n        return min(res, query(x, node-&gt;l, l, mid)); // &lt;-- change to max(...) for max-version\n    } else {\n        return min(res, query(x, node-&gt;r, mid + 1, r)); // &lt;-- change to max(...) for max-version\n    }\n}\ninline ll query(ll x){\n    return query(x, root, X_L, X_R);\n}\n\n// \u91ca\u653e\u6811\uff08\u82e5\u9700\u8981\uff09\nvoid clear_tree(Node* node){\n    if (!node) return;\n    clear_tree(node-&gt;l);\n    clear_tree(node-&gt;r);\n    delete node;\n}\n\n// -----------------\n// \u793a\u4f8b main\uff08\u6f14\u793a\u7528\u6cd5\uff09\n// -----------------\nint main(){\n    ios::sync_with_stdio(false);\n    cin.tie(nullptr);\n\n    // \u793a\u4f8b\uff1a\u63d2\u5165\u4e09\u6761\u76f4\u7ebf\uff08\u6700\u5c0f\u503c\u67e5\u8be2\uff09\n    add_line(Line(2, 3));    // y = 2x + 3\n    add_line(Line(-1, 10));  // y = -x + 10\n    add_line(Line(0, 5));    // y = 5\n\n    cout &lt;&lt; \"query(0) = \" &lt;&lt; query(0) &lt;&lt; \"\\n\";   // \u671f\u671b min(3,10,5) = 3\n    cout &lt;&lt; \"query(2) = \" &lt;&lt; query(2) &lt;&lt; \"\\n\";   // \u671f\u671b min(7,8,5) = 5\n    cout &lt;&lt; \"query(10) = \" &lt;&lt; query(10) &lt;&lt; \"\\n\"; // \u671f\u671b min(23,0,5) = 0\n\n    // \u5728\u533a\u95f4 [1, 5] \u63d2\u5165\u4e00\u6761\u53ea\u5728\u6b64\u533a\u95f4\u751f\u6548\u7684\u7ebf\n    add_segment(Line(-3, 50), 1, 5); // y = -3x + 50 \u5728 [1,5] \u6709\u6548\n    cout &lt;&lt; \"query(3) = \" &lt;&lt; query(3) &lt;&lt; \"\\n\";\n\n    // \u7a0b\u5e8f\u7ed3\u675f\u524d\u91ca\u653e\u5185\u5b58\uff08\u6bd4\u8d5b\u4e2d\u4e00\u822c\u4e0d\u9700\u8981\uff09\n    clear_tree(root);\n    root = nullptr;\n    return 0;\n}\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#811-fhq-treap","title":"8.11 \u5e73\u8861\u6811 fhq-Treap","text":""},{"location":"CP/templates/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#8111","title":"8.11.1 \u6309\u503c\u5206\u88c2","text":"<p>\u666e\u901a\u5e73\u8861\u6811\uff0c\u7ef4\u62a4\u96c6\u5408\u3002</p> <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\nmt19937 rnd(chrono::high_resolution_clock::now().time_since_epoch().count());\nstruct Treap {\n    static const int N = 2000000 + 5;\n    int ls[N], rs[N], key[N], val[N], siz[N], root = 0, tot = 0, T1, T2, T3;\n    int newNode(int v) {\n        int u = ++tot;\n        ls[u] = rs[u] = 0;\n        key[u] = rnd();\n        val[u] = v;\n        siz[u] = 1;\n        return u;\n    }\n    void push_up(int u) { siz[u] = siz[ls[u]] + siz[rs[u]] + 1; }\n    int merge(int x, int y) {\n        if (!x or !y) return x + y;\n        if (key[x] &gt; key[y]) {\n            rs[x] = merge(rs[x], y);\n            push_up(x);\n            return x;\n        } else {\n            ls[y] = merge(x, ls[y]);\n            push_up(y);\n            return y;\n        }\n    }\n    void split(int u, int v, int &amp;x, int &amp;y) {\n        if (!u) {\n            x = y = 0;\n            return;\n        }\n        if (val[u] &lt;= v) {\n            x = u;\n            split(rs[u], v, rs[u], y);\n        } else {\n            y = u;\n            split(ls[u], v, x, ls[u]);\n        }\n        push_up(u);\n    }\n    void insert(int v) {\n        split(root, v, T1, T2);\n        root = merge(merge(T1, newNode(v)), T2);\n    }\n    void erase(int v) {\n        split(root, v - 1, T1, T2);\n        split(T2, v, T2, T3);\n        root = merge(merge(T1, merge(ls[T2], rs[T2])), T3);\n    }\n    int rank(int v) {\n        split(root, v - 1, T1, T2);\n        int r = siz[T1] + 1;\n        root = merge(T1, T2);\n        return r;\n    }\n    int kth(int k) {\n        int u = root;\n        while (u) {\n            int s = siz[ls[u]] + 1;\n            if (k == s) break;\n            if (k &lt; s)\n                u = ls[u];\n            else\n                k -= s, u = rs[u];\n        }\n        return val[u];\n    }\n    int pre(int v) {\n        int u = root, best = INT_MIN;\n        while (u) {\n            if (val[u] &lt; v)\n                best = max(best, val[u]), u = rs[u];\n            else\n                u = ls[u];\n        }\n        return best;\n    }\n    int nex(int v) {\n        int u = root, best = INT_MAX;\n        while (u) {\n            if (val[u] &gt; v)\n                best = min(best, val[u]), u = ls[u];\n            else\n                u = rs[u];\n        }\n        return best;\n    }\n};\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#8112","title":"8.11.2 \u6309\u6392\u540d\u5206\u88c2","text":"<p>\u6587\u827a\u5e73\u8861\u6811\uff0c\u7ef4\u62a4\u5e8f\u5217\uff0c\u8fd9\u91cc\u7ed9\u51fa\u7684\u662f\u5b9e\u73b0\u5e8f\u5217\u7684\u533a\u95f4\u7ffb\u8f6c\u64cd\u4f5c\u3002</p> <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\nconstexpr int N = 1e5 + 5;\nmt19937 rnd(time(nullptr));\nstruct Treap {\n    int ls[N], rs[N], key[N], val[N], siz[N];\n    int root = 0, tot = 0, T1, T2, T3;\n    bool tag[N];\n    int node(int v) {\n        int u = ++tot;\n        ls[u] = rs[u] = 0;\n        key[u] = rnd();\n        val[u] = v;\n        siz[u] = 1;\n        return u;\n    }\n    void pushup(int u) {\n        siz[u] = siz[ls[u]] + siz[rs[u]] + 1;\n    }\n    void pushdown(int u) {\n        if (tag[u]) {\n            swap(ls[u], rs[u]);\n            if (ls[u]) tag[ls[u]] ^= 1;\n            if (rs[u]) tag[rs[u]] ^= 1;\n            tag[u] = false;\n        }\n    }\n    void split(int u, int k, int &amp;x, int &amp;y) {\n        if (!u) { x = y = 0; return;}\n        pushdown(u);\n        if (siz[ls[u]] &gt;= k) {\n            y = u;\n            split(ls[u], k, x, ls[u]);\n        } else {\n            x = u;\n            split(rs[u], k - siz[ls[u]] - 1, rs[u], y);\n        }\n        pushup(u);\n    }\n    int merge(int x, int y) {\n        if (!x or !y) return x + y;\n        if (key[x] &lt;= key[y]) {\n            pushdown(y);\n            ls[y] = merge(x, ls[y]);\n            pushup(y);\n            return y;\n        } else {\n            pushdown(x);\n            rs[x] = merge(rs[x], y);\n            pushup(x);\n            return x;\n        }\n    }\n    void reverse(int l, int r) {\n        split(root, l - 1, T1, T2);\n        split(T2, r - l + 1, T2, T3);\n        tag[T2] ^= true;\n        root = merge(T1, merge(T2, T3));\n    }\n    void output(int u) {\n        if (u == 0) return;\n        pushdown(u);\n        output(ls[u]);\n        cout &lt;&lt; val[u] &lt;&lt; \" \";\n        output(rs[u]);\n    }\n} s;\nint main() {\n    ios::sync_with_stdio(false), cin.tie(nullptr);\n    int n, m;\n    cin &gt;&gt; n &gt;&gt; m;\n    for (int i = 1; i &lt;= n; i++) {\n        s.root = s.merge(s.root, s.node(i));\n    }\n    while (m--) {\n        int l, r; cin &gt;&gt; l &gt;&gt; r;\n        s.reverse(l, r);\n    }\n    s.output(s.root);\n}\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E8%AE%BA/","title":"1 \u6570\u8bba","text":""},{"location":"CP/templates/%E6%95%B0%E8%AE%BA/#11","title":"1.1 \u5feb\u901f\u5e42","text":"<pre><code>int ksm(int x, int n = MOD - 2, int p = MOD) {\n    int ans = 1;\n    for (x %= p; n; n &gt;&gt;= 1, x = x * x % p)\n        if (n &amp; 1) ans = ans * x % p;\n    return ans;\n}\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E8%AE%BA/#12","title":"1.2 \u7ebf\u6027\u7b5b","text":"<p>\u9884\u5904\u7406\u79ef\u6027\u51fd\u6570\u7528\uff0c\u540c\u65f6\u7b5b\u51fa\u7d20\u6570\u3002\u5e38\u89c1\u7684\u6709\u56e0\u6570\u4e2a\u6570\u3001\u56e0\u6570\u548c\u3001\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u3001\u6b27\u62c9\u51fd\u6570\u7b49\u3002</p> <ul> <li>\u82e5 \\(p\\nmid i\\)\uff0c\u5219 \\(f_{p\\cdot i} = f_p \\cdot f_i\\)\u3002</li> <li>\u82e5 \\(p\\mid i\\)\uff0c\u9700\u8981\u5f97\u5230 \\(f_{p^k i} \\rightarrow f_{p^{k+1}i}\\) \u7684\u9012\u63a8\u5173\u7cfb\u3002</li> </ul> <p>\u4ee5\u4e0b\u662f\u6c42\u89e3\u56e0\u6570\u4e2a\u6570\u4ee5\u53ca\u56e0\u6570\u548c\u7684\u6a21\u677f\u3002</p> <pre><code>vector&lt;int&gt; primes, minp;\nvector&lt;int&gt; cnt;           // cnt[i] = \u6307\u6570 e\uff08i \u4e2d\u6700\u5c0f\u8d28\u56e0\u5b50\u7684\u5e42\uff09\nvector&lt;long long&gt; pw;      // pw[i] = p^e\uff08\u5bf9\u5e94\u6700\u5c0f\u8d28\u56e0\u5b50\u90e8\u5206\uff09\nvector&lt;long long&gt; dcnt;    // \u7ea6\u6570\u4e2a\u6570 d(n)\nvector&lt;long long&gt; dsum;    // \u7ea6\u6570\u548c sigma(n)\n\nvoid sieve(int n) {\n    primes.reserve(2 * n / __lg(n));\n    minp.assign(n + 1, 0);\n    cnt.assign(n + 1, 0);\n    pw.assign(n + 1, 0);\n    dcnt.assign(n + 1, 0);\n    dsum.assign(n + 1, 0);\n\n    minp[1] = 1;\n    cnt[1] = 0;\n    pw[1] = 1;\n    dcnt[1] = 1;   // d(1) = 1\n    dsum[1] = 1;   // sigma(1) = 1\n\n    for (int i = 2; i &lt;= n; ++i) {\n        if (!minp[i]) {\n            primes.emplace_back(i);\n            minp[i] = i;\n            cnt[i] = 1;      \n            pw[i] = i;       \n            dcnt[i] = 2;      \n            dsum[i] = 1 + (long long)i; \n        }\n        for (int p : primes) {\n            long long ip = 1LL * i * p;\n            if (p &gt; minp[i] || ip &gt; n) break;\n            minp[ip] = p;\n            if (i % p == 0) {\n                cnt[ip] = cnt[i] + 1;\n                pw[ip]  = pw[i] * p;\n                dcnt[ip] = dcnt[i] / (cnt[i] + 1) * (cnt[i] + 2);\n                dsum[ip] = dsum[i] / (1 + pw[i]) * (1 + pw[ip]);\n            } else {\n                cnt[ip] = 1;\n                pw[ip]  = p;\n                dcnt[ip] = dcnt[i] * 2;  \n                dsum[ip] = dsum[i] * (1 + (long long)p);\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E8%AE%BA/#13","title":"1.3 \u6b27\u62c9\u51fd\u6570","text":"<p>1\u5230n\u4e2d\u4e0en\u4e92\u7d20\u7684\u6574\u6570\u4e2a\u6570\uff0c\u662f\u79ef\u6027\u51fd\u6570\u3002</p>"},{"location":"CP/templates/%E6%95%B0%E8%AE%BA/#131","title":"1.3.1 \u5355\u70b9\u67e5","text":"<p>\u7528\u5230\u516c\u5f0f \\(\\varphi(n)=n\\prod_{i=1}^{m}(1-\\frac{1}{p_i})\\)\u3002m\u4e3a\u8d28\u56e0\u6570\u7684\u4e2a\u6570\u3002\u590d\u6742\u5ea6 \\(O(\\sqrt{n})\\)\u3002</p> <pre><code>long long phi(long long n) {\n    long long res = n;\n    for (long long i = 2; i * i &lt;= n; i++) {\n        if (n % i == 0) {\n            while (n % i == 0) n /= i;\n            res = res / i * (i - 1);\n        }\n    }\n    if (n &gt; 1) res = res / n * (n - 1);\n    return res;\n}\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E8%AE%BA/#132","title":"1.3.2 \u7ebf\u6027\u7b5b","text":"<p>\u7528\u5230\u6027\u8d28 \\(\\varphi(p^k) = p^k - p^{k-1}\\)\u3002\u590d\u6742\u5ea6\\(O(n)\\)\u3002</p> <pre><code>vector&lt;int&gt; primes, minp, phi;\nvoid sieve(int n) {\n    primes.reserve(2 * n / __lg(n));\n    minp.assign(n + 1, 0);\n    phi.assign(n + 1, 0);\n    minp[1] = phi[1] = 1;\n    for (int i = 2; i &lt;= n; i++) {\n        if (!minp[i]) {\n            primes.emplace_back(i);\n            minp[i] = i;\n            phi[i] = i - 1;\n        }\n        for (int p : primes) {\n            if (p &gt; minp[i] or i * p &gt; n) break;\n            minp[i * p] = p;\n            if (i % p == 0) {\n                phi[i * p] = phi[i] * p;\n            } else {\n                phi[i * p] = phi[i] * phi[p];\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E8%AE%BA/#133","title":"1.3.3 \u6b27\u62c9\u53cd\u6f14","text":"\\[ n = \\sum_{d\\mid n} \\varphi(d) \\] \\[ \\gcd(a, b) = \\sum_{d}[d\\mid a][d\\mid b]\\varphi(d) \\]"},{"location":"CP/templates/%E6%95%B0%E8%AE%BA/#14","title":"1.4 \u83ab\u6bd4\u4e4c\u65af\u51fd\u6570","text":"\\[ \\mu(n) =  \\begin{cases}  1 &amp; \\text{\u5982\u679c } n = 1, \\\\ 0 &amp; \\text{\u5982\u679c } n \\text{ \u6709\u4e00\u4e2a\u5e73\u65b9\u7684\u8d28\u56e0\u5b50}, \\\\ (-1)^k &amp; \\text{\u5982\u679c } n \\text{ \u662f } k \\text{ \u4e2a\u4e0d\u540c\u8d28\u6570\u7684\u4e58\u79ef}. \\end{cases} \\]"},{"location":"CP/templates/%E6%95%B0%E8%AE%BA/#141","title":"1.4.1 \u7ebf\u6027\u7b5b","text":"<pre><code>void sieve(int n) {\n    minp.assign(n + 1, 0);\n    miu.assign(n + 1, 0);\n    miu[1] = 1;\n    for (int i = 2; i &lt;= n; i++) {\n        if (!minp[i]) {\n            primes.emplace_back(minp[i] = i);\n            miu[i] = -1;\n        }\n        for (int p : primes) {\n            if (p * i &gt; n or p &gt; minp[i]) break;\n            minp[i*p] = p;\n            miu[i*p] = i % p ? -miu[i] : 0;\n        }\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E6%95%B0%E8%AE%BA/#142","title":"1.4.2 \u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14","text":"\\[ \\sum_{d|n} \\mu(d) = [n = 1] \\] \\[ [\\gcd(i, j) = 1] = \\sum_{d|\\gcd(i, j)} \\mu(d) \\]"},{"location":"CP/templates/%E6%95%B0%E8%AE%BA/#15","title":"1.5 \u548c\u5f0f\u53d8\u6362\u6280\u5de7","text":"<ol> <li> <p>\u66ff\u6362\u6761\u4ef6\u5f0f    $$    \\sum_{i=1}^{n} \\sum_{j=1}^{m} \\sum_{d|\\gcd(i,j)} d = \\sum_{i=1}^{n} \\sum_{j=1}^{m} \\sum_{d=1}^{n} [d | i][d | j]d    $$</p> </li> <li> <p>\u66ff\u6362\u6307\u6807\u53d8\u91cf    $$    \\sum_{i=1}^{n} \\sum_{j=1}^{m} [\\gcd(i,j) = k] = \\sum_{ik=1}^{n} \\sum_{jk=1}^{m} [\\gcd(ik,jk) = k]    $$</p> </li> <li> <p>\u4ea4\u6362\u6c42\u548c\u6b21\u5e8f    $$    \\sum_{i=1}^{n} \\sum_{j=1}^{m} A(i)B(j) = \\sum_{j=1}^{m} \\sum_{i=1}^{n} A(i)B(j)    $$</p> </li> <li> <p>\u5206\u79bb\u53d8\u91cf    $$    \\sum_{i=1}^{n} \\sum_{j=1}^{m} A(i)B(j) = \\sum_{i=1}^{n} A(i) \\sum_{j=1}^{m} B(j)    $$</p> </li> </ol>"},{"location":"CP/templates/%E6%95%B0%E8%AE%BA/#16-exgcd","title":"1.6 \u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5 \uff08exgcd\uff09","text":"<pre><code>// gcd(x, y) = a * x + b * y, return gcd(x, y)\nint exgcd(int x, int y, int &amp;a, int &amp;b) {\n    if (!y) {\n        a = 1, b = 0;\n        return x;\n    }\n    int d = exgcd(y, x % y, b, a);\n    b -= a * (x / y);\n    return d;\n}\n</code></pre>"},{"location":"CP/templates/%E6%9D%82%E9%A1%B9/","title":"11 \u6742\u9879","text":""},{"location":"CP/templates/%E6%9D%82%E9%A1%B9/#111","title":"11.1 \u5feb\u8bfb","text":"<pre><code>char buf[1 &lt;&lt; 20], *p1, *p2;\nchar gc() {\n    return p1 == p2 ? p2 = buf + fread(p1 = buf, 1, 1 &lt;&lt; 20, stdin), (p1 == p2) ? EOF : *p1++ : *p1++;\n}\ninline int read(int f = 1, char c = gc(), int x = 0) {\n    while (c &lt; '0' || c &gt; '9') f = (c == '-') ? -1 : 1, c = gc();\n    while (c &gt;= '0' &amp;&amp; c &lt;= '9') x = x * 10 + c - '0', c = gc();\n    return f * x;\n}\n</code></pre>"},{"location":"CP/templates/%E6%9D%82%E9%A1%B9/#112","title":"11.2 \u8c03\u8bd5","text":"<pre><code>void pv(const T&amp; v) {\n    if constexpr (is_same_v&lt;T, vector&lt;int&gt;&gt;) {\n        for (auto i : v) cout &lt;&lt; i &lt;&lt; \" \";\n    } else {\n        cerr &lt;&lt; v;\n    }\n}\n#define debug(v) cerr &lt;&lt; #v &lt;&lt; \" = \", pv(v), cerr &lt;&lt; endl\n</code></pre>"},{"location":"CP/templates/%E6%9D%82%E9%A1%B9/#113-__int128","title":"11.3 __int128","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\nusing i128 = __int128;\n\nostream&amp; operator&lt;&lt;(ostream&amp; os, i128 x) {\n    if (x &lt; 0) {\n        os &lt;&lt; \"-\";\n        x = -x;\n    }\n    if (x == 0) return os &lt;&lt; 0;\n    string s;\n    while (x) {\n        s += char('0' + x % 10);\n        x /= 10;\n    }\n    reverse(s.begin(), s.end());\n    return os &lt;&lt; s;\n}\n\nistream&amp; operator&gt;&gt;(istream&amp; is, i128&amp; x) {\n    string s; is &gt;&gt; s;\n    x = 0;\n    for (auto c : s) {\n        x = x * 10 + c - '0';\n    }\n    return is;\n}\n\ni128 sqrti128(i128 x) {\n    i128 lo = 0, hi = 1e18;\n    while (lo &lt; hi) {\n        i128 mid = (lo + hi + 1) / 2;\n        if (mid * mid &lt;= x) {\n            lo = mid;\n        } else {\n            hi = mid - 1;\n        }\n    }\n    return lo;\n}\n</code></pre>"},{"location":"CP/templates/%E6%9D%82%E9%A1%B9/#114","title":"11.4 \u5b9e\u6570\u57df\u4e8c\u5206","text":"<pre><code>for (int t = 1; t &lt;= 100; t++) {\n    ld mid = (l + r) / 2;\n    if (judge(mid)) r = mid;\n    else l = mid;\n}\ncout &lt;&lt; l &lt;&lt; endl;\n</code></pre>"},{"location":"CP/templates/%E6%9D%82%E9%A1%B9/#115","title":"11.5 \u6574\u6570\u57df\u4e09\u5206","text":"<p>\u8fd9\u6bb5\u4ee3\u7801\u6c42\u7684\u662f\u6781\u5c0f\u503c\uff0c\u6781\u5927\u503c\u9700\u8981\u6539\u53d8\u4e0d\u7b49\u53f7\u65b9\u5411\u3002</p> <pre><code>while (l &lt; r) {\n    int mid = (l + r) / 2;\n    if (check(mid) &lt;= check(mid + 1)) r = mid; // &lt;========= \u6ce8\u610f\u4e0d\u7b49\u53f7\u65b9\u5411\n    else l = mid + 1;\n}\ncout &lt;&lt; check(l) &lt;&lt; endl;\n</code></pre>"},{"location":"CP/templates/%E6%9D%82%E9%A1%B9/#116","title":"11.6 \u5b9e\u6570\u57df\u4e09\u5206","text":"<pre><code>ld l = -1E9, r = 1E9;\nfor (int t = 1; t &lt;= 100; t++) {\n    ld mid1 = (l * 2 + r) / 3;\n    ld mid2 = (l + r * 2) / 3;\n    if (judge(mid1) &lt; judge(mid2)) {\n        r = mid2;\n    } else {\n        l = mid1;\n    }\n}\ncout &lt;&lt; l &lt;&lt; endl;\n</code></pre>"},{"location":"CP/templates/%E6%9D%82%E9%A1%B9/#117-pb_ds","title":"11.7 pb_ds","text":"<pre><code>#include &lt;bits/stdc++.h&gt;\n#include &lt;ext/pb_ds/assoc_container.hpp&gt;\n#include &lt;ext/pb_ds/tree_policy.hpp&gt;\n\nusing namespace std;\nusing namespace __gnu_pbds;\n\n// ordered_set: \u652f\u6301 order_of_key / find_by_order\ntemplate&lt;typename T&gt;\nusing ordered_set = tree&lt;T, null_type, less&lt;T&gt;, rb_tree_tag, tree_order_statistics_node_update&gt;;\n\nint main() {\n    // \u666e\u901a\u6709\u5e8f\u96c6\u5408\n    ordered_set&lt;int&gt; os;\n    os.insert(5);\n    os.insert(1);\n    os.insert(7);\n    os.insert(3);\n    // find_by_order(k): \u8fd4\u56de\u7b2c k (0-based) \u5c0f\u5143\u7d20\u7684\u8fed\u4ee3\u5668\n    cout &lt;&lt; \"2nd: \" &lt;&lt; *os.find_by_order(2) &lt;&lt; \"\\n\"; // 5\n\n    // order_of_key(x): \u8fd4\u56de\u96c6\u5408\u4e2d\u4e25\u683c\u5c0f\u4e8e x \u7684\u5143\u7d20\u4e2a\u6570\n    cout &lt;&lt; \"count &lt; 5: \" &lt;&lt; os.order_of_key(5) &lt;&lt; \"\\n\"; // 2 (1,3)\n\n    // \u5220\u9664\n    os.erase(3);\n    cout &lt;&lt; \"after erase 3, count &lt; 5: \" &lt;&lt; os.order_of_key(5) &lt;&lt; \"\\n\"; // 1\n}\n</code></pre>"},{"location":"CP/templates/%E6%9D%82%E9%A1%B9/#118","title":"11.8 \u65e5\u671f\u6362\u7b97\uff08\u57fa\u59c6\u62c9\u5c14\u68ee\u516c\u5f0f\uff09","text":"<p>\u5df2\u77e5\u5e74\u6708\u65e5\uff0c\u6c42\u661f\u671f\u6570\u3002</p> <pre><code>int week(int y,int m,int d){\n    if(m&lt;=2)m+=12,y--;\n    return (d+2*m+3*(m+1)/5+y+y/4-y/100+y/400)%7+1;\n}\n</code></pre>"},{"location":"CP/templates/%E6%9D%82%E9%A1%B9/#119-simpson","title":"11.9 \u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd5\uff08Simpson\uff09","text":"<p>\u4e8c\u7ef4\u5e73\u9762\u4e0a\u7684\u66f2\u7ebf\u957f\u5ea6 $$ L = \u222b_a^b \\sqrt{1 + (f'(x))^2} dx $$</p> \\[ L = \u222b_{t1}^{t2} \\sqrt{(dx/dt)^2 + (dy/dt)^2} dt \\] <pre><code>const int MAX_DEPTH = 60;\n\ndouble simpson(double l, double r) {\n    return (f(l) + 4.0 * f((l + r) / 2.0) + f(r)) * (r - l) / 6.0;\n}\n\ndouble integral_rec(double l, double r, double eps, double st, int depth) {\n    double mid = (l + r) / 2.0;\n    double sl = simpson(l, mid), sr = simpson(mid, r);\n    double I = sl + sr;\n    double err = fabs(I - st) / 15.0; // \u4f30\u8ba1\u7684\u8bef\u5dee\n\n    // \u590d\u5408\u7edd\u5bf9/\u76f8\u5bf9\u5bb9\u5dee\n    double tol = max(eps, eps * fabs(I)); // \u6216\uff1amax(abs_tol, rel_tol * fabs(I))\n\n    if (err &lt;= tol || depth &gt;= MAX_DEPTH) {\n        return I + (I - st) / 15.0; // Richardson \u4fee\u6b63\n    }\n    return integral_rec(l, mid, eps / 2.0, sl, depth + 1)\n         + integral_rec(mid, r, eps / 2.0, sr, depth + 1);\n}\n\ndouble integral(double l, double r, double EPS) {\n    double s = simpson(l, r);\n    return integral_rec(l, r, EPS, s, 0);\n}\n</code></pre>"},{"location":"CP/templates/%E6%9D%82%E9%A1%B9/#1110","title":"11.10 \u6574\u6570\u9664\u6cd5","text":"<pre><code>int floordiv(int x, int y) {\n    int q = x / y;\n    if (x % y and (x &gt; 0) != (y &gt; 0)) q--;\n    return q;\n}\nint ceildiv(int x, int y) {\n    int q = x / y;\n    if (x % y and (x &gt; 0) == (y &gt; 0)) q++;\n    return q;\n}\n</code></pre>"},{"location":"CP/templates/%E6%A0%91%E8%AE%BA/","title":"7 \u6811\u8bba","text":""},{"location":"CP/templates/%E6%A0%91%E8%AE%BA/#71","title":"7.1 \u6811\u4e0a\u500d\u589e","text":"<p>LCA\u3001\u6811\u4e0a\u8def\u5f84\u3001\u6811\u4e0a\u8def\u5f84\u8fb9\u6743\u6700\u503c\u3002</p> <pre><code>constexpr int N = 1e5 + 5;\nint dep[N], fa[20][N]; // 2^20 = 1048576\nvector&lt;vector&lt;int&gt;&gt; g(N);\nvoid dfs(int x, int f) {\n    dep[x] = dep[f] + 1, fa[0][x] = f;\n    for (int i = 1; i &lt; 20; ++i)\n        fa[i][x] = fa[i-1][fa[i-1][x]];\n    for (int y : g[x])\n        if (y != f) dfs(y, x);\n}\nint lca(int x, int y) {\n    if (dep[x] &lt; dep[y]) swap(x, y);\n    for (int i = 19; ~i; --i)\n        if (dep[fa[i][x]] &gt;= dep[y]) x = fa[i][x];\n    if (x == y) return y;\n    for (int i = 19; ~i; --i)\n        if (fa[i][x] != fa[i][y])\n            x = fa[i][x], y = fa[i][y];\n    return fa[0][x];\n}\n</code></pre>"},{"location":"CP/templates/%E6%A0%91%E8%AE%BA/#72-dfslca","title":"7.2 dfs\u5e8fLCA","text":"<p>\\(O(n\\log{n})\\) \u9884\u5904\u7406\uff0c\\(O(1)\\) \u67e5\u8be2\u3002</p> <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\nconstexpr int N = 5e5 + 5;\nconstexpr int K = __lg(N) + 3;\nint n, m, s;\nint dfn[N], cnt, st[K][N]; \nvector&lt;vector&lt;int&gt;&gt; g(N);\nvoid dfs(int x, int f) {\n    dfn[x] = ++cnt;\n    st[0][dfn[x]] = f;\n    for (int y : g[x])\n        if (y != f) dfs(y, x);\n}\nvoid build_lca() {\n    for (int j = 1; j &lt; K; j++) {\n        for (int i = 1; i + (1 &lt;&lt; j) - 1 &lt;= n; i++) {\n            int p1 = st[j-1][i];\n            int p2 = st[j-1][i + (1 &lt;&lt; (j-1))];\n            st[j][i] = dfn[p1] &lt; dfn[p2] ? p1 : p2;\n        }\n    }\n}\nint lca(int x, int y) {\n    if (x == y) return x;\n    if (dfn[x] &gt; dfn[y]) swap(x, y);\n    int j = __lg(dfn[y] - dfn[x]);\n    int p1 = st[j][dfn[x]+1];\n    int p2 = st[j][dfn[y]-(1&lt;&lt;j)+1];\n    return dfn[p1] &lt; dfn[p2] ? p1 : p2; \n}\nsigned main() {\n    dfs(s, 0); // s \u662f\u6839\n    build_lca();\n    cout &lt;&lt; lca(u, v);\n}\n</code></pre>"},{"location":"CP/templates/%E6%A0%91%E8%AE%BA/#73","title":"7.3 \u865a\u6811","text":"<p>\u5f53\u67e5\u8be2\u70b9\u603b\u6570\u6709\u9650\u65f6\uff0c\u6839\u636e\u67e5\u8be2\u70b9\u53ca\u5176LCA\u5efa\u7acb\u865a\u6811\uff0c\u7136\u540e\u5728\u865a\u6811\u4e0a\u9762dp\u3002\u9700\u8981\u9884\u5904\u7406LCA\u548cdfs\u5e8f\u3002</p> <pre><code>vector&lt;int&gt; g[N], h[N], used; // \u539f\u6811\u3001\u865a\u6811\u3001\u865a\u6811\u4e2d\u7528\u5230\u7684\u70b9\nint stk[N], top;\n\nvoid add_edge(int x, int y) {\n    h[x].emplace_back(y);\n    used.emplace_back(x);\n}\n\nvoid clear() {\n    for (int x : used) {\n        h[x].clear();\n    }\n    used.clear();\n}\n\nvoid build() {\n    sort(a+1,a+1+k,[&amp;](int x, int y) {\n        return dfn[x] &lt; dfn[y];\n    });\n    stk[top=1] = 1;\n    if (a[1] != 1) stk[++top] = a[1];\n    for (int i = 2; i &lt;= k; i++) {\n        int c = lca(stk[top], a[i]);\n        while (top &gt; 1 and dep[stk[top-1]] &gt;= dep[c]) {\n            add_edge(stk[top-1], stk[top]);\n            top--;\n        }        \n        if (c != stk[top]) {\n            add_edge(c, stk[top]);\n            stk[top] = c;\n        }\n        stk[++top] = a[i];\n    }\n    while (top &gt; 1) {\n        add_edge(stk[top-1], stk[top]);\n        top--;\n    }\n}\n</code></pre>"},{"location":"CP/templates/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/","title":"3 \u7ebf\u6027\u4ee3\u6570","text":""},{"location":"CP/templates/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/#31","title":"3.1 \u9ad8\u65af\u6d88\u5143","text":"<p>\u6c42\u89e3\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff0c<code>a[i][0] ~ a[i][n-1]</code> \u4e3a\u7cfb\u6570\uff0c<code>a[i][n]</code> \u4e3a\u7b49\u53f7\u53f3\u8fb9\u7684\u5e38\u6570\uff0c\u6700\u540e\u7ed3\u679c\u4fdd\u5b58\u5728<code>a[i][n]</code>\u4e2d\u3002</p> <pre><code>const int N = 110;\nconst double eps = 1e-8;\nLL n;\ndouble a[N][N];\nLL gauss(){\n    LL c, r;\n    for (c = 0, r = 0; c &lt; n; c ++ ){\n        LL t = r;\n        for (int i = r; i &lt; n; i ++ )    //\u627e\u5230\u7edd\u5bf9\u503c\u6700\u5927\u7684\u884c \n            if (fabs(a[i][c]) &gt; fabs(a[t][c]))\n                t = i;\n        if (fabs(a[t][c]) &lt; eps) continue;\n        for (int j = c; j &lt; n + 1; j ++ ) swap(a[t][j], a[r][j]);    //\u5c06\u7edd\u5bf9\u503c\u6700\u5927\u7684\u4e00\u884c\u6362\u5230\u6700\u9876\u7aef\n        for (int j = n; j &gt;= c; j -- ) a[r][j] /= a[r][c];    //\u5c06\u5f53\u524d\u884c\u9996\u4f4d\u53d8\u6210 1\n        for (int i = r + 1; i &lt; n; i ++ )    //\u5c06\u4e0b\u9762\u5217\u6d88\u6210 0 \n            if (fabs(a[i][c]) &gt; eps)\n                for (int j = n; j &gt;= c; j -- )\n                    a[i][j] -= a[r][j] * a[i][c];\n        r ++ ;\n    }\n    if (r &lt; n){\n        for (int i = r; i &lt; n; i ++ )\n            if (fabs(a[i][n]) &gt; eps)\n                return 2;\n        return 1;\n    }\n    for (int i = n - 1; i &gt;= 0; i -- )\n        for (int j = i + 1; j &lt; n; j ++ )\n            a[i][n] -= a[i][j] * a[j][n];\n    return 0;\n}\nint main(){\n    cin &gt;&gt; n;\n    for (int i = 0; i &lt; n; i ++ )\n        for (int j = 0; j &lt; n + 1; j ++ )\n            cin &gt;&gt; a[i][j];\n    LL t = gauss();\n    if (t == 0){\n        for (int i = 0; i &lt; n; i ++ ){\n            if (fabs(a[i][n]) &lt; eps) a[i][n] = abs(a[i][n]);\n            printf(\"%.2lf\\n\", a[i][n]);\n        }\n    }\n    else if (t == 1) cout &lt;&lt; \"Infinite group solutions\\n\";\n    else cout &lt;&lt; \"No solution\\n\";\n    return 0;\n}\n</code></pre>"},{"location":"CP/templates/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/#32","title":"3.2 \u7ebf\u6027\u57fa","text":"<pre><code>constexpr int L = 60;\nll basis[L];\nint cnt = 0;\nbool insert(ll x) {\n    for (int k = L - 1; k &gt;= 0; k--) {\n        if (((x &gt;&gt; k) &amp; 1LL) == 0) continue;\n        if (basis[k] == 0) {\n            basis[k] = x;\n            cnt++;\n            return true;\n        }\n        x ^= basis[k];\n    }\n    return false;\n}\n</code></pre>"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/","title":"2 \u7ec4\u5408\u6570\u5b66","text":""},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#21","title":"2.1 \u7ec4\u5408\u6570\u5b66\u5e38\u89c1\u6027\u8d28","text":"<ul> <li>\\(k *C^k_n=n*C^{k-1}_{n-1}\\) \uff1b</li> <li>\\(C_k^n*C_m^k=C_m^n*C_{m-n}^{m-k}\\) \uff1b</li> <li>\\(C_n^k+C_n^{k+1}=C_{n+1}^{k+1}\\) \uff1b</li> <li>\\(\\sum_{i=0}^n C_n^i=2^n\\) \uff1b</li> <li>\\(\\sum_{k=0}^n(-1)^k*C_n^k=0\\) \u3002</li> <li>\u4e8c\u9879\u5f0f\u53cd\u6f14\uff1a\\(\\left\\{\\begin{matrix} \\displaystyle f_n=\\sum_{i=0}^n{n\\choose i}g_i\\Leftrightarrow g_n=\\sum_{i=0}^n(-1)^{n-i}{n\\choose i}f_i \\\\  \\displaystyle f_k=\\sum_{i=k}^n{i\\choose k}g_i\\Leftrightarrow g_k=\\sum_{i=k}^n(-1)^{i-k}{i\\choose k}f_i  \\end{matrix}\\right.\\) \uff1b</li> <li>\\(\\displaystyle \\sum_{i=1}^{n}i{n\\choose i}=n * 2^{n-1}\\) \uff1b</li> <li>\\(\\displaystyle \\sum_{i=1}^{n}i^2{n\\choose i}=n*(n+1)*2^{n-2}\\) \uff1b</li> <li>\\(\\displaystyle \\sum_{i=1}^{n}\\dfrac{1}{i}{n\\choose i}=\\sum_{i=1}^{n}\\dfrac{1}{i}\\) \uff1b</li> <li>\\(\\displaystyle \\sum_{i=0}^{n}{n\\choose i}^2={2n\\choose n}\\) \uff1b</li> <li>\u62c9\u683c\u6717\u65e5\u6052\u7b49\u5f0f\uff1a\\(\\displaystyle \\sum_{i=1}^{n}\\sum_{j=i+1}^{n}(a_ib_j-a_jb_i)^2=(\\sum_{i=1}^{n}a_i)^2(\\sum_{i=1}^{n}b_i)^2-(\\sum_{i=1}^{n}a_ib_i)^2\\) \u3002</li> </ul>"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#22","title":"2.2 \u8303\u5fb7\u8499\u5fb7\u5377\u79ef\u516c\u5f0f","text":"<p>\u5728\u6570\u91cf\u4e3a \\(n+m\\) \u7684\u5806\u4e2d\u9009 \\(k\\) \u4e2a\u5143\u7d20\uff0c\u548c\u5206\u522b\u5728\u6570\u91cf\u4e3a \\(n\u3001m\\) \u7684\u5806\u4e2d\u9009 \\(i\u3001k-i\\) \u4e2a\u5143\u7d20\u7684\u65b9\u6848\u6570\u662f\u76f8\u540c\u7684\uff0c\u5373\\(\\displaystyle{\\sum_{i=0}^k\\binom{n}{i}\\binom{m}{k-i}=\\binom{n+m}{k}}\\) \uff1b</p> <p>\u53d8\u4f53\uff1a</p> <ul> <li>\\(\\sum_{i=0}^k C_{i+n}^{i}=C_{k+n+1}^{k}\\) \uff1b</li> <li>\\(\\sum_{i=0}^k C_{n}^{i}*C_m^i=\\sum_{i=0}^k C_{n}^{i}*C_m^{m-i}=C_{n+m}^{n}\\) \u3002</li> </ul>"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#23","title":"2.3 \u5361\u7279\u5170\u6570","text":"<p>Catalan \u6570\u5217 \\(H_n\\) \u53ef\u4ee5\u5e94\u7528\u4e8e\u4ee5\u4e0b\u95ee\u9898\uff1a</p> <ol> <li>\u6709 \\(2n\\) \u4e2a\u4eba\u6392\u6210\u4e00\u884c\u8fdb\u5165\u5267\u573a\u3002\u5165\u573a\u8d39 5 \u5143\u3002\u5176\u4e2d\u53ea\u6709 \\(n\\) \u4e2a\u4eba\u6709\u4e00\u5f20 5 \u5143\u949e\u7968\uff0c\u53e6\u5916 \\(n\\) \u4eba\u53ea\u6709 10 \u5143\u949e\u7968\uff0c\u5267\u9662\u65e0\u5176\u5b83\u949e\u7968\uff0c\u95ee\u6709\u591a\u5c11\u79cd\u65b9\u6cd5\u4f7f\u5f97\u53ea\u8981\u6709 10 \u5143\u7684\u4eba\u4e70\u7968\uff0c\u552e\u7968\u5904\u5c31\u6709 5 \u5143\u7684\u949e\u7968\u627e\u96f6\uff1f</li> <li>\u6709\u4e00\u4e2a\u5927\u5c0f\u4e3a \\(n\\times n\\) \u7684\u65b9\u683c\u56fe\u5de6\u4e0b\u89d2\u4e3a \\((0, 0)\\) \u53f3\u4e0a\u89d2\u4e3a \\((n, n)\\)\uff0c\u4ece\u5de6\u4e0b\u89d2\u5f00\u59cb\u6bcf\u6b21\u90fd\u53ea\u80fd\u5411\u53f3\u6216\u8005\u5411\u4e0a\u8d70\u4e00\u5355\u4f4d\uff0c\u4e0d\u8d70\u5230\u5bf9\u89d2\u7ebf \\(y=x\\) \u4e0a\u65b9\uff08\u4f46\u53ef\u4ee5\u89e6\u78b0\uff09\u7684\u60c5\u51b5\u4e0b\u5230\u8fbe\u53f3\u4e0a\u89d2\u6709\u591a\u5c11\u53ef\u80fd\u7684\u8def\u5f84\uff1f</li> <li>\u5728\u5706\u4e0a\u9009\u62e9 \\(2n\\) \u4e2a\u70b9\uff0c\u5c06\u8fd9\u4e9b\u70b9\u6210\u5bf9\u8fde\u63a5\u8d77\u6765\u4f7f\u5f97\u6240\u5f97\u5230\u7684 \\(n\\) \u6761\u7ebf\u6bb5\u4e0d\u76f8\u4ea4\u7684\u65b9\u6cd5\u6570\uff1f</li> <li>\u5bf9\u89d2\u7ebf\u4e0d\u76f8\u4ea4\u7684\u60c5\u51b5\u4e0b\uff0c\u5c06\u4e00\u4e2a\u51f8\u591a\u8fb9\u5f62\u533a\u57df\u5206\u6210\u4e09\u89d2\u5f62\u533a\u57df\u7684\u65b9\u6cd5\u6570\uff1f</li> <li>\u4e00\u4e2a\u6808\uff08\u65e0\u7a77\u5927\uff09\u7684\u8fdb\u6808\u5e8f\u5217\u4e3a \\(1,2,3, \\cdots ,n\\) \u6709\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u51fa\u6808\u5e8f\u5217\uff1f</li> <li>\\(n\\) \u4e2a\u7ed3\u70b9\u53ef\u6784\u9020\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u4e8c\u53c9\u6811\uff1f</li> <li>\u7531 \\(n\\) \u4e2a \\(+1\\) \u548c \\(n\\) \u4e2a \\(-1\\) \u7ec4\u6210\u7684 \\(2n\\) \u4e2a\u6570 \\(a_1,a_2, \\cdots ,a_{2n}\\)\uff0c\u5176\u90e8\u5206\u548c\u6ee1\u8db3 \\(a_1+a_2+ \\cdots +a_k \\geq 0~(k=1,2,3, \\cdots ,2n)\\)\uff0c\u6709\u591a\u5c11\u4e2a\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u5217\uff1f</li> </ol> <p>\u5176\u5bf9\u5e94\u7684\u5e8f\u5217\u4e3a\uff1a</p> \\(H_0\\) \\(H_1\\) \\(H_2\\) \\(H_3\\) \\(H_4\\) \\(H_5\\) \\(H_6\\) ... 1 1 2 5 14 42 132 ..."},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#231","title":"2.3.1 \u9012\u63a8\u5f0f","text":"<p>\u8be5\u9012\u63a8\u5173\u7cfb\u7684\u89e3\u4e3a\uff1a</p> \\[ H_n = \\frac{\\binom{2n}{n}}{n+1}(n \\geq 2, n \\in \\mathbf{N_{+}}) \\] <p>\u5173\u4e8e Catalan \u6570\u7684\u5e38\u89c1\u516c\u5f0f\uff1a</p> \\[ H_n = \\begin{cases}     \\sum_{i=1}^{n} H_{i-1} H_{n-i} &amp; n \\geq 2, n \\in \\mathbf{N_{+}}\\\\     1 &amp; n = 0, 1 \\end{cases} \\] \\[ H_n = \\frac{H_{n-1} (4n-2)}{n+1} \\] \\[ H_n = \\binom{2n}{n} - \\binom{2n}{n-1} \\]"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#232","title":"2.3.2 \u8def\u5f84\u8ba1\u6570\u95ee\u9898","text":"<p>\u975e\u964d\u8def\u5f84\u662f\u6307\u53ea\u80fd\u5411\u4e0a\u6216\u5411\u53f3\u8d70\u7684\u8def\u5f84\u3002</p> <ol> <li> <p>\u4ece \\((0,0)\\) \u5230 \\((m,n)\\) \u7684\u975e\u964d\u8def\u5f84\u6570\u7b49\u4e8e \\(m\\) \u4e2a \\(x\\) \u548c \\(n\\) \u4e2a \\(y\\) \u7684\u6392\u5217\u6570\uff0c\u5373 \\(\\dbinom{n + m}{m}\\)\u3002</p> </li> <li> <p>\u4ece \\((0,0)\\) \u5230 \\((n,n)\\) \u7684\u9664\u7aef\u70b9\u5916\u4e0d\u63a5\u89e6\u76f4\u7ebf \\(y=x\\) \u7684\u975e\u964d\u8def\u5f84\u6570\uff1a</p> <p>\u5148\u8003\u8651 \\(y=x\\) \u4e0b\u65b9\u7684\u8def\u5f84\uff0c\u90fd\u662f\u4ece \\((0, 0)\\) \u51fa\u53d1\uff0c\u7ecf\u8fc7 \\((1, 0)\\) \u53ca \\((n, n-1)\\) \u5230 \\((n,n)\\)\uff0c\u53ef\u4ee5\u770b\u505a\u662f \\((1,0)\\) \u5230 \\((n,n-1)\\) \u4e0d\u63a5\u89e6 \\(y=x\\) \u7684\u975e\u964d\u8def\u5f84\u6570\u3002</p> <p>\u6240\u6709\u7684\u7684\u975e\u964d\u8def\u5f84\u6709 \\(\\dbinom{2n-2}{n-1}\\) \u6761\u3002\u5bf9\u4e8e\u8fd9\u91cc\u9762\u4efb\u610f\u4e00\u6761\u63a5\u89e6\u4e86 \\(y=x\\) \u7684\u8def\u5f84\uff0c\u53ef\u4ee5\u628a\u5b83\u6700\u540e\u79bb\u5f00\u8fd9\u6761\u7ebf\u7684\u70b9\u5230 \\((1,0)\\) \u4e4b\u95f4\u7684\u90e8\u5206\u5173\u4e8e \\(y=x\\) \u5bf9\u79f0\u53d8\u6362\uff0c\u5c31\u5f97\u5230\u4ece \\((0,1)\\) \u5230 \\((n,n-1)\\) \u7684\u4e00\u6761\u975e\u964d\u8def\u5f84\u3002\u53cd\u4e4b\u4e5f\u6210\u7acb\u3002\u4ece\u800c \\(y=x\\) \u4e0b\u65b9\u7684\u975e\u964d\u8def\u5f84\u6570\u662f \\(\\dbinom{2n-2}{n-1} - \\dbinom{2n-2}{n}\\)\u3002\u6839\u636e\u5bf9\u79f0\u6027\u53ef\u77e5\u6240\u6c42\u7b54\u6848\u4e3a \\(2\\dbinom{2n-2}{n-1} - 2\\dbinom{2n-2}{n}\\)\u3002</p> </li> <li> <p>\u4ece \\((0,0)\\) \u5230 \\((n,n)\\) \u7684\u9664\u7aef\u70b9\u5916\u4e0d\u7a7f\u8fc7\u76f4\u7ebf \\(y=x\\) \u7684\u975e\u964d\u8def\u5f84\u6570\uff1a</p> <p>\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\u53ef\u4ee5\u5f97\u5230\uff1a\\(\\dfrac{2}{n+1}\\dbinom{2n}{n}\\)\u200b</p> </li> </ol>"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#24","title":"2.4 \u6590\u6ce2\u90a3\u5951\u6570\u5217","text":"<p>\u901a\u9879\u516c\u5f0f\uff1a\\(F_n=\\dfrac{1}{\\sqrt 5}*  \\Big[ \\Big( \\dfrac{1+\\sqrt 5}{2} \\Big)^n - \\Big( \\dfrac{1-\\sqrt 5}{2} \\Big)^n \\Big]\\) \u3002</p> <p>\u76f4\u63a5\u7ed3\u8bba\uff1a</p> <ul> <li>\u5361\u897f\u5c3c\u6027\u8d28\uff1a\\(F_{n-1} * F_{n+1}-F_n^2=(-1)^n\\) \uff1b</li> <li>\\(F_{n}^2+F_{n+1}^2=F_{2n+1}\\) \uff1b</li> <li>\\(F_{n+1}^2-F_{n-1}^2=F_{2n}\\) \uff08\u7531\u4e0a\u4e00\u6761\u5199\u4e24\u904d\u76f8\u51cf\u5f97\u5230\uff09\uff1b</li> <li>\u82e5\u5b58\u5728\u5e8f\u5217 \\(a_0=1,a_n=a_{n-1}+a_{n-3}+a_{n-5}+...(n\\ge 1)\\) \u5219 \\(a_n=F_n(n\\ge 1)\\) \uff1b</li> <li>\u9f50\u80af\u591a\u592b\u5b9a\u7406\uff1a\u4efb\u4f55\u6b63\u6574\u6570\u90fd\u53ef\u4ee5\u8868\u793a\u6210\u82e5\u5e72\u4e2a\u4e0d\u8fde\u7eed\u7684\u6590\u6ce2\u90a3\u5951\u6570\uff08 \\(F_2\\) \u5f00\u59cb\uff09\u53ef\u4ee5\u7528\u8d2a\u5fc3\u5b9e\u73b0\u3002</li> </ul> <p>\u6c42\u548c\u516c\u5f0f\u7ed3\u8bba\uff1a</p> <ul> <li>\u5947\u6570\u9879\u6c42\u548c\uff1a\\(F_1+F_3+F_5+...+F_{2n-1}=F_{2n}\\) \uff1b</li> <li>\u5076\u6570\u9879\u6c42\u548c\uff1a\\(F_2+F_4+F_6+...+F_{2n}=F_{2n+1}-1\\) \uff1b</li> <li>\u5e73\u65b9\u548c\uff1a\\(F_1^2+F_2^2+F_3^2+...+F_n^2=F_n*F_{n+1}\\) \uff1b</li> <li>\\(F_1+2F_2+3F_3+...+nF_n=nF_{n+2}-F_{n+3}+2\\) \uff1b</li> <li>\\(-F_1+F_2-F_3+...+(-1)^nF_n=(-1)^n(F_{n+1}-F_n)+1\\) \uff1b</li> <li>\\(F_{2n-2m-2}(F_{2n}+F_{2n+2})=F_{2m+2}+F_{4n-2m}\\) \u3002</li> </ul> <p>\u6570\u8bba\u7ed3\u8bba\uff1a</p> <ul> <li>\\(F_a \\mid F_b \\Leftrightarrow a \\mid b\\) \uff1b</li> <li>\\(\\gcd(F_a,F_b)=F_{\\gcd(a,b)}\\) \uff1b</li> <li>\u5f53 \\(p\\) \u4e3a \\(5k\\pm 1\\) \u578b\u7d20\u6570\u65f6\uff0c\\(\\begin{cases} F_{p-1}\\equiv 0\\pmod p \\\\ F_p\\equiv 1\\pmod p \\\\ F_{p+1}\\equiv 1\\pmod p \\end{cases}\\) \uff1b</li> <li>\u5f53 \\(p\\) \u4e3a \\(5k\\pm 2\\) \u578b\u7d20\u6570\u65f6\uff0c\\(\\begin{cases} F_{p-1}\\equiv 1\\pmod p \\\\ F_p\\equiv -1\\pmod p \\\\ F_{p+1}\\equiv 0\\pmod p \\end{cases}\\) \uff1b</li> <li>\\(F(n)\\%m\\) \u7684\u5468\u671f \\(\\le 6m\\) \uff08 \\(m=2\\times 5^k\\) \u65f6\u53d6\u5230\u7b49\u53f7\uff09\uff1b</li> <li>\u65e2\u662f\u6590\u6ce2\u90a3\u5951\u6570\u53c8\u662f\u5e73\u65b9\u6570\u7684\u6709\u4e14\u4ec5\u6709 \\(1,144\\) \u3002</li> </ul> <p>\u5feb\u901f\u500d\u589e\u6cd5\uff08\u6bd4\u77e9\u9635\u4e58\u5e38\u6570\u5c0f\uff09\uff1a <pre><code>pair&lt;int, int&gt; fib(int n) { // O(logn)\u8fd4\u56deF(n),F(n+1)\n  if (n == 0) return {0, 1};\n  auto p = fib(n &gt;&gt; 1);\n  int c = p.first * (2 * p.second - p.first);\n  int d = p.first * p.first + p.second * p.second;\n  if (n &amp; 1)\n    return {d, c + d};\n  else\n    return {c, d};\n}\n</code></pre></p>"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#25","title":"2.5 \u7ea6\u745f\u592b\u95ee\u9898","text":"<p>n \u4e2a\u4eba\u6807\u53f7 \\(0,1,\\cdots, n-1\\)\u3002\u9006\u65f6\u9488\u7ad9\u4e00\u5708\uff0c\u4ece \\(0\\) \u53f7\u5f00\u59cb\uff0c\u6bcf\u4e00\u6b21\u4ece\u5f53\u524d\u7684\u4eba\u9006\u65f6\u9488\u6570 \\(k\\) \u4e2a\uff0c\u7136\u540e\u8ba9\u8fd9\u4e2a\u4eba\u51fa\u5c40\u3002\u95ee\u6700\u540e\u5269\u4e0b\u7684\u4eba\u662f\u8c01\u3002</p>"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#251","title":"2.5.1 \u7ebf\u6027\u7b97\u6cd5","text":"<p>\u8bbe \\(J_{n,k}\\) \u8868\u793a\u89c4\u6a21\u5206\u522b\u4e3a \\(n,k\\) \u7684\u7ea6\u745f\u592b\u95ee\u9898\u7684\u7b54\u6848\u3002\u6211\u4eec\u6709\u5982\u4e0b\u9012\u5f52\u5f0f</p> \\[ J_{n,k}=(J_{n-1,k}+k)\\bmod n \\] <p>\u8fd9\u4e2a\u4e5f\u5f88\u597d\u63a8\u3002\u4f60\u4ece \\(0\\) \u5f00\u59cb\u6570 \\(k\\) \u4e2a\uff0c\u8ba9\u7b2c \\(k-1\\) \u4e2a\u4eba\u51fa\u5c40\u540e\u5269\u4e0b \\(n-1\\) \u4e2a\u4eba\uff0c\u4f60\u8ba1\u7b97\u51fa\u5728 \\(n-1\\) \u4e2a\u4eba\u4e2d\u9009\u7684\u7b54\u6848\u540e\uff0c\u518d\u52a0\u4e00\u4e2a\u76f8\u5bf9\u4f4d\u79fb \\(k\\) \u5f97\u5230\u771f\u6b63\u7684\u7b54\u6848\u3002\u8fd9\u4e2a\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u663e\u7136\u662f \\(\\Theta (n)\\) \u7684\u3002</p> <pre><code>int josephus(int n, int k) {\n  int res = 0;\n  for (int i = 1; i &lt;= n; ++i) res = (res + k) % i;\n  return res;\n}\n</code></pre>"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#252","title":"2.5.2 \u5bf9\u6570\u7b97\u6cd5","text":"<p>\u5bf9\u4e8e \\(k\\) \u8f83\u5c0f \\(n\\) \u8f83\u5927\u7684\u60c5\u51b5\uff0c\u672c\u9898\u8fd8\u6709\u4e00\u79cd\u590d\u6742\u5ea6\u4e3a \\(\\Theta (k\\log n)\\) \u7684\u7b97\u6cd5\u3002</p> <p>\u8003\u8651\u5230\u6211\u4eec\u6bcf\u6b21\u8d70 \\(k\\) \u4e2a\u5220\u4e00\u4e2a\uff0c\u90a3\u4e48\u5728\u4e00\u5708\u4ee5\u5185\u6211\u4eec\u53ef\u4ee5\u5220\u6389 \\(\\left\\lfloor\\frac{n}{k}\\right\\rfloor\\) \u4e2a\uff0c\u7136\u540e\u5269\u4e0b\u4e86 \\(n-\\left\\lfloor\\frac{n}{k}\\right\\rfloor\\) \u4e2a\u4eba\u3002\u8fd9\u65f6\u6211\u4eec\u5728\u7b2c \\(\\left\\lfloor\\frac{n}{k}\\right\\rfloor\\cdot k\\) \u4e2a\u4eba\u7684\u4f4d\u7f6e\u4e0a\u3002\u800c\u4f60\u53d1\u73b0\u5b83\u7b49\u4e8e \\(n-n\\bmod k\\)\u3002\u4e8e\u662f\u6211\u4eec\u7ee7\u7eed\u9012\u5f52\u5904\u7406\uff0c\u7b97\u5b8c\u540e\u8fd8\u539f\u5b83\u7684\u76f8\u5bf9\u4f4d\u7f6e\u3002\u8fd8\u539f\u76f8\u5bf9\u4f4d\u7f6e\u7684\u4f9d\u636e\u662f\uff1a\u6bcf\u6b21\u505a\u4e00\u6b21\u5220\u9664\u90fd\u4f1a\u628a\u6570\u5230\u7684\u7b2c \\(k\\) \u4e2a\u4eba\u5220\u9664\uff0c\u4ed6\u4eec\u7684\u7f16\u53f7\u88ab\u4e4b\u540e\u7684\u4eba\u9010\u4e2a\u7ee7\u627f\uff0c\u4e5f\u5373\u7528 \\(n-\\left\\lfloor\\frac{n}{k}\\right\\rfloor\\) \u4eba\u73af\u7b97\u65f6\u6bcf \\(k\\) \u4e2a\u4eba\u5373\u6709 \\(1\\) \u4e2a\u4eba\u7684\u4f4d\u7f6e\u5931\u7b97\uff0c\u56e0\u6b64\u5728\u5f97\u6570\u5c0f\u4e8e \\(0\\) \u65f6\uff0c\u7528\u8fd8\u6ca1\u6709\u88ab\u5220\u53bb \\(k\\) \u500d\u6570\u7f16\u53f7\u7684 \\(n\\) \u4eba\u73af\u7684 \u7684 \\(n\\) \u6c42\u6a21\uff0c\u5728\u5f97\u6570\u5927\u4e8e\u7b49\u4e8e \\(0\\) \u65f6\uff0c\u5373\u53ef\u4ee5\u76f4\u63a5\u4e58 \\(\\frac{k}{k-1}\\), \u4e8e\u662f\u5f97\u5230\u5982\u4e0b\u7684\u7b97\u6cd5\uff1a</p> <pre><code>int josephus(int n, int k) {\n  if (n == 1) return 0;\n  if (k == 1) return n - 1;\n  if (k &gt; n) return (josephus(n - 1, k) + k) % n;  // \u7ebf\u6027\u7b97\u6cd5\n  int res = josephus(n - n / k, k);\n  res -= n % k;\n  if (res &lt; 0) res += n;  // mod n\n  else res += res / (k - 1);  // \u8fd8\u539f\u4f4d\u7f6e\n  return res;\n}\n</code></pre>"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#26","title":"2.6 \u683c\u96f7\u7801","text":"<pre><code>int g(int n) { return n ^ (n &gt;&gt; 1); }\n</code></pre>"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#261","title":"2.6.1 \u901a\u8fc7\u683c\u96f7\u7801\u6784\u9020\u539f\u6570\uff08\u9006\u53d8\u6362\uff09","text":"<p>\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u683c\u96f7\u7801\u7684\u9006\u53d8\u6362\uff0c\u5373\u7ed9\u4f60\u4e00\u4e2a\u683c\u96f7\u7801 \\(g\\)\uff0c\u8981\u6c42\u4f60\u627e\u5230\u539f\u6570 \\(n\\)\u3002\u6211\u4eec\u8003\u8651\u4ece\u4e8c\u8fdb\u5236\u6700\u9ad8\u4f4d\u904d\u5386\u5230\u6700\u4f4e\u4f4d\uff08\u6700\u4f4e\u4f4d\u4e0b\u6807\u4e3a \\(1\\)\uff0c\u5373\u4e2a\u4f4d\uff1b\u6700\u9ad8\u4f4d\u4e0b\u6807\u4e3a \\(k\\)\uff09\u3002\u5219 \\(n\\) \u7684\u4e8c\u8fdb\u5236\u7b2c \\(i\\) \u4f4d\u4e0e \\(g\\) \u7684\u4e8c\u8fdb\u5236\u7b2c \\(i\\) \u4f4d \\(g_i\\) \u7684\u5173\u7cfb\u5982\u4e0b\uff1a</p> \\[ \\begin{aligned} n_k &amp;= g_k \\\\ n_{k-1} &amp;= g_{k-1} \\oplus n_k &amp;&amp;= g_k \\oplus g_{k-1} \\\\ n_{k-2} &amp;= g_{k-2} \\oplus n_{k-1} &amp;&amp;= g_k \\oplus g_{k-1} \\oplus g_{k-2} \\\\ n_{k-3} &amp;= g_{k-3} \\oplus n_{k-2} &amp;&amp;= g_k \\oplus g_{k-1} \\oplus g_{k-2} \\oplus g_{k-3} \\\\ &amp;\\vdots\\\\ n_{k-i} &amp;=\\displaystyle\\bigoplus_{j=0}^ig_{k-j} \\end{aligned} \\] <pre><code>int rev_g(int g) {\n  int n = 0;\n  for (; g; g &gt;&gt;= 1) n ^= g;\n  return n;\n}\n</code></pre>"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#27","title":"2.7 \u9519\u4f4d\u6392\u5217","text":""},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#271","title":"2.7.1 \u5b9a\u4e49","text":"<p>\u9519\u4f4d\u6392\u5217\uff08derangement\uff09\u662f\u6ca1\u6709\u4efb\u4f55\u5143\u7d20\u51fa\u73b0\u5728\u5176\u6709\u5e8f\u4f4d\u7f6e\u7684\u6392\u5217\u3002\u5373\uff0c\u5bf9\u4e8e \\(1\\sim n\\) \u7684\u6392\u5217 \\(P\\)\uff0c\u5982\u679c\u6ee1\u8db3 \\(P_i\\neq i\\)\uff0c\u5219\u79f0 \\(P\\) \u662f \\(n\\) \u7684\u9519\u4f4d\u6392\u5217\u3002</p> <p>\u4f8b\u5982\uff0c\u4e09\u5143\u9519\u4f4d\u6392\u5217\u6709 \\(\\{2,3,1\\}\\) \u548c \\(\\{3,1,2\\}\\)\u3002\u56db\u5143\u9519\u4f4d\u6392\u5217\u6709 \\(\\{2,1,4,3\\}\\)\u3001\\(\\{2,3,4,1\\}\\)\u3001\\(\\{2,4,1,3\\}\\)\u3001\\(\\{3,1,4,2\\}\\)\u3001\\(\\{3,4,1,2\\}\\)\u3001\\(\\{3,4,2,1\\}\\)\u3001\\(\\{4,1,2,3\\}\\)\u3001\\(\\{4,3,1,2\\}\\) \u548c \\(\\{4,3,2,1\\}\\)\u3002\u9519\u4f4d\u6392\u5217\u662f\u6ca1\u6709\u4e0d\u52a8\u70b9\u7684\u6392\u5217\uff0c\u5373\u6ca1\u6709\u957f\u5ea6\u4e3a 1 \u7684\u5faa\u73af\u3002</p> <p>\u9519\u4f4d\u6392\u5217\u6570\u5217\u7684\u524d\u51e0\u9879\u4e3a \\(0,1,2,9,44,265\\)\uff08OEIS A000166\uff09\u3002</p>"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#272","title":"2.7.2 \u9012\u63a8\u7684\u8ba1\u7b97","text":"<p>\u9519\u4f4d\u6392\u5217\u6570\u6ee1\u8db3\u9012\u63a8\u5173\u7cfb\uff1a</p> \\[ D_n=(n-1)(D_{n-1}+D_{n-2}) \\] <p>\u8fd9\u91cc\u4e5f\u7ed9\u51fa\u53e6\u4e00\u4e2a\u9012\u63a8\u5173\u7cfb\uff1a</p> \\[ D_n=nD_{n-1}+{(-1)}^n \\]"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#273","title":"2.7.3 \u5176\u4ed6\u5173\u7cfb","text":"<p>\u9519\u4f4d\u6392\u5217\u6570\u6709\u4e00\u4e2a\u7b80\u5355\u7684\u53d6\u6574\u8868\u8fbe\u5f0f\uff0c\u589e\u957f\u901f\u5ea6\u4e0e\u9636\u4e58\u4ec5\u76f8\u5dee\u5e38\u6570\uff1a</p> \\[ D_n=\\begin{cases}     \\left\\lceil\\frac{n!}{\\mathrm{e}}\\right\\rceil, &amp; \\text{if }n\\text{ is even}, \\\\     \\left\\lfloor\\frac{n!}{\\mathrm{e}}\\right\\rfloor,            &amp; \\text{if }n\\text{ is odd}. \\end{cases} \\] <p>\u968f\u7740\u5143\u7d20\u6570\u91cf\u7684\u589e\u52a0\uff0c\u5f62\u6210\u9519\u4f4d\u6392\u5217\u7684\u6982\u7387 P \u63a5\u8fd1\uff1a</p> \\[ P=\\lim_{n\\to\\infty}\\frac{D_n}{n!}=\\frac{1}{\\mathrm{e}} \\]"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#28","title":"2.8 \u5eb7\u6258\u5c55\u5f00","text":"<p>\\(O(n\\log{n})\\) \u6c42\u51fa\u4e00\u4e2a\u6392\u5217\u5728\u6240\u6709\u957f\u5ea6\u4e3a \\(n\\) \u7684\u6392\u5217\u4e2d\u7684\u5b57\u5178\u5e8f\u6392\u540d\u3002</p> <pre><code>#include &lt;bits/stdc++.h&gt;\n#define int long long\nusing namespace std;\nconstexpr int MOD = 998244353;\nconstexpr int N = 1e6 + 5;\nint n, x, d[N], fac[N], ans;\nvoid add(int i, int x) {\n    for (; i &lt;= n; i += (i &amp; -i)) d[i] += x;\n}\nint query(int i, int s = 0) {\n    for (; i &gt; 0; i -= (i &amp; -i)) s += d[i];\n    return s;\n}\nsigned main() {\n    cin.tie(nullptr)-&gt;sync_with_stdio(false);\n    cin &gt;&gt; n;\n    fac[0] = 1;\n    for (int i = 1; i &lt;= n; ++i) {\n        d[i] = (i &amp; -i);                 // O(n) \u5efa\u6811\n        fac[i] = (fac[i - 1] * i) % MOD;  // \u9884\u5904\u7406\u9636\u4e58\n    }\n    for (int i = 1; i &lt;= n; ++i) {\n        cin &gt;&gt; x;\n        add(x, -1);\n        ans = (ans + query(x) * fac[n - i] % MOD) % MOD;\n    }\n    cout &lt;&lt; ans + 1 &lt;&lt; '\\n';\n}\n</code></pre>"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#29","title":"2.9 \u9006\u5eb7\u6258\u5c55\u5f00","text":"<p>\u7531\u4e8e \\(n\\) \u4e0d\u4f1a\u8d85\u8fc720\uff08\u5426\u5219\u6ca1\u6cd5\u5904\u7406\u9636\u4e58\uff09\uff0c\u8fd9\u91cc\u63d0\u4f9b\u66b4\u529b\u505a\u6cd5\uff0c\u590d\u6742\u5ea6 \\(O(n^2)\\)\u3002</p> <pre><code>#define int long long\nconstexpr int N = 21;\nint fac[N]; // \u9884\u5904\u7406\u4e00\u4e0b\u9636\u4e58\u8868\nvector&lt;int&gt; get_inv_cantor(int n, int k) { // k\u4ece0\u5f00\u59cb\n    vector&lt;int&gt; perm;\n    vector&lt;bool&gt; used(n + 1, false);\n    for (int i = n; i &gt;= 1; --i) {\n        int order = k / fac[i - 1];\n        k %= fac[i - 1];\n        for (int j = 1; j &lt;= n; ++j) {\n            if (used[j]) continue;\n            if (order == 0) {\n                perm.push_back(j);\n                used[j] = true;\n                break;\n            }\n            order--;\n        }\n    }\n    return perm;\n}\n</code></pre>"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#210-stirling-number","title":"2.10 \u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff08Stirling Number\uff09","text":"<p>\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff08\u65af\u7279\u6797\u5b50\u96c6\u6570\uff09\\(\\begin{Bmatrix}n\\\\ k\\end{Bmatrix}\\)\uff0c\u4e5f\u53ef\u8bb0\u505a \\(S(n,k)\\)\uff0c\u8868\u793a\u5c06 \\(n\\) \u4e2a\u4e24\u4e24\u4e0d\u540c\u7684\u5143\u7d20\uff0c\u5212\u5206\u4e3a \\(k\\) \u4e2a\u4e92\u4e0d\u533a\u5206\u7684\u975e\u7a7a\u5b50\u96c6\u7684\u65b9\u6848\u6570\u3002</p>"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#2101","title":"2.10.1 \u9012\u63a8\u5f0f","text":"\\[ \\begin{Bmatrix}n\\\\ k\\end{Bmatrix}=\\begin{Bmatrix}n-1\\\\ k-1\\end{Bmatrix}+k\\begin{Bmatrix}n-1\\\\ k\\end{Bmatrix} \\] <p>\u8fb9\u754c\u662f \\(\\begin{Bmatrix}n\\\\ 0\\end{Bmatrix}=[n=0]\\)\u3002</p>"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#2102","title":"2.10.2 \u901a\u9879\u516c\u5f0f","text":"\\[ \\begin{Bmatrix}n\\\\m\\end{Bmatrix}=\\sum\\limits_{i=0}^m\\dfrac{(-1)^{m-i}i^n}{i!(m-i)!} \\]"},{"location":"CP/templates/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/#2103","title":"2.10.3 \u540c\u4e00\u884c\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u7684\u8ba1\u7b97","text":"<p>\u300c\u540c\u4e00\u884c\u300d\u7684\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u6307\u7684\u662f\uff0c\u6709\u7740\u4e0d\u540c\u7684 \\(i\\)\uff0c\u76f8\u540c\u7684 \\(n\\) \u7684\u4e00\u7cfb\u5217 \\(\\begin{Bmatrix}n\\\\i\\end{Bmatrix}\\)\u3002\u6c42\u51fa\u540c\u4e00\u884c\u7684\u6240\u6709\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff0c\u5c31\u662f\u5bf9 \\(i=0..n\\) \u6c42\u51fa\u4e86\u5c06 \\(n\\) \u4e2a\u4e0d\u540c\u5143\u7d20\u5212\u5206\u4e3a \\(i\\) \u4e2a\u975e\u7a7a\u96c6\u7684\u65b9\u6848\u6570\u3002</p> <p>\u6839\u636e\u4e0a\u9762\u7ed9\u51fa\u7684\u901a\u9879\u516c\u5f0f\uff0c\u5377\u79ef\u8ba1\u7b97\u5373\u53ef\u3002\u8be5\u505a\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(n \\log n)\\)\u3002</p>"},{"location":"course/","title":"\u8bfe\u7a0b","text":"<p>\u8fd9\u4e2a\u90e8\u5206\u5c06\u5c55\u793a\u672c\u4eba\u5728\u672c\u79d1\u9636\u6bb5\u63a5\u89e6\u7684\u4e00\u4e9b\u8ba1\u7b97\u673a\u8bfe\u7a0b\u4e0e\u5b9e\u9a8c, \u76ee\u524d\u5c1a\u672a\u6574\u7406\u5b8c\u3002</p>"},{"location":"course/ComputerNetwork/","title":"\u8ba1\u7b97\u673a\u7f51\u7edc","text":"<p>\u8fd9\u91cc\u5305\u542b\u4e86BUPT\u672a\u6765\u5b66\u9662\u300a\u8ba1\u7b97\u673a\u7f51\u7edc\u300b\u8bfe\u7a0b\u7684\u4f5c\u4e1a\u548c\u5b9e\u9a8c\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%83%E6%AC%A1%E4%BD%9C%E4%B8%9A/","title":"\u8ba1\u7b97\u673a\u7f51\u7edc\u7b2c\u4e03\u6b21\u4f5c\u4e1a","text":""},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%83%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r3","title":"\u7b2c\u4e00\u9898 R3","text":"<p>\u8def\u5f84\u635f\u8017\u6307\u7684\u662f\u65e0\u7ebf\u4fe1\u53f7\u5728\u4f20\u64ad\u8fc7\u7a0b\u4e2d\u4ea7\u751f\u8870\u51cf\uff1b\u591a\u5f84\u4f20\u64ad\u6307\u7684\u662f\u4fe1\u53f7\u7ecf\u53cd\u5c04\u4ee5\u4e0d\u540c\u8def\u5f84\u5230\u8fbe\u63a5\u6536\u7aef\u4ea7\u751f\u6df7\u53e0\uff1b\u6765\u81ea\u5176\u4ed6\u6e90\u7684\u5e72\u6270\u6307\u7684\u662f\u540c\u4e00\u9891\u6bb5\u7684\u4e0d\u540c\u4fe1\u53f7\u4e4b\u95f4\u76f8\u4e92\u5e72\u6270\u3002\u4e09\u8005\u4ea7\u751f\u65e0\u7ebf\u4fe1\u9053\u635f\u4f24\u7684\u65b9\u5f0f\u4e0d\u540c\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%83%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r4","title":"\u7b2c\u4e8c\u9898 R4","text":"<p>\u589e\u52a0\u4f20\u8f93\u529f\u7387\u6216\u8005\u6539\u53d8\u8c03\u5236\u65b9\u6848\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%83%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r26","title":"\u7b2c\u4e09\u9898 R26","text":"<p>\u201c\u4e09\u89d2\u5f62\u8def\u7531\u201d\u6307\u7684\u662f\u79fb\u52a8\u7ed3\u70b9\u7684\u95f4\u63a5\u8def\u7531\u9009\u62e9\u65b9\u6cd5\u5b58\u5728\u7684\u4f4e\u6548\u95ee\u9898\u3002\u5728\u901a\u4fe1\u8005\u4e0e\u79fb\u52a8\u8282\u70b9\u4e4b\u95f4\u5b58\u5728\u4e00\u6761\u66f4\u6709\u6548\u7684\u8def\u7531\uff0c\u53d1\u5f80\u79fb\u52a8\u8282\u70b9\u7684\u6570\u636e\u62a5\u4e5f\u8981\u5148\u53d1\u7ed9\u5f52\u5c5e\u4ee3\u7406\uff0c\u7136\u540e\u518d\u53d1\u9001\u5230\u5916\u90e8\u7f51\u7edc\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%83%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p8","title":"\u7b2c\u56db\u9898 P8","text":"<p>a.</p> <p>\u5047\u5b9a\u6709\u4e00\u6761\u62a5\u6587\uff0c\u4eceC\u5230B\u9700\u8981\u4e00\u4e2a\u65f6\u9699\uff0c\u4eceB\u5230A\u9700\u8981\u4e00\u4e2a\u65f6\u9699\uff08\u6b64\u65f6C\u4e0d\u80fd\u4f20\u7ed9B\uff09\u3002\u56e0\u6b64\u6700\u5927\u901f\u7387\u4e3a\u6bcf\u4e2a\u65f6\u96990.5\u6761\u62a5\u6587</p> <p>b.</p> <p>\u4e24\u8fb9\u540c\u65f6\u53d1\u9001\u6ca1\u6709\u5e72\u6270\uff0c\u6700\u5927\u901f\u7387\u662f\u6bcf\u4e2a\u65f6\u96992\u6761\u62a5\u6587\u3002</p> <p>c.</p> <p>A\u5411B\u53d1\u7684\u65f6\u5019C\u5fc5\u987b\u9759\u9ed8\uff0c\u5426\u5219B\u4f1a\u6536\u4e0d\u5230\u3002A\u548cC\u8f6e\u6d41\u53d1\uff0c\u6bcf\u4e2a\u65f6\u96991\u6761\u62a5\u6587\u3002</p> <p>d.</p> <p>\u200b   a\uff09\u5982\u679cB\u53ef\u4ee5\u8fb9\u53d1\u8fb9\u6536\uff0c\u6bcf\u4e2a\u65f6\u96991\u6761\u62a5\u6587\uff0c\u5426\u5219\u4ecd\u662f\u6bcf\u4e2a\u65f6\u96990.5\u6761\u62a5\u6587\u3002</p> <p>\u200b   b\uff09\u6bcf\u4e2a\u65f6\u96992\u6761\u62a5\u6587\u3002</p> <p>\u200b   c\uff09\u6bcf\u4e2a\u65f6\u96992\u6761\u62a5\u6587</p> <p>e.</p> <p>\u200b   a\uff09\u4e00\u6b21\u5b8c\u6574\u4f20\u8f93\u9700\u8981C-&gt;B-&gt;A-&gt;B-&gt;C\u56db\u4e2a\u65f6\u9699\uff0c\u6bcf\u4e2a\u65f6\u96990.25\u4e2a\u5305\u3002</p> <p>\u200b   b\uff09A-&gt;B \u540c\u65f6 D-&gt;C, B-&gt;A \u540c\u65f6 C-&gt;D\u3002\u6bcf\u4e2a\u65f6\u96991\u4e2a\u5305\u3002</p> <p>\u200b   c\uff09 A-&gt;B\uff08\u6570\u636e\uff09, B-&gt;A\uff08ACK\uff09 \u540c\u65f6 C-&gt;D\uff08\u6570\u636e\uff09, A-&gt;B\uff08\u7b2c\u4e8c\u4e2a\u5305\uff09\u540c\u65f6D-&gt;C\u53d1\u9001ACK\u3002\u957f\u671f\u6765\u770b\uff0c\u4ecd\u7136\u662f\u6bcf\u4e2a\u65f6\u96991\u4e2a\u5305\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%83%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p11","title":"\u7b2c\u4e94\u9898 P11","text":"<p>a.</p> <p>\u4e0d\u80fd\uff0c\u56e0\u4e3a\u8ddd\u79bb\u5411\u91cf\u7b97\u6cd5\u6bcf\u6b21\u53ea\u80fd\u66f4\u65b0\u76f8\u90bb\u8def\u7531\u5668\u7684\u8f6c\u53d1\u8868\uff0c\u5f97\u8981\u6574\u6761\u8def\u5f84\u4e0a\u7684\u8def\u7531\u5668\u90fd\u66f4\u65b0\u4e86\u4e4b\u540e\u624d\u80fd\u8def\u7531\u5230\u65b0\u7684\u5916\u90e8\u7f51\u7edc\u3002</p> <p>b.</p> <p>\u6709\u53ef\u80fd\uff0c\u5728\u8f6c\u53d1\u8868\u9010\u6e10\u66f4\u65b0\u7684\u9636\u6bb5\uff0c\u66f4\u65b0\u8fc7\u7684\u8def\u7531\u5668\u8ba4\u4e3a\u7528\u6237\u5728\u65b0\u7684\u5916\u90e8\u7f51\u7edc\uff0c\u672a\u66f4\u65b0\u7684\u8def\u7531\u5668\u8ba4\u4e3a\u7528\u6237\u8fd8\u5728\u539f\u6765\u7684\u7f51\u7edc\u3002</p> <p>c.</p> <p>\u7f51\u7edc\u4e2d\u7684\u6240\u6709\u8def\u7531\u5668\u90fd\u77e5\u9053\u5230\u8fbe\u79fb\u52a8\u7528\u6237\u7684\u8def\u5f84\uff0c\u9700\u8981\u6240\u6709\u7684\u8f6c\u53d1\u8868\u90fd\u88ab\u66f4\u65b0\uff0c\u6240\u9700\u65f6\u95f4\u7ea6\u4e3a\u7f51\u7edc\u4e2d\u4efb\u610f\u4e24\u70b9\u7684\u5e73\u5747\u8df3\u6570\u4e58\u4ee5\u5e73\u5747\u6bcf\u4e00\u8df3\u7684\u66f4\u65b0\u95f4\u9694\u3002\u6700\u574f\u60c5\u51b5\u662f\u7f51\u7edc\u4e2d\u76f8\u8ddd\u6700\u8fdc\u7684\u4e24\u8282\u70b9\u4e4b\u95f4\u7684\u8df3\u6570\u4e58\u4ee5\u6bcf\u4e00\u8df3\u7684\u66f4\u65b0\u95f4\u9694\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%89%E6%AC%A1%E4%BD%9C%E4%B8%9A/","title":"\u8ba1\u7b97\u673a\u7f51\u7edc\u7b2c\u4e09\u6b21\u4f5c\u4e1a","text":"<p>\u5317\u4eac\u90ae\u7535\u5927\u5b66 2023212723 \u5434\u5b87\u9534</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%89%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p2","title":"\u7b2c\u4e00\u9898 P2","text":"<ul> <li>\u6e90\u7aef\u53e3\uff1a80\uff0c\u76ee\u7684\u7aef\u53e3\uff1a26145\uff0c\u6e90IP\uff1aB\uff0c \u76ee\u7684IP\uff1aC</li> <li>\u6e90\u7aef\u53e3\uff1a80\uff0c\u76ee\u7684\u7aef\u53e3\uff1a7532\uff0c\u6e90IP\uff1aB\uff0c \u76ee\u7684IP\uff1aC</li> <li>\u6e90\u7aef\u53e3\uff1a80\uff0c\u76ee\u7684\u7aef\u53e3\uff1a26145\uff0c\u6e90IP\uff1aB\uff0c \u76ee\u7684IP\uff1aA</li> </ul>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%89%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p3","title":"\u7b2c\u4e8c\u9898 P3","text":"<ul> <li> <p>8bit\u5b57\u8282\u548c=100101101\uff0c\u6ea2\u51fa\u7684\u4e00\u4f4d\u52a0\u5230\u7b2c\u96f6\u4f4d\uff0c\u5f97\u523000101110\uff0c\u53d6\u53cd\u540e\u5f97\u523011010001\u3002</p> </li> <li> <p>\u76f4\u63a5\u4f7f\u7528\u5b57\u8282\u548c\u53ef\u80fd\u56e0\u4e3a\u8fdb\u4f4d\u6ea2\u51fa\u800c\u4e22\u5931\u90e8\u5206\u4fe1\u606f\uff0c\u800c\u53cd\u7801\u901a\u8fc7\u5c06\u6ea2\u51fa\u4f4d\u52a0\u5230\u7b2c\u96f6\u4f4d\u518d\u53d6\u53cd\u4fdd\u7559\u4e86\u66f4\u591a\u4fe1\u606f\u3002</p> </li> <li>\u63a5\u6536\u65b9\u5c06\u6240\u6709\u6570\u636e\uff08\u5305\u62ec\u6821\u9a8c\u548c\uff09\u6309\u76f8\u540c\u65b9\u5f0f\u8ba1\u7b97\u548c\u3002\u5982\u679c\u7ed3\u679c\u5168\u4e3a1\uff08\u5373\u53cd\u7801\u548c\u4e3a<code>11111111</code>\uff09\uff0c\u8bf4\u660e\u6570\u636e\u6b63\u786e\uff1b\u5426\u5219\u5b58\u5728\u9519\u8bef\u3002</li> <li>\u5982\u679c\u67091\u6bd4\u7279\u5dee\u9519\uff0c\u4f1a\u5bfc\u81f4\u6700\u7ec8\u7684\u7ed3\u679c\u4e0d\u5168\u4e3a1\uff0c\u53ef\u4ee5\u68c0\u6d4b\u51fa\u6765\u3002</li> <li>\u5982\u679c\u67092\u6bd4\u7279\u5dee\u9519\uff0c\u5047\u8bbe\u76f8\u540c\u4f4d1\u53d80\uff0c0\u53d81\uff0c\u90a3\u4e48\u5c06\u4f1a\u68c0\u6d4b\u4e0d\u51fa\u3002</li> </ul>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%89%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p5","title":"\u7b2c\u4e09\u9898 P5","text":"<p>\u4e0d\u80fd\uff0c\u6b63\u5982\u4e0a\u4e00\u9898\u6240\u8bf4\u7684\uff0c2\u6bd4\u7279\u5dee\u9519\uff0c\u6216\u8005\u8bf4\u5076\u6570\u6bd4\u7279\u5dee\u9519\uff0c\u6709\u53ef\u80fd\u68c0\u6d4b\u4e0d\u51fa\u6765\u3002\u56e0\u6b64\u63a5\u6536\u65b9\u4e0d\u80fd\u786e\u4fe1\u6ca1\u6709\u51fa\u73b0\u8fc7\u6bd4\u7279\u5dee\u9519\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%89%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p6","title":"\u7b2c\u56db\u9898 P6","text":"<p>\u5f53\u63a5\u6536\u65b9\u7684ACK\u5728\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u635f\u574f\u6216\u4e22\u5931\u65f6\uff0c\u63a5\u6536\u65b9\u7b49\u5f85\u4e0b\u4e00\u4e2a\u5305\uff0c\u4f46\u662f\u53d1\u9001\u65b9\u7531\u4e8e\u6ca1\u6709\u6536\u5230ACK\u800c\u4e00\u76f4\u53d1\u4e0a\u4e00\u4e2a\u5305\uff0c\u5bfc\u81f4\u53cc\u65b9\u90fd\u8fdb\u5165\u6b7b\u9501\u72b6\u6001\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%89%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p14","title":"\u7b2c\u4e94\u9898 P14","text":"<ul> <li>\u5f53\u53d1\u9001\u65b9\u5076\u5c14\u53d1\u9001\u6570\u636e\u65f6\uff0c\u4f7f\u7528\u4ec5NAK\u7684\u534f\u8bae\u66f4\u597d\uff0c\u56e0\u4e3a\u6570\u636e\u53d1\u9001\u9891\u7387\u4f4e\uff0c\u4e22\u5305\u6216\u51fa\u9519\u6982\u7387\u8f83\u5c0f\uff0cNAK\u4ec5\u5728\u4e22\u5305\u6216\u51fa\u9519\u65f6\u89e6\u53d1\uff0c\u51cf\u5c11\u4e86\u786e\u8ba4\u6d88\u606f\u7684\u6570\u91cf\uff0c\u8282\u7701\u7f51\u7edc\u8d44\u6e90\u3002\u53e6\u5916\uff0c\u53d1\u9001\u65b9\u65e0\u9700\u4e3a\u6bcf\u4e2a\u6570\u636e\u5305\u7ef4\u62a4ACK\u8ba1\u65f6\u5668\uff0c\u964d\u4f4e\u4e86\u534f\u8bae\u7684\u590d\u6742\u5ea6\u4e0e\u8d44\u6e90\u5f00\u9500\u3002</li> <li>\u5f53\u53d1\u9001\u65b9\u4f20\u8f93\u5927\u91cf\u6570\u636e\u4e14\u4e22\u5305\u7387\u4f4e\u65f6\uff0c\u4f7f\u7528\u4ec5NAK\u7684\u534f\u8bae\u4ecd\u7136\u66f4\u4f18\u3002\u56e0\u4e3a\u5728\u4f4e\u4e22\u5305\u7387\u7684\u573a\u666f\u4e0b\uff0cNAK\u7684\u89e6\u53d1\u6b21\u6570\u8f83\u5c11\uff0c\u907f\u514d\u4e86\u5927\u91cfACK\u7684\u6570\u636e\u4f20\u8f93\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u53d1\u9001\u65b9\u53ef\u4ee5\u6301\u7eed\u53d1\u9001\u6570\u636e\u800c\u65e0\u9700\u7b49\u5f85ACK\uff0c\u80fd\u63d0\u9ad8\u541e\u5410\u91cf\u3002</li> </ul>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%89%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p15","title":"\u7b2c\u516d\u9898 P15","text":"<p>\u53d1\u9001\u4e00\u4e2a\u5206\u7ec4\u8fdb\u5165 \\(1\\text{Gbps}\\) \u94fe\u8def\u6240\u9700\u65f6\u95f4\u4e3a\uff1a $$ t_{trans} = \\frac{L}{R} = \\frac{8\\times15\\text{bit/pkt}}{10^9\\text{bit/s}}=1.2\\times10^{-5}\\text{s} $$ \u4e3a\u4f7f\u4fe1\u9053\u5229\u7528\u7387\u8d85\u8fc7 \\(90\\%\\)\uff0c $$ U_{sender} = \\frac{n\\times t_{trans}}{\\text{RTT} + t_{trans}} = \\frac{0.012n}{30.012} \\ge 90\\% $$ \u89e3\u5f97 \\(n \\ge 2251\\)\u3002</p> <p>\u5373\u7a97\u53e3\u957f\u5ea6\u9700\u8981\u5927\u4e8e\u7b49\u4e8e2251\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%89%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p31","title":"\u7b2c\u4e03\u9898 P31","text":"<ul> <li> <p>\u5f97\u5230106ms\u540e:  </p> </li> <li> <p>\\(DevRTT = 0.75 \\times 5 + 0.25 \\times |106 - 100| = 5.25\\) ms  </p> </li> <li>\\(EstimatedRTT = 0.875 \\times 100 + 0.125 \\times 106 = 100.75\\) ms  </li> <li> <p>\\(TimeoutInterval = 100.75 + 4 \\times 5.25 = 121.75\\) ms  </p> </li> <li> <p>\u5f97\u5230120ms\u540e:  </p> <ul> <li>\\(DevRTT = 0.75 \\times 5.25 + 0.25 \\times |120 - 100.75| = 8.75\\) ms  </li> <li>\\(EstimatedRTT = 0.875 \\times 100.75 + 0.125 \\times 120 = 103.16\\) ms  </li> <li>\\(TimeoutInterval = 103.16 + 4 \\times 8.75 = 138.16\\) ms  </li> </ul> </li> <li> <p>\u5f97\u5230140ms\u540e:  </p> <ul> <li>\\(DevRTT = 0.75 \\times 8.75 + 0.25 \\times |140 - 103.16| = 15.77\\) ms  </li> <li>\\(EstimatedRTT = 0.875 \\times 103.16 + 0.125 \\times 140 = 107.76\\) ms  </li> <li>\\(TimeoutInterval = 107.76 + 4 \\times 15.77 = 170.84\\) ms  </li> </ul> </li> <li> <p>\u5f97\u523090ms\u540e:  </p> <ul> <li>\\(DevRTT = 0.75 \\times 15.77 + 0.25 \\times |90 - 107.76| = 16.27\\) ms  </li> <li>\\(EstimatedRTT = 0.875 \\times 107.76 + 0.125 \\times 90 = 105.54\\) ms  </li> <li>\\(TimeoutInterval = 105.54 + 4 \\times 16.27 = 170.62\\) ms  </li> </ul> </li> <li> <p>\u5f97\u5230115ms\u540e:  </p> <ul> <li>\\(DevRTT = 0.75 \\times 16.27 + 0.25 \\times |115 - 105.54| = 14.57\\) ms  </li> <li>\\(EstimatedRTT = 0.875 \\times 105.54 + 0.125 \\times 115 = 106.72\\) ms  </li> <li>\\(TimeoutInterval = 106.72 + 4 \\times 14.57 = 165\\) ms  </li> </ul> </li> </ul>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%89%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p33","title":"\u7b2c\u516b\u9898 P33","text":"<p>\u5f53\u53d1\u9001\u7aef\u7b2c\u4e00\u6b21\u53d1\u9001\u62a5\u6587\uff0c\u7b49\u5f85ACK\uff0c\u8d85\u65f6\u540e\u91cd\u4f20\uff0c\u5047\u8bbe\u5728\u6b64\u65f6\u542f\u52a8\u8ba1\u65f6\uff0c\u5f53\u53d1\u9001\u7aef\u63a5\u6536\u5230ACK\u540e\u7ed3\u675f\u8ba1\u65f6\uff0c\u4f46\u6b64\u65f6\u63a5\u6536\u5230\u7684ACK\u53ef\u80fd\u662f\u7b2c\u4e00\u6b21\u53d1\u9001\u62a5\u6587\u7684\u8fd4\u56deACK\uff0c\u56e0\u6b64\u91cd\u4f20\u62a5\u6587\u7684sampleRTT\u8ba1\u7b97\u6709\u8bef\u3002\u6240\u4ee5\u8981\u907f\u514d\u6d4b\u91cf\u91cd\u4f20\u62a5\u6587\u6bb5\u7684sampleRTT\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%89%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p40","title":"\u7b2c\u4e5d\u9898 P40","text":"<p>\u200b   a. \u6162\u542f\u52a8\u65f6\u95f4\u4e3a0\\~6\u4e0e23\\~26\uff0c\u6bcf\u9694\u4e00\u4e2a\u8f6e\u56de\u7a97\u53e3\u957f\u5ea6\u7ffb\u500d\u3002</p> <p>\u200b   b. \u62e5\u585e\u907f\u514d\u7684\u65f6\u95f4\u4e3a6\\~16\u4e0e17\\~22\uff0c\u7a97\u53e3\u957f\u5ea6\u7ebf\u6027\u589e\u957f\u3002</p> <p>\u200b   c. \u662f\u6839\u636e\u4e09\u4e2a\u5197\u4f59ACK\u6d4b\u51fa\u7684\uff0c\u5426\u5219\u7a97\u53e3\u957f\u5ea6\u4f1a\u964d\u4f4e\u52301\u3002</p> <p>\u200b   d. \u7b2c22\u4e2a\u4f20\u8f93\u8f6e\u56de\u540e\u662f\u6839\u636e\u8d85\u65f6\u68c0\u6d4b\u51fa\u7684\uff0c\u56e0\u4e3a\u7a97\u53e3\u957f\u5ea6\u964d\u4f4e\u52301\u3002</p> <p>\u200b   e. ssthresh\u7684\u521d\u59cb\u503c\u8bbe\u7f6e\u4e3a32\uff0c\u56e0\u4e3a\u7a97\u53e3 \u957f\u5ea6\u523032\u65f6\u5f00\u59cb\u62e5\u585e\u907f\u514d\u3002</p> <p>\u200b   f. \u5728\u7b2c16\u4e2a\u4f20\u8f93\u8f6e\u56de\u68c0\u6d4b\u5230\u4e22\u5305\uff0cssthresh\u8bbe\u7f6e\u4e3a42\u7684\u4e00\u534a\uff0c\u4e5f\u5c31\u662f21\u3002</p> <p>\u200b   g. \u5728\u7b2c22\u4e2a\u4f20\u8f93\u8f6e\u56de\u68c0\u6d4b\u5230\u4e22\u5305\uff0cssthresh\u8bbe\u7f6e\u4e3a29\u7684\u4e00\u534a\u4e0b\u53d6\u6574\uff0c\u4e5f\u5c31\u662f14.</p> <p>\u200b   h. \u7a97\u53e3\u957f\u5ea6[1,2,4,8,16,32,33,34,...]\uff0c\u53d6\u4e00\u4e2a\u524d\u7f00\u548c\uff0c\u5f97\u5230[1,3,7,15,31,64,100,...]\uff0c\u5728\u7b2c7\u4e2a\u4f20\u8f93\u56de\u5408\u8d85\u8fc770\uff0c\u56e0\u6b64\u5728\u7b2c7\u4e2a\u56de\u5408\u53d1\u9001\u7b2c70\u4e2a\u62a5\u6587\u6bb5\u3002</p> <p>\u200b   i. ssthressh\u53d8\u6210\u4e00\u534a\u7684\u7a97\u53e3\u957f\u5ea6\uff0c\u4e5f\u5c31\u662f4\uff0c\u7a97\u53e3\u957f\u5ea6\u53d8\u6210ssthresh+3\uff0c\u4e5f\u5c31\u662f7\u3002</p> <p>\u200b   j. \u5982\u679c\u662fTCP Tahoe\uff0c\u5728\u7b2c17\u56de\u5408\u53d8\u62101\uff0c18\u56de\u5408\u53d8\u62102\uff0c19\u56de\u5408\u53d8\u62104\u3002ssthressh\u4e3a21\u3002</p> <p>\u200b   k. 17~21\u8f6e\uff0c\u517131\u4e2a\u5206\u7ec4\uff0c22\u8f6e21\u4e2a\u5206\u7ec4\uff0c\u517152\u4e2a\u5206\u7ec4\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%B8%89%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p54","title":"\u7b2c\u5341\u9898 P54","text":"<p>\u8003\u8651\u7a97\u53e3\u957f\u5ea6\u4ece \\(W/2\\) \u589e\u52a0\u5230 \\(W\\) \u7684\u8fc7\u7a0b\uff0c\u4f20\u8f93\u7684\u603b\u62a5\u6587\u6bb5\u6570\u4e3a\uff1a $$ \\begin{aligned} s &amp;= \\frac{W}{2} + \\frac{W}{2} \\times (1+\\alpha) + \\cdots + \\frac{W}{2} \\times (1+\\alpha)^{\\lfloor \\log_{1+\\alpha} 2 \\rfloor} \\ &amp;\\approx W \\times \\frac{2\\alpha + 1}{2\\alpha} \\end{aligned} $$ \u4e22\u5305\u7387\u4e3a\uff1a $$ \\begin{aligned} L &amp;= \\frac{1}{s} \\ &amp;= \\frac{2\\alpha}{W \\times (2\\alpha + 1)} \\end{aligned} $$ \u6240\u9700\u65f6\u95f4\u4e3a\uff1a $$ RTT \\times \\lfloor log_{\\alpha+1}{2} \\rfloor $$ \u4e0eTCP\u7684\u5e73\u5747\u541e\u5410\u65e0\u5173\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BD%9C%E4%B8%9A/","title":"\u8ba1\u7b97\u673a\u7f51\u7edc\u7b2c\u4e8c\u6b21\u4f5c\u4e1a","text":""},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p3","title":"\u7b2c\u4e00\u9898 P3","text":"<p>\u200b   \u9664\u4e86 HTTP \u5916\uff0c\u8fd8\u9700\u8981\u4f20\u8f93\u5c42\u7684 TCP \u534f\u8bae\u548c\u5e94\u7528\u5c42\u7684 DNS \u534f\u8bae\u3002\u5176\u4e2d\uff0cDNS \u534f\u8bae\u7528\u4e8e\u5c06\u57df\u540d\u89e3\u6790\u4e3a IP \u5730\u5740\uff0cTCP \u534f\u8bae\u7528\u4e8e\u7ed9 HTTP \u63d0\u4f9b\u53ef\u9760\u7684\u6570\u636e\u4f20\u8f93\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p4","title":"\u7b2c\u4e8c\u9898 P4","text":""},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BD%9C%E4%B8%9A/#a-url","title":"a. \u7531\u6d4f\u89c8\u5668\u8bf7\u6c42\u7684\u6587\u6863\u7684 URL \u662f\u4ec0\u4e48\uff1f","text":"<p>\u200b   \u4f9d\u636e\u7b2c\u4e00\u884c <code>GET /cs453/index.html</code> \u8868\u793a\u8bf7\u6c42\u7684\u8def\u5f84\u662f <code>/cs453/index.html</code>\uff0c<code>Host: gaia.cs.umass.edu</code> \u8868\u793a\u8be5\u670d\u52a1\u5668\u7684\u4e3b\u673a\u540d\u3002\u56e0\u6b64\u5b8c\u6574\u7684URL\u4e3ahttp://gaia.cs.umass.edu/cs453/index.html\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BD%9C%E4%B8%9A/#b-http","title":"b. \u8be5\u6d4f\u89c8\u5668\u8fd0\u884c\u7684\u662f HTTP \u7684\u4f55\u79cd\u7248\u672c\uff1f","text":"<p>\u200b   \u7b2c\u4e00\u884c <code>GET /cs453/index.html HTTP/1.1</code> \u8868\u660e\u8fd0\u884c\u7684\u662f \\(1.1\\) \u7248\u672c\u7684 HTTP\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BD%9C%E4%B8%9A/#c","title":"c. \u8be5\u6d4f\u89c8\u5668\u8bf7\u6c42\u7684\u662f\u4e00\u6761\u975e\u6301\u7eed\u8fde\u63a5\u8fd8\u662f\u4e00\u6761\u6301\u7eed\u8fde\u63a5\uff1f","text":"<p>\u200b   \u6700\u540e\u4e00\u884c <code>Connection: keep-alive</code> \u8868\u793a\u6d4f\u89c8\u5668\u8bf7\u6c42\u7684\u662f\u4e00\u6761\u6301\u7eed\u8fde\u63a5\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BD%9C%E4%B8%9A/#d-ip","title":"d. \u8be5\u6d4f\u89c8\u5668\u6240\u8fd0\u884c\u7684\u4e3b\u673a\u7684 IP \u5730\u5740\u662f\u4ec0\u4e48\uff1f","text":"<p>\u200b   \u8fd9\u6761\u62a5\u6587\u91cc\u597d\u50cf\u6ca1\u6709\u627e\u5230\u76f8\u5173\u4fe1\u606f\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BD%9C%E4%B8%9A/#e-http","title":"e. \u53d1\u8d77\u8be5\u62a5\u6587\u7684\u6d4f\u89c8\u5668\u7684\u7c7b\u578b\u662f\u4ec0\u4e48\uff1f\u5728 HTTP \u8bf7\u6c42\u62a5\u6587\u4e2d\uff0c\u4e3a\u4ec0\u4e48\u9700\u8981\u6d4f\u89c8\u5668\u7c7b\u578b\uff1f","text":"<p>\u200b   \u4f9d\u636e <code>User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.2) Gecko/20040804 Netscape/7.2 (ax)</code> \u8868\u660e\u8be5\u6d4f\u89c8\u5668\u7c7b\u578b\u662f <code>Netscape 7.2</code> \u3002\u9700\u8981\u6d4f\u89c8\u5668\u7c7b\u578b\u7684\u539f\u56e0\u662f\u670d\u52a1\u5668\u9700\u8981\u6839\u636e\u4e0d\u540c\u7684\u6d4f\u89c8\u5668\u7c7b\u578b\u6765\u8fd4\u56de\u7279\u5b9a\u7248\u672c\u7684 HTML/CSS/JS \u4ee5\u517c\u5bb9\u65e7\u7248\u672c\u7684\u6d4f\u89c8\u5668\u3001\u7ed9\u624b\u673a\u6d4f\u89c8\u5668\u663e\u793a\u624b\u673a\u7248\u7684\u9875\u9762\u4ee5\u53ca\u5c4f\u853d\u67d0\u4e9b\u7279\u5b9a\u7684\u6d4f\u89c8\u5668\u6216\u722c\u866b\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p7","title":"\u7b2c\u4e09\u9898 P7","text":"<p>\u200b   \u8bbf\u95ee \\(n\\) \u4e2a DNS \u670d\u52a1\u5668\uff0c\u8bf4\u660e\u662f\u8fed\u4ee3\u67e5\u8be2\uff0cDNS \u67e5\u8be2\u65f6\u95f4\u4e3a\uff1a $$ T_{DNS} = \\sum_{i=1}^{n}RTT_i $$ \u200b   \u5728\u5efa\u7acb TCP \u8fde\u63a5\u65f6\uff0c\u524d\u4e24\u6b21\u63e1\u624b\u9700\u8981\u4e00\u4e2a \\(RTT_0\\), \u6700\u540e\u4e00\u6b21\u63e1\u624b\u9644\u5e26\u53d1\u9001\u8bf7\u6c42\u62a5\u6587\uff0c\u6700\u7ec8\u5f97\u5230\u54cd\u5e94\u9700\u8981\u4e00\u4e2a \\(RTT_0\\)\uff0c\u56e0\u6b64\u603b\u65f6\u95f4\u4e3a\uff1a $$ T_{total} = 2\\cdot RTT_0 +\\sum_{i=1}^{n}RTT_i $$</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p22","title":"\u7b2c\u56db\u9898 P22","text":""},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BD%9C%E4%B8%9A/#1-client-server","title":"1. Client-Server","text":"\\[ T_{c-s} \\geq max\\{\\frac{NF}{u_s}, \\frac{F}{d_{min}}\\} \\] <p>\u5bf9\u4e8e \\(N = 10\\)\uff0c\\(N=100\\)\uff0c\\(N=1000\\) \u7684\u60c5\u51b5\uff0c\u5206\u522b\u4ee3\u5165\u6570\u636e\uff0c\u53ef\u7b97\u5f97\u4e0b\u5217\u6700\u5c0f\u5206\u53d1\u65f6\u95f4\uff1a | N    | \\(T_{\\text{min}}^{\\text{C-S}}\\) (s) | | ---- | --------------------------------- | | 10   | 10,000                            | | 100  | 66,666.67                         | | 1000 | 666,666.67                        |</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BD%9C%E4%B8%9A/#2-p2p","title":"2. P2P","text":"\\[ T_{P2P} \\geq \\max \\left\\{ \\frac{F}{u_s}, \\frac{F}{d_{\\min}}, \\frac{NF}{(u_s + \\sum u_i)} \\right\\} \\] <p>\u5728\u672c\u9898\u4e2d\uff0c\u6bcf\u4e2apeer\u7684\u4e0a\u4f20\u901f\u7387 \\(u_i\\) \u90fd\u76f8\u540c\uff0c\u56e0\u6b64\u4e0a\u5f0f\u53ef\u5199\u6210\uff1a $$ T_{P2P} \\geq \\max \\left{ \\frac{F}{u_s}, \\frac{F}{d_{i}}, \\frac{NF}{u_s + N \\times u} \\right} $$</p> <p>\u5bf9\u4e8e\u6bcf\u4e2a N \u548c u \u7684\u7ec4\u5408\uff0c\u5206\u522b\u4ee3\u5165\u6570\u636e\uff0c\u53ef\u7b97\u5f97\u4e0b\u5217\u6700\u5c0f\u5206\u53d1\u65f6\u95f4\uff1a</p> N \\( u = 300 \\) kbps \\( u = 700 \\) kbps \\( u = 2 \\) Mbps 10 10,000 10,000 10,000 100 33,333.33 20,000 10,000 1000 60,606.06 27,397.26 10,000 <p>\u4f7f\u7528\u4e0b\u9762\u7684python\u7a0b\u5e8f\u751f\u6210\u56fe\u8868\uff1a <pre><code>import matplotlib.pyplot as plt\n\n# \u53c2\u6570\u8bbe\u7f6e\nF = 20 * 1000  # 20 Gb = 20,000 Mb\nu_s = 30  # Mbps\nd_i = 2  # Mbps\nN_values = [10, 100, 1000]  # \u5bf9\u7b49\u65b9\u6570\u91cf\nu_values = [0.3, 0.7, 2]  # \u5bf9\u7b49\u65b9\u4e0a\u4f20\u901f\u7387 (Mbps)\n\n# \u8ba1\u7b97\u5ba2\u6237-\u670d\u52a1\u5668\u6a21\u5f0f\u65f6\u95f4\ndef cs_time(N):\n    return max(N * F / u_s, F / d_i)\n\ncs_times = [cs_time(N) for N in N_values]\n\n# \u8ba1\u7b97P2P\u6a21\u5f0f\u65f6\u95f4\ndef p2p_time(N, u):\n    return max(F / u_s, F / d_i, (N * F) / (u_s + N * u))\n\np2p_times = {\n    '300 kbps': [p2p_time(N, 0.3) for N in N_values],\n    '700 kbps': [p2p_time(N, 0.7) for N in N_values],\n    '2 Mbps': [p2p_time(N, 2) for N in N_values]\n}\n\n# \u7ed8\u5236\u56fe\u8868\nplt.figure(figsize=(12, 8))\n\n# \u5ba2\u6237-\u670d\u52a1\u5668\u6a21\u5f0f\nplt.plot(N_values, cs_times, 'ro-', label='Client-Server', linewidth=2, markersize=8)\n\n# P2P\u6a21\u5f0f\nfor u_label, times in p2p_times.items():\n    plt.plot(N_values, times, 'o--', label=f'P2P (u={u_label})', linewidth=2, markersize=8)\n\n# \u56fe\u8868\u7f8e\u5316\nplt.xscale('log')\nplt.yscale('log')\nplt.xticks(N_values, labels=[str(n) for n in N_values])\nplt.xlabel('Number of Peers (N)', fontsize=12)\nplt.ylabel('Minimum Distribution Time (seconds)', fontsize=12)\nplt.title('File Distribution Time Comparison (F=20Gb)\\n'\n          f'Server: u_s={u_s}Mbps, Clients: d_i={d_i}Mbps', fontsize=14)\nplt.grid(True, which=\"both\", ls=\"-\", alpha=0.3)\nplt.legend(fontsize=12)\nplt.tight_layout()\n\n# \u663e\u793a\u56fe\u8868\nplt.show()\n</code></pre></p> <p>\u7ed3\u679c\u5982\u4e0b\uff1a </p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p27","title":"\u7b2c\u4e94\u9898 P27","text":"<p>a. \u5982\u679c\u751f\u6210\u97f3\u9891\u548c\u89c6\u9891\u7684\u6df7\u5408\u6587\u4ef6\uff0c\u7531\u4e58\u6cd5\u539f\u7406\uff0c\u603b\u5171\u9700\u8981\u5b58\u50a8 \\(N^2\\) \u4e2a\u6587\u4ef6\u3002</p> <p>b. \u5982\u679c\u5206\u522b\u53d1\u9001\u97f3\u9891\u6d41\u548c\u89c6\u9891\u6d41\uff0c\u7531\u52a0\u6cd5\u539f\u7406\uff0c\u603b\u5171\u9700\u8981\u5b58\u50a8 \\(2\\times N\\) \u4e2a\u6587\u4ef6\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%94%E6%AC%A1%E4%BD%9C%E4%B8%9A/","title":"\u8ba1\u7b97\u673a\u7f51\u7edc\u7b2c\u4e94\u6b21\u4f5c\u4e1a","text":""},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%94%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r1","title":"\u7b2c\u4e00\u9898 R1","text":"<p>\u57fa\u4e8e\u6bcf\u8def\u7531\u5668\u63a7\u5236\u7684\u63a7\u5236\u5e73\u9762\u610f\u5473\u7740\u6bcf\u4e2a\u8def\u7531\u5668\u72ec\u7acb\u8fd0\u884c\u8def\u7531\u7b97\u6cd5\uff0c\u8f6c\u53d1\u529f\u80fd\u548c\u8def\u7531\u529f\u80fd\u90fd\u5728\u6bcf\u4e2a\u8def\u7531\u5668\u5185\u90e8\u5b9e\u73b0\uff0c\u5e76\u901a\u8fc7\u4e0e\u5176\u4ed6\u8def\u7531\u5668\u8fdb\u884c\u901a\u4fe1\u6765\u66f4\u65b0\u8f6c\u53d1\u8868\u3002\u8fd9\u65f6\u7f51\u7edc\u7684\u63a7\u5236\u5e73\u9762\u548c\u6570\u636e\u5e73\u9762\u5728\u6bcf\u4e2a\u8def\u7531\u5668\u4e2d\u81ea\u884c\u5b9e\u73b0\uff0c\u56e0\u6b64\u662f\u6574\u4f53\u7684\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%94%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r2","title":"\u7b2c\u4e8c\u9898 R2","text":"<p>\u57fa\u4e8e\u903b\u8f91\u4e0a\u96c6\u4e2d\u63a7\u5236\u7684\u63a7\u5236\u5e73\u9762\u610f\u5473\u7740\u6709\u4e00\u4e2a\u4e2d\u5fc3\u63a7\u5236\u5668\u6765\u8ba1\u7b97\u548c\u5206\u53d1\u8f6c\u53d1\u8868\u7ed9\u6bcf\u4e2a\u8def\u7531\u5668\u3002\u6b64\u65f6\u63a7\u5236\u5e73\u9762\u5728\u4e00\u4e2a\u4e2d\u5fc3\u7684\u670d\u52a1\u5668\u4e0a\uff0c\u6570\u636e\u5e73\u9762\u5728\u6bcf\u4e2a\u8def\u7531\u5668\u4e0a\uff0c\u56e0\u6b64\u4e8c\u8005\u5728\u5206\u79bb\u7684\u8bbe\u5907\u4e2d\u5b9e\u73b0\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%94%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r6","title":"\u7b2c\u4e09\u9898 R6","text":"<p>\u4e0d\u5fc5\u8981\u3002\u6bcf\u4e2a\u81ea\u6d3d\u7cfb\u7edf\u53ef\u4ee5\u81ea\u4e3b\u5728\u7cfb\u7edf\u5185\u9009\u62e9\u5408\u9002\u7684\u8def\u7531\u7b97\u6cd5\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%94%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r9","title":"\u7b2c\u56db\u9898 R9","text":"<p>\u5728OSPF\u81ea\u6d3d\u7cfb\u7edf\u4e2d\uff0c\u533a\u57df\u6307\u7684\u662f\u4e00\u7ec4\u8def\u7531\u5668\u96c6\u5408\u3002\u96c6\u5408\u4e2d\u7684\u6bcf\u4e2a\u8def\u7531\u5668\u5411\u540c\u4e00\u96c6\u5408\u5185\u7684\u6240\u6709\u5176\u4ed6\u8def\u7531\u5668\u5e7f\u64ad\u5b83\u7684\u94fe\u8def\u72b6\u6001\u3002\u5f15\u5165\u533a\u57df\u7684\u6982\u5ff5\u662f\u4e3a\u4e86\u5c06OSPF\u7cfb\u7edf\u5206\u5c42\uff0c\u6bcf\u4e2a\u533a\u57df\u72ec\u7acb\u8fd0\u884c\u81ea\u8eab\u7684\u94fe\u8def\u72b6\u6001\u7b97\u6cd5\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%94%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r15","title":"\u7b2c\u4e94\u9898 R15","text":"<p>\u6211\u5c06\u5728SDN\u63a7\u5236\u5e73\u9762\u7684\u5e94\u7528\u5c42\u5b9e\u73b0\u8be5\u7b97\u6cd5\uff0c\u56e0\u4e3a\u5e94\u7528\u5c42\u8d1f\u8d23\u7aef\u5230\u7aef\u7684\u8def\u7531\uff0c\u652f\u6301\u5f00\u53d1\u548c\u81ea\u5b9a\u4e49\u7f51\u7edc\u5e94\u7528\uff0c\u7075\u6d3b\u6027\u5f3a\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%94%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r20","title":"\u7b2c\u516d\u9898 R20","text":"<p>ICMP\u8d85\u65f6\u62a5\u6587\uff08Type11\uff09\u548cICMP\u4e0d\u53ef\u8fbe\u62a5\u6587\uff08Type3\uff09</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%94%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p3","title":"\u7b2c\u4e03\u9898 P3","text":"Step N' D(t),p(t) D(u),p(u) D(v),p(v) D(w),p(w) D(y),p(y) D(z),p(z) 0 x \\(\\infin\\) \\(\\infin\\) 3,x 6,x 6,x 8,x 1 xv 7,v 6,v 3,x 6,x 6,x 8,x 2 xvu 7,v 6,v 3,x 6,x 6,x 8,x 3 xvuw 7,v 6,v 3,x 6,x 6,x 8,x 4 xvuwy 7,v 6,v 3,x 6,x 6,x 8,x 5 xvuwyt 7,v 6,v 3,x 6,x 6,x 8,x 6 xvuwytz 7,v 6,v 3,x 6,x 6,x 8,x"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%94%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p4","title":"\u7b2c\u516b\u9898 P4","text":"<p>a.</p> Step N\u2032 D(x),p(x) D(u),p(u) D(v),p(v) D(w),p(w) D(y),p(y) D(z),p(z) 0 t \u221e 2,t 4,t \u221e 7,t \u221e 1 tu \u221e 2,t 4,t 5,u 7,t \u221e 2 tuv 7,v 2,t 4,t 5,u 7,t \u221e 3 tuvw 7,v 2,t 4,t 5,u 7,t \u221e 4 tuvwx 7,v 2,t 4,t 5,u 7,t 15,x 5 tuvwxy 7,v 2,t 4,t 5,u 7,t 15,x 6 tuvwxyz 7,v 2,t 4,t 5,u 7,t 15,x <p>b.</p> Step N\u2032 D(x),p(x) D(t),p(t) D(v),p(v) D(w),p(w) D(y),p(y) D(z),p(z) 0 u \u221e 2,u 3,u 3,u \u221e \u221e 1 ut \u221e 2,u 3,u 3,u 9,t \u221e 2 utv 6,v 2,u 3,u 3,u 9,t \u221e 3 utvw 6,v 2,u 3,u 3,u 9,t \u221e 4 utvwx 6,v 2,u 3,u 3,u 9,t 14,x 5 utvwxy 6,v 2,u 3,u 3,u 9,t 14,x 6 utvwxyz 6,v 2,u 3,u 3,u 9,t 14,x <p>c.</p> Step N\u2032 D(x),p(x) D(u),p(u) D(t),p(t) D(w),p(w) D(y),p(y) D(z),p(z) 0 v 3,v 3,v 4,v 4,v 8,v \u221e 1 vx 3,v 3,v 4,v 4,v 8,v 11,x 2 vxu 3,v 3,v 4,v 4,v 8,v 11,x 3 vxut 3,v 3,v 4,v 4,v 8,v 11,x 4 vxutw 3,v 3,v 4,v 4,v 8,v 11,x 5 vxutwy 3,v 3,v 4,v 4,v 8,v 11,x 6 vxutwyz 3,v 3,v 4,v 4,v 8,v 11,x <p>d.</p> Step N' D(x), p(x) D(u), p(u) D(v), p(v) D(t), p(t) D(y), p(y) D(z), p(z) 0 w 6,w 3,w 4,w \u221e \u221e \u221e 1 wu 6,w 3,w 4,w 5,u \u221e \u221e 2 wuv 6,w 3,w 4,w 5,u 12,v \u221e 3 wuvt 6,w 3,w 4,w 5,u 12,v \u221e 4 wuvtx 6,w 3,w 4,w 5,u 12,v 14,x 5 wuvtxy 6,w 3,w 4,w 5,u 12,v 14,x 6 wuvtxyz 6,w 3,w 4,w 5,u 12,v 14,x <p>e.</p> Step N' D(x), p(x) D(u), p(u) D(v), p(v) D(w), p(w) D(t), p(t) D(z), p(z) 0 y 6,y \u221e 8,y \u221e 7,y 12,y 1 yx 6,y \u221e 8,y 12,x 7,y 12,y 2 yxt 6,y 9,t 8,y 12,x 7,y 12,y 3 yxtv 6,y 9,t 8,y 12,x 7,y 12,y 4 yxtvu 6,y 9,t 8,y 12,x 7,y 12,y 5 yxtvuw 6,y 9,t 8,y 12,x 7,y 12,y 6 yxtvuwz 6,y 9,t 8,y 12,x 7,y 12,y <p>f.</p> Step N' D(x), p(x) D(u), p(u) D(v), p(v) D(w), p(w) D(y), p(y) D(t), p(t) 0 z 8,z \u221e \u221e \u221e 12,z \u221e 1 zx 8,z \u221e 11,x 14,x 12,z \u221e 2 zxv 8,z 14,v 11,x 14,x 12,z 15,v 3 zxvu 8,z 14,v 11,x 14,x 12,z 15,v 4 zxvuw 8,z 14,v 11,x 14,x 12,z 15,v 5 zxvuwy 8,z 14,v 11,x 14,x 12,z 15,v 6 zxvuwyt 8,z 14,v 11,x 14,x 12,z 15,v"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%94%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p7","title":"\u7b2c\u4e5d\u9898 P7","text":"<p>a.</p> <p>\\(D_x=[D_x(w), D_x(y), D_x(u)] = [2, 4, 7]\\)</p> <p>b.</p> <p>\\(c(x, w) &gt; 6 \\text{ or } c(x, y) &lt; 1\\)</p> <p>c.</p> <p>\\(c(x,w)&lt;3 \\text{ or } c(x,y)&gt;0\\)</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E4%BA%94%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p8","title":"\u7b2c\u5341\u9898 P8","text":"<p>x:</p> Cost to x y z From x 0 3 4 From y \u221e \u221e \u221e From z \u221e \u221e \u221e Cost to x y z From x 0 3 4 From y 3 0 6 From z 4 6 0 <p>y:</p> Cost to x y z From x \u221e \u221e \u221e From y 3 0 6 From z \u221e \u221e \u221e Cost to x y z From x 0 3 4 From y 3 0 6 From z 4 6 0 <p>z:</p> Cost to x y z From x \u221e \u221e \u221e From y \u221e \u221e \u221e From z 4 6 0 Cost to x y z From x 0 3 4 From y 3 0 6 From z 4 6 0"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%85%AB%E6%AC%A1%E4%BD%9C%E4%B8%9A/","title":"\u8ba1\u7b97\u673a\u7f51\u7edc\u7b2c\u516b\u6b21\u4f5c\u4e1a","text":""},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%85%AB%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p8","title":"\u7b2c\u4e00\u9898 P8","text":"<p>a. $$ n = p \\times q = 55 $$</p> \\[ z = \\varphi(n) = (p-1)\\times(q-1)=40 \\] <p>b.</p> <p>\u6211\u4eec\u6709\uff1a $$ \\gcd(3, z) = \\gcd(3, 40) = 1 $$ 3 \u4e0e z \u4e92\u7d20\uff0c\u6240\u4ee5 \\(e=3\\) \u53ef\u4ee5\u63a5\u53d7\u3002</p> <p>c.</p> <p>\u6211\u4eec\u6709\uff1a $$ d \\equiv e^{-1} \\equiv 27 \\bmod{40} $$ \u6240\u4ee5 $$ d = 40k+27, \\forall k \\in \\mathbb{Z} $$ \u53c8 $$ 0&lt;d&lt;160 $$ \u6545 d \u7684\u53d6\u503c\u4e3a27\uff0c67\uff0c107\uff0c147\u3002</p> <p>d. $$ c=m^{e}\\bmod n = 8^3\\bmod 55 = 17 $$</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%85%AB%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p10","title":"\u7b2c\u4e8c\u9898 P10","text":"<p>a. $$ K_{A-KDC}(S,B,K_{B-KDC}(S,A)) $$ \u8fd9\u91cc\u9644\u5e26\u4e0aB\u662f\u4e3a\u4e86\u9632\u91cd\u653e\u653b\u51fb\u3002\u8fd9\u91cc\u5b9e\u9645\u4e0a\u8fd8\u5e94\u8be5\u9644\u5e26\u4e0a\u65f6\u95f4\u6233\u548c\u751f\u5b58\u5468\u671f\uff0c\u4f46\u662f\u9898\u76ee\u6761\u4ef6\u672a\u7ed9\u51fa\uff0c\u6240\u4ee5\u4e0d\u8003\u8651\u3002</p> <p>b. $$ K_{B-KDC}(S,A) $$</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%85%AD%E6%AC%A1%E4%BD%9C%E4%B8%9A/","title":"\u8ba1\u7b97\u673a\u7f51\u7edc\u7b2c\u56db\u6b21\u4f5c\u4e1a","text":""},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%85%AD%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r14","title":"\u7b2c\u4e00\u9898 R14","text":"<p>\u53ea\u6709FIFO\u80fd\u786e\u4fdd\u5206\u7ec4\u4ee5\u5230\u8fbe\u6b21\u5e8f\u79bb\u5f00\uff0c\u5176\u4ed6\u65b9\u5f0f\u90fd\u4e0d\u884c\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%85%AD%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r18","title":"\u7b2c\u4e8c\u9898 R18","text":"<p>TTL\u5b57\u6bb5\u786e\u4fdd\u6570\u636e\u5305\u4e0d\u4f1a\u6c38\u8fdc\u5728\u7f51\u7edc\u4e2d\u5faa\u73af\uff0c\u6bcf\u7ecf\u4e00\u4e2a\u8def\u7531\u5668\u5904\u7406\uff0cTTL\u503c\u51cf\u4e00\uff0c\u5f53TTL\u4e3a0\u65f6\u6570\u636e\u62a5\u88ab\u4e22\u5f03\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%85%AD%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r22","title":"\u7b2c\u4e09\u9898 R22","text":"<p>11011111.00000001.00000011.00011011</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%85%AD%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r27","title":"\u7b2c\u56db\u9898 R27","text":"<p>\u201c\u8def\u7531\u805a\u5408\u201d\u6307\u7684\u662f\u4f7f\u7528\u5355\u4e2a\u7f51\u7edc\u524d\u7f00\u901a\u544a\u591a\u4e2a\u7f51\u7edc\u7684\u80fd\u529b\u3002\u4e00\u4e2a\u7ec4\u7ec7\u901a\u5e38\u88ab\u5206\u914d\u4e00\u5757\u8fde\u7eed\u7684\u5730\u5740\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7ec4\u7ec7\u5185\u90e8\u7684\u8bbe\u5907IP\u5730\u5740\u5c06\u5171\u4eab\u76f8\u540c\u7684\u524d\u7f00\u3002\u5f53\u7ec4\u7ec7\u5916\u90e8\u7684\u4e00\u53f0\u8def\u7531\u5668\u8f6c\u53d1\u4e00\u4e2a\u6570\u636e\u62a5\uff0c\u4e14\u8be5\u6570\u636e\u62a5\u7684\u76ee\u7684\u5730\u5740\u4f4d\u4e8e\u8be5\u7ec4\u7ec7\u5185\u90e8\u65f6\uff0c\u4ec5\u9700\u8981\u8003\u8651\u8be5\u5730\u5740\u524d\u7684x\u6bd4\u7279\u3002\u8fd9\u76f8\u5f53\u5927\u5730\u51cf\u5c11\u4e86\u5728\u8fd9\u4e9b\u8def\u7531\u5668\u4e2d\u7684\u8f6c\u53d1\u8868\u7684\u957f\u5ea6\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%85%AD%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p6","title":"\u7b2c\u4e94\u9898 P6","text":"<p>a.</p> \u5206\u7ec4 \u5230\u8fbe\u65f6\u95f4 \u79bb\u5f00\u65f6\u95f4 \u65f6\u5ef6 2 0 2 2 3 1 3 2 4 1 4 3 5 3 6 3 6 2 5 3 7 3 7 4 8 5 8 3 9 5 9 4 10 7 10 3 11 8 11 3 12 8 12 4 \\[ \\text{\u5e73\u5747\u65f6\u5ef6}=3.091 \\] <p>b.</p> \u5206\u7ec4 \u5230\u8fbe\u65f6\u95f4 \u79bb\u5f00\u65f6\u95f4 \u65f6\u5ef6 2 0 3 3 3 1 2 1 4 1 7 6 5 3 4 1 6 2 8 6 7 3 5 2 8 5 10 5 9 5 6 1 10 7 11 4 11 8 9 1 12 8 12 4 \\[ \\text{\u5e73\u5747\u65f6\u5ef6}=3.091 \\] <p>c.</p> \u5206\u7ec4 \u5230\u8fbe\u65f6\u95f4 \u79bb\u5f00\u65f6\u95f4 \u65f6\u5ef6 2 0 3 3 3 1 5 4 4 1 2 1 5 3 4 1 6 2 7 5 7 3 6 3 8 5 8 3 9 5 10 5 10 7 12 5 11 8 9 1 12 8 11 3 \\[ \\text{\u5e73\u5747\u65f6\u5ef6}=3.091 \\] <p>d.</p> \u5206\u7ec4 \u5230\u8fbe\u65f6\u95f4 \u79bb\u5f00\u65f6\u95f4 \u65f6\u5ef6 2 0 3 3 3 1 2 1 4 1 6 5 5 3 4 1 6 2 8 6 7 3 5 2 8 5 10 5 9 5 7 2 10 7 11 4 11 8 9 1 12 8 12 4 <p>\u7b2c\u4e00\u7c7b\u6743\u91cd\u662f2\uff0c\u4f46\u662f\u5f53\u7b2c\u4e00\u7c7b\u4e3a\u7a7a\u65f6\u9009\u62e9\u5904\u7406\u7b2c\u4e8c\u7c7b\u3002</p> \\[ \\text{\u5e73\u5747\u65f6\u5ef6}=3.091 \\] <p>e.</p> <p>\u4e0a\u8ff0\u56db\u79cd\u60c5\u51b5\uff0c\u4e0d\u7ba1\u91c7\u7528\u4ec0\u4e48\u7b56\u7565\uff0c\u5e73\u5747\u65f6\u5ef6\u90fd\u76f8\u7b49\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%85%AD%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p8","title":"\u7b2c\u516d\u9898 P8","text":"<p>a.</p> \u524d\u7f00\u5339\u914d \u8f6c\u53d1\u7aef\u53e3 11100000 00 0 11100000 01000000 1 1110000 2 11100001 1 3 \u5176\u4ed6 3 <p>b.</p> <p>11001000 10010001 01010001 01010101</p> <p>\u4e0d\u80fd\u5339\u914d\u4efb\u610f\u5df2\u77e5\u524d\u7f00\uff0c\u8f6c\u53d1\u5230\u7aef\u53e33\u3002</p> <p>11100001 01000000 11000011 00111100</p> <p>\u524d\u7f00\u5339\u914d1110000\uff0c\u8f6c\u53d1\u5230\u7aef\u53e32\u3002</p> <p>11100001 10000000 00010001 01110111</p> <p>\u524d\u7f00\u5339\u914d11100001 1\uff0c\u8f6c\u53d1\u5230\u7aef\u53e33\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%85%AD%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p10","title":"\u7b2c\u4e03\u9898 P10","text":"\u63a5\u53e3 \u5730\u5740\u8303\u56f4 \u5730\u5740\u6570\u91cf 0 11000000~11011111 32 1 10000000~10111111 64 2 11100000~11111111 32 3 00000000~01111111 128"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%85%AD%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p15","title":"\u7b2c\u516b\u9898 P15","text":"<p>a.</p> \u5b50\u7f51 \u5730\u5740 A 214.97.254.0/24 B 214.97.255.0/25 C 214.97.255.128/25 D 214.98.0.0/30 E 214.98.0.4/30 F 214.98.0.8/30 <p>b.</p> <p>R1\uff1a</p> \u6700\u957f\u524d\u7f00\u5339\u914d \u8f6c\u53d1\u5230\u5b50\u7f51 11010110 01100010 00000000 000000 D 11010110 01100010 00000000 000010 F 11010110 01100001 11111110 A <p>R2\uff1a</p> \u6700\u957f\u524d\u7f00\u5339\u914d \u8f6c\u53d1\u5230\u5b50\u7f51 11010110 01100010 00000000 000000 D 11010110 01100010 00000000 000001 E 11010110 01100001 11111111 0 B <p>R3\uff1a</p> \u6700\u957f\u524d\u7f00\u5339\u914d \u8f6c\u53d1\u5230\u5b50\u7f51 11010110 01100010 00000000 000001 E 11010110 01100010 00000000 000010 F 11010110 01100001 11111111 1 C"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%85%AD%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p18","title":"\u7b2c\u4e5d\u9898 P18","text":"<p>a.</p> <p>\u4e3b\u673a\u7684\u7aef\u53e3\u5730\u5740\uff1a192.168.1.1\uff0c192.168.1.2\uff0c192.168.1.3</p> <p>\u8def\u7531\u5668\u7aef\u53e3\u5730\u5740\uff1a192.168.1.4</p> <p>b.</p> WAN \u7aef LAN \u7aef 24.34.112.235,5001 192.168.1,3345 24.34.112.235,5002 192.168.1,3346 24.34.112.235,5003 192.168.2,3345 24.34.112.235,5004 192.168.2,3346 24.34.112.235,5005 192.168.3,3345 24.34.112.235,5006 192.168.3,3346"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%85%AD%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p19","title":"\u7b2c\u5341\u9898 P19","text":"<p>a.</p> <p>\u5728\u6355\u83b7\u5230\u7684\u6240\u6709NAT\u5411\u5916\u90e8\u53d1\u9001\u7684\u5206\u7ec4\u4e2d\uff0c\u67e5\u770b\u6240\u6709\u6807\u8bc6\u53f7\u843d\u5728\u7684\u8fde\u7eed\u533a\u95f4\u4e2a\u6570\uff0c\u6709\u591a\u5c11\u6807\u8bc6\u53f7\u7684\u8fde\u7eed\u533a\u95f4\u5c31\u6709\u591a\u5c11\u53f0\u4e3b\u673a\u3002</p> <p>b.</p> <p>\u5982\u679c\u968f\u673a\u5206\u914d\u6807\u8bc6\u53f7\uff0c\u90a3\u4e48\u5c31\u65e0\u6cd5\u5c06\u6807\u8bc6\u53f7\u7684\u8fde\u7eed\u533a\u95f4\u5bf9\u5e94\u5230\u4e00\u53f0\u4e3b\u673a\uff0c\u4e0a\u8ff0\u65b9\u6cd5\u4e5f\u5c31\u65e0\u6cd5\u5de5\u4f5c\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%9B%9B%E6%AC%A1%E4%BD%9C%E4%B8%9A/","title":"\u8ba1\u7b97\u673a\u7f51\u7edc\u7b2c\u56db\u6b21\u4f5c\u4e1a","text":""},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%9B%9B%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r14","title":"\u7b2c\u4e00\u9898 R14","text":"<p>\u53ea\u6709FIFO\u80fd\u786e\u4fdd\u5206\u7ec4\u4ee5\u5230\u8fbe\u6b21\u5e8f\u79bb\u5f00\uff0c\u5176\u4ed6\u65b9\u5f0f\u90fd\u4e0d\u884c\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%9B%9B%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r18","title":"\u7b2c\u4e8c\u9898 R18","text":"<p>TTL\u5b57\u6bb5\u786e\u4fdd\u6570\u636e\u5305\u4e0d\u4f1a\u6c38\u8fdc\u5728\u7f51\u7edc\u4e2d\u5faa\u73af\uff0c\u6bcf\u7ecf\u4e00\u4e2a\u8def\u7531\u5668\u5904\u7406\uff0cTTL\u503c\u51cf\u4e00\uff0c\u5f53TTL\u4e3a0\u65f6\u6570\u636e\u62a5\u88ab\u4e22\u5f03\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%9B%9B%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r22","title":"\u7b2c\u4e09\u9898 R22","text":"<p>11011111.00000001.00000011.00011011</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%9B%9B%E6%AC%A1%E4%BD%9C%E4%B8%9A/#r27","title":"\u7b2c\u56db\u9898 R27","text":"<p>\u201c\u8def\u7531\u805a\u5408\u201d\u6307\u7684\u662f\u4f7f\u7528\u5355\u4e2a\u7f51\u7edc\u524d\u7f00\u901a\u544a\u591a\u4e2a\u7f51\u7edc\u7684\u80fd\u529b\u3002\u4e00\u4e2a\u7ec4\u7ec7\u901a\u5e38\u88ab\u5206\u914d\u4e00\u5757\u8fde\u7eed\u7684\u5730\u5740\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7ec4\u7ec7\u5185\u90e8\u7684\u8bbe\u5907IP\u5730\u5740\u5c06\u5171\u4eab\u76f8\u540c\u7684\u524d\u7f00\u3002\u5f53\u7ec4\u7ec7\u5916\u90e8\u7684\u4e00\u53f0\u8def\u7531\u5668\u8f6c\u53d1\u4e00\u4e2a\u6570\u636e\u62a5\uff0c\u4e14\u8be5\u6570\u636e\u62a5\u7684\u76ee\u7684\u5730\u5740\u4f4d\u4e8e\u8be5\u7ec4\u7ec7\u5185\u90e8\u65f6\uff0c\u4ec5\u9700\u8981\u8003\u8651\u8be5\u5730\u5740\u524d\u7684x\u6bd4\u7279\u3002\u8fd9\u76f8\u5f53\u5927\u5730\u51cf\u5c11\u4e86\u5728\u8fd9\u4e9b\u8def\u7531\u5668\u4e2d\u7684\u8f6c\u53d1\u8868\u7684\u957f\u5ea6\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%9B%9B%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p6","title":"\u7b2c\u4e94\u9898 P6","text":"<p>a.</p> \u5206\u7ec4 \u5230\u8fbe\u65f6\u95f4 \u79bb\u5f00\u65f6\u95f4 \u65f6\u5ef6 2 0 2 2 3 1 3 2 4 1 4 3 5 3 6 3 6 2 5 3 7 3 7 4 8 5 8 3 9 5 9 4 10 7 10 3 11 8 11 3 12 8 12 4 \\[ \\text{\u5e73\u5747\u65f6\u5ef6}=3.091 \\] <p>b.</p> \u5206\u7ec4 \u5230\u8fbe\u65f6\u95f4 \u79bb\u5f00\u65f6\u95f4 \u65f6\u5ef6 2 0 3 3 3 1 2 1 4 1 7 6 5 3 4 1 6 2 8 6 7 3 5 2 8 5 10 5 9 5 6 1 10 7 11 4 11 8 9 1 12 8 12 4 \\[ \\text{\u5e73\u5747\u65f6\u5ef6}=3.091 \\] <p>c.</p> \u5206\u7ec4 \u5230\u8fbe\u65f6\u95f4 \u79bb\u5f00\u65f6\u95f4 \u65f6\u5ef6 2 0 3 3 3 1 5 4 4 1 2 1 5 3 4 1 6 2 7 5 7 3 6 3 8 5 8 3 9 5 10 5 10 7 12 5 11 8 9 1 12 8 11 3 \\[ \\text{\u5e73\u5747\u65f6\u5ef6}=3.091 \\] <p>d.</p> \u5206\u7ec4 \u5230\u8fbe\u65f6\u95f4 \u79bb\u5f00\u65f6\u95f4 \u65f6\u5ef6 2 0 3 3 3 1 2 1 4 1 6 5 5 3 4 1 6 2 8 6 7 3 5 2 8 5 10 5 9 5 7 2 10 7 11 4 11 8 9 1 12 8 12 4 <p>\u7b2c\u4e00\u7c7b\u6743\u91cd\u662f2\uff0c\u4f46\u662f\u5f53\u7b2c\u4e00\u7c7b\u4e3a\u7a7a\u65f6\u9009\u62e9\u5904\u7406\u7b2c\u4e8c\u7c7b\u3002</p> \\[ \\text{\u5e73\u5747\u65f6\u5ef6}=3.091 \\] <p>e.</p> <p>\u4e0a\u8ff0\u56db\u79cd\u60c5\u51b5\uff0c\u4e0d\u7ba1\u91c7\u7528\u4ec0\u4e48\u7b56\u7565\uff0c\u5e73\u5747\u65f6\u5ef6\u90fd\u76f8\u7b49\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%9B%9B%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p8","title":"\u7b2c\u516d\u9898 P8","text":"<p>a.</p> \u524d\u7f00\u5339\u914d \u8f6c\u53d1\u7aef\u53e3 11100000 00 0 11100000 01000000 1 1110000 2 11100001 1 3 \u5176\u4ed6 3 <p>b.</p> <p>11001000 10010001 01010001 01010101</p> <p>\u4e0d\u80fd\u5339\u914d\u4efb\u610f\u5df2\u77e5\u524d\u7f00\uff0c\u8f6c\u53d1\u5230\u7aef\u53e33\u3002</p> <p>11100001 01000000 11000011 00111100</p> <p>\u524d\u7f00\u5339\u914d1110000\uff0c\u8f6c\u53d1\u5230\u7aef\u53e32\u3002</p> <p>11100001 10000000 00010001 01110111</p> <p>\u524d\u7f00\u5339\u914d11100001 1\uff0c\u8f6c\u53d1\u5230\u7aef\u53e33\u3002</p>"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%9B%9B%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p10","title":"\u7b2c\u4e03\u9898 P10","text":"\u63a5\u53e3 \u5730\u5740\u8303\u56f4 \u5730\u5740\u6570\u91cf 0 11000000~11011111 32 1 10000000~10111111 64 2 11100000~11111111 32 3 00000000~01111111 128"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%9B%9B%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p15","title":"\u7b2c\u516b\u9898 P15","text":"<p>a.</p> \u5b50\u7f51 \u5730\u5740 A 214.97.254.0/24 B 214.97.255.0/25 C 214.97.255.128/25 D 214.98.0.0/30 E 214.98.0.4/30 F 214.98.0.8/30 <p>b.</p> <p>R1\uff1a</p> \u6700\u957f\u524d\u7f00\u5339\u914d \u8f6c\u53d1\u5230\u5b50\u7f51 11010110 01100010 00000000 000000 D 11010110 01100010 00000000 000010 F 11010110 01100001 11111110 A <p>R2\uff1a</p> \u6700\u957f\u524d\u7f00\u5339\u914d \u8f6c\u53d1\u5230\u5b50\u7f51 11010110 01100010 00000000 000000 D 11010110 01100010 00000000 000001 E 11010110 01100001 11111111 0 B <p>R3\uff1a</p> \u6700\u957f\u524d\u7f00\u5339\u914d \u8f6c\u53d1\u5230\u5b50\u7f51 11010110 01100010 00000000 000001 E 11010110 01100010 00000000 000010 F 11010110 01100001 11111111 1 C"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%9B%9B%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p18","title":"\u7b2c\u4e5d\u9898 P18","text":"<p>a.</p> <p>\u4e3b\u673a\u7684\u7aef\u53e3\u5730\u5740\uff1a192.168.1.1\uff0c192.168.1.2\uff0c192.168.1.3</p> <p>\u8def\u7531\u5668\u7aef\u53e3\u5730\u5740\uff1a192.168.1.4</p> <p>b.</p> WAN \u7aef LAN \u7aef 24.34.112.235,5001 192.168.1,3345 24.34.112.235,5002 192.168.1,3346 24.34.112.235,5003 192.168.2,3345 24.34.112.235,5004 192.168.2,3346 24.34.112.235,5005 192.168.3,3345 24.34.112.235,5006 192.168.3,3346"},{"location":"course/ComputerNetwork/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%AC%E5%9B%9B%E6%AC%A1%E4%BD%9C%E4%B8%9A/#p19","title":"\u7b2c\u5341\u9898 P19","text":"<p>a.</p> <p>\u5728\u6355\u83b7\u5230\u7684\u6240\u6709NAT\u5411\u5916\u90e8\u53d1\u9001\u7684\u5206\u7ec4\u4e2d\uff0c\u67e5\u770b\u6240\u6709\u6807\u8bc6\u53f7\u843d\u5728\u7684\u8fde\u7eed\u533a\u95f4\u4e2a\u6570\uff0c\u6709\u591a\u5c11\u6807\u8bc6\u53f7\u7684\u8fde\u7eed\u533a\u95f4\u5c31\u6709\u591a\u5c11\u53f0\u4e3b\u673a\u3002</p> <p>b.</p> <p>\u5982\u679c\u968f\u673a\u5206\u914d\u6807\u8bc6\u53f7\uff0c\u90a3\u4e48\u5c31\u65e0\u6cd5\u5c06\u6807\u8bc6\u53f7\u7684\u8fde\u7eed\u533a\u95f4\u5bf9\u5e94\u5230\u4e00\u53f0\u4e3b\u673a\uff0c\u4e0a\u8ff0\u65b9\u6cd5\u4e5f\u5c31\u65e0\u6cd5\u5de5\u4f5c\u3002</p>"},{"location":"course/DataStructure/","title":"\u6570\u636e\u7ed3\u6784","text":"<p>\u8fd9\u91cc\u5305\u542b\u4e86BUPT\u672a\u6765\u5b66\u9662\u300a\u6570\u636e\u7ed3\u6784\u4e0e\u7b97\u6cd5\u300b\u8fd9\u95e8\u8bfe\u7684\u8bfe\u540e\u4f5c\u4e1a\u4e0e\u5b9e\u9a8c\u3002</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/","title":"\u6570\u636e\u7ed3\u6784\u7b2c\u4e00\u7ae0\u4f5c\u4e1a","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_2","title":"\u7b2c\u4e00\u9898","text":"<p>\u8bbe \\(n\\) \u662f\u5076\u6570\uff0c\u8bd5\u8ba1\u7b97\u8fd0\u884c\u4e0b\u5217\u7a0b\u5e8f\u6bb5\u540e \\(m\\) \u7684\u503c\uff0c\u5e76\u7ed9\u51fa\u8be5\u7a0b\u5e8f\u6bb5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002</p> <pre><code>m = 0;\nfor (i = 1; i &lt;= n; i++)\n    for (j = 2 * i; j &lt;= n; j++)\n        m = m + 1;\n</code></pre> <p><code>m=m+1</code> \u8fd9\u884c\u8bed\u53e5\u603b\u5171\u6267\u884c\u6b21\u6570\u4e3a\uff1a $$ \\sum_{i=1}^n{max{n-2\\times i + 1,0}} = \\sum_{i=1}^{\\lfloor \\frac{n}{2} \\rfloor}{n-2\\times i + 1}=(n+1)\\cdot \\lfloor \\frac{n}{2}\\rfloor - \\lfloor \\frac{n}{2}\\rfloor \\cdot (1 + \\lfloor \\frac{n}{2}\\rfloor) $$ \u7531 \\(n = \\lfloor \\frac{n}{2}\\rfloor + \\lceil \\frac{n}{2}\\rceil\\)\uff0c\u4e0a\u5f0f\u8fdb\u4e00\u6b65\u5316\u4e3a\uff1a $$ \\lfloor \\frac{n}{2}\\rfloor \\cdot (n - \\lfloor \\frac{n}{2}\\rfloor) = \\lfloor \\frac{n}{2}\\rfloor \\cdot \\lceil \\frac{n}{2}\\rceil = O(n^2) $$  \u6240\u4ee5\uff0c\u8be5\u7a0b\u5e8f\u6bb5\u7684\u65f6\u95f4\u590d\u6742\u5ea6 \\(T(n) = O(n^2)\\)\u3002</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_3","title":"\u7b2c\u4e8c\u9898","text":"<p>\u4e0b\u5217\u7b97\u6cd5\u5bf9\u4e00 \\(n\\) \u4f4d\u4e8c\u8fdb\u5236\u6570\u52a0 \\(1\\)\uff0c\u5047\u5982\u65e0\u6ea2\u51fa\uff0c\u8be5\u7b97\u6cd5\u5728\u6700\u574f\u60c5\u51b5\u4e0b\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u4ec0\u4e48\uff1f\u5e76\u5206\u6790\u5b83\u7684\u5e73\u5747\u65f6\u95f4\u590d\u6742\u5ea6\u3002</p> <pre><code>void func(int A[n]) // A[n]\u4e2d\u6bcf\u4e2a\u5143\u7d20\u53d6\u503c0\u62161\uff0c\u5047\u8bbe\u4e0b\u6807\u4ece1-&gt;n\n{\n    int i = n;\n    while (A[i] == 1)\n    {\n        A[i] = 0;\n        i--;\n    }\n    A[i] = 1;\n}\n</code></pre> <ul> <li>\u6700\u574f\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e00\u4f4d\u90fd\u662f \\(1\\)\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 \\(T(n) = O(n)\\)\u3002</li> <li>\u5e73\u5747\u60c5\u51b5\u4e0b\uff0c\u5047\u8bbe\u6240\u6709 \\(n\\) \u4f4d\u4e8c\u8fdb\u5236\u6570\u7b49\u6982\u7387\u51fa\u73b0\uff0c\\(T(n) = \\frac{n + 1 + \\sum_{i=1}^{n}2^{n-i}\\cdot i}{2^n} = \\frac{2^{n+1}-1}{2^n} = O(1)\\)\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_4","title":"\u7b2c\u4e09\u9898","text":"<p>\u8c03\u7528\u4e0b\u5217\u51fd\u6570f(n)\u56de\u7b54\u4e0b\u5217\u95ee\u9898\uff1a</p> <ol> <li>\u8bd5\u7ed9\u51faf(n)\u503c\u7684\u5927\u5c0f\uff0c\u5e76\u5199\u51faf(n)\u503c\u7684\u63a8\u5bfc\u8fc7\u7a0b\uff1b</li> <li>\u5047\u5b9an=5\uff0c\u8bd5\u6307\u51faf(5)\u503c\u7684\u5927\u5c0f\u548c\u6267\u884cf(5)\u65f6\u7684\u8f93\u51fa\u7ed3\u679c\u3002</li> </ol> <pre><code>int f(int n)\n{\n    int i, j, k, sum = 0;\n    for(i = 1; i &lt; n + 1; i++)\n    {\n        for(j = n; j &gt; i - 1; j--)\n            for(k = 1; k &lt; j + 1; k++)\n                sum++;\n        printf(\"sum=%d\\n\", sum);\n    }\n    return (sum);\n}\n</code></pre> <p>\u7531\u4e8e \\(j &gt; i - 1 \\ge 0\\)\uff0c\u6700\u5185\u5c42\u5bf9 \\(k\\) \u7684\u5faa\u73af\u603b\u662f\u6267\u884c \\(j\\) \u6b21\uff0c\u7b49\u4ef7\u4e8e <code>sum += j</code>\u3002</p> <p>\u6240\u4ee5\u5bf9\u4e8e\u56fa\u5b9a\u7684 \\(i\\)\uff0csum\u7d2f\u8ba1\u589e\u52a0\uff1a $$ \\sum_{j = i}^{n}{j} = \\frac{(i + n)\\cdot (n - i + 1)}{2} $$ \u6545 f(n) \u7684\u503c\u4e3a\uff1a $$ \\begin{aligned} f(n)     &amp;= \\sum_{i = 1}^{n} \\frac{(i + n) \\cdot (n - i + 1)}{2} \\     &amp;= \\frac{1}{2} \\sum_{i=1}^{n} \\left( n^2 + n - i \\cdot (i - 1) \\right) \\     &amp;= \\frac{1}{2} \\left( n^3 + n^2 - \\frac{(n + 1) \\cdot n \\cdot (n - 1)}{3} \\right) \\     &amp;= \\frac{1}{3} n^3 + \\frac{1}{2} n^2 + \\frac{1}{6} n \\end{aligned} $$ f(5) \u7684\u5927\u5c0f\u4e3a 55\uff0c\u6267\u884c f(5) \u65f6\u8f93\u51fa\u5982\u4e0b\uff1a</p> <pre><code>sum=15\nsum=29\nsum=41\nsum=50\nsum=55\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%83%E7%AB%A0%E4%BD%9C%E4%B8%9A/","title":"\u6570\u636e\u7ed3\u6784\u7b2c\u4e03\u7ae0\u4f5c\u4e1a","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%83%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_2","title":"\u7b2c\u4e00\u9898","text":"<p>\u8bd5\u8bc1\u660e\uff1a\u5bf9\u4e8e\u4e00\u4e2a\u65e0\u5411\u56fe $ G = (V, E) $\uff0c\u82e5 $ G $ \u4e2d\u5404\u9876\u70b9\u7684\u5ea6\u5747\u5927\u4e8e\u6216\u7b49\u4e8e 2\uff0c\u5219 $ G $ \u4e2d\u5fc5\u6709\u56de\u8def\u3002</p> <p>\u89e3\uff1a</p> <p>\u5047\u8bbe \\(H=(V_H,E_H)\\) \u4e3a \\(G\\) \u7684\u4e00\u4e2a\u6781\u5927\u8fde\u901a\u5757\uff0c\\(V_H = \\set{a_1,a_2,...,a_n}\\)\uff0c\u5219\u5fc5\u5b58\u5728\u7b80\u5355\u8def\u5f84 \\(P=({a_{k_1},a_{k_2},...,a_{k_n}})\\) \u3002</p> <p>\u7531\u4e8e \\(G\\) \u4e2d\u5404\u9876\u70b9\u5ea6\u6570\u5927\u4e8e\u7b49\u4e8e2\uff0c\u5b58\u5728\u70b9 \\(a_{k_i}\\) \u4f7f\u5f97 \\(a_{k_1}\\) \u4e0e \\(a_{k_i}\\) \u4e4b\u95f4\u6709\u4e00\u6761\u8fb9\u3002</p> <p>\u4ece\u800c \\((a_{k_1}, a_{k_2}, ... a_{k_i}, a_{k_1})\\) \u4e3a\u4e00\u6761\u7b80\u5355\u56de\u8def\u3002</p> <p>\u56e0\u6b64 \\(G\\) \u4e2d\u5fc5\u6709\u56de\u8def\u3002</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%83%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_3","title":"\u7b2c\u4e8c\u9898","text":"<p>\u5df2\u77e5\u67d0\u56fe\u7684\u90bb\u63a5\u8868\u5982\u4e0b\u56fe\u6240\u793a</p> <p>(1) \u5199\u51fa\u6b64\u90bb\u63a5\u8868\u5bf9\u5e94\u7684\u90bb\u63a5\u77e9\u9635\uff1b (2) \u5199\u51fa\u7531v1\u5f00\u59cb\u7684\u6df1\u5ea6\u4f18\u5148\u904d\u5386\u7684\u5e8f\u5217\uff1b (3) \u5199\u51fa\u7531v1\u5f00\u59cb\u7684\u6df1\u5ea6\u4f18\u5148\u7684\u751f\u6210\u6811\uff1b (4) \u5199\u51fa\u7531v1\u5f00\u59cb\u7684\u5e7f\u5ea6\u4f18\u5148\u904d\u5386\u7684\u5e8f\u5217\uff1b (5) \u5199\u51fa\u7531v1\u5f00\u59cb\u7684\u5e7f\u5ea6\u4f18\u5148\u7684\u751f\u6210\u6811\uff1b (6) \u5199\u51fa\u5c06\u65e0\u5411\u56fe\u7684\u90bb\u63a5\u77e9\u9635\u8f6c\u6362\u6210\u90bb\u63a5\u8868\u7684\u7b97\u6cd5\u3002</p> <p>\u89e3\uff1a</p> <p>(1) $$ \\begin{array}{c|cccccc}    &amp; v_1 &amp; v_2 &amp; v_3 &amp; v_4 &amp; v_5 &amp; v_6 \\ \\hline v_1 &amp;  0  &amp;  1  &amp;  1  &amp;  1  &amp;  0  &amp;  0  \\ v_2 &amp;  1  &amp;  0  &amp;  0  &amp;  0  &amp;  1  &amp;  0  \\ v_3 &amp;  1  &amp;  0  &amp;  0  &amp;  0  &amp;  1  &amp;  0  \\ v_4 &amp;  1  &amp;  0  &amp;  0  &amp;  0  &amp;  0  &amp;  1  \\ v_5 &amp;  0  &amp;  1  &amp;  1  &amp;  0  &amp;  0  &amp;  0  \\ v_6 &amp;  0  &amp;  0  &amp;  0  &amp;  1  &amp;  0  &amp;  0 \\end{array} $$ (2)</p> <p>v1,v2,v5,v3,v4,v6</p> <p>(3)</p> <p></p> <p>(4)</p> <p>v1,v2,v3,v4,v5,v6</p> <p>(5)</p> <p></p> <p>(6)</p> <pre><code>void convert(Mgraph g, Agraph *G) {\n    G-&gt;n = g.n, G-&gt;e = g.e;\n    for (int i = 1; i &lt;= g.n; i++) {\n        G-&gt;adjlist[i].data = g.vexs[i].data;\n        G-&gt;adjlist[i].firstarc = NULL;\n        ArcNode **last = &amp;G-&gt;adjlist[i].firstarc;\n        for (int j = 1; j &lt;= g.n; j++) {\n            if (g.edges[i][j]) {\n                ArcNode* tmp = (ArcNode*)malloc(sizeof(ArcNode));\n                tmp-&gt;adjvex = j;\n                tmp-&gt;weight = g.edges[i][j];\n                *last = tmp;\n                last = &amp;tmp-&gt;nextarc;\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%83%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_4","title":"\u7b2c\u4e09\u9898","text":"<p>\u5df2\u77e5\u4e00\u56fe\u5982\u4e0b\u56fe\u6240\u793a\uff1a (1) \u5199\u51fa\u5168\u90e8\u62d3\u6251\u6392\u5e8f\uff1b (2) \u4ee5v1\u4e3a\u6e90\u70b9\uff0c\u4ee5v8\u4e3a\u6c47\u70b9\uff0c\u7ed9\u51fa\u6240\u6709\u4e8b\u4ef6\u5141\u8bb8\u53d1\u751f\u7684\u6700\u65e9\u65f6\u95f4\u548c\u6700\u665a\u65f6\u95f4\uff0c\u5e76\u7ed9\u51fa\u5173\u952e\u8def\u5f84\uff1b (3) \u5229\u7528Dijkstra\u7b97\u6cd5\u6c42V1\u7ed3\u70b9\u5230\u5404\u70b9\u7684\u6700\u77ed\u8ddd\u79bb\u3002</p> <p></p> <p>\u89e3\uff1a</p> <p>(1)</p> <p>v1,v2,v3,v4,v6,v5,v7,v8</p> <p>v1,v3,v2,v4,v6,v5,v7,v8</p> <p>(2)</p> \u6700\u65e9\u65f6\u95f4 \u6700\u665a\u65f6\u95f4 v1 0 0 v2 2 2 v3 3 3 v4 7 7 v5 13 13 v6 11 11 v7 16 16 v8 17 17 <p>\uff083\uff09</p> <p>v1,v2,v4,v6,v5,v7,v8</p> <p>v1,v2,v4,v6,v8</p> <p>v1,v3,v5,v7,v8</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%83%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_5","title":"\u7b2c\u56db\u9898","text":"<p>\u6709\u4e00\u56fe\u7684\u90bb\u63a5\u77e9\u9635\u5982\u4e0b\uff0c\u8bd5\u7ed9\u51fa\u7528Floyd\u7b97\u6cd5\u6c42\u5404\u70b9\u95f4\u6700\u77ed\u8ddd\u79bb\u7684\u77e9\u9635\u5e8f\u5217 \\(A^1\\)\uff0c\\(A^2\\)\uff0c\\(A^3\\)\uff0c\\(A^4\\)\u3002</p> \\[ A = \\begin{bmatrix}  0 &amp; 2 &amp; \\infty &amp; \\infty \\\\  \\infty &amp; 0 &amp; 1 &amp; 6 \\\\  5 &amp; \\infty &amp; 0 &amp; 4 \\\\  3 &amp; \\infty &amp; \\infty &amp; 0  \\end{bmatrix} \\] <p>\u89e3\uff1a $$ A^1 = \\begin{bmatrix}  0 &amp; 2 &amp; \\infty &amp; \\infty \\  \\infty &amp; 0 &amp; 1 &amp; 6 \\  5 &amp; 7 &amp; 0 &amp; 4 \\  3 &amp; 5 &amp; \\infty &amp; 0  \\end{bmatrix} $$</p> \\[ A^2 = \\begin{bmatrix}  0 &amp; 2 &amp; 3 &amp; 8 \\\\  \\infty &amp; 0 &amp; 1 &amp; 6 \\\\  5 &amp; 7 &amp; 0 &amp; 4 \\\\  3 &amp; 5 &amp; 6 &amp; 0  \\end{bmatrix} \\] \\[ A^3 = \\begin{bmatrix}  0 &amp; 2 &amp; 3 &amp; 7 \\\\  6 &amp; 0 &amp; 1 &amp; 5 \\\\  5 &amp; 7 &amp; 0 &amp; 4 \\\\  3 &amp; 5 &amp; 6 &amp; 0  \\end{bmatrix} \\] \\[ A^3 = \\begin{bmatrix}  0 &amp; 2 &amp; 3 &amp; 7 \\\\  6 &amp; 0 &amp; 1 &amp; 5 \\\\  5 &amp; 7 &amp; 0 &amp; 4 \\\\  3 &amp; 5 &amp; 6 &amp; 0  \\end{bmatrix} \\] \\[ A^4 = \\begin{bmatrix}  0 &amp; 2 &amp; 3 &amp; 7 \\\\  6 &amp; 0 &amp; 1 &amp; 5 \\\\  5 &amp; 7 &amp; 0 &amp; 4 \\\\  3 &amp; 5 &amp; 6 &amp; 0  \\end{bmatrix} \\]"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%83%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_6","title":"\u7b2c\u4e94\u9898","text":"<p>\u5df2\u77e5\u67d0\u56fe\u7684\u90bb\u63a5\u77e9\u9635\u4e3aA\uff0c\u5373\u82e5\u4ecei\u5230j\u6709\u8fb9\uff0c\u5219A[i, j]=1\uff0c\u5426\u5219A[i, j]=0\u3002\u8bd5\u7f16\u5199\u4e00\u7b97\u6cd5\u6c42\u77e9\u9635A\u7684\u4f20\u9012\u95ed\u5305C\uff1a\u4f7f\u5f97\u82e5\u4ecei\u5230j\u6709\u4e00\u6761\u6216\u591a\u6761\u8def\u5f84\uff0c\u5219C[i, j]=1\uff0c\u5426\u5219C[i, j]=0\u3002</p> <p>\u89e3\uff1a</p> <p>\u7ecf\u5178\u7684Warshell-Floyd\u7b97\u6cd5\u6c42\u4f20\u9012\u95ed\u5305\uff0c\u8fd9\u662f\u201c\u79bb\u6563\u6570\u5b66\uff08\u4e0a\uff09\u201d\u8fd9\u95e8\u8bfe\u7684\u5927\u4f5c\u4e1a\u3002</p> <pre><code>typedef int adjmatrix[MAXV][MAXV];\nvoid change(adjmatrix A, adjmatrix C, int n) {\n    // C = A^0\n    for (int i = 1; i &lt;= n; i++) {\n        for (int j = 1; j &lt;= n; j++) {\n            C[i][j] = A[i][j];\n        }\n    }\n    // C^{k-1} -&gt; C^k\n    for (int k = 1; k &lt;= n; k++) {\n        for (int i = 1; i &lt;= n; i++) {\n            for (int j = 1; j &lt;= n; j++) {\n                C[i][j] |= C[i][k] &amp; C[k][j];\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%83%E7%AB%A0%E5%AE%9E%E9%AA%8C/","title":"\u9898\u76ee\uff1a\u968f\u673a\u6709\u5411\u56fe\u53ef\u8fbe\u6027\u5206\u6790","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%83%E7%AB%A0%E5%AE%9E%E9%AA%8C/#1","title":"1. \u9700\u6c42\u5206\u6790","text":"<p>\u4efb\u52a1\u63cf\u8ff0\uff1a \u4ece\u547d\u4ee4\u884c\u63a5\u53d7\u6574\u6570V\u548cE\uff0c\u968f\u673a\u751f\u6210\u542b\u6709V\u4e2a\u9876\u70b9\u548cE\u6761\u8fb9\u7684\u7b80\u5355\u6709\u5411\u56fe\uff0c\u5373\u4e0d\u5305\u542b\u81ea\u73af\u548c\u5e73\u884c\u8fb9\uff0c\u5b58\u50a8\u7ed3\u6784\u65e0\u9650\u5b9a\u3002\u5bf9\u6b64\u6709\u5411\u56fe\uff0c\u8fd0\u884c\u5b9e\u9a8c\u6c42\u4ece\u4e00\u4e2a\u968f\u673a\u9009\u5b9a\u7684\u9876\u70b9\u53ef\u4ee5\u5230\u8fbe\u7684\u9876\u70b9\u6570\u91cf\u7684\u5e73\u5747\u503c\u3002</p> <p>\u8f93\u5165/\u8f93\u51fa\u8981\u6c42\uff1a  </p> <ul> <li>\u8f93\u5165\u5f62\u5f0f\uff1a\u7531\u7a7a\u683c\u5206\u9694\u7684\u4e24\u4e2a\u6574\u6570 \\(V\\)\u548c \\(E\\)\uff0c\u8868\u793a\u9876\u70b9\u6570\u548c\u8fb9\u6570\u3002</li> <li>\u8f93\u51fa\u5f62\u5f0f\uff1a\u4e00\u4e2a\u4e24\u4f4d\u5c0f\u6570\uff0c\u8868\u793a\u968f\u673a\u53d6\u4e00\u4e2a\u9876\u70b9\u53ef\u8fbe\u7684\u9876\u70b9\u6570\u91cf\u5e73\u5747\u503c\u3002</li> <li>\u9650\u5236\uff1a\\(1 \\leq V \\leq 1000\\)\uff0c\\(1 \\leq E \\leq V(V-1)\\)\u3002</li> </ul> <p>\u529f\u80fd\u8981\u6c42\uff1a  </p> <ol> <li>\u968f\u673a\u751f\u6210\u4e00\u4e2a\u9876\u70b9\u6570\u4e3aV\uff0c\u8fb9\u6570\u4e3aE\u7684\u56fe\u3002</li> <li>\u6c42\u51fa\u4ece\u4e00\u4e2a\u968f\u673a\u9009\u5b9a\u7684\u9876\u70b9\u53ef\u4ee5\u5230\u8fbe\u7684\u9876\u70b9\u6570\u91cf\u7684\u5e73\u5747\u503c\u3002</li> </ol>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%83%E7%AB%A0%E5%AE%9E%E9%AA%8C/#2","title":"2. \u6982\u8981\u8bbe\u8ba1","text":"<p>\u89e3\u51b3\u601d\u8def\uff1a  </p> <ol> <li>\u9884\u5904\u7406\uff1a\u751f\u6210\u4e00\u4e2a\u5305\u542b\u6240\u6709 \\(V \\times (V-1)\\) \u6761\u53ef\u80fd\u7684\u6709\u5411\u8fb9\u7684\u5217\u8868\u3002</li> <li>\u968f\u673a\u9009\u8fb9\uff1a\u4f7f\u7528 Fisher-Yates \u6d17\u724c\u7b97\u6cd5\u5c06\u8be5\u5217\u8868\u6253\u4e71\uff0c\u5e76\u9009\u53d6\u524d \\(E\\) \u6761\u8fb9\u4f5c\u4e3a\u56fe\u7684\u8fb9\u96c6\u3002</li> <li>\u6784\u5efa\u56fe\uff1a\u6839\u636e\u9009\u51fa\u7684 \\(E\\) \u6761\u8fb9\uff0c\u4f7f\u7528\u90bb\u63a5\u8868\u6570\u636e\u7ed3\u6784\u6784\u5efa\u6709\u5411\u56fe\u3002</li> <li>\u8499\u7279\u5361\u6d1b\u6a21\u62df\uff1a<ol> <li>\u91cd\u590d\u8fdb\u884c 1000 \u6b21\u5b9e\u9a8c\u3002</li> <li>\u5728\u6bcf\u6b21\u5b9e\u9a8c\u4e2d\uff0c\u968f\u673a\u9009\u53d6\u4e00\u4e2a\u9876\u70b9\u4f5c\u4e3a\u8d77\u70b9\u3002</li> <li>\u4f7f\u7528\u5e7f\u5ea6\u4f18\u5148\u641c\u7d22 (BFS) \u7b97\u6cd5\uff0c\u4ece\u8be5\u8d77\u70b9\u51fa\u53d1\uff0c\u904d\u5386\u6240\u6709\u53ef\u8fbe\u7684\u9876\u70b9\u5e76\u8ba1\u6570\u3002</li> </ol> </li> <li>\u8ba1\u7b97\u5e73\u5747\u503c\uff1a\u5c06 1000 \u6b21\u5b9e\u9a8c\u5f97\u5230\u7684\u53ef\u8fbe\u9876\u70b9\u6570\u7d2f\u52a0\uff0c\u5e76\u9664\u4ee5 1000\uff0c\u5f97\u5230\u6700\u7ec8\u7684\u5e73\u5747\u503c\u3002</li> </ol> <p>\u6570\u636e\u7ed3\u6784\uff1a  </p> <ol> <li> <p>\u56fe\u7684\u5b58\u50a8\uff1a\u91c7\u7528\u90bb\u63a5\u8868\u3002\u6bcf\u4e2a\u9876\u70b9\u6709\u4e00\u4e2a\u94fe\u8868\uff0c\u5b58\u50a8\u4ece\u8be5\u9876\u70b9\u51fa\u53d1\u7684\u6240\u6709\u8fb9\u3002     <pre><code>typedef struct Anode {\n    int to;\n    struct Anode* nextarc;\n} ArcNode;\n\ntypedef struct Vnode {\n    ArcNode *firstarc;\n} AdjList[MAXV];\n\ntypedef struct {\n    AdjList adjlist;\n    int n, e;\n} Agraph;\n</code></pre></p> </li> <li> <p>BFS \u8f85\u52a9\u961f\u5217\uff1a\u4f7f\u7528\u4e00\u4e2a\u7b80\u5355\u7684\u6570\u7ec4\u548c\u4e24\u4e2a\u6307\u9488 <code>front</code>, <code>tail</code> \u6765\u6a21\u62df\u961f\u5217\uff0c\u7528\u4e8e\u5e7f\u5ea6\u4f18\u5148\u641c\u7d22\u3002<code>visited</code> \u6570\u7ec4\u7528\u4e8e\u6807\u8bb0\u8282\u70b9\u662f\u5426\u5df2\u88ab\u8bbf\u95ee\u3002     <pre><code>int queue[MAXV&lt;&lt;1], front, tail;\nbool visited[MAXV];\n</code></pre></p> </li> </ol> <p>\u6a21\u5757\u5173\u7cfb\uff1a  </p> <ul> <li>\u56fe\u751f\u6210\u6a21\u5757\uff1a<ul> <li><code>generate_graph</code>\uff1a\u6838\u5fc3\u51fd\u6570\uff0c\u534f\u8c03\u56fe\u7684\u751f\u6210\u8fc7\u7a0b\u3002</li> <li><code>init_edges</code>\uff1a\u521d\u59cb\u5316\u5305\u542b\u6240\u6709\u53ef\u80fd\u8fb9\u7684\u5168\u5c40\u6570\u7ec4\u3002</li> <li><code>shuffle_edges</code>\uff1a\u968f\u673a\u6253\u4e71\u5e76\u9009\u53d6 E \u6761\u8fb9\u3002</li> <li><code>add_edge</code>\uff1a\u5411\u90bb\u63a5\u8868\u4e2d\u6dfb\u52a0\u4e00\u6761\u5177\u4f53\u7684\u8fb9\u3002</li> </ul> </li> <li>\u6a21\u62df\u4e0e\u8ba1\u7b97\u6a21\u5757\uff1a<ul> <li><code>run</code>\uff1a\u8d1f\u8d23\u6267\u884c\u6307\u5b9a\u6b21\u6570\u7684\u6a21\u62df\u5b9e\u9a8c\u5e76\u8ba1\u7b97\u5e73\u5747\u503c\u3002</li> <li><code>single_simulate</code>\uff1a\u6267\u884c\u5355\u6b21\u6a21\u62df\uff0c\u5305\u62ec\u968f\u673a\u9009\u70b9\u548c\u8c03\u7528 BFS\u3002</li> </ul> </li> <li>BFS \u6838\u5fc3\u6a21\u5757\uff1a<ul> <li><code>push</code>, <code>pop</code>, <code>empty</code>\uff1a\u63d0\u4f9b\u57fa\u672c\u7684\u961f\u5217\u64cd\u4f5c\uff0c\u652f\u6301\u5e7f\u5ea6\u4f18\u5148\u641c\u7d22\u3002</li> </ul> </li> <li>\u4e3b\u7a0b\u5e8f\u6a21\u5757\uff1a<ul> <li><code>main</code>\uff1a\u7a0b\u5e8f\u5165\u53e3\uff0c\u8d1f\u8d23\u89e3\u6790\u8f93\u5165\u3001\u8c03\u7528\u56fe\u751f\u6210\u548c\u6a21\u62df\u8ba1\u7b97\u6a21\u5757\uff0c\u5e76\u6700\u7ec8\u8f93\u51fa\u7ed3\u679c\u3002</li> </ul> </li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%83%E7%AB%A0%E5%AE%9E%E9%AA%8C/#3","title":"3. \u8be6\u7ec6\u8bbe\u8ba1","text":"<p>\u5173\u952e\u7b97\u6cd5\uff1a  </p> <ol> <li> <p><code>void generate_graph(int V, int E)</code></p> <ul> <li>\u4f5c\u7528\uff1a\u6839\u636e\u7ed9\u5b9a\u7684\u9876\u70b9\u6570 <code>V</code> \u548c\u8fb9\u6570 <code>E</code>\uff0c\u6784\u5efa\u4e00\u4e2a\u968f\u673a\u6709\u5411\u56fe\u3002</li> <li>\u8be6\u7ec6\u6b65\u9aa4\uff1a<ol> <li>\u68c0\u67e5 <code>E</code> \u662f\u5426\u8d85\u51fa\u6700\u5927\u53ef\u80fd\u8fb9\u6570 \\(V \\times (V-1)\\)\uff0c\u82e5\u8d85\u51fa\u5219\u62a5\u9519\u9000\u51fa\u3002</li> <li>\u8c03\u7528 <code>init_edges(V)</code> \u751f\u6210\u6240\u6709\u53ef\u80fd\u7684\u8fb9\uff0c\u5e76\u5b58\u50a8\u5230\u5168\u5c40\u6570\u7ec4 <code>edges</code> \u4e2d\u3002</li> <li>\u8c03\u7528 <code>shuffle_edges(E)</code> \u5bf9 <code>edges</code> \u6570\u7ec4\u8fdb\u884c\u968f\u673a\u5316\u5904\u7406\uff0c\u5e76\u622a\u53d6\u524d <code>E</code> \u6761\u3002</li> <li>\u521d\u59cb\u5316\u56fe <code>g</code> \u7684\u9876\u70b9\u6570 <code>n</code>\u3002</li> <li>\u904d\u5386\u5904\u7406\u540e\u7684 <code>edges</code> \u6570\u7ec4\uff0c\u89e3\u7801\u51fa\u6bcf\u6761\u8fb9\u7684\u8d77\u70b9 <code>x</code> \u548c\u7ec8\u70b9 <code>y</code>\uff0c\u5e76\u8c03\u7528 <code>add_edge(&amp;g, x, y)</code> \u5c06\u8fb9\u6dfb\u52a0\u5230\u90bb\u63a5\u8868\u4e2d\u3002</li> </ol> </li> </ul> </li> <li> <p><code>void shuffle_edges(int k)</code></p> <ul> <li>\u4f5c\u7528\uff1a\u5b9e\u73b0 Fisher-Yates \u6d17\u724c\u7b97\u6cd5\uff0c\u7528\u4e8e\u4ece <code>cnt</code> \u6761\u53ef\u80fd\u7684\u8fb9\u4e2d\u65e0\u504f\u5730\u968f\u673a\u9009\u53d6 <code>k</code> \u6761\u3002</li> <li>\u5b9e\u73b0\u7ec6\u8282\uff1a<ul> <li>\u5faa\u73af <code>i</code> \u4ece <code>0</code> \u5230 <code>k-1</code>\uff1a</li> <li>\u5728 <code>[i, cnt-1]</code> \u8303\u56f4\u5185\u751f\u6210\u4e00\u4e2a\u968f\u673a\u7d22\u5f15 <code>j</code>\u3002</li> <li>\u4ea4\u6362 <code>edges[i]</code> \u548c <code>edges[j]</code> \u7684\u5185\u5bb9\u3002</li> <li>\u5faa\u73af\u7ed3\u675f\u540e\uff0c\u6570\u7ec4 <code>edges</code> \u7684\u524d <code>k</code> \u4e2a\u5143\u7d20\u5373\u4e3a\u968f\u673a\u9009\u51fa\u7684\u8fb9\u96c6\u3002</li> <li>\u5c06\u5168\u5c40\u8fb9\u8ba1\u6570 <code>cnt</code> \u66f4\u65b0\u4e3a <code>k</code>\u3002</li> </ul> </li> </ul> </li> <li> <p><code>int single_simulate(int n)</code></p> <ul> <li>\u4f5c\u7528\uff1a\u6267\u884c\u4e00\u6b21\u5b8c\u6574\u7684\u6a21\u62df\uff1a\u968f\u673a\u9009\u62e9\u4e00\u4e2a\u8d77\u70b9\uff0c\u5e76\u8ba1\u7b97\u4ece\u5b83\u51fa\u53d1\u53ef\u8fbe\u7684\u9876\u70b9\u603b\u6570\u3002</li> <li>\u8be6\u7ec6\u6b65\u9aa4\uff1a<ol> <li>\u91cd\u7f6e\u72b6\u6001\uff1a\u5c06\u961f\u5217\u5934\u5c3e\u6307\u9488 <code>front</code> \u548c <code>tail</code> \u7f6e\u4e3a0\uff0c\u5e76\u4f7f\u7528 <code>memset</code> \u6e05\u7a7a <code>visited</code> \u6570\u7ec4\uff0c\u786e\u4fdd\u672c\u6b21\u6a21\u62df\u4e0d\u53d7\u4e0a\u6b21\u5f71\u54cd\u3002</li> <li>\u968f\u673a\u9009\u70b9\uff1a\u901a\u8fc7 <code>rand() % n + 1</code> \u968f\u673a\u9009\u62e9\u4e00\u4e2a <code>1</code> \u5230 <code>n</code> \u4e4b\u95f4\u7684\u9876\u70b9\u4f5c\u4e3a\u8d77\u70b9 <code>x</code>\u3002</li> <li>BFS \u521d\u59cb\u5316\uff1a\u5c06\u8d77\u70b9 <code>x</code> \u63a8\u5165\u961f\u5217 (<code>push(x)</code>)\uff0c\u5e76\u6807\u8bb0\u4e3a\u5df2\u8bbf\u95ee\u3002</li> <li>BFS \u904d\u5386\uff1a<ul> <li>\u5f53\u961f\u5217\u4e0d\u4e3a\u7a7a\u65f6\uff0c\u51fa\u961f\u4e00\u4e2a\u9876\u70b9 <code>u</code>\uff0c\u53ef\u8fbe\u9876\u70b9\u8ba1\u6570 <code>res</code> \u52a0\u4e00\u3002</li> <li>\u904d\u5386 <code>u</code> \u7684\u90bb\u63a5\u94fe\u8868\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u90bb\u63a5\u70b9 <code>v</code>\uff0c\u5982\u679c <code>v</code> \u672a\u88ab\u8bbf\u95ee\u8fc7\uff0c\u5219\u5c06\u5176\u5165\u961f\u5e76\u6807\u8bb0\u4e3a\u5df2\u8bbf\u95ee\u3002</li> </ul> </li> <li>\u8fd4\u56de\u7ed3\u679c\uff1aBFS \u7ed3\u675f\u540e\uff0c<code>res</code> \u5373\u4e3a\u4ece\u8d77\u70b9 <code>x</code> \u53ef\u8fbe\u7684\u9876\u70b9\u603b\u6570\uff08\u5305\u62ec\u8d77\u70b9\u81ea\u8eab\uff09\uff0c\u51fd\u6570\u8fd4\u56de\u8be5\u503c\u3002</li> </ol> </li> </ul> </li> <li> <p><code>double run(int n, int t)</code></p> <ul> <li>\u4f5c\u7528\uff1a\u6267\u884c <code>t</code> \u6b21\u6a21\u62df\uff0c\u5e76\u8ba1\u7b97\u53ef\u8fbe\u9876\u70b9\u6570\u7684\u5e73\u5747\u503c\u3002</li> <li>\u6d41\u7a0b\uff1a<ol> <li>\u521d\u59cb\u5316\u603b\u548c <code>res = 0</code>\u3002</li> <li>\u5faa\u73af <code>t</code> \u6b21\uff0c\u6bcf\u6b21\u8c03\u7528 <code>single_simulate(n)</code> \u5e76\u5c06\u5176\u8fd4\u56de\u503c\u7d2f\u52a0\u5230 <code>res</code> \u4e2d\u3002</li> <li>\u5faa\u73af\u7ed3\u675f\u540e\uff0c\u8fd4\u56de <code>(double)res / t</code> \u4f5c\u4e3a\u5e73\u5747\u503c\u3002</li> </ol> </li> </ul> </li> <li> <p><code>int main(int argc, char *argv[])</code></p> <ul> <li>\u4f5c\u7528\uff1a\u7a0b\u5e8f\u4e3b\u5165\u53e3\uff0c\u534f\u8c03\u6574\u4e2a\u6d41\u7a0b\u3002</li> <li>\u6d41\u7a0b\uff1a<ol> <li>\u8c03\u7528 <code>srand(time(NULL))</code> \u521d\u59cb\u5316\u968f\u673a\u6570\u79cd\u5b50\u3002</li> <li>\u4ece\u6807\u51c6\u8f93\u5165\u8bfb\u53d6\u9876\u70b9\u6570 <code>V</code> \u548c\u8fb9\u6570 <code>E</code>\u3002</li> <li>\u8c03\u7528 <code>generate_graph(V, E)</code> \u6784\u5efa\u56fe\u3002</li> <li>\u8c03\u7528 <code>run(V, 1000)</code> \u6267\u884c 1000 \u6b21\u6a21\u62df\u5e76\u83b7\u53d6\u5e73\u5747\u503c\u3002</li> <li>\u4f7f\u7528 <code>printf(\"%.2f\\n\", ans)</code> \u5c06\u7ed3\u679c\u683c\u5f0f\u5316\u4e3a\u4e24\u4f4d\u5c0f\u6570\u5e76\u8f93\u51fa\u3002</li> </ol> </li> </ul> </li> </ol> <p>\u6d41\u7a0b\u56fe\uff1a  </p> <ul> <li> <p>\u56fe\u751f\u6210\u6d41\u7a0b (<code>generate_graph</code>) <pre><code>flowchart TD\n    A[\"\u5f00\u59cb(V, E)\"] --&gt; B{\"E &gt; V*(V-1)?\"};\n    B --&gt;|\"\u662f\"| C[\"\u62a5\u9519\u5e76\u9000\u51fa\"];\n    B --&gt;|\"\u5426\"| D[\"\u8c03\u7528 init_edges(V) \u751f\u6210\u6240\u6709\u8fb9\"];\n    D --&gt; E[\"\u8c03\u7528 shuffle_edges(E) \u968f\u673a\u9009\u53d6E\u6761\u8fb9\"];\n    E --&gt; F[\"\u5faa\u73af\u904d\u5386\u9009\u4e2d\u7684E\u6761\u8fb9\"];\n    F --&gt; G[\"\u89e3\u7801\u51fa\u8fb9\u7684\u8d77\u70b9x\u548c\u7ec8\u70b9y\"];\n    G --&gt; H[\"\u8c03\u7528 add_edge(g, x, y)\"];\n    H --&gt; F;\n    F -- \"\u5faa\u73af\u7ed3\u675f\" --&gt; I[\"\u5b8c\u6210\"];\n</code></pre></p> </li> <li> <p>\u5355\u6b21\u6a21\u62df\u6d41\u7a0b (<code>single_simulate</code>) <pre><code>flowchart TD\n    A[\"\u5f00\u59cb(n)\"] --&gt; B[\"\u91cd\u7f6e\u961f\u5217\u548cvisited\u6570\u7ec4\"];\n    B --&gt; C[\"\u968f\u673a\u9009\u62e9\u8d77\u70b9 x\"];\n    C --&gt; D[\"\u5c06 x \u5165\u961f\uff0c\u6807\u8bb0 visited[x]=true\"];\n    D --&gt; E{\"\u961f\u5217\u662f\u5426\u4e3a\u7a7a\uff1f\"};\n    E --&gt;|\"\u662f\"| F[\"\u8fd4\u56de\u53ef\u8fbe\u8282\u70b9\u6570 res\"];\n    E --&gt;|\"\u5426\"| G[\"u = \u51fa\u961f()\"];\n    G --&gt; H[\"res++\"];\n    H --&gt; I[\"\u904d\u5386 u \u7684\u90bb\u63a5\u70b9 v\"];\n    I --&gt; J{\"v \u662f\u5426\u5df2\u8bbf\u95ee\uff1f\"};\n    J --&gt;|\"\u662f\"| I;\n    J --&gt;|\"\u5426\"| K[\"\u5c06 v \u5165\u961f\uff0c\u6807\u8bb0 visited[v]=true\"];\n    K --&gt; I;\n    I -- \"\u904d\u5386\u7ed3\u675f\" --&gt; E;\n</code></pre></p> </li> </ul> <p>\u51fd\u6570\u8c03\u7528\u5173\u7cfb\u56fe\uff1a  </p> <pre><code>graph TD\n    main --&gt; srand;\n    main --&gt; scanf;\n    main --&gt; generate_graph;\n    main --&gt; run;\n    main --&gt; printf;\n\n    generate_graph --&gt; init_edges;\n    generate_graph --&gt; shuffle_edges;\n    generate_graph --&gt; add_edge;\n\n    shuffle_edges --&gt; swap;\n\n    run --&gt; single_simulate;\n\n    single_simulate --&gt; push;\n    single_simulate --&gt; pop;\n    single_simulate --&gt; empty;\n</code></pre> <p>\u8c03\u7528\u5173\u7cfb\u8bf4\u660e\uff1a</p> <ul> <li><code>main</code> \u51fd\u6570\u662f\u9876\u5c42\u63a7\u5236\u5668\uff0c\u5b83\u6309\u987a\u5e8f\u8c03\u7528\u4e86\u56fe\u751f\u6210\u51fd\u6570 <code>generate_graph</code> \u548c\u6a21\u62df\u8fd0\u884c\u51fd\u6570 <code>run</code>\u3002</li> <li><code>generate_graph</code> \u8d1f\u8d23\u5efa\u56fe\u7684\u6240\u6709\u6b65\u9aa4\uff0c\u5b83\u4f9d\u8d56 <code>init_edges</code> \u6765\u521b\u5efa\u5019\u9009\u8fb9\u96c6\uff0c<code>shuffle_edges</code> \u6765\u968f\u673a\u5316\u9009\u53d6\uff0c\u4ee5\u53ca <code>add_edge</code> \u6765\u586b\u5145\u90bb\u63a5\u8868\u3002</li> <li><code>run</code> \u662f\u6a21\u62df\u7684\u9a71\u52a8\u5668\uff0c\u5b83\u591a\u6b21\u8c03\u7528 <code>single_simulate</code> \u6765\u6536\u96c6\u6570\u636e\u3002</li> <li><code>single_simulate</code> \u662f\u5355\u6b21\u5b9e\u9a8c\u7684\u6838\u5fc3\uff0c\u5b83\u5b9e\u73b0\u4e86 BFS \u7b97\u6cd5\uff0c\u5e76\u4f9d\u8d56 <code>push</code>\u3001<code>pop</code>\u3001<code>empty</code> \u8fd9\u4e09\u4e2a\u8f85\u52a9\u51fd\u6570\u6765\u64cd\u4f5c\u961f\u5217\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%83%E7%AB%A0%E5%AE%9E%E9%AA%8C/#4","title":"4. \u8c03\u8bd5\u5206\u6790","text":"<p>\u95ee\u9898\u4e0e\u89e3\u51b3\uff1a  </p> <ol> <li> <ul> <li> <p>\u95ee\u9898\u63cf\u8ff0\uff1a\u5728\u65e9\u671f\u7248\u672c\u4e2d\uff0cBFS \u961f\u5217\u7684\u5934\u5c3e\u6307\u9488 <code>front</code> \u548c <code>tail</code> \u662f\u5168\u5c40\u53d8\u91cf\uff0c\u4e14\u53ea\u5728\u7a0b\u5e8f\u542f\u52a8\u65f6\u9690\u5f0f\u521d\u59cb\u5316\u4e00\u6b21\u3002\u8fd9\u5bfc\u81f4\u53ea\u6709\u7b2c\u4e00\u6b21\u8c03\u7528 <code>single_simulate</code> \u662f\u6b63\u786e\u7684\uff0c\u540e\u7eed\u8c03\u7528\u4f1a\u56e0\u4e3a <code>front</code> \u548c <code>tail</code> \u7684\u503c\u672a\u91cd\u7f6e\u800c\u51fa\u9519\uff0c\u751a\u81f3\u5bfc\u81f4\u6570\u7ec4\u8d8a\u754c\u3002</p> </li> <li> <p>\u89e3\u51b3\u65b9\u6848\uff1a\u5728 <code>single_simulate</code> \u51fd\u6570\u7684\u5165\u53e3\u5904\uff0c\u663e\u5f0f\u5730\u5c06 <code>front</code> \u548c <code>tail</code> \u91cd\u7f6e\u4e3a0\uff0c\u5373 <code>front = tail = 0;</code>\u3002\u8fd9\u6837\u786e\u4fdd\u4e86\u6bcf\u6b21\u6a21\u62df\u90fd\u4ece\u4e00\u4e2a\u5e72\u51c0\u7684\u7a7a\u961f\u5217\u5f00\u59cb\u3002</p> </li> </ul> </li> <li> <ul> <li> <p>\u95ee\u9898\u63cf\u8ff0\uff1a\u7a0b\u5e8f\u80fd\u591f\u6b63\u786e\u8ba1\u7b97\u51fa\u5e73\u5747\u503c\uff0c\u4f46\u5728 <code>main</code> \u51fd\u6570\u4e2d\u8c03\u7528 <code>run</code> \u51fd\u6570\u540e\uff0c\u6ca1\u6709\u63a5\u6536\u5176\u8fd4\u56de\u503c\uff0c\u4e5f\u672a\u8fdb\u884c\u4efb\u4f55\u8f93\u51fa\u3002\u7a0b\u5e8f\u8fd0\u884c\u540e\u65e0\u58f0\u65e0\u606f\u5730\u7ed3\u675f\uff0c\u65e0\u6cd5\u9a8c\u8bc1\u7ed3\u679c\u3002</p> </li> <li> <p>\u89e3\u51b3\u65b9\u6848\uff1a\u5728 <code>main</code> \u51fd\u6570\u4e2d\uff0c\u4f7f\u7528\u4e00\u4e2a <code>double</code> \u7c7b\u578b\u7684\u53d8\u91cf <code>ans</code> \u6765\u63a5\u6536 <code>run</code> \u51fd\u6570\u7684\u8fd4\u56de\u503c\uff0c\u5e76\u4f7f\u7528 <code>printf(\"%.2f\\n\", ans);</code> \u5c06\u7ed3\u679c\u6253\u5370\u5230\u63a7\u5236\u53f0\u3002</p> </li> </ul> </li> </ol> <p>\u6539\u8fdb\u65b9\u5411\uff1a  </p> <ul> <li>\u51cf\u5c11\u5168\u5c40\u53d8\u91cf\uff1a\u5f53\u524d\u4ee3\u7801\u5927\u91cf\u4f7f\u7528\u5168\u5c40\u53d8\u91cf\uff08\u5982 <code>g</code>, <code>edges</code>, <code>queue</code>, <code>visited</code> \u7b49\uff09\uff0c\u8fd9\u4f7f\u5f97\u6a21\u5757\u95f4\u7684\u8026\u5408\u5ea6\u8f83\u9ad8\uff0c\u5bb9\u6613\u5f15\u53d1\u7c7b\u4f3c\u961f\u5217\u672a\u91cd\u7f6e\u7684\u9519\u8bef\u3002\u672a\u6765\u53ef\u4ee5\u5c06\u5176\u91cd\u6784\u4e3a\u901a\u8fc7\u51fd\u6570\u53c2\u6570\u4f20\u9012\uff0c\u63d0\u9ad8\u4ee3\u7801\u7684\u6a21\u5757\u5316\u548c\u5065\u58ee\u6027\u3002</li> <li>\u5185\u5b58\u7ba1\u7406\uff1a<code>add_edge</code> \u51fd\u6570\u4e2d\u4f7f\u7528\u4e86 <code>malloc</code> \u5206\u914d\u5185\u5b58\uff0c\u4f46\u7a0b\u5e8f\u4e2d\u6ca1\u6709\u5bf9\u5e94\u7684 <code>free</code> \u64cd\u4f5c\u3002\u867d\u7136\u5bf9\u4e8e\u8fd9\u79cd\u8fd0\u884c\u4e00\u6b21\u5373\u9000\u51fa\u7684\u7a0b\u5e8f\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u56de\u6536\u5185\u5b58\uff0c\u4f46\u5728\u66f4\u590d\u6742\u7684\u5e94\u7528\u4e2d\u4f1a\u5bfc\u81f4\u5185\u5b58\u6cc4\u6f0f\u3002\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e2a <code>free_graph</code> \u51fd\u6570\uff0c\u5728\u7a0b\u5e8f\u7ed3\u675f\u524d\u91ca\u653e\u6240\u6709\u52a8\u6001\u5206\u914d\u7684\u5185\u5b58\u3002</li> </ul> <p>\u590d\u6742\u5ea6\u5206\u6790\uff1a</p> <ul> <li>\u751f\u6210\u56fe\u7684\u590d\u6742\u5ea6\u53d6\u51b3\u4e8e\u9884\u5904\u7406\u8fb9\u7684\u590d\u6742\u5ea6 \\(O(V^2)\\)\u3002</li> <li>\u5355\u8f6e\u6a21\u62df\u7684\u590d\u6742\u5ea6\u4e3a \\(O(E)\\)\u3002</li> <li>\u603b\u590d\u6742\u5ea6\u4e3a \\(O(V^2+kE)\\)\uff0c\u5176\u4e2d \\(k\\) \u4e3a\u6a21\u62df\u6b21\u6570\uff0c\u9ed8\u8ba4\u503c\u4e3a1000\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%83%E7%AB%A0%E5%AE%9E%E9%AA%8C/#5","title":"5. \u7528\u6237\u4f7f\u7528\u8bf4\u660e","text":"<p>\u8fd0\u884c\u73af\u5883\uff1a<code>GCC</code> \u7f16\u8bd1\u5668 (\u5982 <code>GCC 13.2.0</code>) \u6216\u5176\u4ed6\u6807\u51c6 C \u7f16\u8bd1\u5668\u73af\u5883\u3002</p> <p>\u7f16\u8bd1\u4e0e\u8fd0\u884c\uff1a</p> <ol> <li>\u4fdd\u5b58\u4ee3\u7801\u4e3a <code>graph_sim.c</code>\u3002</li> <li>\u4f7f\u7528 GCC \u7f16\u8bd1\uff1a<code>gcc graph_sim.c -o graph_sim.exe</code></li> <li>\u4ece\u547d\u4ee4\u884c\u8fd0\u884c\uff0c\u63d0\u4f9b\u4e24\u4e2a\u6574\u6570\u53c2\u6570 V (\u9876\u70b9\u6570) \u548c E (\u8fb9\u6570)\u3002</li> <li>\u901a\u8fc7\u4fee\u6539RUN_TIMES\u7684\u5b8f\u5b9a\u4e49\u53ef\u4ee5\u6307\u5b9a\u6a21\u62df\u6b21\u6570\u3002</li> </ol> <p>\u8f93\u5165\u793a\u4f8b\uff1a \u4ece\u547d\u4ee4\u884c\u8f93\u5165\uff0c\u6a21\u62df\u4e00\u4e2a\u6709 100 \u4e2a\u9876\u70b9\u548c 500 \u6761\u8fb9\u7684\u56fe\u3002</p> <p><pre><code>100 500\n</code></pre> \u8f93\u51fa\u793a\u4f8b\uff1a \u7a0b\u5e8f\u4f1a\u8f93\u51fa\u4e00\u4e2a\u6d6e\u70b9\u6570\uff0c\u4ee3\u8868\u6a21\u62df 1000 \u6b21\u540e\u5f97\u5230\u7684\u5e73\u5747\u53ef\u8fbe\u8282\u70b9\u6570\u3002 <pre><code>85.42\n</code></pre></p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%83%E7%AB%A0%E5%AE%9E%E9%AA%8C/#6","title":"6. \u6d4b\u8bd5\u7ed3\u679c","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%83%E7%AB%A0%E5%AE%9E%E9%AA%8C/#1_1","title":"\u6d4b\u8bd51\uff1a\u7a00\u758f\u56fe","text":"<ul> <li>\u8f93\u5165: <code>20 25</code> (V=20, E=25, \u8fb9\u6570\u7ea6\u7b49\u4e8e\u9876\u70b9\u6570)</li> <li>\u8f93\u51fa: <code>1.34</code></li> <li>\u5206\u6790: \u5728\u4e00\u4e2a\u7a00\u758f\u56fe\u4e2d\uff0c\u8282\u70b9\u95f4\u7684\u8fde\u901a\u6027\u8f83\u5dee\uff0c\u5f88\u591a\u8282\u70b9\u53ef\u80fd\u5f62\u6210\u5b64\u7acb\u7684\u5c0f\u8fde\u901a\u5206\u91cf\u3002\u56e0\u6b64\uff0c\u4ece\u4e00\u4e2a\u968f\u673a\u70b9\u51fa\u53d1\uff0c\u5e73\u5747\u80fd\u5230\u8fbe\u7684\u8282\u70b9\u6570\u8f83\u5c11\uff0c\u7b26\u5408\u9884\u671f\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%83%E7%AB%A0%E5%AE%9E%E9%AA%8C/#2_1","title":"\u6d4b\u8bd52\uff1a\u7a20\u5bc6\u56fe","text":"<ul> <li>\u8f93\u5165: <code>20 150</code> (V=20, E=150, \u8fb9\u6570\u63a5\u8fd1 V*(V-1)/2)</li> <li>\u8f93\u51fa: <code>20</code></li> <li>\u5206\u6790: \u5728\u4e00\u4e2a\u7a20\u5bc6\u56fe\u4e2d\uff0c\u8282\u70b9\u4e4b\u95f4\u6709\u5927\u91cf\u7684\u8fb9\uff0c\u6574\u4e2a\u56fe\u6709\u5f88\u5927\u6982\u7387\u662f\u5f3a\u8fde\u901a\u7684\u3002\u56e0\u6b64\uff0c\u4ece\u4efb\u610f\u4e00\u4e2a\u8282\u70b9\u51fa\u53d1\uff0c\u51e0\u4e4e\u53ef\u4ee5\u5230\u8fbe\u6240\u6709\u5176\u4ed6\u8282\u70b9\uff0c\u5e73\u5747\u53ef\u8fbe\u6570\u63a5\u8fd1\u9876\u70b9\u603b\u6570 V\uff0c\u7b26\u5408\u9884\u671f\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%83%E7%AB%A0%E5%AE%9E%E9%AA%8C/#3_1","title":"\u6d4b\u8bd53\uff1a\u5927\u89c4\u6a21\u56fe","text":"<ul> <li>\u8f93\u5165: <code>500 10000</code></li> <li>\u8f93\u51fa: <code>87.83</code></li> <li>\u5206\u6790: \u5bf9\u4e8e\u66f4\u5927\u89c4\u6a21\u7684\u56fe\uff0c\u7a0b\u5e8f\u540c\u6837\u80fd\u7a33\u5b9a\u8fd0\u884c\u5e76\u7ed9\u51fa\u4e00\u4e2a\u5408\u7406\u7684\u7edf\u8ba1\u7ed3\u679c\uff0c\u8bc1\u660e\u4e86\u7b97\u6cd5\u7684\u53ef\u6269\u5c55\u6027\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E4%BD%9C%E4%B8%9A/","title":"\u6570\u636e\u7ed3\u6784\u7b2c\u4e09\u7ae0\u4f5c\u4e1a","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_2","title":"\u7b2c\u4e00\u9898","text":"<p>\u8bd5\u63a8\u5bfc\u6c42\u89e3n\u9636hanoi\u5854\u95ee\u9898\u81f3\u5c11\u8981\u6267\u884c\u79fb\u52a8\u64cd\u4f5cmove\u6b21\u6570\u3002</p> <p>\u89e3\uff1a</p> <p>\u8bbe \\(n\\) \u9636hanoi\u5854\u95ee\u9898\u6240\u9700\u7684\u64cd\u4f5c\u6b21\u6570\u4e3a \\(T_n\\)\u3002</p> <p>\u6211\u4eec\u6709\uff1a $$ T_0 = 0 $$</p> \\[ T_n = 2T_{n-1} + 1, \\space n&gt;0 \\] <p>\u4ee3\u6362 \\(a_n=T_n+1\\)\uff0c\u5f97\uff1a $$ a_0 = 1 $$</p> \\[ a_n = 2a_{n-1}, \\space n&gt;0 \\] <p>\u4ece\u800c\uff0c $$ a_n = 2^n $$ \u56e0\u6b64\uff0c $$ T_n = 2^n-1 $$</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_3","title":"\u7b2c\u4e8c\u9898","text":"<p>\u8bd5\u8bc1\u660e\uff1a\u82e5\u501f\u52a9\u6808\u7531\u8f93\u5165\u5e8f\u5217 \\(1, 2, \\ldots, n\\) \u5f97\u5230\u8f93\u51fa\u5e8f\u5217\u4e3a \\(P_1, P_2, \\ldots, P_n\\)\uff08\u5b83\u662f\u8f93\u5165\u5e8f\u5217\u7684\u4e00\u4e2a\u6392\u5217\uff09\uff0c\u5219\u5728\u8f93\u51fa\u5e8f\u5217\u4e2d\u4e0d\u53ef\u80fd\u51fa\u73b0\u8fd9\u6837\u7684\u60c5\u5f62\uff1a\u5b58\u5728\u7740 \\(i &lt; j &lt; k\\)\uff0c\u4f7f \\(P_j &lt; P_k &lt; P_i\\)\u3002</p> <p>\u8bc1\u660e\uff1a</p> <p>\u5047\u8bbe\u5b58\u5728 \\(i &lt; j &lt; k\\)\uff0c\u4f7f \\(P_j &lt; P_k &lt; P_i\\)\u3002</p> <p>\u5219\u51fa\u6808\u987a\u5e8f\u4e3a \\(P_j, P_k, P_i\\)\uff0c\u8fd9\u4e0e\\(i&lt;j&lt;k\\) \u77db\u76fe\uff0c\u56e0\u6b64\u5047\u8bbe\u4e0d\u6210\u7acb\uff0c\u539f\u547d\u9898\u6210\u7acb\u3002</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_4","title":"\u7b2c\u4e09\u9898","text":"<p>\u5047\u8bbe\u4ee5I\u548cO\u5206\u522b\u8868\u793a\u5165\u6808\u548c\u51fa\u6808\u64cd\u4f5c\u3002\u6808\u7684\u521d\u6001\u548c\u7ec8\u6001\u5747\u4e3a\u7a7a\uff0c\u5165\u6808\u548c\u51fa\u6808\u7684\u64cd\u4f5c\u5e8f\u5217\u53ef\u8868\u793a\u4e3a\u4ec5\u7531I\u548cO\u7ec4\u6210\u7684\u5e8f\u5217\uff0c\u79f0\u53ef\u4ee5\u64cd\u4f5c\u7684\u5e8f\u5217\u4e3a\u5408\u6cd5\u5e8f\u5217\uff0c\u5426\u5219\u79f0\u4e3a\u975e\u6cd5\u5e8f\u5217\u3002</p> <ol> <li> <p>\u4e0b\u9762\u6240\u793a\u7684\u5e8f\u5217\u4e2d\u54ea\u4e9b\u662f\u5408\u6cd5\u7684\uff1f    A. IOIIOIOO    B. IOOIOIIO    C. IIIOIOIO    D. IIIOOIOO</p> </li> <li> <p>\u901a\u8fc7\u5bf9(1)\u7684\u5206\u6790\uff0c\u5199\u51fa\u4e00\u4e2a\u7b97\u6cd5\uff0c\u5f62\u5f0f\u5982\u4e0b\uff1abool Judge(char A[])\uff0c\u5224\u5b9a\u6240\u7ed9\u7684\u64cd\u4f5c\u5e8f\u5217\u662f\u5426\u5408\u6cd5\u3002\u82e5\u5408\u6cd5\uff0c\u8fd4\u56detrue\uff0c\u5426\u5219\u8fd4\u56defalse\uff08\u5047\u5b9a\u88ab\u5224\u5b9a\u7684\u64cd\u4f5c\u5e8f\u5217\u5df2\u5b58\u5165\u4e00\u7ef4\u6570\u7ec4A[]\u4e2d\uff09\u3002</p> </li> </ol> <p>\u89e3\uff1a</p> <p>AD\u5747\u5408\u6cd5\u3002</p> <pre><code>#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\nbool Judge(char A[]) {\n    int n = strlen(A);\n    int cnt = 0;\n    for (int i =0; i &lt; len; i++) {\n        if (A[i] == 'I') {\n            cnt++;\n        } else {\n            cnt--;\n        }\n        if (cnt &lt; 0) return false;\n    }\n    return cnt == 0;\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E5%AE%9E%E9%AA%8C1/","title":"\u9898\u76ee\uff1a\u62ec\u5f27\u5339\u914d\u95ee\u9898\u2014\u2014\u8865\u5168\u7f3a\u5931\u5de6\u62ec\u53f7\u7684\u4e2d\u5e8f\u8868\u8fbe\u5f0f","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E5%AE%9E%E9%AA%8C1/#1","title":"1. \u9700\u6c42\u5206\u6790","text":"<p>\u4efb\u52a1\u63cf\u8ff0\uff1a  \u7f16\u5199\u7a0b\u5e8f\uff0c\u4ece\u6807\u51c6\u8f93\u5165\u8bfb\u53d6\u4e00\u4e2a\u7f3a\u5931\u5de6\u62ec\u53f7\u7684\u4e2d\u5e8f\u8868\u8fbe\u5f0f\uff08\u5982 <code>(1+2)*3-4)*5-6)</code>\uff09\uff0c\u8865\u5168\u7f3a\u5931\u7684\u5de6\u62ec\u53f7\u540e\u8f93\u51fa\u5b8c\u6574\u8868\u8fbe\u5f0f\uff08\u5982 <code>((1+2)*((3-4)*(5-6)))</code>\uff09\u3002  </p> <p>\u8f93\u5165/\u8f93\u51fa\u8981\u6c42\uff1a  </p> <ul> <li>\u8f93\u5165\u5f62\u5f0f\uff1a\u4e00\u884c\u5b57\u7b26\u4e32\uff0c\u5305\u542b\u6570\u5b57\u3001\u8fd0\u7b97\u7b26\uff08<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>\uff09\u3001\u62ec\u53f7\uff08\u53ef\u80fd\u7f3a\u5931\u5de6\u62ec\u53f7\uff09\u3002 </li> <li>\u8f93\u51fa\u5f62\u5f0f\uff1a\u8865\u5168\u5de6\u62ec\u53f7\u540e\u7684\u4e2d\u5e8f\u8868\u8fbe\u5f0f\uff0c\u4fdd\u8bc1\u6240\u6709\u53f3\u62ec\u53f7\u5747\u6709\u5339\u914d\u7684\u5de6\u62ec\u53f7\u3002</li> <li>\u503c\u8303\u56f4\uff1a\u8f93\u5165\u957f\u5ea6\u4e0d\u8d85\u8fc7 <code>MAX_INPUT_SIZE</code>\uff081000\u5b57\u7b26\uff09\u3002 </li> </ul> <p>\u529f\u80fd\u8981\u6c42\uff1a </p> <ol> <li>\u6b63\u786e\u5904\u7406\u6570\u5b57\u3001\u8fd0\u7b97\u7b26\u548c\u62ec\u53f7\u3002</li> <li>\u81ea\u52a8\u8865\u5168\u7f3a\u5931\u7684\u5de6\u62ec\u53f7\uff0c\u786e\u4fdd\u8868\u8fbe\u5f0f\u8bed\u6cd5\u6b63\u786e\u3002</li> <li>\u5bf9\u975e\u6cd5\u8f93\u5165\uff08\u5982\u65e0\u6cd5\u5339\u914d\u7684\u53f3\u62ec\u53f7\uff09\u62a5\u9519\u3002</li> </ol> <p>\u6d4b\u8bd5\u7528\u4f8b\uff1a  </p> \u8f93\u5165 \u8f93\u51fa \u8bf4\u660e <code>1+23)*3-4712)*5-6)))</code> <code>((1+23)*((3-4712)*(5-6)))</code> \u6b63\u5e38\u8f93\u5165 <code>1+2)*3</code> <code>(1+2)*3</code> \u5355\u5c42\u8865\u5168 <code>1+2</code> <code>1+2</code> \u65e0\u62ec\u53f7\uff0c\u65e0\u9700\u8865\u5168 <code>1+)</code> \u62a5\u9519\uff1a<code>\u8868\u8fbe\u5f0f\u683c\u5f0f\u9519\u8bef</code> \u975e\u6cd5\u8f93\u5165"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E5%AE%9E%E9%AA%8C1/#2","title":"2. \u6982\u8981\u8bbe\u8ba1","text":"<p>\u89e3\u51b3\u601d\u8def\uff1a  </p> <ol> <li>\u6808\u7ed3\u6784\u7ba1\u7406\uff1a\u4f7f\u7528\u6808\u5b58\u50a8\u8868\u8fbe\u5f0f\u7247\u6bb5\uff08\u6570\u5b57\u3001\u8fd0\u7b97\u7b26\u3001\u5b50\u8868\u8fbe\u5f0f\uff09\u3002  </li> <li>\u904d\u5386\u8f93\u5165\uff1a\u9010\u4e2a\u5b57\u7b26\u5904\u7406\uff1a  </li> <li>\u6570\u5b57\uff1a\u8fde\u7eed\u8bfb\u53d6\u5b8c\u6574\u4e2a\u6570\u5e76\u538b\u6808\u3002  </li> <li>\u8fd0\u7b97\u7b26\uff1a\u8f6c\u5316\u6210\u5b57\u7b26\u4e32\u5e76\u538b\u6808\u3002  </li> <li>\u53f3\u62ec\u53f7 <code>)</code>\uff1a\u5f39\u51fa\u6808\u9876\u7684\u53f3\u64cd\u4f5c\u6570\u3001\u8fd0\u7b97\u7b26\u3001\u5de6\u64cd\u4f5c\u6570\uff0c\u7ec4\u5408\u4e3a <code>(left op right)</code> \u5e76\u538b\u6808\u3002  </li> <li>\u5de6\u62ec\u53f7\u6216\u7a7a\u683c\uff1a\u5ffd\u7565\u3002</li> <li>\u8865\u5168\u8868\u8fbe\u5f0f\uff1a\u626b\u63cf\u5b8c\u6210\u540e\uff0c\u82e5\u6808\u4e2d\u4ecd\u6709\u591a\u4e2a\u7247\u6bb5\uff0c\u76f4\u63a5\u7ec4\u5408\u6210\u8868\u8fbe\u5f0f\uff0c\u65e0\u9700\u8865\u5145\u62ec\u53f7\u3002  </li> </ol> <p>\u6570\u636e\u7ed3\u6784\uff1a  </p> <pre><code>typedef struct {\n    char **base;    // \u6808\u5e95\u6307\u9488\n    char **top;     // \u6808\u9876\u6307\u9488\n    int stacksize;  // \u6808\u5bb9\u91cf\n} StackStr;\n</code></pre> <p>\u6a21\u5757\u5173\u7cfb\uff1a - <code>initStk</code> / <code>pushStk</code> / <code>popStk</code>\uff1a\u6808\u7684\u57fa\u672c\u64cd\u4f5c\u3002 - <code>combineExpressions</code>\uff1a\u5408\u5e76\u5b50\u8868\u8fbe\u5f0f\u5e76\u6dfb\u52a0\u62ec\u53f7\u3002 - <code>main</code>\uff1a\u63a7\u5236\u6d41\u7a0b\uff0c\u5904\u7406\u8f93\u5165/\u8f93\u51fa\u548c\u9519\u8bef\u68c0\u67e5\u3002  </p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E5%AE%9E%E9%AA%8C1/#3","title":"3. \u8be6\u7ec6\u8bbe\u8ba1","text":"<p>\u5173\u952e\u7b97\u6cd5\uff1a 1. \u6808\u64cd\u4f5c\uff1a\u52a8\u6001\u6269\u5bb9\u6808\uff08<code>STACK_INCREMENT</code>\uff09\uff0c\u786e\u4fdd\u5185\u5b58\u5b89\u5168\u3002 2. \u8868\u8fbe\u5f0f\u5408\u5e76\uff1a    - \u9047\u5230 <code>)</code> \u65f6\uff0c\u5f39\u51fa <code>right</code>\u3001<code>op</code>\u3001<code>left</code>\uff0c\u751f\u6210 <code>(left op right)</code>\u3002    - \u6700\u7ec8\u6808\u4e2d\u5269\u4f59\u7247\u6bb5\u901a\u8fc7\u5faa\u73af\u5408\u5e76\u4e3a\u5b8c\u6574\u8868\u8fbe\u5f0f\u3002  </p> <p>\u6d41\u7a0b\u56fe\uff1a  </p> <pre><code>flowchart TD\n    A([\u5f00\u59cb]) --&gt; B[\u8bfb\u53d6\u8f93\u5165]\n    B --&gt; C[\u521d\u59cb\u5316\u6808]\n    C --&gt; D{\u904d\u5386\u5b57\u7b26}\n    D --&gt;|\u6570\u5b57| E[\u8bfb\u53d6\u6570\u5b57\u538b\u6808]\n    D --&gt;|\u8fd0\u7b97\u7b26| F[\u538b\u6808]\n    D --&gt;|\u53f3\u62ec\u53f7| G[\u5f39\u51fa\u4e09\u9879\u7ec4\u5408]\n    G --&gt; H[\u751f\u6210\u65b0\u8868\u8fbe\u5f0f\u538b\u6808]\n    D --&gt;|\u5176\u4ed6| I[\u62a5\u9519\u9000\u51fa]\n    D --&gt;|\u7ed3\u675f| J{\u6808\u5927\u5c0f&gt;1?}\n    J --&gt;|\u662f| K[\u7ee7\u7eed\u7ec4\u5408]\n    K --&gt; J\n    J --&gt;|\u5426| L[\u8f93\u51fa\u7ed3\u679c]\n    L --&gt; M[\u91ca\u653e\u5185\u5b58]\n    M --&gt; N([\u7ed3\u675f])\n    I --&gt; N\n</code></pre> <p>\u51fd\u6570\u8c03\u7528\u5173\u7cfb\u56fe\uff1a</p> <pre><code>flowchart TD\n    A[main] --&gt; B[initStk]\n    A --&gt; C[emptyStk]\n    A --&gt; D[pushStk]\n    A --&gt; E[popStk]\n    A --&gt; F[sizeStk]\n    A --&gt; G[combineExpressions]\n    A --&gt; H[charToString]\n\n    D --&gt; I[\u5185\u5b58\u6269\u5bb9\u5904\u7406]\n    E --&gt; J[\u7a7a\u6808\u68c0\u67e5]\n    G --&gt; K[\u5b57\u7b26\u4e32\u62fc\u63a5]\n    H --&gt; L[\u5b57\u7b26\u8f6c\u6362]\n\n    style A fill:#f9f,stroke:#333\n    style G fill:#bbf,stroke:#333\n    style H fill:#bbf,stroke:#333\n</code></pre> <p>\u8c03\u7528\u5173\u7cfb\u8bf4\u660e\uff1a</p> <ol> <li>\u6838\u5fc3\u8c03\u7528\u94fe\uff1a</li> </ol> <pre><code>main \u2192 initStk \u2192 pushStk/popStk \u2192 combineExpressions \u2192 \u8f93\u51fa\u7ed3\u679c\n        \u2191           \u2191                \u2191\n        \u2502           \u2502                \u2514\u2500 charToString\uff08\u5904\u7406\u8fd0\u7b97\u7b26\uff09\n        \u2502           \u2514\u2500 sizeStk/emptyStk\uff08\u6808\u72b6\u6001\u68c0\u67e5\uff09\n        \u2514\u2500 free\uff08\u5185\u5b58\u91ca\u653e\uff09\n</code></pre> <ol> <li>\u5173\u952e\u6a21\u5757\u529f\u80fd\uff1a</li> <li><code>initStk</code>\uff1a\u521d\u59cb\u5316\u5b57\u7b26\u4e32\u6808</li> <li><code>pushStk/popStk</code>\uff1a\u5e26\u52a8\u6001\u6269\u5bb9\u7684\u6808\u64cd\u4f5c</li> <li><code>combineExpressions</code>\uff1a\u751f\u6210\u5e26\u62ec\u53f7\u7684\u5b50\u8868\u8fbe\u5f0f</li> <li><code>charToString</code>\uff1a\u5c06\u8fd0\u7b97\u7b26\u8f6c\u4e3a\u5b57\u7b26\u4e32\u683c\u5f0f</li> </ol>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E5%AE%9E%E9%AA%8C1/#4","title":"4. \u8c03\u8bd5\u5206\u6790","text":"<p>\u95ee\u9898\u4e0e\u89e3\u51b3\uff1a  </p> <ol> <li>\u5185\u5b58\u6cc4\u6f0f\uff1a\u6bcf\u6b21\u5408\u5e76\u8868\u8fbe\u5f0f\u540e\u91ca\u653e\u65e7\u5185\u5b58\uff08<code>free(left/op/right)</code>\uff09\u3002  </li> <li>\u65e0\u6cd5\u5904\u7406\u591a\u4f4d\u6570\uff1a\u6dfb\u52a0\u6570\u5b57\u7684\u8fde\u7eed\u8bfb\u5165\u3002</li> <li>\u7f3a\u5c11\u53f3\u62ec\u53f7\u65f6\u62a5\u9519\uff1a\u589e\u6dfb\u5269\u4f59\u8868\u8fbe\u5f0f\u7684\u5408\u5e76\u3002</li> <li>\u4ee3\u7801\u8fc7\u4e8e\u5197\u957f\uff1a\u5c06\u64cd\u4f5c\u7b26\u8f6c\u5316\u6210\u5b57\u7b26\u4e32\uff0c\u5171\u7528\u4e00\u4e2a\u6808\u7ed3\u6784\u3002</li> <li>\u590d\u6742\u5ea6\uff1a\u65f6\u95f4\u590d\u6742\u5ea6 O(n)\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 O(n)\uff08\u6808\u52a8\u6001\u6269\u5bb9\uff09\uff0cn\u4e3a\u8868\u8fbe\u5f0f\u957f\u5ea6\u3002  </li> </ol> <p>\u6539\u8fdb\u65b9\u5411\uff1a  </p> <ul> <li>\u652f\u6301\u66f4\u591a\u8fd0\u7b97\u7b26\uff08\u5982 <code>^</code>\uff09\u3002  </li> <li>\u652f\u6301\u66f4\u591a\u62ec\u53f7\u79cd\u7c7b\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E5%AE%9E%E9%AA%8C1/#5","title":"5. \u7528\u6237\u4f7f\u7528\u8bf4\u660e","text":"<p>\u8fd0\u884c\u73af\u5883\uff1a<code>GCC 13.2.0</code></p> <p>\u7f16\u8bd1\u8fd0\u884c\u540e\uff0c\u8f93\u5165\u4e00\u4e2a\u5f85\u8865\u5168\u7684\u8868\u8fbe\u5f0f\uff0c\u62ec\u53f7\u53ea\u80fd\u662f\u82f1\u6587\u5706\u62ec\u53f7\uff0c\u8fd0\u7b97\u7b26\u53ea\u80fd\u662f\u82f1\u6587\u5b57\u7b26\u4e2d\u7684 <code>+-*/</code>\uff0c\u6309\u4e0b\u56de\u8f66\u540e\u7a0b\u5e8f\u5c06\u4f1a\u81ea\u52a8\u8f93\u51fa\u8865\u5168\u540e\u7684\u4e2d\u5e8f\u8868\u8fbe\u5f0f\u3002\u6ce8\u610f\uff0c\u8f93\u5165\u8868\u8fbe\u5f0f\u957f\u5ea6\u9700\u8981\u5c0f\u4e8e\u7b49\u4e8e1000\uff0c\u5426\u5219\u4f1a\u6ea2\u51fa\u3002</p> <p>\u8f93\u5165\u793a\u4f8b\uff1a  </p> <p><pre><code>1+23)*3-4712)*5-6)))\n</code></pre> \u8f93\u51fa\u793a\u4f8b\uff1a  </p> <pre><code>((1+23)*((3-4712)*(5-6)))\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E5%AE%9E%E9%AA%8C1/#6","title":"6. \u6d4b\u8bd5\u7ed3\u679c","text":"\u8f93\u5165 \u8f93\u51fa <code>1+2)*3+4)*5+6)))</code> <code>((1+2)*((3+4)*(5+6)))</code> <code>1 + 23) / 148 + 18342 - 0))</code> <code>(1+23)/(148+(18342-0))</code> <code>12 + 3)*48</code> <code>(12+3)*48</code>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E5%AE%9E%E9%AA%8C2/","title":"\u9898\u76ee\uff1a\u5224\u522b\u56de\u6587\u5b57\u7b26\u4e32\uff08\u6808\u548c\u961f\u5217\u5b9e\u73b0\uff09","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E5%AE%9E%E9%AA%8C2/#1","title":"1. \u9700\u6c42\u5206\u6790","text":"<p>\u4efb\u52a1\u63cf\u8ff0\uff1a - \u4f7f\u7528\u6808\u548c\u961f\u5217\u5224\u65ad\u8f93\u5165\u7684\u5b57\u7b26\u4e32\u662f\u5426\u4e3a\u56de\u6587\uff08\u6b63\u8bfb\u53cd\u8bfb\u76f8\u540c\uff09\uff0c\u4ee5 <code>#</code> \u4f5c\u4e3a\u8f93\u5165\u7ed3\u675f\u6807\u5fd7\u3002  </p> <p>\u8f93\u5165/\u8f93\u51fa\uff1a - \u8f93\u5165\u5f62\u5f0f\uff1a\u4ece\u952e\u76d8\u9010\u5b57\u7b26\u8f93\u5165\uff0c\u4ee5 <code>#</code> \u7ed3\u5c3e\uff08\u5982 <code>abcba#</code>\uff09\u3002 - \u8f93\u51fa\u5f62\u5f0f\uff1a\u6253\u5370 <code>YES</code>\uff08\u662f\u56de\u6587\uff09\u6216 <code>NO</code>\uff08\u975e\u56de\u6587\uff09\u3002 - \u503c\u8303\u56f4\uff1a\u8f93\u5165\u957f\u5ea6 \u2264 <code>MAX_INPUT_SIZE</code>\uff081000\u5b57\u7b26\uff09\u3002  </p> <p>\u529f\u80fd\u8981\u6c42\uff1a 1. \u52a8\u6001\u5b58\u50a8\u8f93\u5165\u5b57\u7b26\u81f3\u6808\u548c\u961f\u5217\u3002 2. \u901a\u8fc7\u6bd4\u8f83\u6808\uff08\u540e\u8fdb\u5148\u51fa\uff09\u548c\u961f\u5217\uff08\u5148\u8fdb\u5148\u51fa\uff09\u7684\u5b57\u7b26\u5224\u65ad\u56de\u6587\u3002 3. \u5904\u7406\u5185\u5b58\u5206\u914d\u9519\u8bef\u548c\u7a7a\u6808/\u961f\u5217\u5f02\u5e38\u3002  </p> <p>\u6d4b\u8bd5\u6570\u636e\uff1a | \u8f93\u5165\u7c7b\u578b | \u6d4b\u8bd5\u7528\u4f8b | \u9884\u671f\u8f93\u51fa | \u5b9e\u9645\u8f93\u51fa | \u8bf4\u660e           | | -------- | -------- | -------- | -------- | -------------- | | \u5408\u6cd5\u56de\u6587 | <code>ababa#</code> | <code>YES</code>    |          | \u5947\u6570\u957f\u5ea6       | | \u5408\u6cd5\u56de\u6587 | <code>abba#</code>  | <code>YES</code>    |          | \u5076\u6570\u957f\u5ea6       | | \u975e\u6cd5\u56de\u6587 | <code>abc#</code>   | <code>NO</code>     |          | \u975e\u56de\u6587         | | \u7a7a\u8f93\u5165   | <code>#</code>      | <code>YES</code>    |          | \u7a7a\u5b57\u7b26\u4e32\u7b97\u56de\u6587 |</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E5%AE%9E%E9%AA%8C2/#2","title":"2. \u6982\u8981\u8bbe\u8ba1","text":"<p>\u89e3\u51b3\u601d\u8def\uff1a - \u6808\uff08\u540e\u8fdb\u5148\u51fa\uff09\u53cd\u8f6c\u5b57\u7b26\u987a\u5e8f\uff0c\u961f\u5217\uff08\u5148\u8fdb\u5148\u51fa\uff09\u4fdd\u6301\u539f\u987a\u5e8f\uff0c\u901a\u8fc7\u6bd4\u8f83\u4e24\u8005\u5b57\u7b26\u5224\u65ad\u56de\u6587\u3002  </p> <p>\u6570\u636e\u7ed3\u6784\uff1a <pre><code>// \u6808\u5b9a\u4e49\ntypedef struct {\n    char *top, *base;\n    int size;\n} Stack;\n\n// \u961f\u5217\u5b9a\u4e49\uff08\u94fe\u8868\u5b9e\u73b0\uff09\ntypedef struct QNode {\n    char data;\n    struct QNode *next;\n} QNode;\ntypedef struct {\n    QNode *head, *tail;\n} Queue;\n</code></pre></p> <p>\u6a21\u5757\u5212\u5206\uff1a <pre><code>flowchart TD\n    A[main] --&gt; B[\u521d\u59cb\u5316\u6808/\u961f\u5217]\n    A --&gt; C[\u8bfb\u53d6\u8f93\u5165\u5b57\u7b26]\n    C --&gt; D[\u5b57\u7b26\u538b\u6808/\u5165\u961f]\n    A --&gt; E[\u6bd4\u8f83\u6808\u548c\u961f\u5217\u5b57\u7b26]\n    E --&gt; F[\u8f93\u51fa\u7ed3\u679c]\n    F --&gt; G[\u91ca\u653e\u5185\u5b58]\n</code></pre></p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E5%AE%9E%E9%AA%8C2/#3","title":"3. \u8be6\u7ec6\u8bbe\u8ba1","text":"<p>\u5173\u952e\u7b97\u6cd5\u4f2a\u4ee3\u7801\uff1a  </p> <pre><code>def is_palindrome():\n    stack, queue = init_stack(), init_queue()\n    while (c := getchar()) != '#':\n        push_stack(stack, c)\n        push_queue(queue, c)\n\n    while not empty_stack(stack) and not empty_queue(queue):\n        if pop_stack(stack) != pop_queue(queue):\n            return False\n    return True\n</code></pre> <p>\u51fd\u6570\u8c03\u7528\u5173\u7cfb\uff1a  </p> <pre><code>flowchart LR\n    main --&gt; initStack\n    main --&gt; initQueue\n    main --&gt; pushStack\n    main --&gt; pushQueue\n    main --&gt; popStack\n    main --&gt; popQueue\n    main --&gt; clearStack\n    main --&gt; clearQueue\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E5%AE%9E%E9%AA%8C2/#4","title":"4. \u8c03\u8bd5\u5206\u6790","text":"<p>\u95ee\u9898\u4e0e\u89e3\u51b3\uff1a  </p> <ul> <li>\u5bf9\u4e8eC\u8bed\u8a00\u7684\u4e00\u4e9b\u8bed\u6cd5\u6709\u95ee\u9898\uff0c\u901a\u8fc7\u8be2\u95ee\u5927\u6a21\u578b\u89e3\u51b3\u3002\u672c\u5b9e\u9a8c\u6d89\u53ca\u7684\u7b97\u6cd5\u548c\u6570\u636e\u7ed3\u6784\u8fc7\u4e8e\u663e\u7136\u76f4\u767d\uff0c\u672a\u9047\u5230\u95ee\u9898\u3002</li> </ul> <p>\u6539\u8fdb\u8bbe\u60f3\uff1a - \u53ef\u4f18\u5316\u4e3a\u4ec5\u9700\u4e00\u534a\u5b57\u7b26\u6bd4\u8f83\u3002</p> <p>\u590d\u6742\u5ea6\u5206\u6790\uff1a</p> <ul> <li>\u65f6\u95f4\u590d\u6742\u5ea6\uff1a\\(O(n)\\)</li> <li>\u7a7a\u95f4\u590d\u6742\u5ea6\uff1a\\(O(n)\\)</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E5%AE%9E%E9%AA%8C2/#5","title":"5. \u7528\u6237\u4f7f\u7528\u8bf4\u660e","text":"<p>\u8fd0\u884c\u73af\u5883\uff1a<code>GCC 13.2.0</code></p> <p>\u64cd\u4f5c\u6b65\u9aa4\uff1a  </p> <ol> <li>\u7f16\u8bd1\uff1a<code>gcc -o palindrome palindrome.c</code> </li> <li>\u8fd0\u884c\uff1a<code>./palindrome</code> </li> <li>\u8f93\u5165\uff1a\u952e\u5165ascii\u7801\u5b57\u7b26\u4e32\uff0c\u4ee5 <code>#</code> \u7ed3\u5c3e\uff08\u5982 <code>level#</code>\uff09\uff0c\u6309\u56de\u8f66\u663e\u793a\u7ed3\u679c\uff0c\u5b57\u7b26\u4e32\u957f\u5ea6\u9700\u8981\u5c11\u4e8e1000\u3002</li> </ol>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E7%AB%A0%E5%AE%9E%E9%AA%8C2/#6","title":"6. \u6d4b\u8bd5\u7ed3\u679c","text":"\u8f93\u5165 \u9884\u671f\u8f93\u51fa \u5b9e\u9645\u8f93\u51fa <code>racecar#</code> <code>YES</code> <code>YES</code> <code>hello#</code> <code>NO</code> <code>NO</code> <code>a#</code> <code>YES</code> <code>YES</code>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B9%9D%E7%AB%A0%E4%BD%9C%E4%B8%9A/","title":"\u6570\u636e\u7ed3\u6784\u7b2c\u4e5d\u7ae0\u4f5c\u4e1a","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B9%9D%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_2","title":"\u7b2c\u4e00\u9898","text":"<p>\u5168\u56fd\u670910000\u4eba\u53c2\u52a0\u7269\u7406\u7ade\u8d5b\uff0c\u53ea\u5f55\u53d6\u6210\u7ee9\u4f18\u5f02\u7684\u524d10\u540d\uff0c\u4e0d\u9700\u6392\u51fa\u540d\u6b21\u3002\u95ee\u6b64\u79cd\u60c5\u51b5\u4e0b\uff0c\u7528\u4f55\u79cd\u6392\u5e8f\u65b9\u6cd5\u901f\u5ea6\u6700\u5feb\uff1f\u4e3a\u4ec0\u4e48\uff1f</p> <p>\u89e3\uff1a</p> <p>\u4f7f\u7528\u57fa\u4e8e\u5feb\u901f\u6392\u5e8f\u601d\u60f3\u7684kth_element\u7b97\u6cd5\uff0c\u9012\u5f52\u6c42\u89e3\u524dk\u5927\u7684\u6570\u3002\u65f6\u95f4\u590d\u6742\u5ea6\\(O(n)\\)\u3002</p> <p>\u7531\u4e8e\u5206\u6570\u7684\u503c\u57df\u6709\u9650\uff0c\u4e5f\u53ef\u4f7f\u7528\u57fa\u6570\u6392\u5e8f\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u540c\u6837\u4e5f\u662f\\(O(n)\\)\uff0c\u4f46\u9700\u8981\u989d\u5916\u7684\u7a7a\u95f4\u5f00\u9500\u3002</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B9%9D%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_3","title":"\u7b2c\u4e8c\u9898","text":"<p>\u82e5\u5f85\u6392\u5e8f\u5217\u7528\u7ed3\u5e26\u5934\u70b9\u7684\u5355\u94fe\u8868\u5b58\u50a8\uff0c\u8bd5\u7ed9\u51fa\u7b80\u5355\u9009\u62e9\u6392\u5e8f\u7b97\u6cd5\u3002</p> <p>\u89e3\uff1a</p> <pre><code>typedef struct node {\n    int key;\n    InfoType otherinfo;\n    struct node *next;  \n} node, *pointer;\n\nvoid selectsort(pointer h) { // h \u4e3a\u5934\u6307\u9488\n    if (h == NULL || h-&gt;next == NULL) return;\n    pointer sorted_head = NULL;\n    while (h-&gt;next != NULL) {\n        pointer pre_max = NULL;\n        pointer max = h-&gt;next;\n        pointer pre = h;\n        pointer p = h-&gt;next;\n        while (p != NULL) {\n            if (p-&gt;key &gt; max-&gt;key) {\n                pre_max = pre;\n                max = p;\n            }\n            pre = p;\n            p = p-&gt;next;\n        }\n        if (pre_max == NULL) { // max \u4e3a h-&gt;next\n            h-&gt;next = max-&gt;next;\n        } else {\n            pre_max-&gt;next = max-&gt;next;\n        }\n        max-&gt;next = sorted_head;\n        sorted_head = max;\n    }\n    h-&gt;next = sorted_head;\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B9%9D%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_4","title":"\u7b2c\u4e09\u9898","text":"<p>\u8bf7\u7f16\u5199\u51fa\u7b97\u6cd5\uff0c\u501f\u52a9\u4e8e\u5feb\u901f\u6392\u5e8f\u7684\u7b97\u6cd5\u601d\u60f3\uff0c\u5728\u4e00\u7ec4\u65e0\u5e8f\u7684\u8bb0\u5f55\u4e2d\u67e5\u627e\u7ed9\u5b9a\u5173\u952e\u5b57\u503c\u7b49\u4e8ek\u7684\u8bb0\u5f55\u662f\u8bb0\u5f55\u5e8f\u5217\u4e2d\u7b2c\u51e0\u5927\u7684\u6570\u3002\u8bbe\u6b64\u7ec4\u8bb0\u5f55\u5b58\u4e8e\u6570\u7ec4r[low..high]\u4e2d\uff0c\u82e5\u67e5\u627e\u6210\u529f\uff0c\u5219\u8fd4\u56de\u8be5\u8bb0\u5f55\u662fr\u6570\u7ec4\u4e2d\u7b2c\u51e0\u5927\u7684\u6570\uff0c\u5426\u5219\u8fd4\u56de0\u3002 int Index (ElemType r[], int low, int high, int k)</p> <p>\u89e3\uff1a</p> <p>\u9009\u5b9a\u67a2\u8f74\u4e4b\u540e\u5206\u533a\uff0c\u6bd4\u8f83\u67a2\u8f74\u4e0a\u7684\u5065\u4e0ek\u7684\u5927\u5c0f\uff0c\u7136\u540e\u5206\u6cbb\u6c42\u89e3\u3002</p> <pre><code>int Partition(ElemType a[], int low, int high) {\n    ElemType pivot = a[low];\n    while (low &lt; high) {\n        while (low &lt; high &amp;&amp; pivot.key &lt;= a[high].key) --high;\n        a[low] = a[high];\n        while (low &lt; high &amp;&amp; pivot.key &gt;= a[low].key) ++low;\n        a[high] = a[low];\n    }\n    a[low] = pivot;\n    return low;\n}\n\nint Index(ElemType r[], int low, int high, int k) {\n    if (low &gt; high) return 0;\n    int i = Partition(r, low, high);\n    if (r[i].key == k) {\n        return i - low + 1;\n    } else if (r[i].key &lt; k) {\n        int tmp = Index(r, i + 1, high, k); \n        if (tmp == 0) return 0; // \u786e\u4fdd\u80fd\u627e\u5230\u518d\u8ba1\u7b97\u7b54\u6848\n        else return i - low + 1 + tmp;\n    } else{\n        return Index(r, low, i - 1, k);\n    }\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B9%9D%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_5","title":"\u7b2c\u56db\u9898","text":"<p>\u4ee5\u5173\u952e\u7801\u5e8f\u5217(503, 087, 512, 061, 908, 170, 897, 275, 653, 426)\u4e3a\u4f8b\uff0c\u624b\u5de5\u6267\u884c\u4ee5\u4e0b\u6392\u5e8f\u7b97\u6cd5\uff0c\u5199\u51fa\u6bcf\u4e00\u8d9f\u6392\u5e8f\u7ed3\u675f\u65f6\u7684\u5173\u952e\u7801\u72b6\u6001\uff1a (1) \u76f4\u63a5\u63d2\u5165\u6392\u5e8f (2) \u5e0c\u5c14\u6392\u5e8f(d[1]=5, d[2]=3, d[3]=1) (3) \u5feb\u901f\u6392\u5e8f(\u7b2c\u4e00\u4e2a\u8bb0\u5f55\u4e3a\u57fa\u51c6\u8bb0\u5f55) (4) \u5806\u6392\u5e8f (5) \u5f52\u5e76\u6392\u5e8f (6) \u57fa\u6570\u6392\u5e8f</p> <p>\u89e3\uff1a</p> <p>(1) </p> <p>503, 087, 512, 061, 908, 170, 897, 275, 653, 426</p> <p>087, 503, 512, 061, 908, 170, 897, 275, 653, 426</p> <p>087, 503, 512, 061, 908, 170, 897, 275, 653, 426</p> <p>061, 087, 503, 512, 908, 170, 897, 275, 653, 426</p> <p>061, 087, 503, 512, 908, 170, 897, 275, 653, 426</p> <p>061, 087, 170, 503, 512, 908, 897, 275, 653, 426</p> <p>061, 087, 170, 503, 512, 897, 908, 275, 653, 426</p> <p>061, 087, 170, 275, 503, 512, 897, 908, 653, 426</p> <p>061, 087, 170, 275, 503, 512, 653, 897, 908, 426</p> <p>061, 087, 170, 275, 426, 503, 512, 653, 897, 908</p> <p>(2)</p> <p>170, 087, 275, 061, 426, 503, 897, 512, 653, 908 (d=5)</p> <p>061, 087, 275, 170, 426, 503, 897, 512, 653, 908 (d=3)</p> <p>061, 087, 170, 275, 426, 503, 512, 653, 897, 908 (d=1)</p> <p>(3)</p> <p>087, 061, 170, 275, 426, 503, 512, 908, 897, 653 (pivot = 503)</p> <p>061, 087, 170, 275, 426, 503, 512, 908, 897, 653 (pivot = 087)</p> <p>061, 087, 170, 275, 426, 503, 512, 908, 897, 653 (pivot = 061)</p> <p>061, 087, 170, 275, 426, 503, 512, 908, 897, 653 (pivot = 170)</p> <p>061, 087, 170, 275, 426, 503, 512, 908, 897, 653 (pivot = 275)</p> <p>061, 087, 170, 275, 426, 503, 512, 908, 897, 653 (pivot = 512)</p> <p>061, 087, 170, 275, 426, 503, 512, 897, 653, 908 (pivot = 908)</p> <p>061, 087, 170, 275, 426, 503, 512, 653, 897, 908 (pivot = 897)</p> <p>(4)</p> <p>908,653,897,275,426,170,512,503,061,087\uff08\u5efa\u5806\uff09</p> <p>897,653,512,275,426,170,087,503,061,908</p> <p>653,426,512,275,061,170,087,503,897,908</p> <p>653,426,512,275,061,170,087,503,897,908</p> <p>426,275,170,087,061,503,512,653,897,908</p> <p>503,275,170,087,061,426,512,653,897,908</p> <p>275,087,170,061,503,426,512,653,897,908</p> <p>170,087,061,275,503,426,512,653,897,908</p> <p>087,061,170,275,503,426,512,653,897,908</p> <p>061,087,170,275,503,426,512,653,897,908</p> <p>(5)</p> <p>087,503, 061,512, 170,908, 275,897, 426,653</p> <p>061,087,503,512, 170,275,897,908, 426,653</p> <p>061,087,170,275, 503,512,897,908, 426,653</p> <p>061,087,170,275,426,503,512,653,897,908</p> <p>(6)</p> <p>170,061,512,503,653,275,426,087,897,908 \uff08\u4e2a\u4f4d\uff09</p> <p>503,908,512,426,653,061,170,275,087,897 \uff08\u5341\u4f4d\uff09</p> <p>061,087,170,275,426,503,512,653,897,908 \uff08\u767e\u4f4d\uff09</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A/","title":"\u6570\u636e\u7ed3\u6784\u7b2c\u4e8c\u7ae0\u4f5c\u4e1a","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_2","title":"\u7b2c\u4e00\u9898","text":"<p>\u5047\u8bbe\u6709\u4e24\u4e2a\u6309\u5143\u7d20\u503c\u9012\u589e\u6b21\u5e8f\u6392\u5217\u7684\u7ebf\u6027\u8868\uff0c\u5747\u4ee5\u5355\u94fe\u8868\u5f62\u5f0f\u5b58\u50a8\u3002\u8bf7\u7f16\u5199\u7b97\u6cd5\u5c06\u8fd9\u4e24\u4e2a\u5355\u94fe\u8868\u5f52\u5e76\u4e3a\u4e00\u4e2a\u6309\u5143\u7d20\u503c\u9012\u51cf\u6b21\u5e8f\u6392\u5217\u7684\u5355\u94fe\u8868\uff0c\u5e76\u8981\u6c42\u5229\u7528\u539f\u6765\u4e24\u4e2a\u5355\u94fe\u8868\u7684\u7ed3\u70b9\u5b58\u653e\u5f52\u5e76\u540e\u7684\u5355\u94fe\u8868\u3002</p> <p>\u8282\u70b9\u7ed3\u6784\uff1a</p> <pre><code>typedef struct node\n{\n    int data;\n    struct node *next;\n} linknode, *link;\n\nlink Union(link la, link lb)\n</code></pre> <p>\u89e3\uff1a</p> <p>\u5148\u5206\u522b\u9006\u5e8f\uff0c\u518d\u6b63\u5e38\u5f52\u5e76\u5373\u53ef\u3002</p> <pre><code>void Reverse(link head) {\n    if (head-&gt;next == NULL) return;\n    link pre = NULL;\n    link cur = head-&gt;next;\n    link nex = NULL;\n    while (cur != NULL) {\n        nex = cur-&gt;next;\n        cur-&gt;next = pre;\n        pre = cur;\n        cur = nex;\n    }\n    head-&gt;next = pre;\n}\nlink Union(link la, link lb) {\n    Reverse(la), Reverse(lb);\n    link a = la-&gt;next; \n    link b = lb-&gt;next;\n    link head = (link) malloc(sizeof(linknode));\n    link tail = head;\n    while (a != NULL &amp;&amp; b != NULL) {\n        if (a-&gt;data &gt; b-&gt;data) {\n            tail-&gt;next = a;\n            a = a-&gt;next;\n        } else {\n            tail-&gt;next = b;\n            b = b-&gt;next;\n        }\n        tail = tail-&gt;next;\n    }\n    tail-&gt;next = (a != NULL) ? a : b;\n    free(la), free(lb);\n    return head;\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_3","title":"\u7b2c\u4e8c\u9898","text":"<p>\u8bf7\u5728\u4e0b\u5217\u7b97\u6cd5\u7684\u6a2a\u7ebf\u4e0a\u586b\u5165\u9002\u5f53\u7684\u8bed\u53e5\u3002</p> <pre><code>typedef struct node\n{\n    int data;\n    struct node *next;\n} linknode, *link;\n\nbool inclusion(link ha, link hb) : boolean;\n/* \u4ee5ha\u548chb\u4e3a\u5934\u6307\u9488\u7684\u5e26\u5934\u8282\u70b9\u5355\u94fe\u8868\u5206\u522b\u8868\u793a\u9012\u589e\u6709\u5e8f\u8868A\u548cB\uff0c\u672c\u7b97\u6cd5\u5224\u522b\u8868A\u662f\u5426\u5305\u542b\u5728\u8868B\u5185\uff0c\u82e5\u662f\uff0c\u5219\u8fd4\u56de\u201ctrue\u201d\uff0c\u5426\u5219\u8fd4\u56de\u201cfalse\u201d */\n{\n    pa = ha-&gt;next; pb = hb-&gt;next; (1) ;\n    while ( (2) )\n    {\n        if (pa-&gt;data == pb-&gt;data)\n            (3) ;\n        else\n            (4) ;\n    }\n    (5) ;\n}\n</code></pre> <p>\u89e3\uff1a</p> <pre><code>bool inclusion(link ha, link hb) : boolean;\n/* \u4ee5ha\u548chb\u4e3a\u5934\u6307\u9488\u7684\u5e26\u5934\u8282\u70b9\u5355\u94fe\u8868\u5206\u522b\u8868\u793a\u9012\u589e\u6709\u5e8f\u8868A\u548cB\uff0c\u672c\u7b97\u6cd5\u5224\u522b\u8868A\u662f\u5426\u5305\u542b\u5728\u8868B\u5185\uff0c\u82e5\u662f\uff0c\u5219\u8fd4\u56de\u201ctrue\u201d\uff0c\u5426\u5219\u8fd4\u56de\u201cfalse\u201d */\n{\n    pa = ha-&gt;next; pb = hb-&gt;next; bool ok;\n    while (pa != NULL &amp;&amp; pb != NULL and pa-&gt;data &gt;= pb-&gt;data)\n    {\n        if (pa-&gt;data == pb-&gt;data)\n            pa = pa-&gt;next, pb = pb-&gt;next;\n        else\n            pb = pb-&gt;next;\n    }\n    return ok = (pa == NULL);\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_4","title":"\u7b2c\u4e09\u9898","text":"<p>\u8bf7\u5199\u4e00\u7b97\u6cd5link LinkListSort(link la)\uff0c\u5c06\u4e0d\u5e26\u5934\u7ed3\u70b9\u7684\u5355\u94fe\u8868\u6309\u7ed3\u70b9\u6570\u636e\u57df\u7684\u503c\u7684\u5927\u5c0f\u4ece\u5c0f\u5230\u5927\u91cd\u65b0\u94fe\u63a5\u3002\u8981\u6c42\u94fe\u63a5\u8fc7\u7a0b\u4e2d\u4e0d\u5f97\u4f7f\u7528\u9664\u8be5\u94fe\u8868\u4ee5\u5916\u7684\u4efb\u4f55\u94fe\u7ed3\u70b9\u7a7a\u95f4\u3002</p> <pre><code>typedef struct node\n{\n    int data;\n    struct node *next;\n} linknode, *link;\n\nlink LinkListSort(link list)\n</code></pre> <p>\u89e3\uff1a</p> <pre><code>link LinkListSort(link list) {\n    if (list == NULL || list-&gt;next == NULL) {\n        return list;  // \u7a7a\u94fe\u8868\u6216\u5355\u8282\u70b9\u76f4\u63a5\u8fd4\u56de\n    }\n    bool swapped;\n    do {\n        swapped = false;\n        link pre = NULL;      // \u524d\u9a71\u8282\u70b9\n        link cur = list;      // \u5f53\u524d\u8282\u70b9\n        link nex = cur-&gt;next; // \u540e\u7ee7\u8282\u70b9\n        while (nex != NULL) {\n            if (cur-&gt;data &gt; nex-&gt;data) {\n                if (pre == NULL) {\n                    list = nex; \n                } else {\n                    pre-&gt;next = nex;\n                }\n                cur-&gt;next = nex-&gt;next;\n                nex-&gt;next = cur;\n                swapped = true;\n                pre = nex;     \n                nex = cur-&gt;next; \n            } else {\n                pre = cur;\n                cur = nex;\n                nex = nex-&gt;next;\n            }\n        }\n    } while (swapped);\n    return list;\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%8C%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_5","title":"\u7b2c\u56db\u9898","text":"<p>\u5199\u51fa\u4e0b\u56fe\u53cc\u94fe\u8868\u4e2d\u5bf9\u6362\u503c\u4e3a23\u548c15\u7684\u4e24\u4e2a\u7ed3\u70b9\u76f8\u4e92\u4f4d\u7f6e\u65f6\u4fee\u6539\u6307\u9488\u7684\u6709\u5173\u8bed\u53e5\u3002 \u7ed3\u70b9\u7ed3\u6784\u4e3a\uff1a(prev,data,next)</p> <p></p> <pre><code>void solve(link p) {\n    link q = p-&gt;prev;\n    q-&gt;prev-&gt;next = p;\n    p-&gt;next-&gt;prev = q;\n    q-&gt;next = p-&gt;next;\n    p-&gt;prev = q-&gt;prev;\n    q-&gt;prev = p;\n    p-&gt;next = q;\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%8C%E7%AB%A0%E5%AE%9E%E9%AA%8C/","title":"\u9898\u76ee\uff1a\u52a0\u91cc\u68ee\u7684\u4efb\u52a1","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%8C%E7%AB%A0%E5%AE%9E%E9%AA%8C/#1","title":"1. \u9700\u6c42\u5206\u6790","text":"<p>\u4efb\u52a1\u63cf\u8ff0\uff1a </p> <p>\u6709n\u4e2a\u52a0\u91cc\u68ee\u6562\u6b7b\u961f\u7684\u961f\u5458\u8981\u70b8\u6389\u654c\u4eba\u7684\u4e00\u4e2a\u519b\u706b\u5e93\uff0c\u8c01\u90fd\u4e0d\u60f3\u53bb\uff0c\u961f\u957f\u52a0\u91cc\u68ee\u51b3\u5b9a\u7528\u8f6e\u56de\u6570\u6570\u7684\u529e\u6cd5\u6765\u51b3\u5b9a\u54ea\u4e2a\u6218\u58eb\u53bb\u6267\u884c\u4efb\u52a1\u3002\u89c4\u5219\u5982\u4e0b\uff1a\u5982\u679c\u524d\u4e00\u4e2a\u6218\u58eb\u6ca1\u5b8c\u6210\u4efb\u52a1\uff0c\u5219\u8981\u518d\u6d3e\u4e00\u4e2a\u6218\u58eb\u4e0a\u53bb\u3002\u73b0\u7ed9\u6bcf\u4e2a\u6218\u58eb\u7f16\u4e00\u4e2a\u53f7\uff0c\u5927\u5bb6\u56f4\u5750\u6210\u4e00\u5708\uff0c\u968f\u4fbf\u4ece\u67d0\u4e00\u4e2a\u7f16\u53f7\u4e3ax\u7684\u6218\u58eb\u5f00\u59cb\u8ba1\u6570\uff0c\u5f53\u6570\u5230y\u65f6\uff0c\u5bf9\u5e94\u7684\u6218\u58eb\u5c31\u53bb\u6267\u884c\u4efb\u52a1\uff0c\u4e14\u6b64\u6218\u58eb\u4e0d\u518d\u53c2\u52a0\u4e0b\u4e00\u8f6e\u8ba1\u6570\u3002\u5982\u679c\u6b64\u6218\u58eb\u6ca1\u5b8c\u6210\u4efb\u52a1\uff0c\u518d\u4ece\u4e0b\u4e00\u4e2a\u6218\u58eb\u5f00\u59cb\u6570\u6570\uff0c\u88ab\u6570\u5230\u7b2cy\u65f6\uff0c\u6b64\u6218\u58eb\u63a5\u7740\u53bb\u6267\u884c\u4efb\u52a1\u3002\u4ee5\u6b64\u7c7b\u63a8\uff0c\u76f4\u5230\u4efb\u52a1\u5b8c\u6210\u4e3a\u6b62\u3002</p> <p>\u52a0\u91cc\u68ee\u672c\u4eba\u662f\u4e0d\u613f\u610f\u53bb\u7684\uff0c\u5047\u8bbe\u52a0\u91cc\u68ee\u4e3a1\u53f7\uff0c\u8bf7\u4f60\u8bbe\u8ba1\u4e00\u4e2a\u7a0b\u5e8f\u4e3a\u52a0\u91cc\u68ee\u652f\u62db\uff0c\u6c42\u51fan,x,y\u6ee1\u8db3\u4f55\u79cd\u6761\u4ef6\u65f6\uff0c\u52a0\u91cc\u68ee\u80fd\u7559\u5230\u6700\u540e\u800c\u4e0d\u7528\u53bb\u6267\u884c\u4efb\u52a1\u3002\u8981\u6c42\u4e3b\u8981\u6570\u636e\u7ed3\u6784\u91c7\u7528\u94fe\u5f0f\u7ed3\u6784\u5b58\u50a8\u3002</p> <p>\u8f93\u5165\u8f93\u51fa\u8981\u6c42\uff1a</p> <p>\u65e0</p> <p>\u529f\u80fd\u8981\u6c42\uff1a </p> <ol> <li>\u7ed9\u5b9an,x,y\u80fd\u6b63\u786e\u5224\u65ad\u52a0\u91cc\u68ee\u662f\u5426\u5b58\u6d3b\u3002</li> <li>\u751f\u6210\u591a\u7ec4\u4f7f\u5f97\u52a0\u91cc\u68ee\u5b58\u6d3b\u7684(n,x,y)\u4ee5\u89c2\u5bdf\u89c4\u5f8b\u3002</li> </ol> <p>\u6d4b\u8bd5\u7528\u4f8b\uff1a  </p> <p>\u65e0</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%8C%E7%AB%A0%E5%AE%9E%E9%AA%8C/#2","title":"2. \u6982\u8981\u8bbe\u8ba1","text":"<p>\u89e3\u51b3\u601d\u8def\uff1a  </p> <ol> <li>\u4f7f\u7528\u5faa\u73af\u94fe\u8868\u5b58\u50a8\u6bcf\u4e2a\u5b58\u6d3b\u58eb\u5175\u7684\u7f16\u53f7\u3002</li> <li>\u6309\u7167\u9898\u610f\u6a21\u62df\u58eb\u5175\u6570\u6570\u7684\u8fc7\u7a0b\u3002</li> <li>\u6570\u5230y\u7684\u58eb\u5175\u4ece\u5faa\u73af\u94fe\u8868\u4e2d\u5220\u9664\u3002</li> <li>\u91cd\u590d\u4e0a\u8ff0\u8fc7\u7a0b\u76f4\u5230\u53ea\u5269\u4e0b\u4e00\u540d\u58eb\u5175\u3002</li> </ol> <p>\u6570\u636e\u7ed3\u6784\uff1a  </p> <p>\u4f7f\u7528\u5faa\u73af\u94fe\u8868\u5b58\u50a8</p> <pre><code>typedef struct node {\n    int id;\n    struct node *pre, *next;\n} Node, *Link;\n</code></pre> <p>\u6a21\u5757\u5173\u7cfb\uff1a  </p> <ul> <li><code>struct node</code> (<code>Node</code>, <code>Link</code>):</li> <li>\u5b9a\u4e49\u94fe\u8868\u8282\u70b9\uff0c\u5b58\u50a8\u58eb\u5175ID\u53ca\u524d\u540e\u6307\u9488\u3002\u5934\u8282\u70b9ID\u7279\u6b8a\u7528\u4e8e\u8ba1\u6570\u3002</li> <li><code>Link init(int n, int x)</code>:</li> <li>\u521d\u59cb\u5316: \u521b\u5efa\u542b <code>n</code> \u540d\u58eb\u5175\u7684\u5faa\u73af\u94fe\u8868\uff0c\u8bbe\u7f6e\u4ece <code>x</code> \u53f7\u58eb\u5175\u5f00\u59cb\uff0c\u5e76\u8fd4\u56de\u5934\u8282\u70b9\u3002</li> <li><code>void erase_node(Link head, Link x)</code>:</li> <li>\u5220\u9664\u8282\u70b9: \u4ece\u94fe\u8868\u4e2d\u79fb\u9664\u58eb\u5175 <code>x</code>\uff0c\u66f4\u65b0\u5934\u8282\u70b9\u72b6\u6001\uff08\u8ba1\u6570\u3001\u4e0b\u4e00\u8f6e\u8d77\u59cb\u70b9\uff09\u3002</li> <li><code>void single_turn(Link head, int y)</code>:</li> <li>\u5355\u8f6e\u6dd8\u6c70: \u6839\u636e\u62a5\u6570\u503c <code>y</code> \u627e\u5230\u5e76\u6dd8\u6c70\u4e00\u540d\u58eb\u5175\u3002</li> <li><code>int simulate(Link head, int y)</code>:</li> <li>\u5b8c\u6574\u6a21\u62df: \u6267\u884c\u591a\u8f6e\u6dd8\u6c70\uff0c\u76f4\u81f3\u4ec5\u5269\u4e00\u540d\u58eb\u5175\uff0c\u8fd4\u56de\u5176ID\u3002</li> <li><code>bool check(int n, int x, int y)</code>:</li> <li>\u5b58\u6d3b\u68c0\u67e5: \u5224\u65ad\u5728\u53c2\u6570 <code>n</code>, <code>x</code>, <code>y</code> \u4e0b\uff0c1\u53f7\u58eb\u5175\u662f\u5426\u6700\u7ec8\u5b58\u6d3b\u3002</li> <li><code>int main()</code>:</li> <li>\u4e3b\u7a0b\u5e8f: \u904d\u5386\u591a\u7ec4 <code>(n, x, y)</code> \u53c2\u6570\uff0c\u8c03\u7528 <code>check</code> \u627e\u51fa1\u53f7\u58eb\u5175\u7684\u5b58\u6d3b\u6761\u4ef6\u5e76\u8f93\u51fa\u5230\u6587\u4ef6\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%8C%E7%AB%A0%E5%AE%9E%E9%AA%8C/#3","title":"3. \u8be6\u7ec6\u8bbe\u8ba1","text":"<p>\u5173\u952e\u7b97\u6cd5\uff1a  </p> <ul> <li>\u6a21\u62df\u58eb\u5175\u5faa\u73af\u62a5\u6570\u548c\u88ab\u9009\u4e2d\u7684\u8fc7\u7a0b\uff0c\u76f4\u5230\u53ea\u5269\u4e0b\u4e00\u540d\u58eb\u5175\uff0c\u5224\u65ad\u662f\u5426\u662f1\u53f7\u58eb\u5175\u3002\u904d\u5386n\uff0cx\uff0cy\uff0c\u6a21\u62df\u6574\u4e2a\u8fc7\u7a0b\uff0c\u5c06\u6ee1\u8db3\u8981\u6c42\uff081\u53f7\u5b58\u6d3b\uff09\u7684\u4e09\u5143\u7ec4\u5199\u5165\u6587\u4ef6\u3002</li> <li>\u4f7f\u7528python\uff0c\u5c06\u5408\u6cd5\u7684(n, x, y)\u4e09\u5143\u7ec4\u753b\u5728\u4e00\u4e2a\u4e09\u7ef4\u7684\u6563\u70b9\u56fe\u4e0a\uff0c\u89c2\u5bdf\u7ed3\u679c\u3002</li> </ul> <p>\u6d41\u7a0b\u56fe\uff1a  </p> <pre><code>graph TD\n    A[\"\u5f00\u59cb check(n, x, y)\"] --&gt; B[\"\u6b65\u9aa41: \u521d\u59cb\u5316\u6e38\u620f\u73af\u5883 &lt;br&gt; (\u521b\u5efan\u4eba\u5faa\u73af\u94fe\u8868, \u4ecex\u53f7\u58eb\u5175\u5f00\u59cb\u62a5\u6570)\"];\n    B --&gt; C_StartSim[\"\u6b65\u9aa42: \u5f00\u59cb\u6a21\u62df\u6dd8\u6c70\"];\n    C_StartSim --&gt; C_LoopCond{\"\u662f\u5426\u591a\u4e8e1\u540d\u58eb\u5175?\"};\n    C_LoopCond -- \"\u662f\" --&gt; C_StepA[\"a. \u4ece\u5f53\u524d\u58eb\u5175\u5f00\u59cb, &lt;br&gt; \u6309\u62a5\u6570\u503cy\u627e\u5230\u8981\u6dd8\u6c70\u7684\u58eb\u5175\"];\n    C_StepA --&gt; C_StepB[\"b. \u5c06\u8be5\u58eb\u5175\u4ece\u94fe\u8868\u4e2d\u79fb\u9664, &lt;br&gt; \u66f4\u65b0\u4e0b\u4e00\u8f6e\u8d77\u59cb\u70b9\u548c\u5269\u4f59\u4eba\u6570\"];\n    C_StepB --&gt; C_LoopCond;\n    C_LoopCond -- \"\u5426 (\u4ec5\u52691\u540d\u58eb\u5175)\" --&gt; D[\"\u6b65\u9aa43: \u83b7\u53d6\u6700\u7ec8\u5e78\u5b58\u58eb\u5175\u7684ID\"];\n    D --&gt; E[\"\u6b65\u9aa44: \u6e05\u7406/\u91ca\u653e\u94fe\u8868\u5185\u5b58\"];\n    E --&gt; F{\"\u5e78\u5b58\u58eb\u5175\u7684ID\u662f\u5426\u4e3a1?\"};\n    F -- \"\u662f\" --&gt; G[\"\u8fd4\u56de True\"];\n    F -- \"\u5426\" --&gt; H[\"\u8fd4\u56de False\"];\n    G --&gt; I[\"\u7ed3\u675f check\"];\n    H --&gt; I;\n</code></pre> <p>\u51fd\u6570\u8c03\u7528\u5173\u7cfb\u56fe\uff1a</p> <pre><code>graph TD\n    main --&gt; check;\n    check --&gt; init;\n    check --&gt; simulate;\n    check --&gt; free;  \n    simulate --&gt; single_turn;\n    single_turn --&gt; erase_node;\n    erase_node --&gt; free; \n    init --&gt; malloc;\n    main --&gt; fopen;\n    main --&gt; fprintf;\n    main --&gt; fclose;\n    main --&gt; printf;\n    init --&gt; perror; \n    init --&gt; exit;   \n</code></pre> <p>\u6838\u5fc3\u6570\u636e\u7ed3\u6784</p> <ul> <li> <p><code>c   typedef struct node {       int id;       struct node *pre, *next;   } Node, *Link;</code></p> </li> <li> <p>\u5b9a\u4e49\u4e86\u53cc\u5411\u5faa\u73af\u94fe\u8868\u7684\u8282\u70b9\u7ed3\u6784\u3002</p> </li> <li> <p><code>id</code>: \u5b58\u50a8\u58eb\u5175\u7684\u7f16\u53f7\u3002</p> </li> <li><code>pre</code>: \u6307\u5411\u524d\u4e00\u4e2a\u8282\u70b9\u7684\u6307\u9488\u3002</li> <li><code>next</code>: \u6307\u5411\u4e0b\u4e00\u4e2a\u8282\u70b9\u7684\u6307\u9488\u3002</li> <li>\u6ce8\u91ca\u4e2d\u63d0\u5230\u5934\u8282\u70b9\u7684 <code>id</code> \u7528\u6765\u5b58\u50a8\u5269\u4f59\u8282\u70b9\u6570\u76ee\uff0c\u8fd9\u662f\u4e00\u4e2a\u7279\u6b8a\u7528\u9014\u3002</li> </ul> <p>\u51fd\u6570\u8bf4\u660e</p> <ol> <li><code>Link init(int n, int x)</code>:</li> <li>\u4f5c\u7528: \u521d\u59cb\u5316\u4e00\u4e2a\u5305\u542b <code>n</code> \u4e2a\u58eb\u5175\u7684\u5faa\u73af\u94fe\u8868\uff0c\u7528\u4e8e\u7ea6\u745f\u592b\u95ee\u9898\u7684\u6a21\u62df\u3002</li> <li>\u529f\u80fd:<ul> <li>\u521b\u5efa\u4e00\u4e2a\u54e8\u5175\u5934\u8282\u70b9\uff08<code>head</code>\uff09\uff0c\u5e76\u5c06\u5176 <code>id</code> \u8bbe\u7f6e\u4e3a\u58eb\u5175\u603b\u6570 <code>n</code>\u3002</li> <li>\u521b\u5efa <code>n</code> \u4e2a\u58eb\u5175\u8282\u70b9\uff0c\u7f16\u53f7\u4ece 1 \u5230 <code>n</code>\uff0c\u5e76\u5c06\u5b83\u4eec\u94fe\u63a5\u6210\u4e00\u4e2a\u53cc\u5411\u5faa\u73af\u94fe\u8868\u3002</li> <li>\u5c06 <code>head</code> \u8282\u70b9\u7684 <code>next</code> \u6307\u9488\u6307\u5411\u7f16\u53f7\u4e3a <code>x</code> \u7684\u58eb\u5175\u8282\u70b9\uff0c\u4f5c\u4e3a\u62a5\u6570\u7684\u8d77\u59cb\u4f4d\u7f6e\u3002</li> <li>\u5c06 <code>head</code> \u8282\u70b9\u7684 <code>pre</code> \u6307\u9488\u6307\u5411\u7f16\u53f7\u4e3a <code>x</code> \u7684\u58eb\u5175\u8282\u70b9\u7684\u524d\u4e00\u4e2a\u8282\u70b9\u3002</li> <li>\u8fd4\u56de\u6307\u5411\u5934\u8282\u70b9\u7684\u6307\u9488 <code>head</code>\u3002</li> </ul> </li> <li><code>void erase_node(Link head, Link x)</code>:</li> <li>\u4f5c\u7528: \u4ece\u5faa\u73af\u94fe\u8868\u4e2d\u5220\u9664\u6307\u5b9a\u7684\u58eb\u5175\u8282\u70b9 <code>x</code>\u3002</li> <li>\u529f\u80fd:<ul> <li>\u5c06\u88ab\u5220\u9664\u8282\u70b9 <code>x</code> \u7684\u4e0b\u4e00\u4e2a\u8282\u70b9\u8bbe\u7f6e\u4e3a\u65b0\u7684\u62a5\u6570\u8d77\u59cb\u70b9\uff08\u66f4\u65b0 <code>head-&gt;next</code>\uff09\u3002</li> <li>\u66f4\u65b0 <code>head-&gt;pre</code> \u6307\u5411\u65b0\u7684\u62a5\u6570\u8d77\u59cb\u70b9\u7684\u524d\u4e00\u4e2a\u8282\u70b9\u3002</li> <li>\u5c06 <code>head-&gt;id</code>\uff08\u5269\u4f59\u58eb\u5175\u6570\uff09\u51cf 1\u3002</li> <li>\u5c06\u88ab\u5220\u9664\u8282\u70b9 <code>x</code> \u4ece\u94fe\u8868\u4e2d\u79fb\u9664\uff08\u66f4\u65b0 <code>x</code> \u7684\u524d\u9a71\u548c\u540e\u7ee7\u8282\u70b9\u7684\u6307\u9488\uff09\u3002</li> <li>\u91ca\u653e\u88ab\u5220\u9664\u8282\u70b9 <code>x</code> \u7684\u5185\u5b58\u3002</li> </ul> </li> <li><code>void single_turn(Link head, int y)</code>:</li> <li>\u4f5c\u7528: \u6267\u884c\u4e00\u8f6e\u62a5\u6570\u5e76\u6dd8\u6c70\u4e00\u540d\u58eb\u5175\u3002</li> <li>\u529f\u80fd:<ul> <li>\u4ece <code>head-&gt;next</code> \u6307\u5411\u7684\u5f53\u524d\u58eb\u5175\u5f00\u59cb\u3002</li> <li>\u4ece\u5f53\u524d\u58eb\u5175\u5f00\u59cb\uff0c\u5411\u524d\u79fb\u52a8\u76f8\u5e94\u7684\u6b65\u6570\u627e\u5230\u8981\u6dd8\u6c70\u7684\u58eb\u5175\u3002</li> <li>\u8c03\u7528 <code>erase_node</code> \u51fd\u6570\u6dd8\u6c70\u8be5\u58eb\u5175\u3002</li> </ul> </li> <li><code>int simulate(Link head, int y)</code>:</li> <li>\u4f5c\u7528: \u6a21\u62df\u6574\u4e2a\u7ea6\u745f\u592b\u95ee\u9898\u7684\u8fc7\u7a0b\uff0c\u76f4\u5230\u53ea\u5269\u4e0b\u4e00\u540d\u58eb\u5175\u3002</li> <li>\u529f\u80fd:<ul> <li>\u5f53\u5269\u4f59\u58eb\u5175\u6570 (<code>head-&gt;id</code>) \u5927\u4e8e 1 \u65f6\uff0c\u5faa\u73af\u8c03\u7528 <code>single_turn</code> \u51fd\u6570\u6267\u884c\u62a5\u6570\u548c\u6dd8\u6c70\u3002</li> <li>\u8fd4\u56de\u6700\u540e\u5e78\u5b58\u7684\u58eb\u5175\u7684\u7f16\u53f7 (<code>head-&gt;next-&gt;id</code>)\u3002</li> </ul> </li> <li><code>bool check(int n, int x, int y)</code>:</li> <li>\u4f5c\u7528: \u68c0\u67e5\u5728\u7ed9\u5b9a\u603b\u4eba\u6570 <code>n</code>\u3001\u8d77\u59cb\u62a5\u6570\u58eb\u5175\u7f16\u53f7 <code>x</code> \u548c\u62a5\u6570\u503c <code>y</code> \u7684\u6761\u4ef6\u4e0b\uff0c1\u53f7\u58eb\u5175\u662f\u5426\u80fd\u6700\u7ec8\u5b58\u6d3b\u3002</li> <li>\u529f\u80fd:<ul> <li>\u8c03\u7528 <code>init</code> \u51fd\u6570\u521d\u59cb\u5316\u94fe\u8868\u3002</li> <li>\u8c03\u7528 <code>simulate</code> \u51fd\u6570\u6a21\u62df\u7ea6\u745f\u592b\u95ee\u9898\u3002</li> <li>\u91ca\u653e <code>head</code> \u8282\u70b9\uff08\u6ce8\u610f\uff1a\u5728\u4f60\u7684\u539f\u59cb\u4ee3\u7801\u4e2d\uff0c<code>simulate</code> \u540e\u53ea\u5269\u4e0b\u4e00\u4e2a\u8282\u70b9\uff0c\u4e5f\u9700\u8981\u91ca\u653e\uff0c\u6216\u8005\u5728 <code>check</code> \u4e2d\u7edf\u4e00\u5904\u7406\uff09\u3002</li> <li>\u5982\u679c\u6700\u540e\u5e78\u5b58\u7684\u58eb\u5175\u7f16\u53f7\u4e3a 1\uff0c\u5219\u8fd4\u56de <code>true</code>\uff0c\u5426\u5219\u8fd4\u56de <code>false</code>\u3002</li> <li>\u4f60\u5728\u6700\u65b0\u7684\u4ee3\u7801\u4e2d\u5df2\u7ecf\u6dfb\u52a0\u4e86\u5bf9 <code>head</code> \u7684 <code>free</code> \u64cd\u4f5c\uff0c\u5f88\u597d\u3002\u4f46 <code>simulate</code> \u540e\u8fd4\u56de\u7684 <code>head-&gt;next</code> \u6307\u5411\u7684\u6700\u540e\u4e00\u4e2a\u8282\u70b9\u4e5f\u9700\u8981\u91ca\u653e\uff0c\u8fd9\u901a\u5e38\u5728 <code>check</code> \u51fd\u6570\u4e2d\u3001\u83b7\u53d6\u5176 <code>id</code> \u4e4b\u540e\u8fdb\u884c\u3002</li> </ul> </li> <li><code>int main()</code>:</li> <li>\u4f5c\u7528: \u7a0b\u5e8f\u4e3b\u5165\u53e3\uff0c\u7528\u4e8e\u6267\u884c\u4e00\u7cfb\u5217\u7ea6\u745f\u592b\u95ee\u9898\u6a21\u62df\uff0c\u5e76\u5c061\u53f7\u58eb\u5175\u5b58\u6d3b\u7684 <code>(n, x, y)</code> \u53c2\u6570\u7ec4\u5408\u8f93\u51fa\u5230\u6587\u4ef6\u3002</li> <li>\u529f\u80fd:<ul> <li>\u6253\u5f00\u4e00\u4e2a\u540d\u4e3a <code>josephus_survivors.txt</code> \u7684\u6587\u4ef6\u7528\u4e8e\u5199\u5165\u7ed3\u679c\u3002</li> <li>\u5b9a\u4e49\u6a21\u62df\u7684\u53c2\u6570\u8303\u56f4\uff08<code>n_max</code>, <code>y_max</code>\uff09\u3002</li> <li>\u4f7f\u7528\u4e09\u5c42\u5d4c\u5957\u5faa\u73af\u904d\u5386\u4e0d\u540c\u7684 <code>n</code>\uff08\u603b\u4eba\u6570\uff09\u3001<code>x</code>\uff08\u8d77\u59cb\u62a5\u6570\u58eb\u5175\u7f16\u53f7\uff09\u548c <code>y</code>\uff08\u62a5\u6570\u503c\uff09\u7684\u7ec4\u5408\u3002</li> <li>\u5bf9\u4e8e\u6bcf\u79cd\u7ec4\u5408\uff0c\u8c03\u7528 <code>check</code> \u51fd\u6570\u5224\u65ad1\u53f7\u58eb\u5175\u662f\u5426\u5b58\u6d3b\u3002</li> <li>\u5982\u679c1\u53f7\u58eb\u5175\u5b58\u6d3b\uff0c\u5219\u5c06\u8be5 <code>(n, x, y)</code> \u7ec4\u5408\u5199\u5165\u6587\u4ef6\u3002</li> <li>\u5173\u95ed\u6587\u4ef6\u3002</li> </ul> </li> </ol>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%8C%E7%AB%A0%E5%AE%9E%E9%AA%8C/#4","title":"4. \u8c03\u8bd5\u5206\u6790","text":"<p>\u95ee\u9898\u4e0e\u89e3\u51b3\uff1a  </p> <ol> <li>\u4e00\u5f00\u59cb\u5728\u6808\u7a7a\u95f4\u5206\u914d\u8282\u70b9\u5185\u5b58\uff0c\u5bfc\u81f4\u5faa\u73af\u94fe\u8868\u7684\u521d\u59cb\u5316\u6709\u8bef\uff0c\u6539\u7528malloc\u540e\u89e3\u51b3\u3002</li> <li>\u8981\u6c42\u4f7f\u7528\u94fe\u5f0f\u7ed3\u6784\u5b58\u50a8\uff0c\u6bcf\u6b21\u90fd\u6a21\u62df\u5b9e\u9645\u8fc7\u7a0b\uff0ccheck\u4e00\u6b21\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(n^2)\\)\uff0c\u8017\u65f6\u592a\u5927\uff0c\u56e0\u6b64\u53ea\u80fd\u6a21\u62df\u5c0f\u89c4\u6a21\u6570\u636e\u3002\u5b9e\u9645\u4e0a\uff0c\u7ea6\u745f\u592b\u95ee\u9898\u6709 \\(O(n)\\) \u4ee5\u53ca \\(O(y \\log{n})\\) \u7684\u89e3\u6cd5\uff0c\u4f46\u662f\u9650\u4e8e\u5b9e\u9a8c\u8981\u6c42\uff0c\u672a\u80fd\u5b9e\u73b0\u3002</li> </ol> <p>\u6539\u8fdb\u65b9\u5411\uff1a  </p> <ul> <li>\u5b9e\u73b0\u4e00\u4e2a\u8df3\u8868\uff0c\u6bcf\u4e2a\u8282\u70b9\u9884\u5904\u7406\u540e\u7ee7\u8ddd\u79bb \\(2^i\\) \u7684\u8282\u70b9\u5e76\u5728\u5220\u9664\u8282\u70b9\u65f6\u52a8\u6001\u66f4\u65b0\uff0c\u53ef\u5c06\u6a21\u62df\u7684\u8fc7\u7a0b\u8fdb\u884c\u4f18\u5316\uff0c\u5c06\u5355\u6b21\u6a21\u62df\u65f6\u95f4\u590d\u6742\u5ea6\u4f18\u5316\u5230 \\(O(n \\log n)\\)\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%8C%E7%AB%A0%E5%AE%9E%E9%AA%8C/#5","title":"5. \u7528\u6237\u4f7f\u7528\u8bf4\u660e","text":"<p>\u8fd0\u884c\u73af\u5883\uff1a<code>GCC 13.2.0</code>\uff0c<code>python3.12.7</code></p> <p>\u4f9d\u8d56\u7b2c\u4e09\u65b9\u5e93\uff1apandas\u3001matplotlib</p> <p>\u4f7f\u7528\u8bf4\u660e\uff1a</p> <ul> <li>\u7f16\u8bd1\u8fd0\u884cChp2Exp1.c\u6587\u4ef6\u751f\u6210\u6570\u636e\uff0c\u7136\u540e\u8fd0\u884cdraw.py\u6587\u4ef6\u7ed8\u56fe\u3002</li> <li>Chp2Exp1.c\u6587\u4ef6\u4e2dmain\u51fd\u6570\u91cc\u7684n_max\u548cy_max\u4e3a\u6a21\u62df\u7684\u6700\u5927\u503c\uff0c\u53ef\u4ee5\u76f8\u5e94\u8c03\u6574\uff0c\u4f46\u662f\u7531\u4e8e\u7a0b\u5e8f\u590d\u6742\u5ea6\u8f83\u9ad8\uff0c\u4e0d\u5b9c\u8fc7\u5927\u3002</li> <li>\u8fd0\u884cpython\u7a0b\u5e8f\u4e4b\u524d\u9700\u8981\u5b89\u88c5\u76f8\u5e94\u7684\u4f9d\u8d56\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%8C%E7%AB%A0%E5%AE%9E%E9%AA%8C/#6","title":"6. \u6d4b\u8bd5\u7ed3\u679c","text":"<ul> <li>Chp2Exp1.c</li> </ul> <pre><code>\u5f00\u59cb\u6a21\u62df (n_max=25, y_max=25)...\n\u5df2\u5b8c\u6210\u5bf9 n = 5 \u7684\u6240\u6709\u6a21\u62df\u3002\n\u5df2\u5b8c\u6210\u5bf9 n = 10 \u7684\u6240\u6709\u6a21\u62df\u3002\n\u5df2\u5b8c\u6210\u5bf9 n = 15 \u7684\u6240\u6709\u6a21\u62df\u3002\n\u5df2\u5b8c\u6210\u5bf9 n = 20 \u7684\u6240\u6709\u6a21\u62df\u3002\n\u5df2\u5b8c\u6210\u5bf9 n = 25 \u7684\u6240\u6709\u6a21\u62df\u3002\n\u6570\u636e\u751f\u6210\u5b8c\u6bd5\u3002\u7ed3\u679c\u4fdd\u5b58\u5728 josephus_survivors.txt \u6587\u4ef6\u4e2d\u3002\n</code></pre> <ul> <li>draw.py</li> </ul> <p>\u901a\u8fc7\u89c2\u5bdf\u4e09\u7ef4\u6563\u70b9\u56fe\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e9b\u89c4\u5f8b\uff1a</p> <ul> <li> <p>\u5927\u90e8\u5206\u7684\u70b9\u6742\u4e71\u65e0\u7ae0\u3002</p> </li> <li> <p>\u56fa\u5b9ay\u65f6\uff0c(n,x) \u5206\u5e03\u5728\u4e00\u7cfb\u5217\u5e73\u884c\u76f4\u7ebf\u4e0a\uff0c\u5982\u4e0b\u56fe\uff1a</p> </li> </ul> <p></p> <ul> <li> <p>y\u8d8a\u5927\uff0c(n,x)\u5728\u76f4\u7ebf\u4e0a\u7684\u5206\u5e03\u8d8a\u7a00\u758f\u3002</p> </li> <li> <p>\u56fa\u5b9an\u65f6\uff0c\u672a\u80fd\u89c2\u5bdf\u5230\u660e\u663e\u89c4\u5f8b\uff0c\u5982\u4e0b\u56fe\uff1a</p> </li> </ul> <p></p> <ul> <li>\u5f53x=1\uff0cy=2\u65f6\uff0cn\u53ea\u6709\u662f2\u7684\u5e42\u6b21\u624d\u6ee1\u8db3\u6761\u4ef6\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%94%E7%AB%A0%E4%BD%9C%E4%B8%9A/","title":"\u6570\u636e\u7ed3\u6784\u7b2c\u4e94\u7ae0\u4f5c\u4e1a","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%94%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_2","title":"\u7b2c\u4e00\u9898","text":"<p>\u8bbe\u8ba1\u7b97\u6cd5\uff0c\u7ed9\u5b9a\u4e24\u4e2a\u5747\u542b\u6709n\u4e2a\u5143\u7d20\u7684\u6574\u5f62\u6570\u7ec4A\u548cB\uff0c\u5224\u5b9aB\u662f\u5426\u662fA\u5faa\u73af\u53f3\u79fb\u82e5\u5e72\u4f4d\u5f97\u5230\u7684\u3002</p> <p>\u89e3\uff1a</p> <p>\u4f7f\u7528KMP\u7b97\u6cd5\u8fdb\u884c\u6a21\u5f0f\u5339\u914d\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 \\(O(n)\\)\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 \\(O(n)\\)\u3002</p> <pre><code>bool isRightMove(int A[], int B[], int n) {\n    // \u6c42 next \u6570\u7ec4, \u5047\u8bbe\u4e0b\u6807\u4ece0\u5f00\u59cb\n    int* next = (int*) calloc(n, sizeof(int));\n    for (int i = 1, j = 0; i &lt; n; i++) {\n        while (j &gt; 0 &amp;&amp; B[i] != B[j]) j = next[j - 1];\n        if (B[i] == B[j]) ++j;\n        next[i] = j;\n    }\n    // \u6a21\u5f0f\u5339\u914d\n    bool found = false;\n    for (int i = 0, j = 0; i &lt; 2*n; i++) {\n        int a = A[i%n];\n        while (j &gt; 0 &amp;&amp; a != B[j]) j = next[j - 1];\n        if (a == B[j]) ++j;\n        if (j == n) found = true;\n    }\n    free(next);\n    return found;\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%94%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_3","title":"\u7b2c\u4e8c\u9898","text":"<p>\u8bbe\u5bf9\u79f0\u77e9\u9635A\u5982\u4e0b\u6240\u793a\uff1a</p> <ol> <li> <p>\u82e5\u5c06A\u89c6\u4e3a\u5bf9\u79f0\u77e9\u9635\uff0c\u753b\u51fa\u5bf9\u5176\u538b\u7f29\u5b58\u50a8\u7684\u5b58\u50a8\u8868\uff0c\u5e76\u8ba8\u8bba\u5982\u4f55\u5b58\u53d6A\u4e2d\u5143\u7d20 $ a_{ij} $ (\\(1 &lt;= i, j &lt;= 4\\));</p> </li> <li> <p>\u82e5\u5c06A\u89c6\u4e3a\u7a00\u758f\u77e9\u9635\uff0c\u753b\u51faA\u7684\u5341\u5b57\u94fe\u8868\u7ed3\u6784\u3002</p> </li> </ol> \\[ \\begin{bmatrix} 2 &amp; 0 &amp; 0 &amp; 4 \\\\ 0 &amp; 0 &amp; 3 &amp; 0 \\\\ 0 &amp; 3 &amp; 0 &amp; 0 \\\\ 4 &amp; 0 &amp; 0 &amp; 0 \\\\ \\end{bmatrix} \\] <ol> <li></li> </ol> <p>\u5b58\u53d6\u65b9\u5f0f\uff1a\\(a_{ij} = \\begin{cases} sa_{\\frac{i(i-1)}{2} + j} &amp; \\text{if } i \\ge j, \\\\ sa_{\\frac{j(j-1)}{2} + i} &amp; \\text{if } i &lt; j. \\end{cases}\\)</p> <ol> <li></li> </ol>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%94%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_4","title":"\u7b2c\u4e09\u9898","text":"<p>\u6c42\u4e0b\u5217\u5e7f\u4e49\u8868\u64cd\u4f5c\u7684\u7ed3\u679c\uff1a</p> <p>\u89e3\uff1a</p> <ol> <li>Head[Tail[Head[((a, b),(c,d))]]] = a</li> <li>Tail[Head[Tail[((a,b),(c,d))]]] = (d)</li> </ol>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%94%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_5","title":"\u7b2c\u56db\u9898","text":"<p>\u5229\u7528\u5e7f\u4e49\u8868\u7684Head\u548cTail\u64cd\u4f5c\u628a\u539f\u5b50c\u4ece\u5e7f\u4e49\u8868L=((a,b),(c,d))\u4e2d\u5206\u79bb\u51fa\u6765\uff0c\u5e76\u6c42\u8868L\u7684\u957f\u5ea6\u548c\u6df1\u5ea6\u3002</p> <p>\u89e3\uff1a</p> <p>c = Head[Tail[L]]\uff0cL\u7684\u957f\u5ea6\u4e3a2\uff0c\u6df1\u5ea6\u4e3a2\u3002</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%94%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_6","title":"\u7b2c\u4e94\u9898","text":"<p>\u5047\u8bbe\u4e00\u4e2a\u7a00\u758f\u77e9\u9635t\u7684\u884c\u5217\u6570\u76f8\u540c\uff0c\u91c7\u7528\u4e09\u5143\u7ec4TSMatrix\u8868\u793a\uff0cTSMatrix\u7ed3\u6784\u53c2\u89c1\u8bfe\u4ef6\u7b2c17\u9875\uff0c\u8bbe\u8ba1\u7b97\u6cd5\u6c42\u5de6\u4e0a-&gt;\u53f3\u4e0b\u5bf9\u89d2\u7ebf\u4e0a\u975e0\u5143\u7d20\u4e4b\u548c\u3002</p> <p>\u89e3\uff1a</p> <p>\u5982\u679c\u4e0d\u662f\u65b9\u9635\uff0c\u8fd4\u56defalse\uff0c\u5426\u5219\u904d\u5386\u6240\u6709\u5143\u7d20\uff0c\u5982\u679c\u884c\u6807\u548c\u5217\u6807\u76f8\u540c\uff0c\u52a0\u5165sum\uff0c\u6700\u540e\u8fd4\u56detrue\u3002</p> <pre><code>bool Sum(TSMatrix t, elemtype &amp;sum) {\n    if (t.m != t.n) return false;\n    sum = 0;\n    for (int p = 1; p &lt;= t.t; ++p) {\n        if (t.data[p].i == t.data[p].j) {\n            sum += t.data[p].v;\n        }\n    }\n    return true;\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%94%E7%AB%A0%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/","title":"\u9898\u76ee\uff1a\u7a00\u758f\u77e9\u9635\u7684\u76f8\u52a0\u4e0e\u76f8\u4e58\u7b97\u6cd5\u5b9e\u73b0","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%94%E7%AB%A0%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/#1","title":"1. \u9700\u6c42\u5206\u6790","text":"<p>\u4efb\u52a1\u63cf\u8ff0\uff1a - \u5b9e\u73b0\u7a00\u758f\u77e9\u9635\u7684\u76f8\u52a0\u548c\u76f8\u4e58\u7b97\u6cd5\uff0c\u4f7f\u7528\u4e09\u5143\u7ec4\u8868\u5b58\u50a8\u7ed3\u6784\uff0c\u68c0\u6d4b\u77e9\u9635\u8fd0\u7b97\u7684\u5408\u6cd5\u6027\u5e76\u8f93\u51fa\u7ed3\u679c\u3002  </p> <p>\u8f93\u5165/\u8f93\u51fa\uff1a  </p> <ul> <li>\u8f93\u5165\u5f62\u5f0f\uff1a  </li> <li>\u8f93\u5165\u77e9\u9635\u7684\u884c\u6570\u3001\u5217\u6570\u3001\u975e\u96f6\u5143\u4e2a\u6570\u3002  </li> <li>\u9010\u884c\u8f93\u5165\u975e\u96f6\u5143\u7684\u884c\u4e0b\u6807\u3001\u5217\u4e0b\u6807\u548c\u503c\uff08\u5982 <code>1 2 3</code> \u8868\u793a\u7b2c1\u884c\u7b2c2\u5217\u7684\u5143\u7d20\u503c\u4e3a3\uff09\u3002  </li> <li>\u8f93\u51fa\u5f62\u5f0f\uff1a  </li> <li>\u82e5\u53ef\u76f8\u52a0/\u76f8\u4e58\uff0c\u6253\u5370\u7ed3\u679c\u77e9\u9635\uff08\u6309\u884c\u5217\u987a\u5e8f\u8f93\u51fa\uff0c\u975e\u96f6\u5143\u663e\u793a\u503c\uff0c\u5176\u4f59\u4e3a0\uff09\u3002  </li> <li>\u82e5\u4e0d\u53ef\u8fd0\u7b97\uff0c\u663e\u793a\u9519\u8bef\u539f\u56e0\uff08\u5982\u201c\u884c\u5217\u4e0d\u5339\u914d\u201d\uff09\u3002  </li> </ul> <p>\u529f\u80fd\u8981\u6c42\uff1a 1. \u8f93\u5165\u65f6\u81ea\u52a8\u6309\u884c\u5217\u4e0b\u6807\u6392\u5e8f\u4e09\u5143\u7ec4\u3002 2. \u68c0\u6d4b\u77e9\u9635\u76f8\u52a0/\u76f8\u4e58\u7684\u5408\u6cd5\u6027\u3002 3. \u52a8\u6001\u5206\u914d\u5185\u5b58\uff0c\u6b63\u786e\u5904\u7406\u96f6\u5143\u7d20\u3002  </p> <p>\u6d4b\u8bd5\u6570\u636e\uff1a | \u8f93\u5165\u7c7b\u578b       | \u6d4b\u8bd5\u7528\u4f8b                                                                 | \u9884\u671f\u8f93\u51fa                     | | -------------- | ------------------------------------------------------------------------ | ---------------------------- | | \u5408\u6cd5\u76f8\u52a0       | \u77e9\u9635A\uff1a<code>2 2 2</code> \u2192 <code>1 1 3</code>, <code>2 2 4</code>\uff1b\u77e9\u9635B\uff1a<code>2 2 3</code> \u2192 <code>1 1 2</code>, <code>1 2 5</code>, <code>2 2 -4</code> | \u76f8\u52a0\u7ed3\u679c\u77e9\u9635\uff1a<code>[[5,5],[0,0]]</code> | | \u975e\u6cd5\u76f8\u52a0       | \u77e9\u9635A\uff1a<code>2 2 1</code> \u2192 <code>1 1 1</code>\uff1b\u77e9\u9635B\uff1a<code>3 3 1</code> \u2192 <code>1 1 1</code>                      | \u663e\u793a\u201c\u5f62\u72b6\u4e0d\u540c\uff0c\u65e0\u6cd5\u76f8\u52a0\u201d      | | \u5408\u6cd5\u76f8\u4e58       | \u77e9\u9635A\uff1a<code>2 3 2</code> \u2192 <code>1 1 2</code>, <code>2 3 3</code>\uff1b\u77e9\u9635B\uff1a<code>3 2 2</code> \u2192 <code>1 2 4</code>, <code>3 1 5</code>    | \u76f8\u4e58\u7ed3\u679c\u77e9\u9635\uff1a<code>[[8,0],[15,0]]</code>| | \u975e\u6cd5\u76f8\u4e58       | \u77e9\u9635A\uff1a<code>2 2 1</code> \u2192 <code>1 1 1</code>\uff1b\u77e9\u9635B\uff1a<code>3 3 1</code> \u2192 <code>1 1 1</code>                      | \u663e\u793a\u201c\u5f62\u72b6\u4e0d\u540c\uff0c\u65e0\u6cd5\u76f8\u4e58\u201d      |  </p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%94%E7%AB%A0%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/#2","title":"2. \u6982\u8981\u8bbe\u8ba1","text":"<p>\u89e3\u51b3\u601d\u8def\uff1a - \u76f8\u52a0\uff1a\u4ec5\u5f53\u4e24\u77e9\u9635\u884c\u3001\u5217\u6570\u76f8\u540c\u65f6\uff0c\u6309\u884c\u5217\u4e0b\u6807\u904d\u5386\u4e09\u5143\u7ec4\u8868\uff0c\u5408\u5e76\u76f8\u540c\u4f4d\u7f6e\u7684\u5143\u7d20\uff08\u548c\u4e3a0\u5219\u5ffd\u7565\uff09\u3002 - \u76f8\u4e58\uff1a\u4ec5\u5f53\u5de6\u77e9\u9635\u5217\u6570\u7b49\u4e8e\u53f3\u77e9\u9635\u884c\u6570\u65f6\uff0c\u5229\u7528\u884c\u903b\u8f91\u94fe\u63a5\u4f18\u5316\u8ba1\u7b97\uff0c\u7d2f\u52a0\u5bf9\u5e94\u5143\u7d20\u4e58\u79ef\u3002  </p> <p>\u6570\u636e\u7ed3\u6784\uff1a <pre><code>typedef struct {  \n    int i, j; // \u884c\u4e0b\u6807\u3001\u5217\u4e0b\u6807  \n    int e;    // \u5143\u7d20\u503c  \n} Triple;  \ntypedef struct {  \n    Triple data[MAXSIZE + 1]; // \u4e09\u5143\u7ec4\u8868\uff08\u4ece\u7d22\u5f151\u5f00\u59cb\u5b58\u50a8\uff09  \n    int mu, nu, tu;           // \u884c\u6570\u3001\u5217\u6570\u3001\u975e\u96f6\u5143\u4e2a\u6570  \n} TSMatrix;  \n</code></pre></p> <p>\u6a21\u5757\u5212\u5206\uff1a <pre><code>flowchart TD  \n    A[main] --&gt; B[\u8f93\u5165\u77e9\u9635A/B]  \n    B --&gt; C[\u68c0\u6d4b\u8fd0\u7b97\u5408\u6cd5\u6027]  \n    C --&gt;|\u5408\u6cd5| D[\u6267\u884c\u76f8\u52a0/\u76f8\u4e58]  \n    C --&gt;|\u975e\u6cd5| E[\u663e\u793a\u9519\u8bef\u539f\u56e0]  \n    D --&gt; F[\u8f93\u51fa\u7ed3\u679c\u77e9\u9635]  \n</code></pre></p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%94%E7%AB%A0%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/#3","title":"3. \u8be6\u7ec6\u8bbe\u8ba1","text":"<p>\u5173\u952e\u7b97\u6cd5\u4f2a\u4ee3\u7801\uff1a <pre><code># \u77e9\u9635\u76f8\u52a0\ndef add(M1, M2):\n    if M1.mu != M2.mu or M1.nu != M2.nu:\n        return None\n    M3 = \u521d\u59cb\u5316\u7ed3\u679c\u77e9\u9635\n    k1, k2 = 1, 1\n    while k1 &lt;= M1.tu and k2 &lt;= M2.tu:\n        if M1.data[k1] \u884c\u5217 == M2.data[k2] \u884c\u5217:\n            sum_e = M1.e + M2.e\n            if sum_e != 0:\n                \u6dfb\u52a0 sum_e \u5230 M3\n            k1++, k2++\n        elif M1.data[k1] \u884c\u5217 &lt; M2.data[k2] \u884c\u5217:\n            \u6dfb\u52a0 M1.data[k1] \u5230 M3\n            k1++\n        else:\n            \u6dfb\u52a0 M2.data[k2] \u5230 M3\n            k2++\n    \u5904\u7406\u5269\u4f59\u5143\u7d20\n    return M3\n\n# \u77e9\u9635\u76f8\u4e58\ndef multiply(M1, M2):\n    if M1.nu != M2.mu:\n        return None\n    \u8ba1\u7b97 M1 \u7684\u884c\u8f85\u52a9\u5411\u91cf rpot1\n    \u8ba1\u7b97 M2 \u7684\u884c\u8f85\u52a9\u5411\u91cf rpot2\n    for \u6bcf\u884c i in M1:\n        \u521d\u59cb\u5316\u4e34\u65f6\u6570\u7ec4 tmp\n        for \u6bcf\u4e2a\u975e\u96f6\u5143 in M1 \u7684 i \u884c:\n            col = \u5f53\u524d\u5143\u7d20\u7684\u5217\n            value = \u5f53\u524d\u5143\u7d20\u7684\u503c\n            for \u6bcf\u4e2a\u975e\u96f6\u5143 in M2 \u7684 col \u884c:\n                tmp[\u5217] += value * M2\u5143\u7d20\u503c\n        \u5c06 tmp \u4e2d\u975e\u96f6\u503c\u5b58\u5165 M3\n    return M3\n</code></pre></p> <p>\u51fd\u6570\u8c03\u7528\u5173\u7cfb\uff1a <pre><code>flowchart LR  \n    main --&gt; input  \n    main --&gt; add  \n    main --&gt; multiply  \n    main --&gt; output  \n    add --&gt; \u884c\u5217\u5408\u5e76\u903b\u8f91  \n    multiply --&gt; \u884c\u903b\u8f91\u94fe\u63a5\u4f18\u5316  \n</code></pre></p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%94%E7%AB%A0%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/#4","title":"4. \u8c03\u8bd5\u5206\u6790","text":"<p>\u95ee\u9898\u4e0e\u89e3\u51b3\uff1a - \u52a0\u6cd5\u903b\u8f91\u9519\u8bef\uff1a\u884c\u5217\u76f8\u540c\u76f4\u63a5\u76f8\u52a0\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u548c\u4e3a0\u7684\u60c5\u51b5\uff0c\u901a\u8fc7\u7279\u5224\u89e3\u51b3\u3002 - \u9884\u5904\u7406\u9519\u8bef\uff1a\u8f93\u5165\u7684\u4e09\u5143\u7ec4\u672a\u6309\u884c\u5217\u6392\u5e8f\uff0c\u5bfc\u81f4\u5408\u5e76\u903b\u8f91\u5931\u6548\u3002\u901a\u8fc7 <code>qsort</code> \u9884\u5904\u7406\u89e3\u51b3\u3002  </p> <p>\u590d\u6742\u5ea6\u5206\u6790\uff1a  </p> <ul> <li>\u76f8\u52a0\uff1a\u65f6\u95f4\u590d\u6742\u5ea6 \\(O(n_1 + n_2)\\)\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 \\(O(MAXSIZE)\\)\u3002  </li> <li>\u76f8\u4e58\uff1a\u65f6\u95f4\u590d\u6742\u5ea6 \\(O(n_1 \\times n_2)\\)\uff08\u6700\u574f\u60c5\u51b5\uff09\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 \\(O(MAXSIZE)\\)\u3002  </li> <li>\u5176\u4e2d\uff0c\\(n_1\\) \u548c \\(n_2\\) \u4e3a\u4e24\u4e2a\u53c2\u4e0e\u8fd0\u7b97\u7684\u77e9\u9635\u4e2d\u975e\u96f6\u5143\u7d20\u4e2a\u6570\uff0cMAXSIZE\u4e3a\u4ee3\u7801\u4e2d\u5b9a\u4e49\u7684\u9884\u7559\u6700\u5927\u975e\u96f6\u5143\u7d20\u4e2a\u6570\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%94%E7%AB%A0%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/#5","title":"5. \u7528\u6237\u4f7f\u7528\u8bf4\u660e","text":"<p>\u8fd0\u884c\u73af\u5883\uff1a<code>GCC 13.2.0</code> </p> <p>\u64cd\u4f5c\u6b65\u9aa4\uff1a  </p> <ol> <li>\u7f16\u8bd1\uff1a<code>gcc -o matrix matrix.c</code> </li> <li>\u8fd0\u884c\uff1a<code>./matrix</code> </li> <li>\u8f93\u5165\uff1a  </li> <li>\u4f9d\u6b21\u8f93\u5165\u77e9\u9635A\u7684\u884c\u6570\u3001\u5217\u6570\u3001\u975e\u96f6\u5143\u4e2a\u6570\uff0c\u7136\u540e\u8f93\u5165\u6bcf\u4e2a\u975e\u96f6\u5143\u7684\u4e09\u5143\u7ec4\u3002  </li> <li>\u91cd\u590d\u4e0a\u8ff0\u6b65\u9aa4\u8f93\u5165\u77e9\u9635B\u3002  </li> <li>\u8f93\u51fa\uff1a\u7a0b\u5e8f\u81ea\u52a8\u68c0\u6d4b\u8fd0\u7b97\u5408\u6cd5\u6027\u5e76\u6253\u5370\u7ed3\u679c\u3002  </li> </ol>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%94%E7%AB%A0%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/#6","title":"6. \u6d4b\u8bd5\u7ed3\u679c","text":"\u8f93\u5165\u7c7b\u578b \u9884\u671f\u8f93\u51fa \u5b9e\u9645\u8f93\u51fa \u5408\u6cd5\u76f8\u52a0 \u6b63\u786e\u5408\u5e76\u975e\u96f6\u5143 \u5339\u914d \u975e\u6cd5\u76f8\u52a0 \u663e\u793a\u201c\u5f62\u72b6\u4e0d\u540c\uff0c\u65e0\u6cd5\u76f8\u52a0\u201d \u5339\u914d \u5408\u6cd5\u76f8\u4e58 \u6b63\u786e\u8ba1\u7b97\u4e58\u79ef\u77e9\u9635 \u5339\u914d \u975e\u6cd5\u76f8\u4e58 \u663e\u793a\u201c\u5f62\u72b6\u4e0d\u540c\uff0c\u65e0\u6cd5\u76f8\u4e58\u201d \u5339\u914d"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AB%E7%AB%A0%E4%BD%9C%E4%B8%9A/","title":"\u6570\u636e\u7ed3\u6784\u7b2c\u516b\u7ae0\u4f5c\u4e1a","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AB%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_2","title":"\u7b2c\u4e00\u9898","text":"<p>\u5305\u62ecn\u4e2a\u5173\u952e\u7801\u7684m\u9636B-\u6811\u5728\u4e00\u6b21\u68c0\u7d22\u4e2d\u6700\u591a\u6d89\u53ca\u591a\u5c11\u4e2a\u7ed3\u70b9\uff1f\uff08\u8981\u6c42\u5199\u51fa\u63a8\u5bfc\u8fc7\u7a0b\u3002\uff09</p> <p>\u89e3:</p> <p>\u6d89\u53ca\u7684\u7ed3\u70b9\u4e2a\u6570\u6700\u591a\u4e3a\u6811\u7684\u9ad8\u5ea6\u3002</p> <p>\u5047\u8bbe\u6bcf\u5c42\u6bcf\u4e2a\u70b9\u90fd\u6709\u6700\u5c11\u7684\u5173\u952e\u5b57\uff0c\u6b64\u65f6\u6811\u7684\u9ad8\u5ea6\u8fbe\u5230\u6700\u5927\u3002</p> <p>\u7b2c\u4e00\u5c42\uff0c1\u4e2a\u7ed3\u70b9\uff0c1\u4e2a\u5173\u952e\u5b57\uff1b\u7b2c\u4e8c\u5c42\uff0c2\u4e2a\u7ed3\u70b9\uff0c\\(2\\lceil m/2-1\\rceil\\) \u4e2a\u5173\u952e\u5b57\uff1b\u7b2c\u4e09\u5c42\uff0c\\(2 \\lceil m/2\\rceil\\) \u4e2a\u7ed3\u70b9\uff0c\\(2\\lceil m/2\\rceil \\lceil m/2-1\\rceil\\) \u4e2a\u5173\u952e\u5b57\u3002</p> <p>\u7b2cL\u5c42\uff0c\\(2 \\lceil m/2\\rceil^{L-2}\\) \u4e2a\u7ed3\u70b9\uff0c\\(2\\lceil m/2\\rceil^{L-2} \\lceil m/2-1\\rceil\\) \u4e2a\u5173\u952e\u5b57\u3002</p> <p>\u5c06\u6bcf\u4e00\u5c42\u5173\u952e\u5b57\u4e2a\u6570\u76f8\u52a0\uff0c\u5f97\u5230 \\(N = 2\\lceil m/2 \\rceil^{L-1}-1\\) .</p> <p>\u4ece\u800c\u603b\u5171\u6d89\u53ca \\(L = \\log_{\\lceil m/2 \\rceil} \\left( \\frac{(N+1)}{2} \\right) + 1\\) \u4e2a\u7ed3\u70b9.</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AB%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_3","title":"\u7b2c\u4e8c\u9898","text":"<p>\u8bd5\u4ece\u7a7a\u6811\u5f00\u59cb\uff0c\u753b\u51fa\u6309\u4ee5\u4e0b\u6b21\u5e8f\u54113\u9636B-\u6811\u4e2d\u63d2\u5165\u5173\u952e\u7801\u7684\u5efa\u6811\u8fc7\u7a0b\uff1a20\uff0c30\uff0c50\uff0c52\uff0c60\uff0c68\uff0c70\u3002\u5982\u679c\u6b64\u540e\u5220\u966450\u548c68\uff0c\u753b\u51fa\u6bcf\u4e00\u6b65\u6267\u884c\u540eB-\u6811\u7684\u72b6\u6001\u3002</p> <p>\u89e3\uff1a</p> <p>\u5efa\u6811\u8fc7\u7a0b\uff1a</p> <p></p> <p>\u5220\u9664\u8fc7\u7a0b\uff1a</p> <p></p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AB%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_4","title":"\u7b2c\u4e09\u9898","text":"<p>\u5df2\u77e5\u4e8c\u53c9\u6811\u6392\u5e8f\u6811\u4e2d\u67d0\u7ed3\u70b9\u6307\u9488p\uff0c\u5176\u53cc\u4eb2\u7ed3\u70b9\u6307\u9488\u4e3afp\uff0cp\u4e3afp\u7684\u5de6\u5b69\u5b50\uff0c\u8bd5\u7f16\u5199\u7b97\u6cd5\uff0c\u5220\u9664p\u6240\u6307\u7ed3\u70b9\u3002</p> <p>\u89e3\uff1a</p> <p>\u5f53p\u7684\u5de6\u53f3\u5b69\u5b50\u6709\u4e00\u4e2a\u4e3a\u7a7a\u65f6\uff0c\u76f4\u63a5\u8ba9\u53e6\u4e00\u4e2a\u5b69\u5b50\u4f5c\u4e3afp\u7684\u5b69\u5b50\uff1b\u5f53\u5de6\u53f3\u5b69\u5b50\u90fd\u4e3a\u7a7a\u65f6\uff0cfp\u7684\u5b69\u5b50\u4e3a\u7a7a\u3002</p> <p>\u5f53p\u7684\u5de6\u53f3\u5b69\u5b50\u90fd\u5b58\u5728\u65f6\uff0c\u5c06p\u7684\u5de6\u5b69\u5b50\u4e2d\u7684\u6700\u5927\u7ed3\u70b9\u4e0ep\u8fdb\u884c\u4ea4\u6362\uff0c\u540c\u65f6\u4fee\u6539\u5176\u7236\u8282\u70b9\u7684\u8fde\u63a5\u5173\u7cfb\u3002</p> <pre><code>typedef struct node {\n    int data;\n    struct node *left, *right;\n} BiTNode, *BiTree;\n\nvoid Delete(BiTree &amp;root, BiTree p, BiTree fp) {\n    if (p-&gt;left == NULL) {\n        fp-&gt;left = p-&gt;right;\n        free(p);\n    } else if (p-&gt;right == NULL) {\n        fp-&gt;left = p-&gt;left;\n        free(p);\n    } else {\n        BiTree fu = p, u = p-&gt;left;\n        while (u-&gt;right != NULL) {\n            fu = u;\n            u = u-&gt;right;\n        }\n        p-&gt;data = u-&gt;data;\n        if (fu == p) fu-&gt;left = u-&gt;left;\n        else fu-&gt;right = u-&gt;left;\n        free(u);\n    }\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AB%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_5","title":"\u7b2c\u56db\u9898","text":"<p>\u8bd5\u753b\u51fa\u4ece\u7a7a\u6811\u5f00\u59cb\uff0c\u7531\u5b57\u7b26\u5e8f\u5217(t,d,e,s,u,g,b,j,a,k,r,i)\u6784\u6210\u7684\u4e8c\u53c9\u5e73\u8861\u6811\uff0c\u5e76\u4e3a\u6bcf\u4e00\u6b21\u7684\u5e73\u8861\u5904\u7406\u6307\u660e\u65cb\u8f6c\u7c7b\u578b\u3002</p> <p>\u89e3\uff1a</p> <p></p> <p></p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AB%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_6","title":"\u7b2c\u4e94\u9898","text":"<p>\u5df2\u77e5\u542b12\u4e2a\u5173\u952e\u5b57\u7684\u6709\u5e8f\u8868\u53ca\u5176\u76f8\u5e94\u6743\u503c\u4e3a\uff1a</p> \u5e8f\u53f7 1 2 3 4 5 6 7 8 9 10 11 12 \u5173\u952e\u5b57 A B C D E F G H I J K L \u6743\u503c 4 6 3 4 9 3 2 6 1 5 3 4 <p>(1) \u753b\u51fa\u5bf9\u4ee5\u4e0a\u6709\u5e8f\u8868\u8fdb\u884c\u6298\u534a\u67e5\u627e\u7684\u5224\u5b9a\u6811\uff0c\u6c42\u6298\u534a\u67e5\u627e\u65f6\u67e5\u627e\u6210\u529f\u7684\u5e73\u5747\u67e5\u627e\u957f\u5ea6ASL\u3002</p> <p>(2) \u82e5\u4e3a\u7b49\u6982\u7387\u67e5\u627e\uff0c\u6c42\u6298\u534a\u67e5\u627e\u65f6\u67e5\u627e\u6210\u529f\u7684\u5e73\u5747\u67e5\u627e\u957f\u5ea6ASL\u3002</p> <p>\u89e3\uff1a</p> <p>(1) </p> <p></p> <p>\uff082\uff09 $$ ASL=\\frac{1 \\times 1 + 2 \\times 2 + 3 \\times 4 + 4 \\times 5}{12} = 3.083 $$</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AB%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_7","title":"\u7b2c\u516d\u9898","text":"<p>\u5047\u8bbe\u4e00\u68f5\u5e73\u8861\u4e8c\u53c9\u6811\u7684\u6bcf\u4e2a\u7ed3\u70b9\u90fd\u6807\u660e\u4e86\u5e73\u8861\u56e0\u5b50bf\uff0c\u8bd5\u8bbe\u8ba1\u4e00\u4e2a\u7b97\u6cd5\uff0c\u5229\u7528bf\u503c\u6c42\u5e73\u8861\u4e8c\u53c9\u6811\u7684\u9ad8\u5ea6\u3002<code>int Height(BSTree t)</code></p> <p>\u89e3\uff1a</p> <p>\u5229\u7528bf\u7684\u503c\uff0c\u9009\u62e9\u9ad8\u5ea6\u8f83\u5c0f\u7684\u5206\u652f\u8fdb\u5165\u3002\u6bcf\u6b21\u53ea\u7528\u8fdb\u5165\u4e00\u4e2a\u5206\u652f\uff0c\u590d\u6742\u5ea6 \\(O(\\log n)\\)\u3002</p> <pre><code>typedef struct node {\n    int data, bf;\n    struct node *left, *right;\n} BSTNode, *BSTree;\nint Height(BSTree t) {\n    if (t == NULL) return 0;\n    if (t-&gt;bf &gt; 0) {\n        return Height(t-&gt;right) + t-&gt;bf + 1;\n    } else {\n        return Height(t-&gt;left) - t-&gt;bf + 1;\n    }\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AB%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_8","title":"\u7b2c\u4e03\u9898","text":"<p>\u9009\u53d6\u54c8\u5e0c\u51fd\u6570H(k)=(3k) MOD 11\u3002</p> <p>1) \u7528\u7ebf\u6027\u63a2\u6d4b\u5f00\u653e\u5b9a\u5740\u6cd5\u5904\u7406\u51b2\u7a81\uff0c 2) \u7528\u94fe\u5730\u5740\u6cd5\u5904\u7406\u51b2\u7a81</p> <p>\u8bd5\u57280~10\u7684\u6563\u5217\u5730\u5740\u7a7a\u95f4\u4e2d\u5bf9\u5173\u952e\u5b57\u5e8f\u5217(22, 41, 53, 46, 30, 13, 01, 67)\u9020\u54c8\u5e0c\u8868\uff0c\u5e76\u6c42\u7b49\u6982\u7387\u60c5\u51b5\u4e0b\u67e5\u627e\u6210\u529f\u65f6\u7684\u5e73\u5747\u67e5\u627e\u957f\u5ea6\u548c\u4e0d\u6210\u529f\u65f6\u7684\u5e73\u5747\u67e5\u627e\u957f\u5ea6\u4ee5\u53ca\u88c5\u586b\u56e0\u5b50\u03b1\u3002</p> <p>\u89e3\uff1a</p> <ol> <li>\u7ebf\u6027\u63a2\u6d4b\u518d\u6563\u5217\uff1a</li> </ol> <p></p> <p>\u6210\u529f\u65f6\uff0c\\(ASL_s=(1+1+2+2+1+1+2+6)/8=2\\).</p> <p>\u4e0d\u6210\u529f\u65f6\uff0c\\(ASL_f=(2+1+8+7+6+5+4+3+2+1+1)/11=3.636\\).</p> <p>\u88c5\u586b\u56e0\u5b50 \\(\\alpha = 8/11 = 0.727\\).</p> <ol> <li>\u94fe\u5730\u5740\u6cd5\uff1a</li> </ol> <p></p> <p>\u6210\u529f\u65f6\uff0c\\(ASL_s=(5\\times 1+3\\times2)/8=1.375\\).</p> <p>\u4e0d\u6210\u529f\u65f6\uff0c\\(ASL_f=(2+1+3+3+1+2+3+1+1+1+1)/11=1.727\\).</p> <p>\u88c5\u586b\u56e0\u5b50 \\(\\alpha = 8/11 = 0.727\\).</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A/","title":"\u6570\u636e\u7ed3\u6784\u7b2c\u516d\u7ae0\u4f5c\u4e1a","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_2","title":"\u7b2c\u4e00\u9898","text":"<p>\u8bbe\u67d0\u4e8c\u53c9\u6811\u7684\u5148\u5e8f\u904d\u5386\u5e8f\u5217\u4e3a: ABCDEFGHI\uff0c\u4e2d\u5e8f\u904d\u5386\u5e8f\u5217\u4e3a: BCAEDGHFI\u3002 (1) \u8bd5\u753b\u51fa\u8be5\u4e8c\u53c9\u6811\u5bf9\u5e94\u7684\u540e\u5e8f\u7ebf\u7d22\u4e8c\u53c9\u6811\uff1b (2) \u5c06\uff081\uff09\u6240\u5f97\u7684\u4e8c\u53c9\u6811\u8f6c\u5316\u4e3a\u5bf9\u5e94\u7684\u6811\u6216\u68ee\u6797\uff1b</p> <p>\u89e3:</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_3","title":"\u7b2c\u4e8c\u9898","text":"<p>\u8bd5\u7f16\u5199\u7b97\u6cd5\uff0c\u5224\u65ad\u4e24\u9897\u68f5\u4ee5\u4e8c\u53c9\u94fe\u8868\u8868\u793a\u7684\u4e8c\u53c9\u6811p\u548cq\u662f\u5426\u76f8\u4f3c\u3002</p> <p>\u89e3\uff1a</p> <pre><code>bool Similar(BiTree p, BiTree q) {\n    if (p == NULL &amp;&amp; q != NULL) return false;\n    if (q == NULL &amp;&amp; p != NULL) return false;\n    if (p == NULL &amp;&amp; q == NULL) return true;\n    return Similar(p-&gt;lc, q-&gt;lc) &amp;&amp; Similar(p-&gt;rc, q-&gt;rc);\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_4","title":"\u7b2c\u4e09\u9898","text":"<p>\u7f16\u5199\u7b97\u6cd5\u5224\u65ad\u4e00\u68f5\u4ee5\u4e8c\u53c9\u94fe\u8868\u8868\u793a\u7684\u4e8c\u53c9\u6811\u662f\u5426\u4e3a\u5b8c\u5168\u4e8c\u53c9\u6811\u3002</p> <p>\u89e3\uff1a</p> <pre><code>const int MAX_NODE_SIZE = 100000;\nbool JudgeComplete(BiTree root) {\n    if (root == NULL) return true;\n    BiTree* queue = (BiTree*) malloc(MAX_NODE_SIZE * sizeof(BiTree));\n    if (queue == NULL) exit(EXIT_FAILURE);\n    int front = 0, back = 0; // [front, back)\n    queue[back++] = root;\n    bool have_null = false;\n    while (front &lt; back) {\n        BiTree now = queue[front++];\n        if (now == NULL) {\n            have_null = true;\n            continue;\n        } else if (have_null) {\n            free(queue);\n            return false;\n        }\n        queue[back++] = now-&gt;lc;\n        queue[back++] = now-&gt;rc;\n    }\n    free(queue);\n    return true;\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_5","title":"\u7b2c\u56db\u9898","text":"<p>\u8bbe\u8ba1\u7b97\u6cd5\u6c42\u5b69\u5b50\u5144\u5f1f\u94fe\u8868\u8868\u793a\u7684\u6811\u7684\u5ea6\u3002</p> <p>\u89e3\uff1a</p> <pre><code>int degree(CSTree root) {\n    if (root == NULL) return 0;\n    int deg = 0, max_deg = 0;\n    CSTree p = root-&gt;firstchild;\n    while (p != NULL) {\n        int tmp_deg = degree(p);\n        if (tmp_deg &gt; max_deg) max_deg = tmp_deg; \n        p = p-&gt;nextsibling;\n    }\n    if (max_deg &gt; deg) deg = max_deg;\n    return deg;\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_6","title":"\u7b2c\u4e94\u9898","text":"<p>\u8bd5\u7f16\u5199\u7b97\u6cd5\uff0c\u5bf9\u4e00\u68f5\u4ee5\u5b69\u5b50-\u5144\u5f1f\u94fe\u8868\u8868\u793a\u7684\u6811\u7edf\u8ba1\u53f6\u5b50\u7684\u4e2a\u6570\u3002</p> <p>\u89e3\uff1a</p> <pre><code>int Count(CSTree root) {\n    if (root == NULL) return 0;\n    if (root-&gt;firstchild == NULL) return 1;\n    CSTree p = root-&gt;firstchild;\n    int leaves = 0;\n    while (p != NULL) {\n        leaves += Count(p);\n        p = p-&gt;nextsibling;\n    }\n    return leaves;\n}\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_7","title":"\u7b2c\u516d\u9898","text":"<p>\u4e00\u4e2a\u6df1\u5ea6\u4e3aL\u7684\u6ee1K\u53c9\u6811\u6709\u4ee5\u4e0b\u6027\u8d28\uff1a\u7b2cL\u5c42\u4e0a\u7684\u7ed3\u70b9\u90fd\u662f\u53f6\u5b50\u7ed3\u70b9\uff0c\u5176\u4f59\u5404\u5c42\u4e0a\u6bcf\u4e2a\u7ed3\u70b9\u90fd\u6709K\u68f5\u975e\u7a7a\u5b50\u6811\uff0c\u5982\u679c\u6309\u5c42\u6b21\u987a\u5e8f\u4ece1\u5f00\u59cb\u5bf9\u5168\u90e8\u7ed3\u70b9\u8fdb\u884c\u7f16\u53f7\uff0c\u6c42\uff1a 1\uff09\u5404\u5c42\u7684\u7ed3\u70b9\u7684\u6570\u76ee\u662f\u591a\u5c11\uff1f 2\uff09\u7f16\u53f7\u4e3an\u7684\u7ed3\u70b9\u7684\u53cc\u4eb2\u7ed3\u70b9\uff08\u82e5\u5b58\u5728\uff09\u7684\u7f16\u53f7\u662f\u591a\u5c11\uff1f 3\uff09\u7f16\u53f7\u4e3an\u7684\u7ed3\u70b9\u7684\u7b2ci\u4e2a\u5b69\u5b50\u7ed3\u70b9\uff08\u82e5\u5b58\u5728\uff09\u7684\u7f16\u53f7\u662f\u591a\u5c11\uff1f 4\uff09\u7f16\u53f7\u4e3an\u7684\u7ed3\u70b9\u6709\u53f3\u5144\u5f1f\u7684\u6761\u4ef6\u662f\u4ec0\u4e48\uff1f\u5982\u679c\u6709\uff0c\u5176\u53f3\u5144\u5f1f\u7684\u7f16\u53f7\u662f\u591a\u5c11\uff1f \u8bf7\u7ed9\u51fa\u8ba1\u7b97\u548c\u63a8\u5bfc\u8fc7\u7a0b\u3002</p> <p>\u89e3\uff1a</p> <ol> <li> <p>\u8bbe\u7b2c \\(i\\) \u5c42\u7684\u7ed3\u70b9\u6570\u76ee\u4e3a \\(cnt_i\\)\u3002\u5219 \\(cnt_{1}=1, \\space cnt_{i}=K \\cdot cnt_{i-1}\\)\u3002\u56e0\u6b64 \\(cnt_i=K^{i-1}\\)\u3002</p> </li> <li> <p>\u5047\u8bbe\u7f16\u53f7\u4e3a \\(n\\) \u7684\u53cc\u4eb2\u7ed3\u70b9\u662f \\(p\\)\u3002\u6bcf\u4e2a\u7ed3\u70b9\u6309\u7167\u7f16\u53f7\u987a\u5e8f\u5404\u81ea\u62e5\u6709 \\(K\\) \u4e2a\u5b69\u5b50\uff0c\u4ece\u800c \\(p\\) \u7684\u5b69\u5b50\u7ed3\u70b9\u7f16\u53f7 \\(n\\) \u6ee1\u8db3\uff1a $$ (p-1)\\cdot K + 2 \\leq n \\leq p \\cdot K + 1 $$ \u200b   \u4ece\u800c\uff0c $$ p-1 \\leq \\frac{n-2}{K} &lt; p $$ \u200b   \u5373 $$ p=\\lfloor \\frac{n-2}{K} \\rfloor + 1 $$</p> </li> <li> <p>\u7f16\u53f7\u4e3a \\(n\\) \u7684\u7ed3\u70b9\u4e4b\u524d\u6709 \\(n-1\\) \u4e2a\u7ed3\u70b9\uff0c\\((n-1)\\cdot K\\) \u4e2a\u9664\u6839\u4e4b\u5916\u7684\u7ed3\u70b9+\u5b69\u5b50\uff0c\u56e0\u6b64\u7ed3\u70b9 \\(n\\) \u7684\u7b2c \\(i\\) \u4e2a\u5b69\u5b50\u7f16\u53f7\u4e3a \\((n-1) \\cdot K + 1 + i\\)\u3002</p> </li> <li> <p>\u53ea\u8981\u4e0d\u662f\u6bcf\u4e2a\u7ed3\u70b9\u6700\u53f3\u4fa7\u7684\u5b69\u5b50\u90fd\u6709\u53f3\u5144\u5f1f\u3002\u5373 \\(n \\in \\set{i | 1\\leq i \\leq \\frac{1-K^L}{1-K} \\and i \\not= tK+1, \\forall t \\in N}\\)\u3002</p> </li> </ol>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_8","title":"\u7b2c\u4e03\u9898","text":"<p>\u8bd5\u8bc1\u660e\uff1a\u540c\u4e00\u68f5\u4e8c\u53c9\u6811\u7684\u6240\u6709\u53f6\u5b50\u7ed3\u70b9\uff0c\u5728\u5148\u5e8f\u5e8f\u5217\u3001\u4e2d\u5e8f\u5e8f\u5217\u4ee5\u53ca\u540e\u5e8f\u5e8f\u5217\u4e2d\u90fd\u6309\u76f8\u540c\u7684\u76f8\u5bf9\u4f4d\u7f6e\u51fa\u73b0\uff08\u5373\u5148\u540e\u987a\u5e8f\u76f8\u540c\uff09\u3002</p> <p>\u8bc1\u660e\uff1a</p> <p>\u8bb0\u4efb\u610f\u4e24\u679a\u53f6\u5b50\u7ed3\u70b9\u5206\u522b\u4e3a \\(i\\) \u548c \\(j\\)\u3002\u6211\u4eec\u53ea\u9700\u8bf4\u660e\uff1a\u5728\u5148\u5e8f\u3001\u4e2d\u5e8f\u3001\u540e\u5e8f\u4e09\u79cd\u904d\u5386\u4e2d\uff0c\\(i\\) \u4e0e \\(j\\) \u7684\u5148\u540e\u5173\u7cfb\u4e0d\u4f1a\u6539\u53d8\u3002</p> <p>\u8bbe \\(u=\\mathrm{lca}(i,j)\\) \u4e3a \\(i\\) \u4e0e \\(j\\) \u5728\u8fd9\u68f5\u6811\u4e2d\u7684\u6700\u8fd1\u516c\u5171\u7956\u5148\u3002\u7531\u4e8e \\(i,j\\) \u5747\u4e3a\u53f6\u5b50\uff0c\u5fc5\u6709 \\(u\\neq i\\) \u4e14 \\(u\\neq j\\)\uff0c\u4e14 \\(i,j\\) \u5206\u522b\u4f4d\u4e8e \\(u\\) \u7684\u4e24\u4e2a\u4e0d\u540c\u5b50\u6811\u4e2d\u3002</p> <p>\u4e0d\u59a8\u8bbe \\(i\\) \u5728 \\(u\\) \u7684\u5de6\u5b50\u6811\u4e2d\uff0c\\(j\\) \u5728 \\(u\\) \u7684\u53f3\u5b50\u6811\u4e2d\u3002</p> <p>\u4ee5 \\(u\\) \u4e3a\u6839\u7684\u5b50\u6811\uff0c\u5148\u5e8f\u987a\u5e8f\u5fc5\u5148\u8bbf\u95ee\u6839 \\(u\\)\uff0c\u7136\u540e\u5b8c\u6574\u904d\u5386\u5176\u5de6\u5b50\u6811\uff08\u5176\u4e2d\u5305\u542b\u53f6\u5b50 \\(i\\)\uff09\uff0c\u6700\u540e\u904d\u5386\u5176\u53f3\u5b50\u6811\uff08\u5305\u542b\u53f6\u5b50 \\(j\\)\uff09\u3002\u56e0\u6b64\u5728\u5148\u5e8f\u5e8f\u5217\u4e2d\uff0c\\(i\\) \u80af\u5b9a\u51fa\u73b0\u5728 \\(j\\) \u4e4b\u524d\u3002</p> <p>\u4ee5 \\(u\\) \u4e3a\u6839\u7684\u5b50\u6811\uff0c\u4e2d\u5e8f\u987a\u5e8f\u5148\u904d\u5386\u5de6\u5b50\u6811\uff08\u9047\u5230 \\(i\\)\uff09\uff0c\u518d\u8bbf\u95ee\u6839 \\(u\\)\uff0c\u6700\u540e\u904d\u5386\u53f3\u5b50\u6811\uff08\u9047\u5230 \\(j\\)\uff09\u3002\u663e\u7136\u4ecd\u6709 \\(i\\) \u5728 \\(j\\) \u4e4b\u524d\u3002</p> <p>\u4ee5 \\(u\\) \u4e3a\u6839\u7684\u5b50\u6811\uff0c\u540e\u5e8f\u987a\u5e8f\u5148\u904d\u5386\u5de6\u5b50\u6811\uff08\u9047\u5230 \\(i\\)\uff09\uff0c\u518d\u904d\u5386\u53f3\u5b50\u6811\uff08\u9047\u5230 \\(j\\)\uff09\uff0c\u6700\u540e\u8bbf\u95ee\u6839 \\(u\\)\u3002\u6545\u5728\u540e\u5e8f\u5e8f\u5217\u4e2d\uff0c\u4ecd\u662f \\(i\\) \u5728 \\(j\\) \u4e4b\u524d\u3002</p> <p>\u7efc\u4e0a\uff0c\u5bf9\u4efb\u610f\u4e24\u53f6\u5b50\u7ed3\u70b9 \\(i,j\\)\uff0c\u4e09\u79cd\u904d\u5386\u5747\u4fdd\u6301\u4e86\u5b83\u4eec\u4e4b\u95f4\u7684\u76f8\u5bf9\u5148\u540e\u5173\u7cfb\u3002\\(\\boxed{}\\)</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_9","title":"\u7b2c\u516b\u9898","text":"<p>\u8bd5\u7ed9\u51fa\u4e0b\u5217\u6709\u5173\u5e76\u67e5\u96c6\u7684\u64cd\u4f5c\u5e8f\u5217\u7684\u8fd0\u7b97\u7ed3\u679c\uff1a merge(1,2), merge(3,4), merge(3,5), merge(1,7), merge(3,6), merge(8,9), merge(1,8), merge(3,10), merge(3,11), merge(3,12), merge(3,13), merge(14,15), merge(16,0), merge(14,16), merge(1,3), merge(1,14).</p> <p>\u8981\u6c42\uff1a</p> <ol> <li>\u5bf9\u4e8emerge(i,j), \u4ee5i\u4f5c\u4e3aj\u7684\u53cc\u4eb2\uff1b</li> <li>\u6309i\u548cj\u4e3a\u6839\u7684\u6811\u7684\u9ad8\u5ea6\u5b9e\u73b0merge(i,j), \u9ad8\u5ea6\u5927\u8005\u4e3a\u9ad8\u5ea6\u5c0f\u8005\u7684\u53cc\u4eb2\uff1b</li> <li>\u6309i\u548cj\u4e3a\u6839\u7684\u6811\u7684\u7ed3\u70b9\u4e2a\u6570\u5b9e\u73b0merge(i,j), \u7ed3\u70b9\u4e2a\u6570\u5927\u8005\u4e3a\u7ed3\u70b9\u4e2a\u6570\u5c0f\u8005\u7684\u53cc\u4eb2\u3002</li> </ol> <p>\u89e3\uff1a</p> <ol> <li></li> <li></li> <li></li> </ol>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_10","title":"\u7b2c\u4e5d\u9898","text":"<p>\u8bbeT\u662f\u4e00\u68f5\u4e8c\u53c9\u6811\uff0c\u9664\u53f6\u5b50\u7ed3\u70b9\u5916\uff0c\u5176\u5b83\u7ed3\u70b9\u7684\u5ea6\u6570\u7686\u4e3a2\uff0c \u82e5T\u4e2d\u67096\u4e2a\u53f6\u7ed3\u70b9\uff0c\u8bd5\u95ee\uff1a</p> <ol> <li>T\u6811\u7684\u6700\u5927\u6df1\u5ea6Kmax=? \u6700\u5c0f\u53ef\u80fd\u6df1\u5ea6Kmin=?</li> <li>T\u6811\u4e2d\u5171\u6709\u591a\u5c11\u975e\u53f6\u7ed3\u70b9\uff1f</li> <li>\u82e5\u53f6\u7ed3\u70b9\u7684\u6743\u503c\u5206\u522b\u4e3a1,2,3,4,5,6\u3002\u8bf7\u6784\u9020\u4e00\u68f5\u54c8\u66fc\u592b\u6811\uff0c    \u5e76\u8ba1\u7b97\u8be5\u54c8\u66fc\u592b\u6811\u7684\u5e26\u6743\u8def\u5f84\u957f\u5ea6wpl\u3002</li> </ol> <p>\u89e3\uff1a</p> <ol> <li> <p>Kmax=6\uff0cKmin=4\u3002</p> </li> <li> <p>\u7531\u4e8c\u53c9\u6811\u7684\u6027\u8d28\u77e5 \\(n_2=n_1-1=5\\)\uff0c\u53c8\u7531\u4e8e\u975e\u53f6\u7ed3\u70b9\u5ea6\u6570\u7686\u4e3a \\(2\\)\uff0c\u56e0\u6b64\u975e\u53f6\u8282\u70b9\u4e2a\u6570\u4e3a\\(5\\)\u3002</p> </li> <li>\\(wpl = 1 \\times 4 + 2 \\times 4 + 3 \\times 3 + 4 \\times 2 + 5 \\times 2 + 6 \\times 2 = 51\\)\u3002</li> </ol>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C1/","title":"\u9898\u76ee\uff1a\u5148\u5e8f\u9012\u5f52\u5efa\u7acb\u4e8c\u53c9\u6811","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C1/#1","title":"1. \u9700\u6c42\u5206\u6790","text":"<p>\u4efb\u52a1\u63cf\u8ff0\uff1a  \u7528\u5148\u5e8f\u9012\u5f52\u8fc7\u7a0b\u5efa\u7acb\u4e8c\u53c9\u6811\uff08\u5b58\u50a8\u7ed3\u6784\uff1a\u4e8c\u53c9\u94fe\u8868\uff09\uff0c\u8981\u6c42\uff1a\u8f93\u51fa\u4e8c\u53c9\u6811\u7684\u56db\u79cd\u8868\u793a\u6cd5\u4e4b\u4e00\u3002</p> <p>\u8f93\u5165/\u8f93\u51fa\u8981\u6c42\uff1a  </p> <ul> <li> <p>\u8f93\u5165\u5f62\u5f0f\uff1a\u4e00\u884c\u5b57\u7b26\u4e32\uff0c\u8868\u793a\u5148\u5e8f\u5e8f\u5217\uff0c<code>*</code>\u4ee3\u8868\u7a7a\u6811\uff0c\u5982\uff1a<code>abc**d**e**</code> \u3002</p> </li> <li> <p>\u8f93\u51fa\u5f62\u5f0f\uff1a\u4e8c\u53c9\u6811\u7684\u56db\u79cd\u8868\u793a\u6cd5\u4e4b\u4e00\u3002\u672c\u5b9e\u9a8c\u9009\u62e9\u6811\u5f62\u8868\u793a\u6cd5\uff0c\u753b\u51fa\u4e8c\u53c9\u6811\u5bf9\u5e94\u7684\u5b57\u7b26\u753b\uff0c\u5b9a\u4e49\u5982\u4e0b\uff1a</p> </li> <li> <p>\u5bf9\u4e8e\u6ee1\u4e8c\u53c9\u6811\uff1a</p> <ol> <li> <p>\u5b9a\u4e49 1 \u7ea7\u6ee1\u4e8c\u53c9\u6811\u7684\u5b57\u7b26\u753b\u4e3a\u4e00\u4e2a\u5e26\u6709\u8282\u70b9\u7f16\u53f7\u7684\u516d\u8fb9\u5f62\u5b57\u7b26\u753b\uff0c\u5bbd\u5ea6 \\(w(1) = 4\\)\uff0c\u9ad8\u5ea6 \\(h(1) = 3\\)\uff0c\u4e8c\u53c9\u6811\u7684\u6df1\u5ea6 \\(d(1) = 1\\)\uff1b</p> </li> <li> <p>\u5b9a\u4e49 \\(i (i &gt; 1)\\) \u7ea7\u6ee1\u4e8c\u53c9\u6811\u7684\u5b57\u7b26\u753b\u4e3a\u4e24\u4e2a \\(i - 1\\) \u7ea7\u6ee1\u4e8c\u53c9\u6811\u7684\u5b57\u7b26\u753b\u95f4\u9694\u4e24\u4e2a\u7a7a\u683c\u5de6\u53f3\u62fc\u63a5\u5230\u4e00\u8d77\uff0c\u7136\u540e\u4ece\u6700\u4e0a\u65b9\u7684\u4e24\u4e2a\u8282\u70b9\u5206\u522b\u4f7f\u7528 '/' \u548c '\\' \u5b57\u7b26\u5411\u4e2d\u5fc3\u805a\u62e2\uff0c\u5e76\u4e14\u76f8\u805a\u65f6 1 \u7ea7\u6ee1\u4e8c\u53c9\u6811\u7684\u5b57\u7b26\u753b\u8868\u793a\u6839\u8282\u70b9\uff0c\u5bbd\u5ea6 \\(w(i) = (w(i - 1) + 1) \\times 2\\)\uff0c\u9ad8\u5ea6 \\(h(i) = 3 \\times 2^{i - 1}\\)\uff0c\u4e8c\u53c9\u6811\u7684\u6df1\u5ea6 \\(d(i) = i\\)\uff1b</p> </li> </ol> <p>\u5982\u4e0b\u56fe\u6240\u793a\u4e3a2\u7ea7\u6ee1\u4e8c\u53c9\u6811\uff1a</p> <p></p> <p>\u5982\u4e0b\u56fe\u6240\u793a\u4e3a3\u7ea7\u6ee1\u4e8c\u53c9\u6811\uff1a</p> <p></p> </li> <li> <p>\u5bf9\u4e8e\u975e\u6ee1\u4e8c\u53c9\u6811\uff1a\u5176\u56fe\u50cf\u662f\u6ee1\u4e8c\u53c9\u6811\u7684\u60c5\u51b5\uff0c\u79fb\u9664\u4e0d\u5b58\u5728\u7684\u8282\u70b9\u548c\u8fb9\uff0c\u5e76\u66ff\u6362\u4e3a\u7a7a\u683c\u5b57\u7b26\u3002</p> </li> <li> <p>\u4e3a\u4fbf\u4e8e\u89c2\u5bdf\uff0c\u5728\u8f93\u51fa\u56fe\u5f62\u6700\u5916\u5c42\u6dfb\u52a0<code>*</code>\u5305\u88f9\u3002</p> </li> <li> <p>\u503c\u8303\u56f4\uff1a\u8f93\u5165\u957f\u5ea6\u5c0f\u4e8e 100\u5b57\u7b26\u3002\u7ed3\u70b9\u7f16\u53f7\u4e3a\u5355\u5b57\u7b26\u7684ASCII\u5b57\u7b26\uff0c*\u8868\u793a\u7a7a\u6811\u3002</p> </li> <li> <p>\u7279\u6b8a\u60c5\u51b5\uff1a\u5982\u679c\u8f93\u5165\u7684\u662f\u7a7a\u6811<code>*</code>\u3002\u5219\u8f93\u51fa\u4e00\u884c\u5b57\u7b26\u4e32<code>Empty tree!</code>\u3002</p> </li> </ul> <p>\u529f\u80fd\u8981\u6c42\uff1a </p> <ol> <li>\u6839\u636e\u8f93\u5165\u7684\u5148\u5e8f\u5e8f\u5217\u6b63\u786e\u6784\u5efa\u4e8c\u53c9\u6811\u3002</li> <li>\u6839\u636e\u6784\u5efa\u7684\u4e8c\u53c9\u6811\u6b63\u786e\u8f93\u51fa\u5176\u6811\u5f62\u8868\u793a\u6cd5\u3002</li> </ol> <p>\u6d4b\u8bd5\u7528\u4f8b\uff1a  </p> \u8f93\u5165 \u8f93\u51fa \u8bf4\u660e <code>*</code> \u7a7a\u6811 <code>a**</code> \u5355\u7ed3\u70b9\u7684\u6811 <code>abc**d**e</code> \u4e00\u822c\u60c5\u51b5"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C1/#2","title":"2. \u6982\u8981\u8bbe\u8ba1","text":"<p>\u89e3\u51b3\u601d\u8def\uff1a  </p> <ol> <li>\u4f7f\u7528\u5148\u5e8f\u9012\u5f52\u7684\u65b9\u6cd5\u5efa\u6811\u3002</li> <li>\u8bb0\u5f55\u6811\u7684\u6df1\u5ea6\u3001\u7ed3\u70b9\u7236\u5b50\u5173\u7cfb\u7b49\u4fe1\u606f\u3002</li> <li>\u753b\u51fa\u5355\u4e2a\u7ed3\u70b9\u7684\u5b57\u7b26\u753b\u3002</li> <li>\u6839\u636e\u7236\u5b50\u5173\u7cfb\u753b\u51fa\u8fb9\u7684\u8fde\u63a5\u5173\u7cfb\u3002</li> <li>\u4f7f\u7528*\u5305\u88f9\u5b57\u7b26\u753b\u3002</li> <li>\u6253\u5370\u5b57\u7b26\u753b\u6811\u5f62\u56fe\u3002</li> </ol> <p>\u6570\u636e\u7ed3\u6784\uff1a  </p> <p>\u4f7f\u7528\u4e8c\u53c9\u94fe\u8868\u5b58\u50a8</p> <pre><code>typedef struct BiTNode {\n    ElemType data;\n    struct BiTNode *lc, *rc;\n    int id;             // \u7f16\u53f7\u5b57\u6bb5\uff0c\u7528\u4e8e\u5b57\u7b26\u753b\n} BiTNode, *BiTree;\n</code></pre> <p>\u6a21\u5757\u5173\u7cfb\uff1a  </p> <ul> <li><code>build</code>\uff1a\u4f7f\u7528\u5148\u5e8f\u9012\u5f52\u5efa\u7acb\u4e8c\u53c9\u6811\u3002</li> <li><code>assign_ids_and_relations</code>\uff1a\u5148\u5e8f\u904d\u5386\u4e8c\u53c9\u6811\uff0c\u7ed9\u7ed3\u70b9\u7f16\u53f7\u5e76\u5904\u7406\u6df1\u5ea6\u548c\u7236\u5b50\u5173\u7cfb\u3002</li> <li><code>draw_node</code>\uff1a\u753b\u51fa\u5355\u4e2a\u7ed3\u70b9\u7684\u5b57\u7b26\u753b\u3002</li> <li><code>draw_line</code>\uff1a\u753b\u51fa\u4e24\u4e2a\u7ed3\u70b9\u4e4b\u95f4\u7684\u8fb9\u3002</li> <li><code>draw</code>\uff1a\u6839\u636e\u7236\u5b50\u5173\u7cfb\u548c\u6df1\u5ea6\uff0c\u8c03\u7528<code>draw_node</code>\u548c<code>draw_line</code>\u753b\u51fa\u6574\u9897\u4e8c\u53c9\u6811\u3002</li> <li><code>print_canvas</code>\uff1a\u753b\u51fa\u4e8c\u53c9\u6811\u5468\u56f4\u7684*\u3002</li> <li><code>destroy</code>\uff1a\u9500\u6bc1\u4e8c\u53c9\u6811\u3002</li> <li><code>main</code>\uff1a\u4e3b\u51fd\u6570\uff0c\u6839\u636e\u8f93\u5165\u5efa\u6811\u3001\u753b\u6811\u5e76\u9000\u51fa\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C1/#3","title":"3. \u8be6\u7ec6\u8bbe\u8ba1","text":"<p>\u5173\u952e\u7b97\u6cd5\uff1a  </p> <p>\u5efa\u6811\u7684\u8fc7\u7a0b\u662f\u672c\u5b9e\u9a8c\u7684\u6838\u5fc3\uff0c\u91c7\u7528\u5148\u5e8f\u9012\u5f52\u7684\u7b97\u6cd5\u8fdb\u884c\u5efa\u6811\u3002</p> <p>build\u51fd\u6570\u7684\u804c\u8d23\u662f\uff0c\u6784\u5efa\u5f53\u524d\u540e\u7f00\u5b57\u7b26\u4e32\u6240\u5bf9\u5e94\u7684\u6811\u3002\u5f53\u904d\u5386\u5230\u5b57\u7b26\u4e32\u672b\u5c3e\u65f6\uff0c\u8fd4\u56de\u7a7a\u6811\uff1b\u5f53\u904d\u5386\u5230*\u65f6\uff0c\u8fd4\u56de\u7a7a\u6811\u5e76\u8ba9\u6307\u9488\u6307\u5411\u4e0b\u4e00\u4e2a\u5b57\u7b26\uff1b\u5426\u5219\u4ee5\u5f53\u524d\u5b57\u7b26\u5efa\u7acb\u6839\u8282\u70b9\uff0c\u9012\u5f52\u6784\u5efa\u5de6\u5b50\u6811\u548c\u53f3\u5b50\u6811\u3002</p> <p>\u6d41\u7a0b\u56fe\uff1a  </p> <pre><code>flowchart TD\n    A([\u5f00\u59cb]) --&gt; B{\u5f53\u524d\u5b57\u7b26 **pp}\n    B --&gt;|\u662f '\\\\0'| C[\u8fd4\u56de NULL]\n    B --&gt;|\u662f '*'| D[\"\u6307\u9488\u540e\u79fb (*pp)++\"]\n    D --&gt; C\n    B --&gt;|\u975e\u7ed3\u675f\u548c'*'| E[\u5206\u914d\u65b0\u8282\u70b9\u5185\u5b58]\n    E --&gt; F{\u5206\u914d\u6210\u529f?}\n    F --&gt;|\u662f| G[\u8282\u70b9\u8d4b\u503c: node-&gt;data = **pp]\n    G --&gt; H[\"\u6307\u9488\u540e\u79fb (*pp)++\"]\n    H --&gt; I[\"\u9012\u5f52\u6784\u5efa\u5de6\u5b50\u6811 node-&gt;lc = build(pp)\"]\n    I --&gt; J[\"\u9012\u5f52\u6784\u5efa\u53f3\u5b50\u6811 node-&gt;rc = build(pp)\"]\n    J --&gt; K[\u8fd4\u56de\u8282\u70b9\u6307\u9488 node]\n    F --&gt;|\u5426| L[\u6253\u5370\u9519\u8bef 'malloc failed']\n    L --&gt; M[\u9000\u51fa\u7a0b\u5e8f EXIT_FAILURE]\n    C --&gt; K\n    K --&gt; N([\u7ed3\u675f])\n</code></pre> <p>\u51fd\u6570\u8c03\u7528\u5173\u7cfb\u56fe\uff1a</p> <pre><code>flowchart TD\n    A[\"main\"] --&gt; B[\"build\"]\n    A --&gt; C[\"assign_ids_and_relations\"]\n    A --&gt; D[\"init_dep\"]\n    A --&gt; E[\"draw\"]\n    A --&gt; F[\"print_canvas\"]\n    A --&gt; G[\"destroy\"]\n\n    E --&gt; H[\"draw_node\"]\n    E --&gt; I[\"draw_line\"]\n</code></pre> <p>\u8c03\u7528\u5173\u7cfb\u8bf4\u660e\uff1a</p> <ul> <li><code>main</code></li> <li>\u9996\u5148\u8c03\u7528 <code>build</code>(char **pp) \u9012\u5f52\u6784\u5efa\u4e8c\u53c9\u6811\u7ed3\u6784\u3002</li> <li>\u63a5\u7740\u8c03\u7528 <code>assign_ids_and_relations</code>(BiTree u, int depth) \u4e3a\u6bcf\u4e2a\u8282\u70b9\u5206\u914d\u7f16\u53f7\u3001\u586b\u5145 <code>lson[]</code>/<code>rson[]</code>/<code>fa[]</code>\uff0c\u8ba1\u7b97\u6574\u68f5\u6811\u7684\u6700\u5927\u6df1\u5ea6\u3002</li> <li>\u7136\u540e\u8c03\u7528 <code>init_dep</code>(int u, int d) \u81ea\u4e0a\u800c\u4e0b\u8ba1\u7b97\u6bcf\u4e2a\u8282\u70b9\u7ed8\u56fe\u65f6\u7684\u5782\u76f4\u504f\u79fb\u91cf\uff0c<code>init_dep</code> \u672c\u8eab\u9012\u5f52\u904d\u5386\u6240\u6709\u7f16\u53f7\u8282\u70b9\u3002</li> <li>\u8c03\u7528 <code>draw</code>(int u, int x, int y) \u5728\u753b\u5e03\u4e0a\u7ed8\u5236\u8282\u70b9\u548c\u8fde\u7ebf\uff0c\u8fc7\u7a0b\u4e2d\u4f1a\uff1a<ul> <li>\u8c03\u7528 <code>draw_node</code>(int i, int j, int num) \u753b\u5355\u4e2a\u8282\u70b9\u7684\u6846\u548c\u7f16\u53f7\u5b57\u7b26\uff1b</li> <li>\u8c03\u7528 <code>draw_line</code>(int x, int y, int u, int v, char c) \u753b\u4ece\u7236\u8282\u70b9\u5230\u5b50\u8282\u70b9\u7684\u8fde\u7ebf\uff1b</li> <li>\u5e76\u9012\u5f52\u8c03\u7528\u81ea\u8eab\u6765\u7ed8\u5236\u6240\u6709\u5b50\u6811\u3002</li> </ul> </li> <li>\u8c03\u7528 <code>print_canvas</code>() \u626b\u63cf\u5e76\u8f93\u51fa\u753b\u5e03\u5185\u5bb9\uff0c\u7528 <code>*</code> \u7ed8\u5236\u8fb9\u6846\u3002</li> <li>\u6700\u540e\u8c03\u7528 <code>destroy</code>(BiTree root) \u9012\u5f52\u91ca\u653e\u6240\u6709\u6811\u8282\u70b9\uff0c\u907f\u514d\u5185\u5b58\u6cc4\u6f0f\u3002</li> <li><code>build</code></li> <li>\u6839\u636e\u5148\u5e8f\u5e26 <code>*</code> \u6807\u8bb0\u7684\u5b57\u7b26\u4e32\uff0c\u9012\u5f52\u521b\u5efa\u5de6\u53f3\u5b50\u8282\u70b9\uff0c\u76f4\u5230\u8bfb\u5230 <code>'\\0'</code> \u6216 <code>'*'</code> \u4e3a\u6b62\u3002</li> <li><code>assign_ids_and_relations</code></li> <li>\u6df1\u5ea6\u4f18\u5148\u904d\u5386\u4e8c\u53c9\u6811\uff0c<ul> <li>\u4e3a\u6bcf\u4e2a\u8282\u70b9\u751f\u6210\u81ea\u589e <code>id</code>\uff0c</li> <li>\u8bb0\u5f55\u5176\u5de6\u53f3\u5b69\u5b50\u7f16\u53f7\u5230 <code>lson[id]</code>/<code>rson[id]</code> \u5e76\u8bbe\u7f6e <code>fa[child] = id</code>\uff0c</li> <li>\u6309\u9700\u66f4\u65b0\u5168\u5c40 <code>tree_depth</code>\u3002</li> </ul> </li> <li><code>init_dep</code></li> <li>\u4ee5\u6839\u8282\u70b9\u4e3a\u8d77\u70b9\uff0c\u6309\u5c42\u7ea7\u8c03\u7528\u81ea\u8eab\uff0c</li> <li>\u4f7f\u7528\u5168\u5c40\u6df1\u5ea6 <code>k</code> \u8ba1\u7b97\u6bcf\u4e2a\u8282\u70b9\u5411\u4e0b\u7ed8\u5236\u65f6\u7684\u9ad8\u5ea6\u95f4\u9694 <code>dep[u] = get_hight(k - depth)</code>\u3002</li> <li><code>draw</code></li> <li>\u5bf9\u6bcf\u4e2a\u8282\u70b9\u8c03\u7528 <code>draw_node</code>\uff0c</li> <li>\u5bf9\u6bcf\u6761\u7236\u5b50\u5173\u7cfb\u8c03\u7528 <code>draw_line</code>\uff0c</li> <li>\u5e76\u9012\u5f52\u7ed8\u5236\u5176\u5de6\u53f3\u5b50\u6811\u3002</li> <li><code>draw_node</code></li> <li>\u8d1f\u8d23\u5728\u4e8c\u7ef4\u6570\u7ec4 <code>a</code> \u4e0a\u6309\u56fa\u5b9a\u683c\u5f0f\u7ed8\u5236\u8282\u70b9\u5916\u6846\u548c\u7f16\u53f7\u5b57\u7b26\u3002</li> <li><code>draw_line</code></li> <li>\u8d1f\u8d23\u5728\u4e8c\u7ef4\u6570\u7ec4 <code>a</code> \u4e0a\u7ed8\u5236\u4ece <code>(x,y)</code> \u5230 <code>(u,v)</code> \u7684\u5bf9\u89d2\u7ebf\uff0c\u4f5c\u4e3a\u7236\u5b50\u8fde\u7ebf\u3002</li> <li><code>print_canvas</code></li> <li>\u626b\u63cf <code>a</code> \u6570\u7ec4\u4e2d\u975e\u7a7a\u5b57\u7b26\u7684\u8fb9\u754c\uff0c</li> <li>\u5728\u8fb9\u754c\u7528 <code>*</code> \u8f93\u51fa\u5916\u6846\uff0c\u5176\u4f59\u4f4d\u7f6e\u8f93\u51fa\u539f\u6709\u5b57\u7b26\u3002</li> <li><code>destroy</code></li> <li>\u540e\u5e8f\u904d\u5386\u91ca\u653e\u4e8c\u53c9\u6811\u6240\u6709\u8282\u70b9\uff0c\u56de\u6536\u5185\u5b58\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C1/#4","title":"4. \u8c03\u8bd5\u5206\u6790","text":"<p>\u95ee\u9898\u4e0e\u89e3\u51b3\uff1a  </p> <ol> <li>\u4e00\u5f00\u59cb\u4f7f\u7528\u6570\u7ec4\u4e0b\u6807\u6765\u8bbf\u95ee\u5b57\u7b26\u4e32\uff0c\u8fc7\u4e8e\u7e41\u7410\uff0c\u6539\u7528<code>char*</code>\u548c<code>char**</code>\u3002</li> <li>\u5b57\u7b26\u753b\u4e00\u5f00\u59cb\u6ca1\u8003\u8651\u7a7a\u6811\u7684\u60c5\u51b5\uff0c\u7a7a\u6811\u65f6\u4f1a\u8f93\u51fa\u4e71\u7801\uff0c\u6539\u4e3a\u7279\u5224\uff0c\u8f93\u51fa<code>Empty Tree!</code>\u3002</li> </ol> <p>\u6539\u8fdb\u65b9\u5411\uff1a  </p> <ul> <li>\u652f\u6301\u66f4\u591a\u4e8c\u53c9\u6811\u7684\u8868\u793a\u6cd5\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C1/#5","title":"5. \u7528\u6237\u4f7f\u7528\u8bf4\u660e","text":"<p>\u8fd0\u884c\u73af\u5883\uff1a<code>GCC 13.2.0</code></p> <p>\u7f16\u8bd1\u8fd0\u884c\u540e\uff0c\u8f93\u5165\u4e00\u884c\u4f7f\u7528*\u8868\u793a\u7a7a\u6811\u7684\u5148\u5e8f\u5e8f\u5217\u5b57\u7b26\u4e32\u3002</p> <p>\u8f93\u5165\u793a\u4f8b\uff1a  </p> <pre><code>abc**d**e\n</code></pre> <p>\u8f93\u51fa\u793a\u4f8b\uff1a  </p> <pre><code>*********************\n*           __      *\n*          /a \\     *\n*          \\__/     *\n*          /  \\     *\n*         /    \\    *\n*      __/      \\__ *\n*     /b \\      /e \\*\n*     \\__/      \\__/*\n*     /  \\          *\n*    /    \\         *\n* __/      \\__      *\n*/c \\      /d \\     *\n*\\__/      \\__/     *\n*********************\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C1/#6","title":"6. \u6d4b\u8bd5\u7ed3\u679c","text":"<p>\u8f93\u51651\uff1a</p> <pre><code>ABC**D**EF**G**\n</code></pre> <p>\u8f93\u51fa1\uff1a</p> <pre><code>************************\n*          __          *\n*         /A \\         *\n*         \\__/         *\n*         /  \\         *\n*        /    \\        *\n*       /      \\       *\n*    __/        \\__    *\n*   /B \\        /E \\   *\n*   \\__/        \\__/   *\n* __/  \\__    __/  \\__ *\n*/C \\  /D \\  /F \\  /G \\*\n*\\__/  \\__/  \\__/  \\__/*\n************************\n</code></pre> <p>\u8f93\u51652\uff1a</p> <pre><code>abcd**ef**g****\n</code></pre> <p>\u8f93\u51fa2\uff1a</p> <pre><code>************************************************\n*                                           __ *\n*                                          /a \\*\n*                                          \\__/*\n*                                          /   *\n*                                         /    *\n*                                        /     *\n*                                       /      *\n*                                      /       *\n*                                     /        *\n*                                    /         *\n*                                   /          *\n*                                  /           *\n*                                 /            *\n*                                /             *\n*                               /              *\n*                              /               *\n*                             /                *\n*                            /                 *\n*                           /                  *\n*                          /                   *\n*                         /                    *\n*                        /                     *\n*                       /                      *\n*                      /                       *\n*                   __/                        *\n*                  /b \\                        *\n*                  \\__/                        *\n*                  /                           *\n*                 /                            *\n*                /                             *\n*               /                              *\n*              /                               *\n*             /                                *\n*            /                                 *\n*           /                                  *\n*          /                                   *\n*       __/                                    *\n*      /c \\                                    *\n*      \\__/                                    *\n*      /  \\                                    *\n*     /    \\                                   *\n*    /      \\                                  *\n* __/        \\__                               *\n*/d \\        /e \\                              *\n*\\__/        \\__/                              *\n*          __/  \\__                            *\n*         /f \\  /g \\                           *\n*         \\__/  \\__/                           *\n************************************************\n</code></pre> <p>\u8f93\u51653\uff1a</p> <pre><code>$**\n</code></pre> <p>\u8f93\u51fa3\uff1a</p> <pre><code>******\n* __ *\n*/$ \\*\n*\\__/*\n******\n</code></pre> <p>\u8f93\u51654\uff1a</p> <pre><code>*\n</code></pre> <p>\u8f93\u51fa4\uff1a</p> <pre><code>Empty tree!\n</code></pre> <p>\u7ecf\u6d4b\u8bd5\uff0c\u6ee1\u4e8c\u53c9\u6811\u3001\u975e\u6ee1\u4e8c\u53c9\u6811\u3001\u5355\u4e2a\u7ed3\u70b9\u7684\u6811\u3001\u7a7a\u6811\u3001\u7279\u6b8a\u5b57\u7b26\u7f16\u53f7\u5747\u80fd\u6b63\u786e\u8f93\u51fa\u7ed3\u679c\u3002</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C2/","title":"\u9898\u76ee\uff1a Huffman\u7f16\u7801","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C2/#1","title":"1. \u9700\u6c42\u5206\u6790","text":"<p>\u4efb\u52a1\u63cf\u8ff0\uff1a  \u5c06\u4efb\u610f\u4e00\u4e2a\u6307\u5b9a\u7684\u6587\u4ef6\u8fdb\u884c\u54c8\u592b\u66fc\u7f16\u7801\uff0c\u5e76\u4ee5\u771f\u6b63\u7684\u4e8c\u8fdb\u5236\u4f4d\u751f\u6210\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u538b\u7f29\u6587\u4ef6\uff09\uff1b\u53cd\u8fc7\u6765\uff0c\u53ef\u5c06\u4e00\u4e2a\u538b\u7f29\u6587\u4ef6\u89e3\u7801\u8fd8\u539f\u4e3a\u539f\u6765\u7684\u6587\u4ef6\u3002</p> <p>\u8f93\u5165/\u8f93\u51fa\u8981\u6c42\uff1a  </p> <ul> <li> <p>\u8f93\u5165\u5f62\u5f0f\uff1a\u8fd0\u884c\u53c2\u6570\uff0c\u5f85\u538b\u7f29/\u89e3\u538b\u6587\u4ef6\u5730\u5740\uff0c\u538b\u7f29/\u89e3\u538b\u6587\u4ef6\u5730\u5740\u3002</p> </li> <li> <p>\u8f93\u51fa\u5f62\u5f0f\uff1a\u538b\u7f29\u540e\u7684.huf\u6587\u4ef6\u3002</p> </li> </ul> <p>\u529f\u80fd\u8981\u6c42\uff1a </p> <ol> <li>\u5bf9\u9009\u5b9a\u6587\u4ef6\u4ee5\u4e8c\u8fdb\u5236\u65b9\u5f0f\u8bfb\u5165\uff0c\u4e00\u6b21\u8bfb\u51651024\u5b57\u8282\u3002</li> <li>\u6b63\u786e\u6784\u5efaHuffman\u6811\u5e76\u57fa\u4e8e\u6b64\u8fdb\u884c\u538b\u7f29\u548c\u89e3\u538b\u3002</li> </ol>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C2/#2","title":"2. \u6982\u8981\u8bbe\u8ba1","text":"<p>\u89e3\u51b3\u601d\u8def\uff1a  </p> <ol> <li>\u5faa\u73af\u8bfb\u5165\u6587\u4ef6\uff0c\u7edf\u8ba1\u5b57\u7b26\u9891\u7387\u3002</li> <li>\u6839\u636e\u9891\u7387\u6784\u5efaHuffman\u6811\u3002</li> <li> <p>\u6839\u636eHuffman\u6811\u5f97\u5230\u7f16\u7801\u8868\u3002</p> </li> <li> <p>\u538b\u7f29\u65f6\uff1a</p> </li> <li> <p>\u5c06\u9891\u7387\u8868\u5199\u5165\u6587\u4ef6\u5934\u90e8\u3002</p> </li> <li> <p>\u5c06\u7f16\u7801\u540e\u7684\u5b57\u7b26\u6309\u987a\u5e8f\u5199\u5165\u6587\u4ef6\u3002</p> </li> <li> <p>\u89e3\u538b\u65f6\uff1a</p> </li> <li> <p>\u6839\u636e\u9891\u7387\u8868\u5efa\u7acbHuffman\u6811\u3002</p> </li> <li>\u5c06Huffman\u6811\u89c6\u4f5c\u5b57\u5178\u6811\uff0c\u6cbf\u7740\u5b57\u5178\u6811\u8fdb\u884c\u89e3\u7801\u3002</li> </ol> <p>\u6570\u636e\u7ed3\u6784\uff1a  </p> <p>\u7ed3\u6784\u4f53\u7ed1\u5b9a\u5b57\u7b26\u548c\u9891\u7387\u3002</p> <pre><code>typedef struct {\n    unsigned char ch;\n    ll cnt;\n} Info;\n</code></pre> <p>\u4e8c\u53c9\u94fe\u8868\u5b58\u50a8Huffman\u6811\u3002</p> <pre><code>typedef struct BiTNode {\n    Info data;\n    struct BiTNode *lc, *rc;\n} BiTNode, *BiTree;\n</code></pre> <p>\u4e8c\u53c9\u5806\u52a0\u901fHuffman\u6811\u7684\u6784\u5efa\u3002</p> <pre><code>typedef struct Heap {\n    BiTree heap[MAXN];\n    int size;  // \u5806\u4e2d\u5143\u7d20\u4e2a\u6570\uff0c\u5b58\u50a8\u5728 heap[1..size] \u4e2d\n} *PriorityQueue;\n</code></pre> <p>\u6a21\u5757\u5173\u7cfb\uff1a  </p> <ul> <li>\u4f18\u5148\u961f\u5217 / \u5c0f\u6839\u5806\uff1a<code>init</code>\u3001<code>_up</code>\u3001<code>_down</code>\u3001<code>push</code>\u3001<code>pop</code>\uff0c\u4e3a\u6bcf\u6b21\u5408\u5e76\u53d6\u51fa\u6700\u5c0f\u9891\u6b21\u8282\u70b9\u63d0\u4f9b\u652f\u6301\u3002</li> <li>Huffman \u6811\u6784\u5efa\uff1a<code>buildHuffmanTree</code>\uff08\u521b\u5efa\u6240\u6709\u53f6\u5b50\u5e76\u4e24\u4e24\u5408\u5e76\uff09\u3001<code>freeHuffmanTree</code>\uff08\u91ca\u653e\u6574\u68f5\u6811\uff09\u3002</li> <li>\u7f16\u7801\u8868\u751f\u6210\uff1a<code>encode</code> \u6839\u636e\u6811\u4ece\u6839\u5230\u53f6\u5b50\u8bb0\u5f55\u8def\u5f84 0/1 \u4fdd\u5b58\u5230 <code>table[ch]</code>\u3002</li> <li>\u6309\u4f4d\u5199\u5165\uff1a<code>BitWriter</code> \u7684 <code>bw_init</code>\u3001<code>bw_write_bit</code>\u3001<code>bw_write_code</code>\u3001<code>bw_flush</code>\uff0c\u628a\u4e00\u4e32 <code>'0'/'1'</code> \u5b57\u7b26\u5199\u6210\u771f\u6b63\u7684\u6bd4\u7279\u6d41\u3002</li> <li>\u6309\u4f4d\u8bfb\u53d6\uff1a<code>BitReader</code> \u7684 <code>br_init</code>\u3001<code>br_read_bit</code>\uff0c\u628a\u6587\u4ef6\u8bfb\u5b57\u8282\u540e\u62c6\u5206\u6210\u4e00\u4e2a\u4e00\u4e2a\u6bd4\u7279\u3002</li> <li>\u538b\u7f29\u4e3b\u903b\u8f91\uff1a<code>compress_file</code>\uff0c\u4ece\u9891\u6b21\u7edf\u8ba1\u5230\u6811\u6784\u9020\u3001\u7f16\u7801\u8868\u3001\u5199\u5934\u3001\u6309\u4f4d\u5199\u6b63\u6587\u3002</li> <li>\u89e3\u538b\u4e3b\u903b\u8f91\uff1a<code>decompress_file</code>\uff0c\u4ece\u8bfb\u5934\u5230\u91cd\u5efa\u6811\u3001\u6309\u4f4d\u8bfb\u6b63\u6587\u5e76\u6cbf\u6811\u8fd8\u539f\u5b57\u8282\u3002</li> <li>\u7a0b\u5e8f\u5165\u53e3\uff1a<code>main</code> \u8d1f\u8d23\u89e3\u6790\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u51b3\u5b9a\u8c03\u7528\u201c\u538b\u7f29\u201d\u8fd8\u662f\u201c\u89e3\u538b\u201d\uff0c\u5e76\u8bbe\u7f6e\u63a7\u5236\u53f0\u7f16\u7801\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C2/#3","title":"3. \u8be6\u7ec6\u8bbe\u8ba1","text":"<p>\u5173\u952e\u7b97\u6cd5\uff1a  </p> <ol> <li> <p><code>void swap(BiTree *x, BiTree *y)</code></p> </li> <li> <p>\u4f5c\u7528\uff1a\u4ea4\u6362\u4e24\u4e2a <code>BiTree</code> \u6307\u9488\uff08\u4e8c\u53c9\u6811\u8282\u70b9\uff09\u7684\u5185\u5bb9\u3002</p> </li> <li> <p>\u7ec6\u8282\uff1a\u5728\u5c0f\u6839\u5806\u7684\u4e0a\u4e0b\u8c03\u6574\u8fc7\u7a0b\u4e2d\uff0c\u7528\u6765\u4ea4\u6362\u5806\u6570\u7ec4\u91cc\u76f8\u90bb\u5143\u7d20\u7684\u6307\u9488\u3002</p> </li> <li> <p>\u5c0f\u6839\u5806\uff08PriorityQueue\uff09\u76f8\u5173\u51fd\u6570     \u8fd9\u7ec4\u51fd\u6570\u5171\u540c\u6784\u6210\u4e86\u4e00\u4e2a\u57fa\u4e8e\u6570\u7ec4\u7684\u6700\u5c0f\u5806\uff0c\u7528\u6765\u6bcf\u6b21\u53d6\u51fa\u5f53\u524d\u9891\u7387\u6700\u5c0f\u7684 Huffman \u8282\u70b9\u3002</p> </li> <li> <p><code>void init(PriorityQueue pq)</code></p> <ul> <li>\u4f5c\u7528\uff1a\u521d\u59cb\u5316\u4e00\u4e2a\u7a7a\u7684\u4f18\u5148\u961f\u5217\uff08\u5c0f\u6839\u5806\uff09\uff0c\u628a <code>size</code> \u8bbe\u4e3a 0\u3002</li> </ul> </li> <li><code>void _up(PriorityQueue pq, int i)</code><ul> <li>\u4f5c\u7528\uff1a\u5411\u4e0a\u8c03\u6574\u7d22\u5f15\u4e3a <code>i</code> \u7684\u5806\u5143\u7d20\u3002</li> <li>\u7ec6\u8282\uff1a\u5982\u679c <code>heap[i]</code> \u7684 <code>cnt</code> (\u9891\u6b21) \u6bd4\u5176\u7236\u8282\u70b9\u66f4\u5c0f\uff0c\u5c31\u4e00\u76f4\u4ea4\u6362\u76f4\u5230\u5806\u6027\u8d28\u6062\u590d\u3002</li> </ul> </li> <li><code>void _down(PriorityQueue pq, int i)</code><ul> <li>\u4f5c\u7528\uff1a\u5411\u4e0b\u8c03\u6574\u7d22\u5f15\u4e3a <code>i</code> \u7684\u5806\u5143\u7d20\u3002</li> <li>\u7ec6\u8282\uff1a\u4e0d\u65ad\u6bd4\u8f83\u5f53\u524d\u8282\u70b9\u4e0e\u5b83\u5de6\u53f3\u5b50\u8282\u70b9\u7684 <code>cnt</code>\uff0c\u628a\u6700\u5c0f\u7684\u6d6e\u5230\u4e0a\u9762\uff0c\u76f4\u5230 \u201c\u7236 \u2264 \u5b50\u201d \u6ee1\u8db3\u5c0f\u6839\u5806\u6761\u4ef6\u3002</li> </ul> </li> <li><code>void push(PriorityQueue pq, BiTree x)</code><ul> <li>\u4f5c\u7528\uff1a\u628a\u4e00\u4e2a\u65b0\u7684 Huffman \u5b50\u6811 <code>x</code> \u63d2\u5165\u5806\u4e2d\u3002</li> <li>\u6d41\u7a0b\uff1a\u5148\u628a <code>x</code> \u653e\u5230\u5806\u5c3e (<code>heap[++size] = x</code>)\uff0c\u518d\u8c03\u7528 <code>_up</code> \u4fdd\u6301\u5806\u5e8f\u3002</li> </ul> </li> <li> <p><code>BiTree pop(PriorityQueue pq)</code></p> <ul> <li>\u4f5c\u7528\uff1a\u4ece\u5806\u9876\u5f39\u51fa\u5f53\u524d\u6700\u5c0f\u9891\u6b21\u7684\u5b50\u6811\u8282\u70b9\u3002</li> <li>\u6d41\u7a0b\uff1a\u53d6\u51fa <code>heap[1]</code>\uff08\u6700\u5c0f\uff09\uff0c\u628a\u5806\u5c3e\u5143\u7d20\u79fb\u5230 <code>heap[1]</code>\uff0c<code>size--</code>\uff0c\u7136\u540e\u8c03\u7528 <code>_down</code> \u6062\u590d\u5c0f\u6839\u5806\u3002\u8fd4\u56de\u539f\u6765\u7684\u5806\u9876\u6307\u9488\u3002</li> </ul> </li> <li> <p><code>BiTree buildHuffmanTree(Info *arr, int n)</code></p> </li> <li> <p>\u4f5c\u7528\uff1a\u6839\u636e\u4f20\u5165\u7684 <code>Info</code> \u6570\u7ec4\uff08\u5305\u542b <code>ch</code> \u548c <code>cnt</code>\uff09\u6784\u9020\u4e00\u68f5 Huffman \u6811\uff0c\u5e76\u8fd4\u56de\u6811\u6839\u6307\u9488\u3002</p> </li> <li> <p>\u8be6\u7ec6\u6b65\u9aa4\uff1a</p> <ol> <li>\u82e5 <code>n == 0</code> \u8fd4\u56de <code>NULL</code>\u3002</li> <li>\u7528 <code>malloc</code> \u5206\u914d\u4e00\u4e2a <code>PriorityQueue</code>\uff0c\u8c03\u7528 <code>init</code> \u521d\u59cb\u5316\u3002</li> <li>\u904d\u5386 <code>arr[0..n-1]</code>\uff0c\u4e3a\u6bcf\u4e2a <code>Info</code> \u65b0\u5efa\u4e00\u4e2a <code>BiTNode</code>\uff08\u53f6\u5b50\uff09\uff0c\u628a <code>data.ch = arr[i].ch</code>\u3001<code>data.cnt = arr[i].cnt</code>\uff0c<code>lc=rc=NULL</code>\uff0c\u7136\u540e <code>push</code> \u5165\u5806\u3002</li> <li>\u5f53\u5806\u4e2d\u5143\u7d20\u6570 <code>&gt;1</code> \u65f6\uff1a<ul> <li><code>pop</code> \u51fa\u4e24\u68f5\u6700\u5c0f\u9891\u6b21\u5b50\u6811 <code>min</code>\u3001<code>subMin</code>\uff1b</li> <li>\u65b0\u5efa\u4e00\u4e2a\u7236\u8282\u70b9 <code>parent</code>\uff0c\u4ee4 <code>parent-&gt;data.cnt = min-&gt;cnt + subMin-&gt;cnt</code>\u3001<code>parent-&gt;data.ch = 0</code>\uff08\u65e0\u5b9e\u9645\u5b57\u7b26\uff09\uff0c<code>parent-&gt;lc = min</code>\u3001<code>parent-&gt;rc = subMin</code>\uff1b</li> <li><code>push(pq, parent)</code>\uff0c\u628a\u5b83\u653e\u56de\u5806\u3002</li> </ul> </li> <li>\u6700\u7ec8 <code>pop(pq)</code> \u5c31\u662f Huffman \u6811\u7684\u6839\u3002\u91ca\u653e\u5806\u672c\u8eab\u7684\u5185\u5b58\u540e\u8fd4\u56de\u6839\u6307\u9488\u3002</li> </ol> </li> <li> <p><code>void freeHuffmanTree(BiTree root)</code></p> </li> <li> <p>\u4f5c\u7528\uff1a\u9012\u5f52\u91ca\u653e\u6574\u68f5 Huffman \u6811\u6240\u5360\u7528\u7684\u5185\u5b58\u3002</p> </li> <li> <p>\u6d41\u7a0b\uff1a\u5148\u9012\u5f52\u91ca\u653e\u5de6\u5b50\u6811\u548c\u53f3\u5b50\u6811\uff0c\u518d <code>free(root)</code> \u672c\u8282\u70b9\u3002</p> </li> <li> <p><code>void encode(BiTree root, char sign[], int p)</code></p> </li> <li> <p>\u4f5c\u7528\uff1a\u6839\u636e\u5df2\u6784\u9020\u597d\u7684 Huffman \u6811 <code>root</code>\uff0c\u751f\u6210\u4ece\u6839\u5230\u6bcf\u4e2a\u53f6\u5b50\u8282\u70b9\uff08\u6bcf\u4e2a\u5b57\u7b26\uff09\u7684\u6bd4\u7279\u4e32\u7f16\u7801\uff0c\u5e76\u628a\u5b83\u4fdd\u5b58\u5230\u5168\u5c40 <code>table[ch]</code> \u4e2d\u3002</p> </li> <li>\u53c2\u6570\u542b\u4e49\uff1a<ul> <li><code>root</code>\uff1a\u5f53\u524d\u5b50\u6811\u7684\u6839\u8282\u70b9\u3002</li> <li><code>sign[]</code>\uff1a\u7528\u6765\u7d2f\u79ef\u8def\u5f84\u4e0a\u5199\u5165\u7684 <code>'0'</code> \u6216 <code>'1'</code>\u3002</li> <li><code>p</code>\uff1a\u5f53\u524d\u7d2f\u79ef\u5230 <code>sign[p-1]</code> \u7684\u957f\u5ea6\u3002</li> </ul> </li> <li> <p>\u5b9e\u73b0\u7ec6\u8282\uff1a</p> <ol> <li>\u5982\u679c <code>root == NULL</code> \u76f4\u63a5\u8fd4\u56de\u3002</li> <li>\u82e5\u5f53\u524d\u8282\u70b9\u540c\u65f6 <code>lc == NULL &amp;&amp; rc == NULL</code>\uff0c\u8bf4\u660e\u8fd9\u662f\u53f6\u5b50\uff1a<ul> <li>\u82e5 <code>p == 0</code>\uff08\u4ec5\u6709\u4e00\u4e2a\u7b26\u53f7\uff09\uff0c\u5219\u5f3a\u5236\u7ed9\u5b83\u7f16\u7801 <code>\"0\"</code>\uff1b</li> <li>\u5426\u5219\u628a\u5df2\u7ecf\u7d2f\u79ef\u5728 <code>sign</code> \u4e2d\u7684\u6bd4\u7279\u4e32\u590d\u5236\u5230 <code>table[root-&gt;data.ch]</code>\u3002</li> </ul> </li> <li>\u5982\u679c\u6709\u5de6\u5b50\u8282\u70b9\uff0c\u5c31\u628a <code>sign[p] = '0'</code>\u3001<code>sign[p+1] = '\\0'</code>\uff0c\u9012\u5f52 <code>encode(root-&gt;lc, sign, p+1)</code>\uff1b</li> <li>\u5982\u679c\u6709\u53f3\u5b50\u8282\u70b9\uff0c\u5c31\u628a <code>sign[p] = '1'</code>\u3001<code>sign[p+1] = '\\0'</code>\uff0c\u9012\u5f52 <code>encode(root-&gt;rc, sign, p+1)</code>\u3002</li> </ol> </li> <li> <p>BitWriter \u7cfb\u5217\u51fd\u6570\uff08\u6309\u4f4d\u5199\u5165\uff09     \u7528\u4e8e\u628a\u201c\u5b57\u7b26\u5bf9\u5e94\u7684\u6bd4\u7279\u4e32\u201d\u771f\u6b63\u201c\u6253\u5305\u5230\u5b57\u8282\u6d41\u201d\u4e2d\u3002</p> </li> <li> <p><code>void bw_init(BitWriter *bw, FILE *fp)</code></p> <ul> <li>\u4f5c\u7528\uff1a\u521d\u59cb\u5316\u4e00\u4e2a <code>BitWriter</code>\uff0c\u628a <code>fp</code> \u8d4b\u7ed9 <code>bw-&gt;fp</code>\uff0c<code>buffer=0</code>\uff0c<code>bitcount=0</code>\u3002</li> </ul> </li> <li><code>void bw_write_bit(BitWriter *bw, int bit)</code><ul> <li>\u4f5c\u7528\uff1a\u5411 <code>BitWriter</code> \u4e2d\u5199\u5165\u4e00\u4e2a\u6bd4\u7279\uff08<code>0</code> \u6216 <code>1</code>\uff09\u3002</li> <li>\u6d41\u7a0b\uff1a</li> <li><code>bw-&gt;buffer &lt;&lt;= 1;</code> \u5de6\u79fb\u4e00\u4f4d\uff0c\u628a\u5f53\u524d buffer \u7684\u9ad8\u4f4d\u7a7a\u51fa\u6765\uff1b</li> <li><code>if (bit) bw-&gt;buffer |= 1;</code> \u5982\u679c\u8981\u5199\u5165 <code>1</code>\uff0c\u5c31\u628a\u6700\u4f4e\u4f4d\u8bbe\u4e3a 1\u3002</li> <li><code>bw-&gt;bitcount++</code>\uff1b\u5982\u679c <code>bitcount == 8</code>\uff0c\u8bf4\u660e <code>buffer</code> \u5df2\u586b\u6ee1 8 \u4e2a\u6bd4\u7279\uff0c\u5c31 <code>fputc(buffer)</code> \u5199\u6210\u4e00\u4e2a\u5b57\u8282\u5230 <code>fp</code>\uff0c\u7136\u540e <code>buffer=0; bitcount=0;</code>\u3002</li> </ul> </li> <li><code>void bw_write_code(BitWriter *bw, const char *code)</code><ul> <li>\u4f5c\u7528\uff1a\u628a\u4e00\u4e2a\u4ee5 <code>'0'</code>/<code>'1'</code> \u7ec4\u6210\u7684 ASCII \u5b57\u7b26\u4e32 <code>code</code> \uff08\u6bd4\u5982 <code>\"01011\"</code>\uff09\u4e2d\u7684\u6bcf\u4e2a\u5b57\u7b26\uff0c\u4f9d\u6b21\u8c03\u7528 <code>bw_write_bit</code> \u8f93\u51fa\u6bd4\u7279\u3002</li> </ul> </li> <li> <p><code>void bw_flush(BitWriter *bw)</code></p> <ul> <li>\u4f5c\u7528\uff1a\u5728\u5199\u5165\u5b8c\u6210\u540e\uff0c\u628a <code>buffer</code> \u4e2d\u5c1a\u672a\u51d1\u6ee1 8 \u4f4d\u7684\u90a3\u90e8\u5206\u201c\u5de6\u79fb\u8865 0\u201d\u5e76\u5199\u51fa\u4e00\u4e2a\u5b57\u8282\u3002</li> <li>\u7ec6\u8282\uff1a\u5982\u679c <code>bitcount &gt; 0</code>\uff0c\u5219 <code>buffer &lt;&lt;= (8 - bitcount)</code>\uff0c\u4f7f\u4f4e\u4f4d\u8865 0\uff0c\u628a\u8fd9\u4e2a\u5b57\u8282 <code>fputc</code> \u8f93\u51fa\uff0c\u7136\u540e <code>buffer=0\uff0cbitcount=0</code>\u3002</li> </ul> </li> <li> <p>BitReader \u7cfb\u5217\u51fd\u6570\uff08\u6309\u4f4d\u8bfb\u53d6\uff09     \u7528\u4e8e\u89e3\u538b\u65f6\u628a\u538b\u7f29\u6587\u4ef6\u7684\u6bd4\u7279\u6d41\u62c6\u5206\u56de\u4e00\u4f4d\u4e00\u4f4d\uff0c\u4f9b Huffman \u6811\u904d\u5386\u4f7f\u7528\u3002</p> </li> <li> <p><code>void br_init(BitReader *br, FILE *fp)</code></p> <ul> <li>\u4f5c\u7528\uff1a\u521d\u59cb\u5316\u4e00\u4e2a <code>BitReader</code>\uff0c\u628a <code>fp</code> \u8d4b\u7ed9 <code>br-&gt;fp</code>\uff0c<code>buffer = 0</code>\uff0c<code>bitcount = 0</code>\u3002</li> </ul> </li> <li> <p><code>int br_read_bit(BitReader *br)</code></p> <ul> <li>\u4f5c\u7528\uff1a\u4ece <code>BitReader</code> \u4e2d\u8bfb\u53d6\u4e00\u4e2a\u6bd4\u7279\uff08\u8fd4\u56de <code>0</code> \u6216 <code>1</code>\uff09\uff0c\u5982\u679c\u5df2\u5230\u6587\u4ef6\u672b\u5c3e\u4e14\u65e0\u66f4\u591a\u6570\u636e\uff0c\u5219\u8fd4\u56de <code>-1</code>\u3002</li> <li>\u6d41\u7a0b\uff1a</li> <li>\u5982\u679c <code>bitcount == 0</code>\uff0c\u8bf4\u660e\u5f53\u524d <code>buffer</code> \u91cc\u6ca1\u6709\u53ef\u8bfb\u7684\u6bd4\u7279\uff0c\u5c31 <code>fgetc(fp)</code> \u518d\u8bfb\u4e00\u4e2a\u5b57\u8282\u5230 <code>buffer</code>\uff0c\u5e76\u628a <code>bitcount = 8</code>\uff1b</li> <li>\u4ece <code>buffer</code> \u7684\u6700\u9ad8\u4f4d\u53d6\u51fa 1 \u4f4d\uff1a<code>int bit = (buffer &amp; 0x80) ? 1 : 0;</code>\uff0c\u518d\u628a <code>buffer &lt;&lt;= 1; bitcount--;</code>\uff1b\u8fd4\u56de <code>bit</code>\u3002</li> </ul> </li> <li> <p><code>void compress_file(const char *infile, const char *outfile)</code></p> </li> <li> <p>\u4f5c\u7528\uff1a\u628a\u539f\u6587\u4ef6 <code>infile</code> \u6309\u7167 Huffman \u7f16\u7801\u538b\u7f29\uff0c\u8f93\u51fa\u5230 <code>outfile</code>\u3002</p> </li> <li> <p>\u4e3b\u8981\u6b65\u9aa4\uff1a</p> <ol> <li>\u7edf\u8ba1\u9891\u6b21\uff1a\u6253\u5f00 <code>infile</code>\uff0c\u9010\u5757\u8bfb\u53d6\u5230 <code>unsigned char buffer[1024]</code> \u4e2d\uff0c\u7d2f\u52a0 <code>cnt[buffer[i]]++</code>\u3002</li> <li>\u628a <code>cnt[i] &gt; 0</code> \u7684\u5b57\u8282\u5c01\u88c5\u5230 <code>Info signs[]</code> \u4e2d\uff0c\u8ba1\u7b97\u51fa\u4e00\u5171\u6709 <code>tot</code> \u79cd\u5b57\u7b26\u3002</li> <li>\u6784\u5efa Huffman \u6811\uff1a\u8c03\u7528 <code>buildHuffmanTree(signs, tot)</code> \u83b7\u5f97 <code>HuffmanTree</code>\u3002</li> <li>\u751f\u6210\u7f16\u7801\u8868\uff1a\u6e05\u7a7a\u5168\u5c40 <code>table</code>\uff0c\u518d\u505a\u4e00\u6b21 <code>encode(HuffmanTree, sign, 0)</code>\uff0c\u8ba9 <code>table[ch]</code> \u5f97\u5230\u4ece\u6839\u5230\u8be5\u53f6\u5b50\u7684\u6bd4\u7279\u4e32\uff08\u5f62\u5982 <code>\"01011\"</code>\uff09\u3002</li> <li>\u8ba1\u7b97\u603b\u6bd4\u7279\u6570 &amp; padding\uff1a\u904d\u5386 <code>i=0..255</code>\uff0c<code>if (cnt[i]&gt;0) total_bits += cnt[i] * strlen(table[i])</code>\uff1b\u7136\u540e <code>padding = (8 - (total_bits % 8)) % 8</code>\u3002</li> <li>\u5199\u538b\u7f29\u5934\uff1a\u6253\u5f00 <code>outfile</code>\uff08<code>fopen(..., \"wb\")</code>\uff09\uff0c\u5148 <code>for (i=0..255) fwrite(&amp;cnt[i], sizeof(ll), 1, fout)</code>\uff0c\u518d <code>fwrite(&amp;padding, 1, 1, fout)</code>\u3002\u6b64\u65f6\u5934\u90e8\u56fa\u5b9a\u5360\u7528 <code>256\u00d78 + 1 = 2049</code> \u5b57\u8282\u3002</li> <li>\u6309\u4f4d\u5199\u6b63\u6587\uff1a\u7528 <code>BitWriter bw; bw_init(&amp;bw, fout);</code>\uff0c\u56de\u5230 <code>infile</code> \u5934\uff0c\u6bcf\u6b21 <code>fgetc(fin)</code> \u5f97\u5230 <code>ch</code>\uff0c\u8c03\u7528 <code>bw_write_code(&amp;bw, table[ch])</code>\uff0c\u6700\u540e\u8c03\u7528 <code>bw_flush(&amp;bw)</code> \u628a\u672b\u5c3e\u4e0d\u6ee1 8 \u4f4d\u7684\u5269\u4f59\u6bd4\u7279\u5199\u51fa\u3002</li> <li>\u5173\u95ed\u6587\u4ef6\uff0c\u91ca\u653e <code>HuffmanTree</code>\u3001<code>signs[]</code>\uff0c\u5e76\u5728\u5c4f\u5e55\u6253\u5370\u201c\u538b\u7f29\u5b8c\u6210\u201d\u7684\u4fe1\u606f\u3002</li> </ol> </li> <li> <p><code>void decompress_file(const char *infile, const char *outfile)</code></p> </li> <li> <p>\u4f5c\u7528\uff1a\u628a\u538b\u7f29\u6587\u4ef6 <code>infile</code> \u89e3\u538b\u56de\u539f\u59cb\u5185\u5bb9\uff0c\u8f93\u51fa\u5230 <code>outfile</code>\u3002</p> </li> <li> <p>\u4e3b\u8981\u6b65\u9aa4\uff1a</p> <ol> <li>\u8bfb\u53d6\u538b\u7f29\u5934\uff1a\u6253\u5f00 <code>infile</code>\uff08<code>\"rb\"</code>\uff09\uff0c\u5148 <code>for (i=0..255) fread(&amp;cnt[i], sizeof(ll), 1, fin)</code> \u8bfb\u56de\u9891\u7387\u8868\uff1b\u518d <code>fread(&amp;padding, 1, 1, fin)</code> \u8bfb\u56de <code>padding</code>\u3002</li> <li>\u8ba1\u7b97\u539f\u59cb\u5b57\u8282\u603b\u6570\uff1a<code>sum_cnt = sum(cnt[i] for i=0..255)</code>\u3002</li> <li>\u91cd\u5efa Huffman \u6811\uff1a\u4e0e\u538b\u7f29\u65f6\u4e00\u81f4\uff0c\u628a <code>cnt[i]&gt;0</code> \u7684\u5b57\u8282\u5c01\u88c5\u5230 <code>signs[]</code> \u4e2d\uff0c\u8c03\u7528 <code>buildHuffmanTree(signs, tot)</code> \u5f97\u5230 <code>HuffmanTree</code>\uff1b\uff08\u53ef\u9009\uff09\u518d\u7528 <code>encode(...)</code> \u91cd\u65b0\u751f\u6210 <code>table</code>\uff0c\u4f46\u771f\u6b63\u89e3\u7801\u65f6\u5e76\u4e0d\u9700\u8981 <code>table</code>\uff0c\u53ea\u8981\u7528\u6811\u672c\u8eab\u904d\u5386\u5373\u53ef\u3002</li> <li>\u6309\u4f4d\u8bfb\u6b63\u6587\u5e76\u8fd8\u539f\uff1a\u6253\u5f00 <code>outfile</code>\uff08<code>\"wb\"</code>\uff09\uff0c\u521d\u59cb\u5316 <code>BitReader br; br_init(&amp;br, fin);</code>\uff0c\u4ee4 <code>BiTree node = HuffmanTree; written = 0;</code><ul> <li>\u5faa\u73af <code>while (written &lt; sum_cnt)</code>\uff1a</li> <li><code>bit = br_read_bit(&amp;br)</code>\uff0c\u5982\u679c <code>bit == -1</code> \u62a5\u9519\u7ed3\u675f\uff1b</li> <li><code>node = (bit == 0 ? node-&gt;lc : node-&gt;rc);</code></li> <li>\u5982\u679c <code>node</code> \u662f\u53f6\u5b50\uff08\u5373 <code>node-&gt;lc==NULL &amp;&amp; node-&gt;rc==NULL</code>\uff09\uff0c\u4ee4 <code>fputc(node-&gt;data.ch, fout); written++; node = HuffmanTree;</code></li> <li>\u5faa\u73af\u76f4\u5230\u5199\u51fa <code>sum_cnt</code> \u4e2a\u5b57\u8282\u3002</li> </ul> </li> <li>\u5173\u95ed\u6587\u4ef6\uff0c\u91ca\u653e <code>HuffmanTree</code>\u3001<code>signs[]</code>\uff0c\u5e76\u6253\u5370 \u201c\u89e3\u538b\u5b8c\u6210\u201d \u4fe1\u606f\u3002</li> </ol> </li> <li> <p><code>void print_usage(const char *progname)</code></p> <ul> <li> <p>\u4f5c\u7528\uff1a\u5f53\u547d\u4ee4\u884c\u53c2\u6570\u4e0d\u7b26\u5408\u9884\u671f\u65f6\uff0c\u5728\u6807\u51c6\u9519\u8bef\u4e0a\u6253\u5370\u7a0b\u5e8f\u7528\u6cd5\u63d0\u793a\u3002</p> </li> <li> <p>\u5185\u5bb9\uff1a</p> </li> </ul> <pre><code>\u7528\u6cd5\uff1a\n  \u538b\u7f29\uff1aprogname -c \u539f\u59cb\u6587\u4ef6\u8def\u5f84 \u538b\u7f29\u540e\u6587\u4ef6\u8def\u5f84\n  \u89e3\u538b\uff1aprogname -d \u538b\u7f29\u6587\u4ef6\u8def\u5f84 \u89e3\u538b\u540e\u6587\u4ef6\u8def\u5f84\n</code></pre> </li> <li> <p><code>int main(int argc, char *argv[])</code></p> <ul> <li>\u4f5c\u7528\uff1a\u7a0b\u5e8f\u5165\u53e3\uff0c\u6839\u636e\u547d\u4ee4\u884c\u53c2\u6570\u51b3\u5b9a\u201c\u538b\u7f29\u201d\u8fd8\u662f\u201c\u89e3\u538b\u201d\uff0c\u6216\u6253\u5370\u7528\u6cd5\u3002</li> <li>\u4e3b\u8981\u6d41\u7a0b\uff1a</li> <li>\u8c03\u7528 <code>SetConsoleOutputCP(CP_UTF8); SetConsoleCP(CP_UTF8);</code>\uff0c\u4f7f Windows \u63a7\u5236\u53f0\u4ee5 UTF-8 \u6a21\u5f0f\u8fdb\u884c\u8f93\u5165/\u8f93\u51fa\uff0c\u4ee5\u4fdd\u8bc1\u4e2d\u6587\u63d0\u793a\u6b63\u5e38\u663e\u793a\u3002</li> <li>\u68c0\u67e5 <code>argc != 4</code>\uff0c\u5982\u679c\u4e0d\u7b49\u4e8e 4\uff0c\u5c31\u8c03\u7528 <code>print_usage(argv[0])</code> \u5e76\u8fd4\u56de <code>1</code>\u3002</li> <li>\u5982\u679c <code>strcmp(argv[1], \"-c\") == 0</code>\uff0c\u5c31\u8c03\u7528 <code>compress_file(argv[2], argv[3])</code>\uff1b       \u5982\u679c <code>strcmp(argv[1], \"-d\") == 0</code>\uff0c\u5c31\u8c03\u7528 <code>decompress_file(argv[2], argv[3])</code>\uff1b\u5426\u5219\u518d\u6b21\u6253\u5370\u7528\u6cd5\u5e76\u8fd4\u56de <code>1</code>\u3002</li> <li>\u6700\u540e\u8fd4\u56de <code>0</code>\u3002</li> </ul> </li> </ol> <p>\u6d41\u7a0b\u56fe\uff1a  </p> <ul> <li>\u5c0f\u6839\u5806</li> </ul> <pre><code>flowchart TD\n    A[\"\u5f00\u59cb\"] --&gt; B[\"\u521d\u59cb\u5316\u4e00\u4e2a\u7a7a\u5806\uff0csize = 0\"]\n    B --&gt; C{\"\u6267\u884c\u64cd\u4f5c\u7c7b\u578b\uff1f\"}\n    C --&gt;|\"\u63d2\u5165(push)\"| D[\"\u5c06\u65b0\u8282\u70b9\u653e\u5230\u5806\u5c3e\"]\n    D --&gt; E[\"\u5411\u4e0a\u8c03\u6574\uff1a\u5982\u679c\u5f53\u524d\u8282\u70b9\u9891\u6b21\u5c0f\u4e8e\u7236\u8282\u70b9\uff0c\u4ea4\u6362\u5e76\u7ee7\u7eed\u5411\u4e0a\"]\n    E --&gt; F[\"\u5b8c\u6210\u63d2\u5165\u64cd\u4f5c\uff0c\u8fd4\u56de\"]\n    C --&gt;|\"\u5f39\u51fa(pop)\"| G{\"\u5806\u662f\u5426\u4e3a\u7a7a\uff1f\"}\n    G --&gt;|\"\u662f\"| H[\"\u8fd4\u56de\u7a7a \u6216 \u62a5\u9519\"]\n    G --&gt;|\"\u5426\"| I[\"\u53d6\u51fa\u5806\u9876\uff08\u6700\u5c0f\u9891\u6b21\uff09\"]\n    I --&gt; J[\"\u5c06\u5806\u5c3e\u5143\u7d20\u79fb\u5230\u5806\u9876\uff0csize--\"]\n    J --&gt; K[\"\u5411\u4e0b\u8c03\u6574\uff1a\u4e0e\u5b50\u8282\u70b9\u6bd4\u8f83\uff0c\u9009\u5c0f\u8005\u4ea4\u6362\u5e76\u7ee7\u7eed\u5411\u4e0b\"]\n    K --&gt; L[\"\u8fd4\u56de\u539f\u5806\u9876\u8282\u70b9\"]\n</code></pre> <ul> <li>\u6784\u5efa Huffman \u6811</li> </ul> <pre><code>flowchart TD\n    A[\"\u5f00\u59cb\u6784\u5efa Huffman \u6811\"] --&gt; B[\"\u51c6\u5907\u4e00\u4e2a\u5c0f\u6839\u5806\"]\n    B --&gt; C[\"\u628a\u6240\u6709\u51fa\u73b0\u8fc7\u7684\u5b57\u7b26\uff08\u53f6\u5b50\u8282\u70b9\uff09\u6309\u9891\u6b21\u63d2\u5165\u5806\u4e2d\"]\n    C --&gt; D{\"\u5806\u4e2d\u5143\u7d20&gt;1\uff1f\"}\n    D --&gt;|\"\u662f\"| E[\"\u5f39\u51fa\u4e24\u4e2a\u6700\u5c0f\u9891\u6b21\u5b50\u6811 A\u3001B\"]\n    E --&gt; F[\"\u521b\u5efa\u4e00\u4e2a\u65b0\u5185\u90e8\u8282\u70b9 P\uff0c\u9891\u6b21 = A\u4e0eB\u7684\u9891\u6b21\u4e4b\u548c\uff0c\u5de6\u5b50\u6811\u6307\u5411 A\uff0c\u53f3\u5b50\u6811\u6307\u5411 B\"]\n    F --&gt; G[\"\u5c06\u65b0\u8282\u70b9 P \u63d2\u5165\u5806\"]\n    G --&gt; D\n    D --&gt;|\"\u5426\"| H[\"\u5806\u4e2d\u53ea\u5269\u4e00\u4e2a\u8282\u70b9\uff0c\u5c06\u5176\u4f5c\u4e3a Huffman \u6811\u7684\u6839\"]\n    H --&gt; I[\"\u91ca\u653e\u5806\u7ed3\u6784\uff0c\u8fd4\u56de\u6839\u8282\u70b9\"]\n</code></pre> <ul> <li>\u7f16\u7801</li> </ul> <pre><code>flowchart TD\n    A[\"\u5f00\u59cb\u751f\u6210\u7f16\u7801\u8868\"] --&gt; B[\"\u4ece Huffman \u6811\u6839\u8282\u70b9\u51fa\u53d1\uff0c\u8def\u5f84\u5b57\u7b26\u4e32 sign = \\\"\\\"\"]\n    B --&gt; C{\"\u5f53\u524d\u8282\u70b9\u662f\u5426\u4e3a\u7a7a\uff1f\"}\n    C --&gt;|\"\u662f\"| D[\"\u76f4\u63a5\u8fd4\u56de\"]\n    C --&gt;|\"\u5426\"| E{\"\u5f53\u524d\u8282\u70b9\u662f\u5426\u4e3a\u53f6\u5b50\uff1f\"}\n    E --&gt;|\"\u662f\"| F[\"\u5982\u679c\u8def\u5f84\u957f\u5ea6\u4e3a 0\uff08\u4ec5\u4e00\u4e2a\u7b26\u53f7\uff09\uff0c\u5219\u8d4b\u7801\u201c0\u201d\uff1b\u5426\u5219\u5c06\u5f53\u524d\u8def\u5f84\u5b57\u7b26\u4e32\u4fdd\u5b58\u5230\u5bf9\u5e94\u5b57\u7b26\u7684\u7f16\u7801\u8868\"]\n    F --&gt; G[\"\u8fd4\u56de\u4e0a\u4e00\u5c42\"]\n    E --&gt;|\"\u5426\"| H{\"\u662f\u5426\u6709\u5de6\u5b50\u6811\uff1f\"}\n    H --&gt;|\"\u662f\"| I[\"\u5728\u8def\u5f84\u5c3e\u8ffd\u52a0 '0'\uff0c\u9012\u5f52\u8bbf\u95ee\u5de6\u5b50\u6811\"]\n    I --&gt; J[\"\u8fd4\u56de\u65f6\u6062\u590d\u8def\u5f84\u5b57\u7b26\u4e32\u957f\u5ea6\"]\n    H --&gt;|\"\u5426\"| J\n    J --&gt; K{\"\u662f\u5426\u6709\u53f3\u5b50\u6811\uff1f\"}\n    K --&gt;|\"\u662f\"| L[\"\u5728\u8def\u5f84\u5c3e\u8ffd\u52a0 '1'\uff0c\u9012\u5f52\u8bbf\u95ee\u53f3\u5b50\u6811\"]\n    L --&gt; M[\"\u8fd4\u56de\u65f6\u6062\u590d\u8def\u5f84\u5b57\u7b26\u4e32\u957f\u5ea6\"]\n    K --&gt;|\"\u5426\"| N[\"\u8fd4\u56de\u4e0a\u4e00\u5c42\"]\n</code></pre> <ul> <li>\u538b\u7f29</li> </ul> <pre><code>flowchart TD\n    A[\"\u5f00\u59cb\u538b\u7f29\"] --&gt; B[\"\u6253\u5f00\u539f\u59cb\u6587\u4ef6\uff0c\u82e5\u5931\u8d25\u5219\u62a5\u9519\u5e76\u9000\u51fa\"]\n    B --&gt; C[\"\u8bfb\u53d6\u6587\u4ef6\uff0c\u7edf\u8ba1\u6bcf\u4e2a\u5b57\u8282\u7684\u51fa\u73b0\u9891\u6b21\u5230 cnt[]\"]\n    C --&gt; D[\"\u56de\u5230\u6587\u4ef6\u5f00\u5934\uff0c\u6784\u9020 Info \u6570\u7ec4\uff08\u5305\u542b\u5b57\u7b26\u548c\u9891\u6b21\uff09\"]\n    D --&gt; E[\"\u8c03\u7528 buildHuffmanTree \u6784\u5efa Huffman \u6811\"]\n    E --&gt; F[\"\u521d\u59cb\u5316\u7f16\u7801\u8868\uff0c\u5c06\u8868\u7f6e\u7a7a\"]\n    F --&gt; G[\"\u9012\u5f52\u751f\u6210\u6bcf\u4e2a\u5b57\u7b26\u7684\u6bd4\u7279\u4e32\u7f16\u7801\u5230\u7f16\u7801\u8868 table\"]\n    G --&gt; H[\"\u8ba1\u7b97\u6240\u6709\u5b57\u7b26\u7f16\u7801\u540e\u7684\u603b\u6bd4\u7279\u6570 total_bits\"]\n    H --&gt; I[\"\u6839\u636e total_bits \u8ba1\u7b97\u672b\u5c3e\u8865\u96f6\u7684\u4f4d\u6570 padding\"]\n    I --&gt; J[\"\u6253\u5f00\u8f93\u51fa\u6587\u4ef6\uff0c\u82e5\u5931\u8d25\u5219\u62a5\u9519\u5e76\u9000\u51fa\"]\n    J --&gt; K[\"\u5148\u5199\u5165 256 \u4e2a\u9891\u6b21\u503c\uff08long long \u6570\u7ec4\uff09\"]\n    K --&gt; L[\"\u518d\u5199\u5165 1 \u5b57\u8282\u7684 padding \u4fe1\u606f\"]\n    L --&gt; M[\"\u521d\u59cb\u5316 BitWriter \u4ee5\u4fbf\u6309\u4f4d\u5199\u5165\"]\n    M --&gt; N[\"\u56de\u5230\u539f\u59cb\u6587\u4ef6\u5f00\u5934\"]\n    N --&gt; O{\"\u8bfb\u53d6\u4e00\u4e2a\u5b57\u8282 ch\uff1f\"}\n    O --&gt;|\"\u662f\"| P[\"\u67e5\u8868\u5f97\u5230 ch \u7684\u6bd4\u7279\u4e32\uff0c\u6309\u6bd4\u7279\u5199\u5165 BitWriter\"]\n    P --&gt; O\n    O --&gt;|\"\u5426\"| Q[\"flush BitWriter\uff0c\u5c06\u5269\u4f59\u4f4d\u586b\u5145\u540e\u5199\u51fa\"]\n    Q --&gt; R[\"\u5173\u95ed\u8f93\u5165/\u8f93\u51fa\u6587\u4ef6\"]\n    R --&gt; S[\"\u91ca\u653e Huffman \u6811\u7b49\u8d44\u6e90\"]\n    S --&gt; T[\"\u6253\u5370\u201c\u538b\u7f29\u5b8c\u6210\u201d\u4fe1\u606f\u5e76\u8fd4\u56de\"]\n</code></pre> <ul> <li>\u89e3\u538b</li> </ul> <pre><code>flowchart TD\n    A[\"\u5f00\u59cb\u89e3\u538b\"] --&gt; B[\"\u6253\u5f00\u538b\u7f29\u6587\u4ef6\uff0c\u82e5\u5931\u8d25\u5219\u62a5\u9519\u5e76\u9000\u51fa\"]\n    B --&gt; C[\"\u4f9d\u6b21\u8bfb\u53d6 256 \u4e2a\u9891\u6b21\u503c\u5230 cnt[]\"]\n    C --&gt; D[\"\u8bfb\u53d6 1 \u5b57\u8282 padding\"]\n    D --&gt; E[\"\u8ba1\u7b97\u539f\u59cb\u6587\u4ef6\u7684\u603b\u5b57\u8282\u6570 sum_cnt = \u03a3 cnt[i]\"]\n    E --&gt; F[\"\u6784\u9020 Info \u6570\u7ec4\uff0c\u5305\u542b\u51fa\u73b0\u8fc7\u7684\u5b57\u7b26\u53ca\u5176\u9891\u6b21\"]\n    F --&gt; G[\"\u8c03\u7528 buildHuffmanTree \u91cd\u5efa Huffman \u6811\"]\n    G --&gt; H[\"\u6253\u5f00\u8f93\u51fa\u6587\u4ef6\uff0c\u82e5\u5931\u8d25\u5219\u62a5\u9519\u5e76\u9000\u51fa\"]\n    H --&gt; I[\"\u521d\u59cb\u5316 BitReader \u4ee5\u4fbf\u6309\u6bd4\u7279\u8bfb\u53d6\"]\n    I --&gt; J[\"\u8bbe\u7f6e\u5199\u51fa\u8ba1\u6570 written = 0\uff0c\u4ece\u6811\u6839 node = root\"]\n    J --&gt; K{\"written &lt; sum_cnt\uff1f\"}\n    K --&gt;|\"\u5426\"| L[\"\u5173\u95ed\u6587\u4ef6\uff0c\u91ca\u653e\u8d44\u6e90\uff0c\u6253\u5370\u201c\u89e3\u538b\u5b8c\u6210\u201d\u5e76\u8fd4\u56de\"]\n    K --&gt;|\"\u662f\"| M[\"\u4ece BitReader \u4e2d\u8bfb\u53d6\u4e00\u4e2a\u6bd4\u7279 bit\"]\n    M --&gt; N{\"bit \u662f\u5426\u4e3a -1 \uff08\u7ed3\u675f\uff09\uff1f\"}\n    N --&gt;|\"\u662f\"| O[\"\u62a5\u9519\u201c\u6bd4\u7279\u6d41\u610f\u5916\u7ed3\u675f\u201d\uff0c\u9000\u51fa\u5faa\u73af\"]\n    N --&gt;|\"\u5426\"| P[\"\u5982\u679c bit=0\uff0c\u5219 node=node-&gt;\u5de6\u5b50\u6811\uff1b\u5426\u5219 node=node-&gt;\u53f3\u5b50\u6811\"]\n    P --&gt; Q{\"node \u662f\u5426\u5230\u8fbe\u53f6\u5b50\uff1f\"}\n    Q --&gt;|\"\u5426\"| K\n    Q --&gt;|\"\u662f\"| R[\"\u8f93\u51fa node \u5bf9\u5e94\u7684\u5b57\u7b26\u5230\u6587\u4ef6\uff1bwritten++; \u56de\u5230\u6811\u6839 node=root\"]\n    R --&gt; K\n</code></pre> <p>\u51fd\u6570\u8c03\u7528\u5173\u7cfb\u56fe\uff1a</p> <pre><code>flowchart LR\n    main --&gt; print_usage\n    main --&gt; compress_file\n    main --&gt; decompress_file\n\n    compress_file --&gt; buildHuffmanTree\n    compress_file --&gt; encode\n    compress_file --&gt; bw_init\n    compress_file --&gt; bw_write_code\n    compress_file --&gt; bw_flush\n    compress_file --&gt; freeHuffmanTree\n\n    decompress_file --&gt; buildHuffmanTree\n    decompress_file --&gt; br_init\n    decompress_file --&gt; br_read_bit\n    decompress_file --&gt; freeHuffmanTree\n\n    buildHuffmanTree --&gt; init\n    buildHuffmanTree --&gt; push\n    buildHuffmanTree --&gt; pop\n\n    push --&gt; _up\n\n    pop --&gt; _down\n</code></pre> <p>\u8c03\u7528\u5173\u7cfb\u8bf4\u660e\uff1a</p> <ul> <li>\u4e3b\u7a0b\u5e8f <code>main</code></li> <li>\u6839\u636e\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f <code>-c</code>\uff08\u538b\u7f29\uff09\u8fd8\u662f <code>-d</code>\uff08\u89e3\u538b\uff09\u6765\u5206\u652f\uff1a<ul> <li><code>-c</code> \u2192 \u8c03\u7528 <code>compress_file(infile, outfile)</code></li> <li><code>-d</code> \u2192 \u8c03\u7528 <code>decompress_file(infile, outfile)</code></li> </ul> </li> <li>\u538b\u7f29\u6d41\u7a0b\uff08<code>compress_file</code>\uff09</li> <li>\u5148\u7528 <code>fopen</code>/<code>fread</code> \u7edf\u8ba1\u9891\u6b21\u5230 <code>cnt[]</code></li> <li>\u5c06\u975e\u96f6\u9891\u6b21\u5c01\u88c5\u4e3a <code>Info signs[]</code>\uff0c\u8c03\u7528 <code>buildHuffmanTree</code> \u6784\u9020 Huffman \u6811</li> <li>\u8c03\u7528 <code>encode</code> \u751f\u6210 <code>table[ch]</code>\uff08\u6309 <code>sign[]</code> \u9012\u5f52\u4e0b\u53bb\u4ea7\u751f\u6bd4\u7279\u4e32\uff09</li> <li>\u8ba1\u7b97 <code>total_bits</code> \u4e0e <code>padding</code></li> <li>\u6253\u5f00\u8f93\u51fa\u6587\u4ef6\uff0c\u5199\u5165 256\u00d7<code>cnt[i]</code> + 1\u00d7<code>padding</code></li> <li>\u7528 <code>BitWriter</code>\uff08<code>bw_init</code>\u3001<code>bw_write_code</code>\u3001<code>bw_flush</code>\uff09\u6309\u4f4d\u5199\u771f\u6b63\u7684 Huffman \u6bd4\u7279\u6d41</li> <li>\u91ca\u653e\u6811\u4e0e\u4e2d\u95f4\u6570\u7ec4</li> <li>\u89e3\u538b\u6d41\u7a0b\uff08<code>decompress_file</code>\uff09</li> <li>\u5148\u7528 <code>fopen</code>/<code>fread</code> \u8bfb\u56de 256 \u4e2a <code>cnt[i]</code> + 1 \u4e2a <code>padding</code></li> <li>\u8ba1\u7b97 <code>sum_cnt = \u2211 cnt[i]</code></li> <li>\u5c06\u975e\u96f6\u9891\u6b21\u5c01\u88c5\u4e3a <code>Info signs[]</code>\uff0c\u8c03\u7528 <code>buildHuffmanTree</code> \u91cd\u5efa Huffman \u6811</li> <li>\u6253\u5f00\u8f93\u51fa\u6587\u4ef6\uff0c\u521d\u59cb\u5316 <code>BitReader</code>\uff08<code>br_init</code>\uff09</li> <li>\u5faa\u73af <code>br_read_bit</code>\uff0c\u6cbf\u6811\u4ece\u6839\u5230\u53f6\u5b50\u904d\u5386\uff0c\u9047\u5230\u53f6\u5b50\u5219 <code>fputc</code> \u8f93\u51fa\u4e00\u4e2a\u5b57\u8282\uff0c\u76f4\u5230\u5199\u6ee1 <code>sum_cnt</code> \u4e2a\u5b57\u8282</li> <li>\u91ca\u653e\u6811\u4e0e\u4e2d\u95f4\u6570\u7ec4</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C2/#4","title":"4. \u8c03\u8bd5\u5206\u6790","text":"<p>\u95ee\u9898\u4e0e\u89e3\u51b3\uff1a  </p> <ol> <li>\u5bf9\u4e8eC\u8bed\u8a00\u6587\u4ef6\u8f93\u5165\u8f93\u51fa\u4e0d\u592a\u638c\u63e1\uff0c\u901a\u8fc7\u5927\u6a21\u578b\u4e86\u89e3\u4e86\u76f8\u5173\u7684\u8bed\u53e5\u548c\u7528\u6cd5\u3002</li> <li>\u5bf9\u4e8e\u4e8c\u53c9\u5806\u7684\u5b9e\u73b0\u4e0d\u592a\u4e86\u89e3\uff0c\u5728OI-wiki\u4e0a\u627e\u5230\u4e86\u76f8\u5173\u8d44\u6599\u3002</li> <li>\u4e00\u5f00\u59cb\u6ca1\u6709\u8003\u8651\u5230\u5b57\u7b26\u4fe1\u606f\uff0c\u53ea\u7edf\u8ba1\u4e86\u9891\u6b21\uff0c\u53d1\u73b0\u8fd9\u6837\u5728\u540e\u7eed\u7f16\u7801\u4f1a\u5f88\u9ebb\u70e6\uff0c\u8bbe\u8ba1\u4e86\u7ed3\u6784\u4f53\u5c06\u4e8c\u8005\u7ed1\u5b9a\u3002</li> <li>\u5bf9\u4e8e\u53ea\u6709\u5355\u4e2a\u5b57\u7b26\u4e0d\u65ad\u91cd\u590d\u7684\u6587\u4ef6\uff0c\u904d\u5386Huffman\u6811\u65f6\u4f1a\u51fa\u73b0\u95ee\u9898\uff0c\u901a\u8fc7\u7279\u6b8a\u5224\u65ad\u89e3\u51b3\u3002</li> </ol> <p>\u6539\u8fdb\u65b9\u5411\uff1a  </p> <ul> <li>\u5224\u65ad\u6587\u4ef6\u7c7b\u578b\uff0c\u5982\u679c\u662f\u5df2\u7ecf\u538b\u7f29\u8fc7\u7684\u6587\u4ef6\uff0c\u4e0d\u518d\u8fdb\u884c\u538b\u7f29\u3002</li> <li>\u5224\u65ad\u6587\u4ef6\u5927\u5c0f\uff0c\u5982\u679c\u6587\u4ef6\u5f88\u5c0f\uff0c\u5199\u5165\u9891\u6b21\u8868\u5360\u7528\u7684\u7a7a\u95f4\u5f00\u9500\u66f4\u5927\uff0c\u5219\u4e0d\u8fdb\u884c\u538b\u7f29\u3002</li> </ul>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C2/#5","title":"5. \u7528\u6237\u4f7f\u7528\u8bf4\u660e","text":"<p>\u8fd0\u884c\u73af\u5883\uff1a<code>GCC 13.2.0</code></p> <pre><code>\u7528\u6cd5\uff1a\n  \u538b\u7f29\uff1a\u7a0b\u5e8f\u8def\u5f84 -c \u539f\u59cb\u6587\u4ef6\u8def\u5f84 \u538b\u7f29\u540e\u6587\u4ef6\u8def\u5f84\n  \u89e3\u538b\uff1a\u7a0b\u5e8f\u8def\u5f84 -d \u538b\u7f29\u6587\u4ef6\u8def\u5f84 \u89e3\u538b\u540e\u6587\u4ef6\u8def\u5f84\n</code></pre> <p>\u8f93\u5165\u793a\u4f8b\uff1a  </p> <pre><code>PS D:\\wyk\\Study\\DataStructure&gt; .\\compress.exe -c .\\kmp.c .\\kmp.huf  \n</code></pre> <p>\u8f93\u51fa\u793a\u4f8b\uff1a  </p> <pre><code>\u538b\u7f29\u5b8c\u6210\uff1a\".\\kmp.c\" \u2192 \".\\kmp.huf\"\n\u539f\u59cb\u5b57\u8282\u603b\u6570 = 496\uff0c\u538b\u7f29\u540e\u6bd4\u7279\u6d41\u603b\u4f4d\u6570 = 2153\uff0cpadding = 7\n\uff0c\u538b\u7f29\u540e\u5b57\u8282\u603b\u6570 = 270\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C2/#6","title":"6. \u6d4b\u8bd5\u7ed3\u679c","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C2/#1_1","title":"\u6d4b\u8bd51","text":"<p>\u8f93\u51651\uff1a</p> <pre><code>PS D:\\wyk\\Study\\DataStructure&gt; .\\compress.exe -c .\\kmp.c .\\kmp.huf  \n</code></pre> <p>\u8f93\u51fa1\uff1a</p> <pre><code>\u538b\u7f29\u5b8c\u6210\uff1a\".\\kmp.c\" \u2192 \".\\kmp.huf\"\n\u539f\u59cb\u5b57\u8282\u603b\u6570 = 496\uff0c\u538b\u7f29\u540e\u6bd4\u7279\u6d41\u603b\u4f4d\u6570 = 2153\uff0cpadding = 7\n\uff0c\u538b\u7f29\u540e\u5b57\u8282\u603b\u6570 = 270\n</code></pre> <p>\u8f93\u51652\uff1a</p> <pre><code>PS D:\\wyk\\Study\\DataStructure&gt; .\\compress.exe -d .\\kmp.huf .\\kmp.cpp\n</code></pre> <p>\u8f93\u51fa2\uff1a</p> <pre><code>\u89e3\u538b\u5b8c\u6210\uff1a\".\\kmp.huf\" \u2192 \".\\kmp.cpp\"\n\u5171\u8fd8\u539f\u539f\u59cb\u5b57\u8282\u6570 = 496\n</code></pre>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C2/#_1","title":"\u6bd4\u8f83\u89e3\u538b\u540e\u7684\u6587\u4ef6\u548c\u539f\u6587\u4ef6\u5185\u5bb9","text":"<p>kmp.c</p> <pre><code>#include &lt;stdio.h&gt;\nvoid get_nextval(char T[], int nextval[]) {\n    int i = 1, j = 0;\n    nextval[1] = 0;\n    while (i &lt; T[0]) {\n        if (j == 0 || T[i] == T[j]) {\n            ++i, ++j;\n            if (T[i] != T[j]) nextval[i] = j;\n            else nextval[i] = nextval[j];\n        } else {\n            j = nextval[j];\n        }\n    }\n}\nint main() {\n    char t[7] = {7, 'a', 'a', 'a', 'a', 'b', '\\0'};\n    int nextval[10] = {0};\n    get_nextval(t, nextval);\n    return 0;\n}\n</code></pre> <p>kmp.cpp</p> <pre><code>#include &lt;stdio.h&gt;\nvoid get_nextval(char T[], int nextval[]) {\n    int i = 1, j = 0;\n    nextval[1] = 0;\n    while (i &lt; T[0]) {\n        if (j == 0 || T[i] == T[j]) {\n            ++i, ++j;\n            if (T[i] != T[j]) nextval[i] = j;\n            else nextval[i] = nextval[j];\n        } else {\n            j = nextval[j];\n        }\n    }\n}\nint main() {\n    char t[7] = {7, 'a', 'a', 'a', 'a', 'b', '\\0'};\n    int nextval[10] = {0};\n    get_nextval(t, nextval);\n    return 0;\n}\n</code></pre> <p>\u5185\u5bb9\u5b8c\u5168\u4e00\u81f4\u3002</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C2/#_2","title":"\u5bf9\u6bd4\u538b\u7f29\u540e\u7684\u6587\u4ef6\u5927\u5c0f","text":"<p>\u53d1\u73b0\u538b\u7f29\u540e\u6587\u4ef6\u53cd\u800c\u53d8\u5927\uff0c\u8fd9\u662f\u7531\u4e8ekmp.c\u592a\u5c0f\uff0c\u5199\u5165\u9891\u7387\u8868\u5360\u7528\u7684\u7a7a\u95f4\u53cd\u800c\u66f4\u5927\u3002</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%85%AD%E7%AB%A0%E5%AE%9E%E9%AA%8C2/#2_1","title":"\u6d4b\u8bd52","text":"<p>\u751f\u62101GB\u51680\u4e8c\u8fdb\u5236\u6587\u4ef6</p> <pre><code>PS D:\\wyk\\Study\\DataStructure&gt; fsutil file createnew .\\big.bin 1073741824             \n\u5df2\u521b\u5efa\u6587\u4ef6 D:\\wyk\\Study\\DataStructure\\big.bin\n</code></pre> <p>\u538b\u7f29</p> <pre><code>PS D:\\wyk\\Study\\DataStructure&gt; .\\compress.exe -c .\\big.bin .\\big.huf\n\u538b\u7f29\u5b8c\u6210\uff1a\".\\big.bin\" \u2192 \".\\big.huf\"\n\u539f\u59cb\u5b57\u8282\u603b\u6570 = 1073741824\uff0c\u538b\u7f29\u540e\u6bd4\u7279\u6d41\u603b\u4f4d\u6570 = 1073741824\uff0cpadding = 0\n\uff0c\u538b\u7f29\u540e\u5b57\u8282\u603b\u6570 = 134217728\n</code></pre> <p>\u89e3\u538b</p> <pre><code>PS D:\\wyk\\Study\\DataStructure&gt; .\\compress.exe -d .\\big.huf .\\big2.bin\n\u89e3\u538b\u5b8c\u6210\uff08\u5355\u7b26\u53f7\u4f18\u5316\uff09\uff1a\".\\big.huf\" \u2192 \".\\big2.bin\"\uff0c\u5199\u5165 1073741824 \u5b57\u8282\n</code></pre> <p>\u5bf9\u6bd4<code>big.bin</code>\u4e0e<code>big.huf</code>\u7684\u5927\u5c0f\uff1a</p> <p></p> <p></p> <p>1GB\u7684\u6587\u4ef6\u88ab\u538b\u7f29\u5230\u4e86128MB\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u5bf9\u4e8e\u5b57\u7b26\u9891\u7387\u5dee\u5f02\u663e\u8457\u7684\u6587\u4ef6\uff0c\u538b\u7f29\u7387\u5f88\u9ad8\u3002</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%8D%81%E7%AB%A0%E4%BD%9C%E4%B8%9A/","title":"\u6570\u636e\u7ed3\u6784\u7b2c\u5341\u7ae0\u4f5c\u4e1a","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%8D%81%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_2","title":"\u7b2c\u4e00\u9898","text":"<p>\u5047\u8bbe\u4e00\u6b21I/O\u7684\u7269\u7406\u5757\u5927\u5c0f\u4e3a150\uff0c\u6bcf\u6b21\u53ef\u5bf9750\u4e2a\u8bb0\u5f55\u8fdb\u884c\u5185\u90e8\u6392\u5e8f\uff0c\u90a3\u4e48\u5bf9\u542b\u6709150000\u4e2a\u8bb0\u5f55\u7684\u78c1\u76d8\u6587\u4ef6\u8fdb\u884c4-\u8def\u5e73\u8861\u5f52\u5e76\u6392\u5e8f\u65f6\uff0c\u5171\u9700\u8fdb\u884c\u591a\u5c11\u6b21I/O?</p> <p>\u89e3:</p> <p>\u5171200\u4e2a\u5f52\u5e76\u6bb5\uff0c\\(\\lceil \\log_{4}{200} \\rceil = 4\\) \u8d9f\u5f52\u5e76\u3002I/O\u6b21\u6570\u4e3a\u5185\u90e8\u6392\u5e8f\u5f97\u5230\u5f52\u5e76\u6bb5\u52a0\u4e0a\u5f52\u5e76\u6240\u9700\u7684I/O\u3002\\(T=1000\\times 2 + 4 \\times 1000 \\times 2 = 10000\\)</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%8D%81%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_3","title":"\u7b2c\u4e8c\u9898","text":"<p>\u8bd5\u4ece\u7a7a\u6811\u5f00\u59cb\uff0c\u753b\u51fa\u6309\u4ee5\u4e0b\u6b21\u5e8f\u54113\u9636B-\u6811\u4e2d\u63d2\u5165\u5173\u952e\u7801\u7684\u5efa\u6811\u8fc7\u7a0b\uff1a20\uff0c30\uff0c50\uff0c52\uff0c60\uff0c68\uff0c70\u3002\u5982\u679c\u6b64\u540e\u5220\u966450\u548c68\uff0c\u753b\u51fa\u6bcf\u4e00\u6b65\u6267\u884c\u540eB-\u6811\u7684\u72b6\u6001\u3002</p> <p>\u89e3\uff1a</p> <p> $$ \\text{I/O\u6b21\u6570}=((4+7)\\times3+(9+12+18+23+31)\\times 2 + 47 \\times 1)=266 $$</p>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%9B%9B%E7%AB%A0%E4%BD%9C%E4%B8%9A/","title":"\u6570\u636e\u7ed3\u6784\u7b2c\u56db\u7ae0\u4f5c\u4e1a","text":""},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%9B%9B%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_2","title":"\u7b2c\u4e00\u9898","text":"<p>\u5206\u522b\u6c42\u51fa\u4e0b\u5217\u6a21\u5f0f\u4e32\u7684next\u548cnextval\u6570\u7ec4\u503c\u3002</p> <p>\u89e3\uff1a</p> <ol> <li><code>t1 = 'aaab'</code></li> <li>next : 0 1 2 3</li> <li>nextval: 0 0 0 3</li> <li><code>t2 = 'abcabaa'</code></li> <li>next: 0 1 1 1 2 3 2</li> <li>nextval: 0 1 1 0 1 3 2</li> <li><code>t3 = 'adabbadada'</code></li> <li>next: 0 1 1 2 1 1 2 3 2 3</li> <li>nextval: 0 1 0 2 1 0 1 0 4 0</li> </ol>"},{"location":"course/DataStructure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E5%9B%9B%E7%AB%A0%E4%BD%9C%E4%B8%9A/#_3","title":"\u7b2c\u4e8c\u9898","text":"<p>\u91cd\u590d\u5b50\u4e32\u7684\u542b\u4e49\u662f\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u8fde\u7eed\u76f8\u7b49\u7684\u5b57\u7b26\u7ec4\u6210\u7684\u5b50\u4e32\uff08\u4e0d\u91cd\u53e0\uff09\uff1b\u73b0\u6709\u67d0\u4e2a\u4e32\u7528\u4e00\u7ef4\u5b57\u7b26\u6570\u7ec4s\u5b58\u50a8\uff0c\u957f\u5ea6\u4e3an\uff0c\u8bbe\u8ba1\u7b97\u6cd5\u6c42s\u7684\u6700\u957f\u91cd\u590d\u5b50\u4e32\u7684\u957f\u5ea6\u3002</p> <p>\u89e3\u6cd5\u4e00\uff1a</p> <p>\u6734\u7d20\u7684\u66b4\u529b\u505a\u6cd5\u662f\u975e\u5e38\u663e\u7136\u7684\uff0c\u8f93\u5165\u5b57\u7b26\u4e32\u7684\u6bcf\u4e00\u4e2a\u5b50\u4e32\u90fd\u6709\u53ef\u80fd\u6210\u4e3a\u91cd\u590d\u5b50\u4e32\uff0c\u6211\u4eec\u53ea\u9700\u679a\u4e3e\u91cd\u590d\u5b50\u4e32\uff0c\u518d\u4f7f\u7528KMP\u8fdb\u884c\u6a21\u5f0f\u5339\u914d\uff0c\u6700\u540e\u68c0\u67e5\u4e0d\u91cd\u53e0\u4f4d\u7f6e\u7684\u5339\u914d\u6570\u91cf\u662f\u5426\u5927\u4e8e1\uff0c\u53d6\u6ee1\u8db3\u6761\u4ef6\u7684\u6700\u957f\u5b50\u4e32\u957f\u5ea6\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 \\(O(n^3)\\)\u3002</p> <pre><code>int LongestString(char s[], int n) {\n    int ans = 0;\n    for (int l = 0; l &lt; n; l++) {\n        for (int r = l + 1; r &lt;= n; r++) {\n            // \u679a\u4e3e\u5b50\u4e32s[l,r), \u8fdb\u884c\u6a21\u5f0f\u5339\u914d\n            int len = r - l;\n            int* next =  (int*) calloc(len, sizeof(int));\n            next[0] = 0;\n            for (int i = 1, j = 0; i &lt; len; i++) {\n                while (j &gt; 0 &amp;&amp; s[l+i] != s[l+j]) j = next[j-1];\n                if (s[l+i] == s[l+j]) ++j;\n                next[i] = j;\n            }\n            // \u7edf\u8ba1\u5339\u914d\u4e2a\u6570\n            int match = 0;\n            for (int i = 0, j = 0; i &lt; n; i++) {\n                while (j &gt; 0 &amp;&amp; s[i] != s[l+j]) j = next[j-1];\n                if (s[i] == s[l+j]) ++j;\n                if (j == len) {\n                    // \u4e0d\u91cd\u53e0\u5339\u914d\n                    j = 0;\n                    match++;\n                }\n            }\n            if (match &gt; 1 &amp;&amp; len &gt; ans) {\n                ans = len;\n            }\n            free(next);\n        }\n    }\n    return ans;\n}\n</code></pre> <p>\u89e3\u6cd5\u4e8c\uff1a</p> <p>\u6ce8\u610f\u5230\u91cd\u590d\u5b50\u4e32\u7684\u957f\u5ea6\u5177\u6709\u5355\u8c03\u6027\uff0c\u5373\u5982\u679c \\(L\\) \u662f\u6700\u957f\u91cd\u590d\u5b50\u4e32\u957f\u5ea6\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6240\u6709 \\(x \\le L\\)\uff0c\u90fd\u5b58\u5728\u957f\u5ea6\u4e3a \\(x\\) \u7684\u91cd\u590d\u5b50\u4e32\u3002\u57fa\u4e8e\u8fd9\u4e00\u6027\u8d28\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u5b50\u4e32\u957f\u5ea6\u8fdb\u884c\u4e8c\u5206\uff0c\u6bcf\u6b21\u679a\u4e3e\u56fa\u5b9a\u957f\u5ea6\u7684\u5b50\u4e32\uff0c\u7136\u540e\u4f7f\u7528KMP\u6a21\u5f0f\u5339\u914d\u6765\u8fdb\u884c\u9a8c\u8bc1\u3002\u65f6\u95f4\u590d\u6742\u5ea6 \\(O(n^2log{n})\\)\u3002</p> <pre><code>int LongestString(char s[], int n) {\n    int L = 0, R = n / 2, ans = 0;\n    while (L &lt;= R) {\n        // \u4e8c\u5206\u957f\u5ea6\n        int len = (L + R) / 2;\n        bool ok = false;\n        for (int p = 0; p + len &lt;= n &amp;&amp; !ok; p++) {\n            // \u6a21\u5f0f\u5339\u914d\n            int* next = (int*)calloc(len, sizeof(int));\n            for (int i = 1, j = 0; i &lt; len; i++) {\n                while (j &gt; 0 &amp;&amp; s[p + i] != s[p + j]) j = next[j - 1];\n                if (s[p + i] == s[p + j]) ++j;\n                next[i] = j;\n            }\n            int match = 0;\n            for (int i = 0, j = 0; i &lt; n; i++) {\n                while (j &gt; 0 &amp;&amp; s[p + i] != s[p + j]) j = next[j - 1];\n                if (s[i] == s[p + j]) ++j;\n                if (j == len) {\n                    match++;\n                    j = 0;\n                }\n            }\n            if (match &gt;= 2) {\n                ok = true;\n            }\n        }\n        if (ok) {\n            ans = len;\n            L = len + 1;\n        } else {\n            R = len - 1;\n        }\n    }\n    return ans;\n}\n</code></pre> <p>\u89e3\u6cd5\u4e09\uff1a</p> <p>\u4ee5\u4e0a\u4e24\u4e2a\u89e3\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u74f6\u9888\u90fd\u5728\u4e8e\u679a\u4e3e\u5b50\u4e32\u3002\u4e8b\u5b9e\u4e0a\uff0c\u6211\u4eec\u6240\u9700\u8981\u7684\u5b50\u4e32\u53ea\u662f\u5f88\u5c11\u7684\u4e00\u90e8\u5206\uff0c\u60f3\u8981\u8fdb\u4e00\u6b65\u4f18\u5316\uff0c\u5173\u952e\u5728\u4e8e\u627e\u5230\u4e00\u4e2a\u9ad8\u6548\u5730\u679a\u4e3e\u5b50\u4e32\u7684\u65b9\u6cd5\u3002\u6ce8\u610f\u5230\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u5b50\u4e32\u5fc5\u7136\u662f\u8fd9\u4e2a\u5b57\u7b26\u4e32\u67d0\u4e00\u540e\u7f00\u7684\u524d\u7f00\uff0c\u6709\u4ee5\u4e0b\u89e3\u6cd5\uff1a</p> <ol> <li> <p>\u5c06\u5b57\u7b26\u4e32s\u7684\u6240\u6709\u540e\u7f00\u6309\u7167\u5b57\u5178\u5e8f\u8fdb\u884c\u6392\u5e8f\u3002</p> </li> <li> <p>\u6c42\u51fa\u6392\u5e8f\u540e\u76f8\u90bb\u540e\u7f00\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\u3002\uff08\u6211\u4eec\u8981\u6c42\u7684\u91cd\u590d\u5b50\u4e32\u5fc5\u7136\u51fa\u73b0\u5728\u516c\u5171\u524d\u7f00\u4e2d\uff09</p> </li> <li> <p>\u5bf9\u4e8e\u6bcf\u4e2a\u6700\u957f\u516c\u5171\u524d\u7f00\uff0c\u901a\u8fc7\u5176\u5728\u540e\u7f00\u4e2d\u7684\u4f4d\u7f6e\u5224\u65ad\u662f\u5426\u91cd\u53e0\uff0c\u5bf9\u4e8e\u4e0d\u91cd\u53e0\u7684\uff0c\u66f4\u65b0\u7b54\u6848</p> </li> </ol> <p>\u8fd9\u91cc\u6211\u4eec\u9700\u8981\u7528\u5230\u540e\u7f00\u6570\u7ec4\uff0c\u4e0b\u9762\u8be6\u7ec6\u9610\u8ff0\uff1a</p> <p>\u5b9a\u4e49 \\(sa_i\\) \u4e3a\u5c06\u6240\u6709\u540e\u7f00\u6309\u7167\u5b57\u5178\u5e8f\u6392\u5e8f\u540e\u7b2c \\(i\\) \u5c0f\u7684\u540e\u7f00\u7f16\u53f7\uff0c\u4e5f\u5c31\u662f\u540e\u7f00\u6570\u7ec4\uff1b\u5b9a\u4e49 \\(rk_i\\) \u8868\u793a\u540e\u7f00 \\(i\\) \u7684\u6392\u540d\u3002\u5b57\u7b26\u4e32\u4e0b\u6807\u4ece \\(1\\) \u5f00\u59cb\u3002</p> <p></p> <p>\u7b2c\u4e00\u6b65\uff0c\u6211\u4eec\u9700\u8981\u9884\u5904\u7406 \\(sa\\)\u548c \\(rk\\) \u4e24\u4e2a\u6570\u7ec4\uff0c\u9ad8\u6548\u5730\u9884\u5904\u7406\u9700\u8981\u8fd0\u7528\u500d\u589e\uff1a</p> <p>\u500d\u589e\u8fc7\u7a0b\uff1a</p> <ol> <li> <p>\u7528\u4e24\u4e2a\u957f\u5ea6\u4e3a \\(1\\) \u7684\u5b50\u4e32\u7684\u6392\u540d\uff0c\u5373 \\(rk_1[i]\\) \u548c \\(rk_1[i+1]\\)\uff0c\u4f5c\u4e3a\u6392\u5e8f\u7684\u7b2c\u4e00\u7b2c\u4e8c\u5173\u952e\u5b57\uff0c\u5c31\u53ef\u4ee5\u5bf9\u5b57\u7b26\u4e32 \\(s\\) \u7684\u6bcf\u4e2a\u957f\u5ea6\u4e3a \\(2\\) \u7684\u5b50\u4e32\uff1a\\(\\{s[i\\dots \\min(i+1, n)]\\ |\\ i \\in [1,\\ n]\\}\\) \u8fdb\u884c\u6392\u5e8f\uff0c\u5f97\u5230 \\(sa_2\\) \u548c \\(rk_2\\)\uff1b</p> </li> <li> <p>\u4e4b\u540e\u7528\u4e24\u4e2a\u957f\u5ea6\u4e3a \\(2\\) \u7684\u5b50\u4e32\u7684\u6392\u540d\uff0c\u5373 \\(rk_2[i]\\) \u548c \\(rk_2[i+2]\\)\uff0c\u4f5c\u4e3a\u6392\u5e8f\u7684\u7b2c\u4e00\u7b2c\u4e8c\u5173\u952e\u5b57\uff0c\u5c31\u53ef\u4ee5\u5bf9\u5b57\u7b26\u4e32 \\(s\\) \u7684\u6bcf\u4e2a\u957f\u5ea6\u4e3a \\(4\\) \u7684\u5b50\u4e32\uff1a\\(\\{s[i\\dots \\min(i+3, n)]\\ |\\ i \\in [1,\\ n]\\}\\) \u8fdb\u884c\u6392\u5e8f\uff0c\u5f97\u5230 \\(sa_4\\) \u548c \\(rk_4\\)\uff1b</p> </li> <li> <p>\u4ee5\u6b64\u500d\u589e\uff0c\u7528\u957f\u5ea6\u4e3a \\(w/2\\) \u7684\u5b50\u4e32\u7684\u6392\u540d\uff0c\u5373 \\(rk_{w/2}[i]\\) \u548c \\(rk_{w/2}[i+w/2]\\)\uff0c\u4f5c\u4e3a\u6392\u5e8f\u7684\u7b2c\u4e00\u7b2c\u4e8c\u5173\u952e\u5b57\uff0c\u5c31\u53ef\u4ee5\u5bf9\u5b57\u7b26\u4e32 \\(s\\) \u7684\u6bcf\u4e2a\u957f\u5ea6\u4e3a \\(w\\) \u7684\u5b50\u4e32 \\(s[i\\dots \\min(i+w-1,\\ n)]\\) \u8fdb\u884c\u6392\u5e8f\uff0c\u5f97\u5230 \\(sa_w\\) \u548c \\(rk_w\\)\u3002\u5176\u4e2d\uff0c\u7c7b\u4f3c\u5b57\u6bcd\u5e8f\u6392\u5e8f\u89c4\u5219\uff0c\u5f53 \\(i+w&gt;n\\) \u65f6\uff0c\\(rk_w[i+w]\\) \u89c6\u4e3a\u65e0\u7a77\u5c0f\uff1b</p> </li> <li> <p>\\(rk_w[i]\\) \u5373\u662f\u5b50\u4e32 \\(s[i\\dots i + w - 1]\\) \u7684\u6392\u540d\uff0c\u8fd9\u6837\u5f53 \\(w \\geqslant n\\) \u65f6\uff0c\u5f97\u5230\u7684\u7f16\u53f7\u6570\u7ec4 \\(sa_w\\)\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u9700\u8981\u7684\u540e\u7f00\u6570\u7ec4\u3002</p> </li> </ol> <p></p> <p>\u500d\u589e\u7684\u8fc7\u7a0b\u662f \\(O(\\log n)\\)\uff0c\u6bcf\u6b21\u500d\u589e\u4f7f\u7528\u57fa\u6570\u6392\u5e8f \\(O(n)\\)\uff0c\u6bcf\u6b21\u5b50\u4e32\u7684\u6bd4\u8f83\u82b1\u8d39 \\(2\\) \u6b21\u5b57\u7b26\u6bd4\u8f83\uff0c\u56e0\u6b64\u9884\u5904\u7406\u7684\u590d\u6742\u5ea6\u662f \\(O(n\\log{n})\\)\u3002</p> <p>\u7b2c\u4e8c\u6b65\uff0c\u6211\u4eec\u9700\u8981\u6c42\u51fa\u5b57\u5178\u5e8f\u76f8\u90bb\u540e\u7f00\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\u3002</p> <p>\u5b9a\u4e49 \\(lcp(i, j)\\) \u4e3a\u540e\u7f00 \\(i\\) \u548c \\(j\\) \u7684\u6700\u957f\u516c\u5171\u524d\u7f00\u957f\u5ea6\uff0c\u5b9a\u4e49 \\(height_i =  \\begin{cases} \\operatorname{lcp}(sa_i, sa_{i-1}), &amp; i &gt; 1 \\\\ 0, &amp; i = 1 \\end{cases}\\)\u200b\u3002</p> <p>\u6211\u4eec\u6709\u5f15\u7406\uff1a $$ height[rk[i]]\\ge height[rk[i-1]]-1 $$ \u8fd9\u662f\u7531\u540e\u7f00\u5b57\u5178\u5e8f\u6392\u5e8f\u7684\u7ed3\u679c\uff0c\u8bc1\u660e\u7565\u3002</p> <p>\u4ece\u800c\u6211\u4eec\u53ef\u4ee5\u9ad8\u6548\u5730\u6c42\u51fa \\(height\\) \u6570\u7ec4\uff1a</p> <pre><code>for (i = 1, k = 0; i &lt;= n; ++i) {\n  if (rk[i] == 0) continue;\n  if (k) --k;\n  while (s[i + k] == s[sa[rk[i] - 1] + k]) ++k;\n  height[rk[i]] = k;\n}\n</code></pre> <p>k\u6700\u591a\u51cfn\u6b21\uff0c\u6700\u591a\u52a02n\u6b21\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a \\(O(n)\\)\u3002</p> <p>\u7b2c\u4e09\u6b65\uff0c\u6211\u4eec\u904d\u5386 \\(height\\) \u6570\u7ec4\uff0c\u5982\u679c \\(sa_i-sa_{i-1}\\ge height_i\\) \u8bf4\u660e \\(height_i\\) \u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4e0d\u91cd\u53e0\u91cd\u590d\u5b50\u4e32\u957f\u5ea6\u3002\u53d6\u6700\u5927\u503c\u5c31\u5f97\u5230\u4e86\u6211\u4eec\u6700\u7ec8\u8981\u6c42\u7684\u7b54\u6848\u3002\u65f6\u95f4\u590d\u6742\u5ea6 \\(O(n)\\)\u3002</p> <p>\u7efc\u4e0a\uff0c\u6211\u4eec\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6 \\(T(n)=O(n\\log n) + O(n) + O(n) = O(n \\log n)\\)\u3002</p> <p>\u5982\u679c\u91c7\u7528DC3\u7b97\u6cd5\u8fdb\u884c\u540e\u7f00\u6570\u7ec4\u7684\u9884\u5904\u7406\uff0c\u8fd8\u53ef\u4ee5\u4f18\u5316\u5230 \\(O(n)\\)\u3002\u4f46\u662f\u5e38\u6570\u8f83\u5927\uff0c\u5b9e\u73b0\u8f83\u590d\u6742\uff0c\u8fd9\u91cc\u4e0d\u518d\u6df1\u5165\u8ba8\u8bba\u3002</p> <p>\u5168\u90e8\u5b9e\u73b0\u4ee3\u7801\uff1a</p> <pre><code>// \u51fd\u6570\u529f\u80fd\uff1a\u6784\u9020\u540e\u7f00\u6570\u7ec4\n// \u53c2\u6570\uff1a\n//    s     : \u8f93\u5165\u5b57\u7b26\u4e32\uff0c\u8981\u6c42\u4ece\u4e0b\u6807 1 \u5f00\u59cb\u5b58\u653e\uff0cs[1..n]\n//    n     : \u5b57\u7b26\u4e32\u957f\u5ea6\n//    sa    : \u5b58\u653e\u6784\u9020\u51fa\u7684\u540e\u7f00\u6570\u7ec4\uff0csa[1..n]\uff1bsa[i] \u8868\u793a\u7b2c i \u5c0f\u7684\u540e\u7f00\u7684\u8d77\u59cb\u4f4d\u7f6e\n//    rk    : \u6392\u540d\u6570\u7ec4\uff0crk[1..(n&lt;&lt;1)]\uff0c\u4fdd\u5b58\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u6392\u540d\n//    oldrk : \u8f85\u52a9\u6570\u7ec4\uff0c\u4e0e rk \u5927\u5c0f\u76f8\u540c\uff0c\u5b58\u653e\u4e0a\u4e00\u8f6e\u7684\u6392\u540d\n//    id    : \u8f85\u52a9\u6570\u7ec4\uff0c\u7528\u4e8e\u8ba1\u6570\u6392\u5e8f\u8fc7\u7a0b\u4e2d\u5b58\u653e\u4e0b\u6807\uff08\u5927\u5c0f &gt;= n+1\uff09\n//    cnt   : \u8ba1\u6570\u6570\u7ec4\uff0c\u5927\u5c0f\u81f3\u5c11\u5e94\u80fd\u5bb9\u7eb3\u5404\u4e2a\u53ef\u80fd\u53d6\u503c\u7684\u6392\u540d\uff08\u4e00\u822c \u2265 n+1 \u6216\u66f4\u5927\uff09\nvoid build_sa(const char s[], int n, int sa[], int rk[], int oldrk[], int id[], int cnt[]) {\n    int i, m, p, w;\n    // \u521d\u59cb m \u53d6\u5b57\u7b26\u96c6\u7684\u6700\u5927 ASCII \u503c\uff0c\u8fd9\u91cc\u5047\u8bbe s \u4e2d\u5b57\u7b26 ASCII \u8303\u56f4\u5728 [1,127]\n    m = 127;\n    // \u7edf\u8ba1\u5b57\u7b26\u9891\u7387\uff0c\u5e76\u521d\u59cb\u5316 rk \u6570\u7ec4\n    // \u6ce8\u610f s \u4ece\u4e0b\u6807 1 \u5f00\u59cb\uff0c\u6545 i \u4ece 1 \u5230 n\n    for (i = 1; i &lt;= n; ++i) {\n        rk[i] = s[i];      // \u521d\u59cb\u5316\u6392\u540d\u4e3a\u5bf9\u5e94\u5b57\u7b26\u7684 ASCII \u503c\n        cnt[ rk[i] ]++;    // \u7edf\u8ba1\u9891\u6570\n    }\n    // \u7d2f\u52a0\u8ba1\u6570\u6570\u7ec4\n    for (i = 1; i &lt;= m; ++i)\n        cnt[i] += cnt[i - 1];\n    // \u5229\u7528\u8ba1\u6570\u6392\u5e8f\u6784\u9020\u521d\u59cb sa \u6570\u7ec4\n    for (i = n; i &gt;= 1; --i)\n        sa[ cnt[rk[i]]-- ] = i;\n    // \u5c06\u521d\u59cb\u6392\u540d\u590d\u5236\u5230 oldrk \u6570\u7ec4\n    memcpy(oldrk + 1, rk + 1, n * sizeof(int));\n    // \u66f4\u65b0 rk \u6570\u7ec4\uff1a\u5bf9\u4e8e sa \u4e2d\u76f8\u90bb\u4e0b\u6807\u76f8\u540c\u5219\u4fdd\u6301\u76f8\u540c\u6392\u540d\uff0c\u5426\u5219\u6392\u540d\u52a0 1\n    for (p = 0, i = 1; i &lt;= n; ++i) {\n        if (i &gt; 1 &amp;&amp; oldrk[ sa[i] ] == oldrk[ sa[i - 1] ])\n            rk[ sa[i] ] = p;\n        else\n            rk[ sa[i] ] = ++p;\n    }\n\n    // \u4e3b\u5faa\u73af\uff1a w \u8868\u793a\u6bd4\u8f83\u7684\u957f\u5ea6\uff0c\u521d\u59cb w = 1\uff0c\u6bcf\u8f6e w \u7ffb\u500d\uff0c\u76f4\u5230 w &gt;= n\n    for (w = 1; w &lt; n; w &lt;&lt;= 1, m = n) {\n        // \u5bf9\u7b2c\u4e8c\u5173\u952e\u5b57\uff1a\u5bf9\u4e8e\u4e0b\u6807 i \u7684\u7b2c\u4e8c\u5173\u952e\u5b57\u4e3a rk[i + w]\n        // \u5148\u5c06\u5f53\u524d sa \u590d\u5236\u5230\u8f85\u52a9\u6570\u7ec4 id\n        memcpy(id + 1, sa + 1, n * sizeof(int));\n        // \u8ba1\u6570\u6570\u7ec4\u6e05\u96f6\n        memset(cnt, 0, (m + 1) * sizeof(int));  \n        // \u6839\u636e\u7b2c\u4e8c\u5173\u952e\u5b57\u7edf\u8ba1\u9891\u6570\uff0c\u6ce8\u610f\uff1a\u82e5 i+w \u8d85\u51fa\u8303\u56f4\uff0c\u5219 rk[i+w] \u9ed8\u8ba4\u4e3a 0\n        for (i = 1; i &lt;= n; ++i)\n            cnt[ rk[id[i] + w] ]++;\n        // \u7d2f\u52a0\u8ba1\u6570\n        for (i = 1; i &lt;= m; ++i)\n            cnt[i] += cnt[i - 1];\n        // \u6839\u636e\u7b2c\u4e8c\u5173\u952e\u5b57\u9006\u5e8f\u6392\u5e8f\uff0c\u66f4\u65b0 sa \u6570\u7ec4\n        for (i = n; i &gt;= 1; --i)\n            sa[ cnt[ rk[id[i] + w] ]-- ] = id[i];\n\n        // \u5bf9\u7b2c\u4e00\u5173\u952e\u5b57\uff1a\u5373 rk[ i ]\uff0c\u540c\u6837\u91c7\u7528\u8ba1\u6570\u6392\u5e8f\n        memcpy(id + 1, sa + 1, n * sizeof(int));\n        memset(cnt, 0, (m + 1) * sizeof(int));\n        for (i = 1; i &lt;= n; ++i)\n            cnt[ rk[id[i] ] ]++;\n        for (i = 1; i &lt;= m; ++i)\n            cnt[i] += cnt[i - 1];\n        for (i = n; i &gt;= 1; --i)\n            sa[ cnt[ rk[id[i] ] ]-- ] = id[i];\n\n        // \u4fdd\u5b58\u4e0a\u4e00\u8f6e\u7684\u6392\u540d\n        memcpy(oldrk + 1, rk + 1, n * sizeof(int));\n        // \u66f4\u65b0\u6392\u540d rk \u6570\u7ec4\uff0c\u6839\u636e (rk[i], rk[i+w]) \u751f\u6210\u65b0\u7684\u6392\u540d\n        for (p = 0, i = 1; i &lt;= n; ++i) {\n            if (i &gt; 1 &amp;&amp; oldrk[sa[i]] == oldrk[sa[i - 1]] &amp;&amp;\n                oldrk[sa[i] + w] == oldrk[sa[i - 1] + w])\n                rk[ sa[i] ] = p;\n            else\n                rk[ sa[i] ] = ++p;\n        }\n    }\n}\n\n// \u51fd\u6570\u529f\u80fd\uff1a\u6784\u9020 height \u6570\u7ec4\n// \u53c2\u6570\uff1a\n//    s     : \u8f93\u5165\u5b57\u7b26\u4e32\uff0c\u8981\u6c42\u4ece\u4e0b\u6807 1 \u5f00\u59cb\u5b58\u653e\uff0cs[1..n]\n//    n     : \u5b57\u7b26\u4e32\u957f\u5ea6\n//    sa    : \u540e\u7f00\u6570\u7ec4\uff0csa[1..n]\uff1b\u6ce8\u610f sa \u548c rk \u6570\u7ec4\u5747\u91c7\u7528 1-based \u7d22\u5f15\n//    rk    : \u6392\u540d\u6570\u7ec4\uff0crk[1..n]\uff0c\u5176\u4e2d rk[i] \u8868\u793a s[i...] \u5728\u540e\u7f00\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\n//    height: \u6784\u9020\u540e\u7684 height \u6570\u7ec4\uff0cheight[1..n]\uff0cheight[i] \u8868\u793a sa[i] \u548c sa[i-1] \u7684\u6700\u957f\u516c\u5171\u524d\u7f00\u957f\u5ea6\nvoid build_height(const char s[], int n, int sa[], int rk[], int height[]) {\n    int i, k;\n    // i \u4ece 1 \u5230 n\uff0c k \u8868\u793a\u5f53\u524d\u5df2\u7ecf\u5339\u914d\u7684\u524d\u7f00\u957f\u5ea6\n    for (i = 1, k = 0; i &lt;= n; ++i) {\n        // \u5982\u679c\u5f53\u524d\u540e\u7f00\u5728 sa \u4e2d\u6392\u7b2c\u4e00\uff0c\u5219\u6ca1\u6709\u524d\u9a71\uff0c\u4e0d\u8ba1\u7b97\n        if (rk[i] == 0)\n            continue;\n        // \u82e5 k &gt; 0\uff0c\u5219\u9012\u51cf k\uff08\u5229\u7528\u76f8\u90bb\u540e\u7f00\u95f4\u7684\u6027\u8d28\uff09\n        if (k) k--;\n        // j \u4e3a\u5f53\u524d\u540e\u7f00\u5728 sa \u4e2d\u524d\u4e00\u4e2a\u540e\u7f00\u7684\u8d77\u59cb\u4f4d\u7f6e\n        int j = sa[rk[i] - 1];\n        // \u6bd4\u8f83 s[i+k] \u4e0e s[j+k] \u76f4\u5230\u4e0d\u7b49\uff0c\u6ce8\u610f s \u6570\u7ec4\u4ece 1 \u5f00\u59cb\n        while (i + k &lt;= n &amp;&amp; j + k &lt;= n &amp;&amp; s[i + k] == s[j + k])\n            k++;\n        height[ rk[i] ] = k;\n    }\n}\nconst int N = 10000;\nint LongestString(char s[], int n) {\n    // \u4e0b\u6807\u4eces[1]\u5f00\u59cb\n    int* sa = (int*) calloc(N , sizeof(int));\n    int* rk = (int*) calloc(N , sizeof(int));\n    int* oldrk = (int*) calloc(N , sizeof(int));\n    int* id = (int*) calloc(N , sizeof(int));\n    int* cnt = (int*) calloc(300 , sizeof(int));\n    int* height = (int*) calloc(N , sizeof(int));\n    build_sa(s, n, sa, rk, oldrk, id, cnt);\n    build_height(s, n, sa, rk, height);\n    int ans = 0;\n    for (int i = 2; i &lt;= n; i++) {\n        if (height[i] &gt; ans &amp;&amp; abs(sa[i] - sa[i-1]) &gt;= height[i]) {\n            ans = height[i];\n        }\n    }\n    free(sa), free(rk), free(oldrk), free(cnt), free(id), free(height);\n    return ans;\n}\n</code></pre>"},{"location":"course/Database/","title":"\u6570\u636e\u5e93\u7cfb\u7edf\u539f\u7406","text":""},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/","title":"SQL \u8bed\u8a00","text":""},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#1-ddl","title":"1. DDL (\u6570\u636e\u5b9a\u4e49\u8bed\u8a00)","text":""},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#11-create-table","title":"1.1 \u521b\u5efa\u8868 (CREATE TABLE)","text":"<pre><code>create table instructor (\n    ID          char(5),\n    name        varchar(20) not null,\n    dept_name   varchar(20),\n    salary      numeric(8,2),\n    primary key (ID),\n    foreign key (dept_name) references department,\n    check(salary &gt; 0)\n);\n\ncreate table section (\n    course_id   varchar(8),\n    sec_id      varchar(8),\n    semester    varchar(6),\n    year        numeric(4, 0),\n    building    varchar(15),\n    room_number varchar(7),\n    time_slot_id varchar(4),\n    primary key(course_id, sec_id, semester, year),\n    foreign key(course_id) references course,\n    check (semester in ('Fall', 'Winter', 'Spring', 'Summer'))\n);\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#12-drop-table","title":"1.2 \u5220\u9664\u8868 (DROP TABLE)","text":"<p>\u5220\u9664\u8868\u7684\u6240\u6709\u4fe1\u606f\uff08\u5143\u7ec4\u548c\u6a21\u5f0f\uff09\u3002</p> <pre><code>drop table r;\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#13-alter-table","title":"1.3 \u4fee\u6539\u8868 (ALTER TABLE)","text":"<p>\u5411\u5df2\u6709\u5173\u7cfb\u4e2d\u6dfb\u52a0\u6216\u5220\u9664\u5c5e\u6027\u3002</p> <pre><code>/* \u6dfb\u52a0\u5c5e\u6027\uff0c\u6240\u6709\u5143\u7ec4\u5728\u65b0\u5c5e\u6027\u4e0a\u9ed8\u8ba4\u4e3a null */\nalter table r add A D;\n\n/* \u5220\u9664\u5c5e\u6027 (\u67d0\u4e9b\u6570\u636e\u5e93\u53ef\u80fd\u4e0d\u652f\u6301) */\nalter table r drop A;\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#14-create-index","title":"1.4 \u521b\u5efa\u7d22\u5f15 (CREATE INDEX)","text":"<p>\u521b\u5efa\u7d22\u5f15\u4ee5\u52a0\u5feb\u67e5\u8be2\u901f\u5ea6\u3002</p> <pre><code>create index studentID_index on student(ID);\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#2-dml","title":"2. DML (\u6570\u636e\u64cd\u7eb5\u8bed\u8a00)","text":""},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#21-insert","title":"2.1 \u63d2\u5165 (INSERT)","text":""},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#_1","title":"\u5728\u8868\u4e2d\u63d2\u5165\u5143\u7d20","text":"<pre><code>insert into course\n    values('CS-347', 'Database Systems', 'Comp. Sci.', 4);\n</code></pre> <p>\u7b49\u4ef7\u4e8e\uff1a</p> <pre><code>insert into course(course_id, title, dept_name, credits)\n    values('CS-347', 'Database Systems', 'Comp. Sci.', 4);\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#_2","title":"\u5728\u8868\u4e2d\u63d2\u5165\u67e5\u8be2\u7ed3\u679c","text":"<pre><code>/* \u5c06\u6240\u6709\u8bb2\u5e08\u6dfb\u52a0\u5230\u5b66\u751f\u5173\u7cfb\u4e2d\uff0c\u5b66\u5206\u8bbe\u4e3a 0 */\ninsert into student\n    select ID, name, dept_name, 0\n    from instructor;\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#22-delete","title":"2.2 \u5220\u9664 (DELETE)","text":"<p>\u4ece\u5173\u7cfb r \u4e2d\u5220\u9664\u6ee1\u8db3\u8c13\u8bcd P \u7684\u5143\u7ec4\u3002</p> <pre><code>delete from r\nwhere P;\n</code></pre> <p>\u4f8b\u5982\uff0c\u5220\u9664\u5de5\u8d44\u4f4e\u4e8e\u5e73\u5747\u5de5\u8d44\u7684\u8bb2\u5e08\uff1a</p> <pre><code>delete from instructor\nwhere salary &lt; (select avg(salary)\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 from instructor);\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#23-update","title":"2.3 \u4fee\u6539 (UPDATE)","text":""},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#_3","title":"\u5168\u90e8\u4fee\u6539","text":"<pre><code>update instructor\nset salary = salary * 1.05;\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#_4","title":"\u90e8\u5206\u4fee\u6539","text":"<pre><code>update instructor\nset salary = salary * 1.03\nwhere salary &gt; 100000;\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#case","title":"\u6761\u4ef6\u4fee\u6539 (CASE)","text":"<pre><code>update instructor\nset salary =    case\n                    when salary &lt;= 100000 then salary * 1.05\n                    else salary * 1.03\n                end;\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#_5","title":"\u57fa\u4e8e\u6807\u91cf\u5b50\u67e5\u8be2\u7684\u4fee\u6539","text":"<p>\u4e3a\u6240\u6709\u5b66\u751f\u91cd\u65b0\u8ba1\u7b97\u5e76\u66f4\u65b0 <code>tot_cred</code> (\u603b\u5b66\u5206)\u3002</p> <pre><code>update student S\nset tot_cred = (\n    select sum(credits)\n\u00a0 \u00a0 from takes, course\n\u00a0 \u00a0 where takes.course_id = course.course_id and\n          S.ID = takes.ID and\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 takes.grade &lt;&gt; 'F' and takes.grade is not null\n);\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#3-dql","title":"3. DQL (\u6570\u636e\u67e5\u8be2\u8bed\u8a00)","text":""},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#31-select","title":"3.1 <code>SELECT</code> \u57fa\u672c\u7ed3\u6784","text":"<pre><code>select  A1, A2, ..., An\nfrom  r1, r2, ..., rm\nwhere P;\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#select","title":"<code>SELECT</code> \u5b50\u53e5","text":"<ul> <li><code>distinct</code>\uff1a\u53bb\u9664\u7ed3\u679c\u4e2d\u7684\u91cd\u590d\u884c\u3002     <pre><code>select distinct dept_name\nfrom instructor;\n</code></pre></li> <li><code>*</code>\uff1a\u8868\u793a\u201c\u6240\u6709\u5c5e\u6027\u201d\u3002     <pre><code>select *\nfrom instructor;\n</code></pre></li> <li><code>as</code>\uff1a\u91cd\u547d\u540d\u5c5e\u6027\u6216\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u3002     <pre><code>select ID, name, salary/12 as monthly_salary\nfrom instructor;\n</code></pre></li> </ul>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#where","title":"<code>WHERE</code> \u5b50\u53e5","text":"<ul> <li><code>between</code>\uff1a\u7528\u4e8e\u8303\u56f4\u67e5\u8be2\u3002     <pre><code>select name\nfrom instructor\nwhere salary between 90000 and 100000;\n</code></pre></li> <li><code>like</code>\uff1a\u7528\u4e8e\u5b57\u7b26\u4e32\u6a21\u7cca\u5339\u914d\u3002<ul> <li><code>%</code>\uff1a\u5339\u914d\u4efb\u610f\u5b50\u4e32\u3002</li> <li><code>_</code>\uff1a\u5339\u914d\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\u3002  <pre><code>select name\nfrom instructor\nwhere name like '%dar%';\n</code></pre></li> </ul> </li> <li><code>is null</code>\uff1a\u68c0\u67e5\u7a7a\u503c\u3002     <pre><code>select name\nfrom instructor\nwhere salary is null;\n</code></pre></li> </ul>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#order-by","title":"<code>ORDER BY</code> \u5b50\u53e5","text":"<p>\u7528\u4e8e\u5bf9\u7ed3\u679c\u5143\u7ec4\u8fdb\u884c\u6392\u5e8f\u3002</p> <pre><code>/* \u9ed8\u8ba4\u5347\u5e8f (asc) */\nselect distinct name\nfrom instructor\norder by name;\n\n/* \u964d\u5e8f (desc) */\norder by name desc;\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#32-aggregate-functions","title":"3.2 \u805a\u5408\u51fd\u6570 (Aggregate Functions)","text":"<p>\u5bf9\u4e00\u7ec4\u503c\u8fdb\u884c\u64cd\u4f5c\u5e76\u8fd4\u56de\u5355\u4e2a\u503c\u3002</p> <ul> <li><code>avg</code>: \u5e73\u5747\u503c</li> <li><code>min</code>: \u6700\u5c0f\u503c</li> <li><code>max</code>: \u6700\u5927\u503c</li> <li><code>sum</code>: \u5408\u8ba1</li> <li><code>count</code>: \u8ba1\u6570</li> </ul> <pre><code>/* \u627e\u51fa Comp. Sci. \u7cfb\u8bb2\u5e08\u7684\u5e73\u5747\u5de5\u8d44 */\nselect avg (salary)\nfrom instructor\nwhere dept_name = 'Comp. Sci.';\n\n/* \u7edf\u8ba1\u8bfe\u7a0b\u603b\u6570 */\nselect count (*)\nfrom course;\n\n/* \u7edf\u8ba1 2010 \u5e74\u6625\u5b63\u5f00\u8bfe\u7684\u6559\u5e08\u4eba\u6570 (\u53bb\u91cd) */\nselect count (distinct ID)\nfrom teaches\nwhere semester = 'Spring' and year = 2010;\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#group-by","title":"<code>GROUP BY</code> \u5b50\u53e5","text":"<p>\u4e0e\u805a\u5408\u51fd\u6570\u4e00\u8d77\u4f7f\u7528\uff0c\u5c06\u5143\u7ec4\u6309\u5c5e\u6027\u503c\u5206\u7ec4\u3002</p> <pre><code>select dept_name, avg (salary) as avg_salary\nfrom instructor\ngroup by dept_name;\n</code></pre> <p>\u6ce8\u610f\uff1a<code>SELECT</code> \u5b50\u53e5\u4e2d\u672a\u88ab\u805a\u5408\u7684\u5c5e\u6027\uff0c\u5fc5\u987b\u51fa\u73b0\u5728 <code>GROUP BY</code> \u5b50\u53e5\u4e2d\u3002</p>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#having","title":"<code>HAVING</code> \u5b50\u53e5","text":"<p>\u7528\u4e8e\u5bf9 <code>GROUP BY</code> \u5f62\u6210\u7684\u5206\u7ec4\u8fdb\u884c\u6761\u4ef6\u7b5b\u9009\u3002</p> <pre><code>select dept_name, avg (salary)\nfrom instructor\ngroup by dept_name\nhaving avg (salary) &gt; 42000;\n</code></pre> <p>\u533a\u522b\uff1a<code>WHERE</code> \u5728\u5206\u7ec4\u524d\u8fc7\u6ee4\u884c\uff0c<code>HAVING</code> \u5728\u5206\u7ec4\u540e\u8fc7\u6ee4\u7ec4\u3002</p>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#33-set-operations","title":"3.3 \u96c6\u5408\u8fd0\u7b97 (Set Operations)","text":"<ul> <li><code>union</code>\uff1a\u5e76\u96c6\uff08\u81ea\u52a8\u53bb\u91cd\uff09</li> <li><code>intersect</code>\uff1a\u4ea4\u96c6\uff08\u81ea\u52a8\u53bb\u91cd\uff09</li> <li><code>except</code>\uff1a\u5dee\u96c6\uff08\u81ea\u52a8\u53bb\u91cd\uff09</li> <li>(\u4f7f\u7528 <code>all</code> \u5173\u952e\u5b57\u53ef\u4fdd\u7559\u91cd\u590d\u9879\uff0c\u5982 <code>union all</code>)</li> </ul> <pre><code>/* 2009 \u5e74\u79cb\u5b63\u6216 2010 \u5e74\u6625\u5b63\u5f00\u8bbe\u7684\u8bfe\u7a0b */\n(select course_id from section where sem = 'Fall' and year = 2009)\nunion\n(select course_id from section where sem = 'Spring' and year = 2010);\n\n/* 2009 \u5e74\u79cb\u5b63 \u4e14 2010 \u5e74\u6625\u5b63\u5f00\u8bbe\u7684\u8bfe\u7a0b */\n(select course_id from section where sem = 'Fall' and year = 2009)\nintersect\n(select course_id from section where sem = 'Spring' and year = 2010);\n\n/* 2009 \u5e74\u79cb\u5b63\u5f00\u8bbe \u4f46 2010 \u5e74\u6625\u5b63\u672a\u5f00\u8bbe\u7684\u8bfe\u7a0b */\n(select course_id from section where sem = 'Fall' and year = 2009)\nexcept\n(select course_id from section where sem = 'Spring' and year = 2010);\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#34-join-expressions","title":"3.4 \u8fde\u63a5 (Join Expressions)","text":""},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#natural-join","title":"\u81ea\u7136\u8fde\u63a5 (Natural Join)","text":"<p>\u5728\u4e24\u4e2a\u5173\u7cfb\u7684\u6240\u6709\u516c\u5171\u5c5e\u6027\u4e0a\u81ea\u52a8\u8fdb\u884c\u7b49\u503c\u8fde\u63a5\u3002</p> <pre><code>select name, course_id\nfrom student natural join takes;\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#join-on","title":"\u8fde\u63a5\u6761\u4ef6 (Join ... On ...)","text":"<pre><code>select *\nfrom student join takes on student.ID = takes.ID;\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#outer-join","title":"\u5916\u8fde\u63a5 (Outer Join)","text":"<p>\u4fdd\u7559\u5728\u4e00\u4e2a\u5173\u7cfb\u4e2d\u5b58\u5728\u4f46\u5728\u53e6\u4e00\u4e2a\u5173\u7cfb\u4e2d\u6ca1\u6709\u5339\u914d\u5143\u7ec4\u7684\u5143\u7ec4\u3002</p> <ul> <li> <p>\u5de6\u5916\u8fde\u63a5 (Left Outer Join)     \u4fdd\u7559\u5de6\u4fa7\u5173\u7cfb\u4e2d\u6ca1\u6709\u5339\u914d\u7684\u5143\u7ec4\u3002</p> <pre><code>select *\nfrom course natural left outer join prereq;\n</code></pre> </li> <li> <p>\u53f3\u5916\u8fde\u63a5 (Right Outer Join)     \u4fdd\u7559\u53f3\u4fa7\u5173\u7cfb\u4e2d\u6ca1\u6709\u5339\u914d\u7684\u5143\u7ec4\u3002</p> <pre><code>select *\nfrom course natural right outer join prereq;\n</code></pre> </li> <li> <p>\u5168\u5916\u8fde\u63a5 (Full Outer Join)     \u4fdd\u7559\u4e24\u4fa7\u5173\u7cfb\u4e2d\u6ca1\u6709\u5339\u914d\u7684\u5143\u7ec4\u3002</p> <pre><code>select *\nfrom course natural full outer join prereq;\n</code></pre> </li> </ul>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#35-nested-subqueries","title":"3.5 \u5d4c\u5957\u5b50\u67e5\u8be2 (Nested Subqueries)","text":"<p>\u5b50\u67e5\u8be2\u662f\u5d4c\u5957\u5728\u53e6\u4e00\u4e2a\u67e5\u8be2\u4e2d\u7684 <code>select-from-where</code> \u8868\u8fbe\u5f0f\u3002</p>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#in-not-in","title":"<code>IN</code> / <code>NOT IN</code> (\u96c6\u5408\u6210\u5458)","text":"<pre><code>/* 2009 \u5e74\u79cb\u5b63 \u4e14 2010 \u5e74\u6625\u5b63\u5f00\u8bbe\u7684\u8bfe\u7a0b */\nselect distinct course_id\nfrom section\nwhere semester = 'Fall' and year = 2009 and\n      course_id in (select course_id\n                    from section\n                    where semester = 'Spring' and year = 2010);\n\n/* 2009 \u5e74\u79cb\u5b63\u5f00\u8bbe \u4f46 2010 \u5e74\u6625\u5b63\u672a\u5f00\u8bbe\u7684\u8bfe\u7a0b */\nselect distinct course_id\nfrom section\nwhere semester = 'Fall' and year = 2009 and\n      course_id not in (select course_id\n                        from section\n                        where semester = 'Spring' and year = 2010);\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#some-all","title":"<code>SOME</code> / <code>ALL</code> (\u96c6\u5408\u6bd4\u8f83)","text":"<ul> <li><code>&gt; some</code>\uff1a\u5927\u4e8e\u5b50\u67e5\u8be2\u7ed3\u679c\u4e2d\u7684\u201c\u81f3\u5c11\u4e00\u4e2a\u201d\u3002     <pre><code>select name\nfrom instructor\nwhere salary &gt; some (select salary\n                     from instructor\n                     where dept_name = 'Biology');\n</code></pre></li> <li><code>&gt; all</code>\uff1a\u5927\u4e8e\u5b50\u67e5\u8be2\u7ed3\u679c\u4e2d\u7684\u201c\u6240\u6709\u201d\u3002     <pre><code>select name\nfrom instructor\nwhere salary &gt; all (select salary\n                    from instructor\n                    where dept_name = 'Biology');\n</code></pre></li> </ul>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#exists-not-exists","title":"<code>EXISTS</code> / <code>NOT EXISTS</code> (\u5b58\u5728\u6027\u6d4b\u8bd5)","text":"<p>\u6d4b\u8bd5\u5b50\u67e5\u8be2\u7ed3\u679c\u662f\u5426\u4e3a\u7a7a\u3002<code>exists r</code> \u5f53 r \u975e\u7a7a\u65f6\u4e3a true\u3002</p> <pre><code>/* 2009 \u5e74\u79cb\u5b63 \u4e14 2010 \u5e74\u6625\u5b63\u5f00\u8bbe\u7684\u8bfe\u7a0b (\u76f8\u5173\u5b50\u67e5\u8be2) */\nselect course_id\nfrom section as S\nwhere semester = 'Fall' and year = 2009 and\n      exists (select *\n              from section as T\n              where semester = 'Spring' and year = 2010\n                    and S.course_id = T.course_id);\n\n/* \u627e\u51fa\u9009\u4fee\u4e86 Biology \u7cfb\u6240\u6709\u8bfe\u7a0b\u7684\u5b66\u751f */\nselect distinct S.ID, S.name\nfrom student as S\nwhere not exists ( (select course_id  /* Biology \u7cfb\u7684\u6240\u6709\u8bfe\u7a0b */\n                    from course\n                    where dept_name = 'Biology')\n                   except  /* \u51cf\u53bb */\n                   (select T.course_id  /* S \u5b66\u751f\u5df2\u9009\u4fee\u7684\u8bfe\u7a0b */\n                    from takes as T\n                    where S.ID = T.ID) );\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#from","title":"<code>FROM</code> \u5b50\u53e5\u4e2d\u7684\u5b50\u67e5\u8be2","text":"<pre><code>/* \u627e\u51fa\u5e73\u5747\u5de5\u8d44\u5927\u4e8e 42000 \u7684\u7cfb\u53ca\u5176\u5e73\u5747\u5de5\u8d44 */\nselect dept_name, avg_salary\nfrom (select dept_name, avg(salary) as avg_salary\n      from instructor\n      group by dept_name)\nwhere avg_salary &gt; 42000;\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#with","title":"<code>WITH</code> \u5b50\u53e5","text":"<p>\u5b9a\u4e49\u4e00\u4e2a\u4e34\u65f6\u7684\u201c\u89c6\u56fe\u201d\uff0c\u4ec5\u5728\u5f53\u524d\u67e5\u8be2\u4e2d\u53ef\u7528\u3002</p> <pre><code>/* \u627e\u51fa\u9884\u7b97\u6700\u9ad8\u7684\u7cfb */\nwith max_budget (value) as (\n    select max(budget)\n    from department\n)\nselect department.name\nfrom department, max_budget\nwhere department.budget = max_budget.value;\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#select_1","title":"<code>SELECT</code> \u5b50\u53e5\u4e2d\u7684\u6807\u91cf\u5b50\u67e5\u8be2","text":"<p>\u8fd4\u56de\u5355\u4e2a\u503c\u7684\u5b50\u67e5\u8be2\u3002</p> <pre><code>/* \u5217\u51fa\u6240\u6709\u7cfb\u53ca\u5176\u8bb2\u5e08\u4eba\u6570 */\nselect dept_name,\n       (select count(*)\n        from instructor\n        where department.dept_name = instructor.dept_name)\n       as num_instructors\nfrom department;\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#36-views","title":"3.6 \u89c6\u56fe (Views)","text":"<p>\u89c6\u56fe\u662f\u4e00\u79cd\u865a\u62df\u5173\u7cfb\uff0c\u5b83\u4e0d\u5b58\u50a8\u6570\u636e\uff0c\u800c\u662f\u5b58\u50a8\u5176\u5b9a\u4e49\u3002</p> <pre><code>create view faculty as\n    select ID, name, dept_name\n    from instructor;\n\ncreate view departments_total_salary(dept_name, total_salary) as\n    select dept_name, sum(salary)\n    from instructor\n    group by dept_name;\n</code></pre> <p>\u53ef\u66f4\u65b0\u7684\u89c6\u56fe\uff08\u5373\u53ef\u4ee5\u5728\u89c6\u56fe\u4e0a\u8fdb\u884c <code>insert</code>, <code>delete</code>, <code>update</code>\uff09\u5fc5\u987b\u6ee1\u8db3\u7279\u5b9a\u6761\u4ef6\uff1a</p> <ul> <li><code>from</code> \u5b50\u53e5\u4e2d\u53ea\u6709\u4e00\u4e2a\u5173\u7cfb\u3002</li> <li><code>select</code> \u5b50\u53e5\u4e2d\u53ea\u5305\u542b\u5c5e\u6027\u540d\uff08\u6ca1\u6709\u8868\u8fbe\u5f0f\u3001\u805a\u5408\u6216 <code>distinct</code>\uff09\u3002</li> <li>\u672a\u5728 <code>select</code> \u4e2d\u51fa\u73b0\u7684\u5c5e\u6027\u5fc5\u987b\u53ef\u4ee5\u4e3a <code>null</code>\u3002</li> <li>\u67e5\u8be2\u4e2d\u6ca1\u6709 <code>group by</code> \u6216 <code>having</code> \u5b50\u53e5\u3002</li> </ul>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#4-dcl","title":"4. DCL (\u6570\u636e\u63a7\u5236\u8bed\u8a00)","text":""},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#41-grant","title":"4.1 \u6388\u4e88\u6743\u9650 (GRANT)","text":"<p>\u7528\u4e8e\u6388\u4e88\u7528\u6237\u6216\u89d2\u8272\u6743\u9650\u3002</p> <pre><code>grant &lt;privilege list&gt;\non &lt;relation or view name&gt;\nto &lt;user list&gt;;\n</code></pre> <ul> <li>\u6743\u9650\u5217\u8868\uff1a<code>select</code>, <code>insert</code>, <code>update</code>, <code>delete</code>, <code>all privileges</code>\u3002</li> <li>\u7528\u6237\u5217\u8868\uff1a\u7528\u6237 ID, <code>public</code> (\u6240\u6709\u7528\u6237) \u6216\u89d2\u8272\u3002</li> </ul> <pre><code>grant select on instructor to U1, U2, UL3;\n</code></pre>"},{"location":"course/Database/SQL%E8%AF%AD%E8%A8%80/#42-revoke","title":"4.2 \u64a4\u9500\u6743\u9650 (REVOKE)","text":"<p>\u7528\u4e8e\u64a4\u9500\u5df2\u6388\u4e88\u7684\u6743\u9650\u3002</p> <pre><code>revoke &lt;privilege list&gt;\non &lt;relation or view name&gt;\nfrom &lt;user list&gt;;\n</code></pre> <pre><code>revoke select on branch from U1, U2, U3;\n</code></pre>"},{"location":"course/Database/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0/","title":"\u5173\u7cfb\u4ee3\u6570 (Relational Algebra)","text":"<p>\u5173\u7cfb\u4ee3\u6570\u662f\u4e00\u79cd\u7528\u4e8e\u5173\u7cfb\u6570\u636e\u5e93\u7684\u8fc7\u7a0b\u5316\u67e5\u8be2\u8bed\u8a00\u3002\u5b83\u5b9a\u4e49\u4e86\u4e00\u7ec4\u8fd0\u7b97\uff0c\u8fd9\u4e9b\u8fd0\u7b97\u4ee5\u4e00\u4e2a\u6216\u591a\u4e2a\u5173\u7cfb\uff08\u8868\uff09\u4f5c\u4e3a\u8f93\u5165\uff0c\u5e76\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u5173\u7cfb\u4f5c\u4e3a\u8f93\u51fa\u3002</p>"},{"location":"course/Database/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0/#1-fundamental-operations","title":"1. \u57fa\u672c\u8fd0\u7b97 (Fundamental Operations)","text":""},{"location":"course/Database/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0/#11-sigma","title":"1.1 \u9009\u62e9 (\\(\\sigma\\))","text":"<p>\u4f5c\u7528\uff1a\u4ece\u5173\u7cfb \\(r\\) \u4e2d\u9009\u53d6\u6ee1\u8db3\u7ed9\u5b9a\u8c13\u8bcd\uff08\u6761\u4ef6\uff09 \\(P\\) \u7684\u5143\u7ec4\uff08\u884c\uff09\u3002</p> <p>\u7b26\u53f7\uff1a\\(\\sigma_P(r)\\)</p> <p>\u793a\u4f8b\uff1a\u627e\u51fa <code>instructor</code> \u5173\u7cfb\u4e2d <code>Comp. Sci.</code> \u7cfb\u4e14\u5de5\u8d44\u5927\u4e8e 80000 \u7684\u8bb2\u5e08\u3002</p> <p>\u4ee3\u6570\uff1a \\(\\sigma_{\\text{dept\\_name} = \\text{'Comp. Sci.'} \\land \\text{salary} &gt; 80000}(\\text{instructor})\\)</p> <p>SQL \u7b49\u4ef7\uff1a</p> <pre><code>SELECT *\nFROM instructor\nWHERE dept_name = 'Comp. Sci.' AND salary &gt; 80000;\n</code></pre>"},{"location":"course/Database/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0/#12-pi","title":"1.2 \u6295\u5f71 (\\(\\pi\\))","text":"<p>\u4f5c\u7528\uff1a\u4ece\u5173\u7cfb \\(r\\) \u4e2d\u9009\u53d6\u6307\u5b9a\u7684\u5c5e\u6027\uff08\u5217\uff09\uff0c\u5e76\u81ea\u52a8\u53bb\u9664\u91cd\u590d\u884c\u3002</p> <p>\u7b26\u53f7\uff1a\\(\\pi_{A_1, A_2, ..., A_n}(r)\\)</p> <p>\u793a\u4f8b\uff1a\u627e\u51fa <code>instructor</code> \u5173\u7cfb\u4e2d\u6240\u6709\u8bb2\u5e08\u7684\u59d3\u540d\uff08<code>name</code>\uff09\u548c\u7cfb\u540d\uff08<code>dept_name</code>\uff09\u3002</p> <p>\u4ee3\u6570\uff1a \\(\\pi_{\\text{name, dept\\_name}}(\\text{instructor})\\)</p> <p>SQL \u7b49\u4ef7\uff1a</p> <pre><code>SELECT DISTINCT name, dept_name\nFROM instructor;\n</code></pre>"},{"location":"course/Database/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0/#13-cup","title":"1.3 \u5e76 (\\(\\cup\\))","text":"<p>\u4f5c\u7528\uff1a\u8fd4\u56de\u4e24\u4e2a\u5173\u7cfb\u4e2d\u51fa\u73b0\u8fc7\u7684\u6240\u6709\u5143\u7ec4\uff0c\u5e76\u81ea\u52a8\u53bb\u9664\u91cd\u590d\u3002\u8981\u6c42\u4e24\u4e2a\u5173\u7cfb \\(r\\) \u548c \\(s\\) \u5e76\u76f8\u5bb9\uff08\u5c5e\u6027\u6570\u91cf\u76f8\u540c\uff0c\u4e14\u5bf9\u5e94\u5c5e\u6027\u7684\u57df/\u7c7b\u578b\u76f8\u540c\uff09\u3002</p> <p>\u7b26\u53f7\uff1a\\(r \\cup s\\)</p> <p>\u793a\u4f8b\uff1a\u627e\u51fa 2009 \u5e74\u79cb\u5b63 \u6216 2010 \u5e74\u6625\u5b63\u5f00\u8bbe\u7684\u6240\u6709\u8bfe\u7a0b\u3002</p> <p>\u4ee3\u6570\uff1a \\(\\pi_{\\text{course\\_id}}(\\sigma_{\\text{semester} = \\text{'Fall'} \\land \\text{year} = 2009}(\\text{section}))\\) \\(\\cup\\) \\(\\pi_{\\text{course\\_id}}(\\sigma_{\\text{semester} = \\text{'Spring'} \\land \\text{year} = 2010}(\\text{section}))\\)</p> <p>SQL \u7b49\u4ef7\uff1a</p> <pre><code>(SELECT course_id FROM section WHERE semester = 'Fall' AND year = 2009)\nUNION\n(SELECT course_id FROM section WHERE semester = 'Spring' AND year = 2010);\n</code></pre>"},{"location":"course/Database/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0/#14-","title":"1.4 \u5dee (\\(-\\))","text":"<p>\u4f5c\u7528\uff1a\u8fd4\u56de\u5728\u5173\u7cfb \\(r\\) \u4e2d\u51fa\u73b0\uff0c\u4f46\u5728\u5173\u7cfb \\(s\\) \u4e2d\u672a\u51fa\u73b0\u7684\u6240\u6709\u5143\u7ec4\u3002\u8981\u6c42 \\(r\\) \u548c \\(s\\) \u5e76\u76f8\u5bb9\u3002</p> <p>\u7b26\u53f7\uff1a\\(r - s\\)</p> <p>\u793a\u4f8b\uff1a\u627e\u51fa 2009 \u5e74\u79cb\u5b63\u5f00\u8bbe\uff0c\u4f46 2010 \u5e74\u6625\u5b63\u672a\u5f00\u8bbe\u7684\u8bfe\u7a0b\u3002</p> <p>\u4ee3\u6570\uff1a \\(\\pi_{\\text{course\\_id}}(\\sigma_{\\text{semester} = \\text{'Fall'} \\land \\text{year} = 2009}(\\text{section}))\\) \\(-\\) \\(\\pi_{\\text{course\\_id}}(\\sigma_{\\text{semester} = \\text{'Spring'} \\land \\text{year} = 2010}(\\text{section}))\\)</p> <p>SQL \u7b49\u4ef7\uff1a</p> <pre><code>(SELECT course_id FROM section WHERE semester = 'Fall' AND year = 2009)\nEXCEPT\n(SELECT course_id FROM section WHERE semester = 'Spring' AND year = 2010);\n</code></pre>"},{"location":"course/Database/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0/#15-times","title":"1.5 \u7b1b\u5361\u5c14\u79ef (\\(\\times\\))","text":"<p>\u4f5c\u7528\uff1a\u5c06\u5173\u7cfb \\(r\\) \u7684\u6bcf\u4e2a\u5143\u7ec4\u4e0e\u5173\u7cfb \\(s\\) \u7684\u6bcf\u4e2a\u5143\u7ec4\u8fdb\u884c\u7ec4\u5408\uff0c\u5f62\u6210\u4e00\u4e2a\u65b0\u7684\u5173\u7cfb\u3002\u5982\u679c \\(r\\) \u6709 \\(n\\) \u4e2a\u5143\u7ec4 \\(m\\) \u4e2a\u5c5e\u6027\uff0c \\(s\\) \u6709 \\(k\\) \u4e2a\u5143\u7ec4 \\(p\\) \u4e2a\u5c5e\u6027\uff0c\u7ed3\u679c\u5c06\u6709 \\(n \\times k\\) \u4e2a\u5143\u7ec4\u548c \\(m + p\\) \u4e2a\u5c5e\u6027\u3002</p> <p>\u7b26\u53f7\uff1a\\(r \\times s\\)</p> <p>\u6ce8\u610f\uff1a\u7b1b\u5361\u5c14\u79ef\u672c\u8eab\u5f88\u5c11\u5355\u72ec\u4f7f\u7528\uff0c\u5b83\u901a\u5e38\u4e0e \\(\\sigma\\) (\u9009\u62e9) \u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u5f62\u6210\u8fde\u63a5\uff08Join\uff09\u3002</p> <p>\u793a\u4f8b\uff1a\u7ec4\u5408 <code>student</code> \u548c <code>takes</code> \u7684\u6240\u6709\u5143\u7ec4\uff0c\u5e76\u7b5b\u9009\u51fa <code>ID</code> \u76f8\u540c\u7684\u5143\u7ec4\u3002</p> <p>\u4ee3\u6570\uff1a \\(\\sigma_{\\text{student.ID} = \\text{takes.ID}}(\\text{student} \\times \\text{takes})\\)</p> <p>SQL \u7b49\u4ef7\uff1a</p> <pre><code>SELECT *\nFROM student, takes\nWHERE student.ID = takes.ID;\n</code></pre>"},{"location":"course/Database/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0/#16-rho","title":"1.6 \u91cd\u547d\u540d (\\(\\rho\\))","text":"<p>\u4f5c\u7528\uff1a\u6539\u53d8\u5173\u7cfb\u6216\u5176\u5c5e\u6027\u7684\u540d\u79f0\u3002\u5f53\u9700\u8981\u5bf9\u4e00\u4e2a\u5173\u7cfb\u81ea\u8eab\u8fdb\u884c\u6bd4\u8f83\uff08\u4f8b\u5982\uff0c\u901a\u8fc7\u7b1b\u5361\u5c14\u79ef\uff09\u65f6\uff0c\u8fd9\u4e2a\u8fd0\u7b97\u81f3\u5173\u91cd\u8981\u3002</p> <p>\u7b26\u53f7\uff1a\\(\\rho_{S(B_1, ..., B_n)}(r)\\) (\u5c06\u5173\u7cfb \\(r\\) \u91cd\u547d\u540d\u4e3a \\(S\\)\uff0c\u5e76\u5c06\u5176\u5c5e\u6027\u91cd\u547d\u540d\u4e3a \\(B_1\\) \u81f3 \\(B_n\\))</p> <p>\u793a\u4f8b\uff1a\u627e\u51fa\u6240\u6709\u5de5\u8d44\u5927\u4e8e <code>Comp. Sci.</code> \u7cfb\u67d0\u4e2a\u8bb2\u5e08\u5de5\u8d44\u7684\u8bb2\u5e08\u3002</p> <p>\u4ee3\u6570\uff1a \\(\\pi_{T.\\text{name}}(\\rho_T(\\text{instructor}) \\bowtie_{T.\\text{salary} &gt; S.\\text{salary}} \\rho_S(\\sigma_{\\text{dept\\_name} = \\text{'Comp. Sci.'}}(\\text{instructor})))\\)</p> <p>SQL \u7b49\u4ef7\uff1a</p> <pre><code>SELECT DISTINCT T.name\nFROM instructor AS T, instructor AS S\nWHERE T.salary &gt; S.salary AND S.dept_name = 'Comp. Sci.';\n</code></pre>"},{"location":"course/Database/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0/#2-derived-operations","title":"2. \u6d3e\u751f\u8fd0\u7b97 (Derived Operations)","text":""},{"location":"course/Database/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0/#21-cap","title":"2.1 \u4ea4 (\\(\\cap\\))","text":"<p>\u4f5c\u7528\uff1a\u8fd4\u56de\u540c\u65f6\u51fa\u73b0\u5728\u5173\u7cfb \\(r\\) \u548c \\(s\\) \u4e2d\u7684\u5143\u7ec4\u3002\u8981\u6c42 \\(r\\) \u548c \\(s\\) \u5e76\u76f8\u5bb9\u3002</p> <p>\u7b26\u53f7\uff1a\\(r \\cap s\\)</p> <p>\u8bf4\u660e\uff1a\u53ef\u7531\u5dee\u8fd0\u7b97\u63a8\u5bfc\uff1a\\(r \\cap s = r - (r - s)\\)</p> <p>\u793a\u4f8b\uff1a\u627e\u51fa 2009 \u5e74\u79cb\u5b63 \u4e14 2010 \u5e74\u6625\u5b63\u5f00\u8bbe\u7684\u8bfe\u7a0b\u3002</p> <p>\u4ee3\u6570\uff1a \\(\\pi_{\\text{course\\_id}}(\\sigma_{\\text{semester} = \\text{'Fall'} \\land \\text{year} = 2009}(\\text{section}))\\) \\(\\cap\\) \\(\\pi_{\\text{course\\_id}}(\\sigma_{\\text{semester} = \\text{'Spring'} \\land \\text{year} = 2010}(\\text{section}))\\)</p> <p>SQL \u7b49\u4ef7\uff1a</p> <pre><code>(SELECT course_id FROM section WHERE semester = 'Fall' AND year = 2009)\nINTERSECT\n(SELECT course_id FROM section WHERE semester = 'Spring' AND year = 2010);\n</code></pre>"},{"location":"course/Database/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0/#22-theta-bowtie_p","title":"2.2 \\(\\theta\\)-\u8fde\u63a5 (\\(\\bowtie_P\\))","text":"<p>\u4f5c\u7528\uff1a\u6309\u7ed9\u5b9a\u8c13\u8bcd\uff08\u6761\u4ef6\uff09 \\(P\\) \u8fde\u63a5\u4e24\u4e2a\u5173\u7cfb \\(r\\) \u548c \\(s\\)\u3002</p> <p>\u7b26\u53f7\uff1a\\(r \\bowtie_P s\\)</p> <p>\u8bf4\u660e\uff1a\u8fd9\u662f\u7b1b\u5361\u5c14\u79ef\u548c\u9009\u62e9\u7684\u7ec4\u5408\uff0c\u7b49\u4ef7\u4e8e \\(\\sigma_P(r \\times s)\\)\u3002</p> <p>\u793a\u4f8b\uff1a\u627e\u51fa <code>instructor</code> \u548c <code>student</code> \u4e2d\u6240\u6709 <code>dept_name</code> \u76f8\u540c\u7684\u5143\u7ec4\u3002</p> <p>\u4ee3\u6570\uff1a \\(\\text{instructor} \\bowtie_{\\text{instructor.dept\\_name} = \\text{student.dept\\_name}} \\text{student}\\)</p> <p>SQL \u7b49\u4ef7\uff1a</p> <pre><code>SELECT *\nFROM instructor, student\nWHERE instructor.dept_name = student.dept_name;\n</code></pre>"},{"location":"course/Database/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0/#23-bowtie","title":"2.3 \u81ea\u7136\u8fde\u63a5 (\\(\\bowtie\\))","text":"<p>\u4f5c\u7528\uff1a\u5728\u4e24\u4e2a\u5173\u7cfb \\(r\\) \u548c \\(s\\) \u7684\u6240\u6709\u540c\u540d\u5c5e\u6027\u4e0a\u8fdb\u884c\u7b49\u503c\u8fde\u63a5\uff0c\u5e76\u81ea\u52a8\u53bb\u9664\u91cd\u590d\u7684\u516c\u5171\u5c5e\u6027\u5217\u3002</p> <p>\u7b26\u53f7\uff1a\\(r \\bowtie s\\)</p> <p>\u793a\u4f8b\uff1a\u8fde\u63a5 <code>student</code> \u548c <code>takes</code>\uff08\u5b83\u4eec\u6709\u516c\u5171\u5c5e\u6027 <code>ID</code>\uff09\u3002</p> <p>\u4ee3\u6570\uff1a \\(\\text{student} \\bowtie \\text{takes}\\)</p> <p>SQL \u7b49\u4ef7\uff1a</p> <pre><code>SELECT *\nFROM student NATURAL JOIN takes;\n</code></pre>"},{"location":"course/OperatingSystem/","title":"\u64cd\u4f5c\u7cfb\u7edf","text":"<p>\u8fd9\u91cc\u5305\u542b\u4e86BUPT\u672a\u6765\u5b66\u9662\u300a\u64cd\u4f5c\u7cfb\u7edf\u300b\u8fd9\u95e8\u8bfe\u7684\u8bfe\u7a0b\u5b9e\u9a8c\u3002</p>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%AE%9E%E9%AA%8C/","title":"\u64cd\u4f5c\u7cfb\u7edf\u7b2c\u4e00\u6b21\u5b9e\u9a8c","text":""},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%AE%9E%E9%AA%8C/#_2","title":"\u5b9e\u9a8c\u5185\u5bb9","text":"<p>\u672c\u6b21\u5b9e\u9a8c\u7684\u4e3b\u8981\u5185\u5bb9\u662f\u5728 Linux \u5185\u6838\u4e2d\u8bbe\u8ba1\u5e76\u5b9e\u73b0\u4e00\u4e2a\u65b0\u7684\u7cfb\u7edf\u8c03\u7528 <code>sys_proc_dfs</code>\u3002\u8be5\u7cfb\u7edf\u8c03\u7528\u9700\u8981\u80fd\u591f\u63a5\u6536\u4e00\u4e2a\u6307\u5b9a\u7684\u8fdb\u7a0b PID\uff0c\u5e76\u4ee5\u6b64\u4e3a\u8d77\u70b9\uff0c\u91c7\u7528\u6df1\u5ea6\u4f18\u5148\u641c\u7d22\u7684\u65b9\u5f0f\u904d\u5386\u8be5\u8fdb\u7a0b\u7684\u6240\u6709\u540e\u4ee3\u3002\u5728\u904d\u5386\u8fc7\u7a0b\u4e2d\uff0c\u9700\u8981\u6536\u96c6\u6bcf\u4e2a\u540e\u4ee3\u8fdb\u7a0b\u7684\u7279\u5b9a\u4fe1\u606f\uff0c\u5305\u62ec\u5176 PID\u3001\u72b6\u6001\u3001\u7528\u6237\u6001\u548c\u5185\u6838\u6001\u8fd0\u884c\u65f6\u95f4\u3001\u7236/\u5b50/\u5144\u8fdb\u7a0b PID\u3001\u4e0a\u4e00\u6b21\u8c03\u5ea6\u7684\u8d77\u6b62\u65f6\u95f4\u6233\uff0c\u4ee5\u53ca\u4e00\u4e2a\u8868\u793a\u6570\u636e\u662f\u5426\u6210\u529f\u5199\u5165\u7528\u6237\u7f13\u51b2\u533a\u7684\u6807\u5fd7\u3002\u6700\u540e\uff0c\u7cfb\u7edf\u8c03\u7528\u9700\u5c06\u6536\u96c6\u5230\u7684\u8fd9\u4e9b\u8fdb\u7a0b\u8bb0\u5f55\u5b89\u5168\u5730\u62f7\u8d1d\u5230\u7528\u6237\u7a7a\u95f4\u63d0\u4f9b\u7684\u7f13\u51b2\u533a\u4e2d\uff0c\u4f9b\u7528\u6237\u6001\u6d4b\u8bd5\u7a0b\u5e8f\u8bfb\u53d6\u548c\u5c55\u793a\u3002</p>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%AE%9E%E9%AA%8C/#_3","title":"\u5b9e\u9a8c\u601d\u8def","text":"<p>\u672c\u5b9e\u9a8c\u91c7\u53d6\u5206\u9636\u6bb5\u63a8\u8fdb\u7684\u7b56\u7565\u3002\u9996\u5148\u7740\u624b\u4e8e\u642d\u5efa\u548c\u9a8c\u8bc1\u5185\u6838\u7f16\u8bd1\u73af\u5883\uff0c\u901a\u8fc7\u6dfb\u52a0\u4e00\u4e2a\u6781\u7b80\u7684 <code>sys_hello</code> \u7cfb\u7edf\u8c03\u7528\uff0c\u8dd1\u901a\u4e86\u4ece\u4fee\u6539\u5185\u6838\u6e90\u7801\u3001\u7f16\u8bd1\u3001\u5b89\u88c5\u3001\u91cd\u542f\u5230\u7528\u6237\u6001\u6d4b\u8bd5\u7684\u5b8c\u6574\u6d41\u7a0b\uff0c\u4e3a\u540e\u7eed\u5f00\u53d1\u5960\u5b9a\u57fa\u7840\u3002</p> <p>\u660e\u786e\u4e86\u57fa\u672c\u6d41\u7a0b\u540e\uff0c\u6839\u636e\u5b9e\u9a8c\u8981\u6c42\uff0c\u5728\u5185\u6838\u5934\u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e86\u7528\u4e8e\u6570\u636e\u4ea4\u6362\u7684<code>struct proc_dfs_info</code> \u7ed3\u6784\u4f53\u3002\u7d27\u63a5\u7740\uff0c\u5728\u5185\u6838\u4e2d\u6ce8\u518c\u4e86\u65b0\u7684\u7cfb\u7edf\u8c03\u7528 <code>sys_proc_dfs</code>\uff0c\u5e76\u5b9e\u73b0\u4e86\u5176\u57fa\u672c\u6846\u67b6\uff0c\u786e\u4fdd\u80fd\u591f\u6b63\u786e\u63a5\u6536\u7528\u6237\u4f20\u5165\u7684PID\u3001\u7f13\u51b2\u533a\u5730\u5740\u548c\u5927\u5c0f\u7b49\u53c2\u6570\uff0c\u5e76\u8fdb\u884c\u521d\u6b65\u7684\u5408\u6cd5\u6027\u6821\u9a8c\u3002</p> <p>\u5b9e\u9a8c\u7684\u6838\u5fc3\u5728\u4e8e\u5185\u6838\u6001\u6df1\u5ea6\u4f18\u5148\u641c\u7d22\u903b\u8f91\u7684\u5b9e\u73b0\u3002\u4e3a\u6b64\uff0c\u8bbe\u8ba1\u4e86 <code>kernel_dfs_traverse</code> \u8f85\u52a9\u51fd\u6570\u3002\u8be5\u51fd\u6570\u5229\u7528Linux\u5185\u6838\u63d0\u4f9b\u7684\u94fe\u8868\u904d\u5386\u5b8f\uff08\u5982 <code>list_for_each_entry</code>\uff09\u548cRCU\u8bfb\u5199\u9501\u6765\u5b89\u5168\u5730\u8bbf\u95ee\u8fdb\u7a0b\u6570\u636e\u7ed3\u6784\uff08<code>task_struct</code>\uff09\uff0c\u9012\u5f52\u5730\u904d\u5386 <code>children</code> \u548c <code>sibling</code> \u94fe\u8868\uff0c\u5b9e\u73b0\u4e86DFS\u7b97\u6cd5\u3002</p> <p>\u5728\u904d\u5386\u8fc7\u7a0b\u4e2d\uff0c<code>kernel_dfs_traverse</code> \u51fd\u6570\u8d1f\u8d23\u4ece <code>task_struct</code> \u53ca\u5176\u5185\u5d4c\u7684\u8c03\u5ea6\u76f8\u5173\u7ed3\u6784\u4f53\uff08\u5982 <code>sched_entity</code>\uff09\u4e2d\u63d0\u53d6\u6240\u9700\u7684\u8fdb\u7a0b\u4fe1\u606f\uff0c\u5e76\u5c06\u5176\u586b\u5145\u5230\u4e00\u4e2a\u4e34\u65f6\u7684\u5185\u6838\u6001 <code>kinfo</code> \u7ed3\u6784\u4f53\u4e2d\u3002</p> <p>\u6700\u540e\uff0c\u7f16\u5199\u4e86\u7528\u6237\u6001\u6d4b\u8bd5\u7a0b\u5e8f <code>test_dfs.c</code>\u3002\u8be5\u7a0b\u5e8f\u8d1f\u8d23\u89e3\u6790\u547d\u4ee4\u884c\u53c2\u6570\u83b7\u53d6\u76ee\u6807PID\uff0c\u5206\u914d\u7f13\u51b2\u533a\uff0c\u8c03\u7528\u65b0\u7684 <code>sys_proc_dfs</code> \u7cfb\u7edf\u8c03\u7528\uff0c\u63a5\u6536\u5185\u6838\u8fd4\u56de\u7684\u8fdb\u7a0b\u8bb0\u5f55\u6570\u91cf\u548c\u6570\u636e\uff0c\u5e76\u5c06\u8fd9\u4e9b\u6570\u636e\u683c\u5f0f\u5316\u4e3a\u6613\u4e8e\u9605\u8bfb\u7684\u8868\u683c\u8fdb\u884c\u8f93\u51fa\u3002\u6574\u4e2a\u5f00\u53d1\u8fc7\u7a0b\u4f34\u968f\u7740\u6301\u7eed\u7684 <code>printk/dmesg</code> \u5185\u6838\u8c03\u8bd5\u548c\u7528\u6237\u6001\u6d4b\u8bd5\uff0c\u4ee5\u89e3\u51b3\u7f16\u8bd1\u4f9d\u8d56\u3001\u8bed\u6cd5\u9519\u8bef\u3001API\u7406\u89e3\u504f\u5dee\u7b49\u95ee\u9898\uff0c\u786e\u4fdd\u6700\u7ec8\u5b9e\u73b0\u7684\u529f\u80fd\u7b26\u5408\u5b9e\u9a8c\u8981\u6c42\u3002</p>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%AE%9E%E9%AA%8C/#_4","title":"\u5b9e\u9a8c\u8fc7\u7a0b","text":""},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%AE%9E%E9%AA%8C/#_5","title":"\u73af\u5883\u642d\u5efa","text":"<p>\u672c\u5b9e\u9a8c\u4f7f\u7528VMware+Ubuntu\uff0c\u4e0b\u6587\u6240\u6709\u64cd\u4f5c\u5747\u5728\u865a\u62df\u673a\u4e2d\u8fdb\u884c\u3002</p> <p>\u4e0b\u8f7dLinux\u6e90\u4ee3\u7801\u5e76\u505a\u597d\u76f8\u5173\u73af\u5883\u914d\u7f6e\uff0c\u4e3a\u540e\u7eed\u5b9e\u9a8c\u5960\u5b9a\u57fa\u7840\u3002</p> <ol> <li>\u66f4\u65b0\u5305\u5217\u8868\u5e76\u5b89\u88c5\u7f16\u8bd1\u4f9d\u8d56</li> </ol> <p><pre><code> sudo apt update\n sudo apt install -y build-essential libncurses-dev bison flex libssl-dev libelf-dev git\n</code></pre>    \u5176\u4e2d\uff0c-y\u9009\u9879\u7528\u4e8e\u5728\u6240\u6709\u4ea4\u4e92\u5f0f\u63d0\u793a\u81ea\u52a8\u56de\u7b54yes\u3002</p> <ol> <li>\u4e0b\u8f7dLinux\u5185\u6838\u6e90\u7801</li> </ol> <pre><code> apt source linux=6.14.0-33.33\n</code></pre> <ol> <li>\u914d\u7f6e\u5185\u6838</li> </ol> <pre><code> # 1. \u8fdb\u5165\u6e90\u7801\u76ee\u5f55\n cd linux-6.14.0/\n # 2. \u590d\u5236\u5f53\u524d\u7cfb\u7edf\u7684\u5185\u6838\u914d\u7f6e\u6587\u4ef6\n cp /boot/config-$(uname -r) .config\n # 3. \u57fa\u4e8e\u65e7\u7684 .config \u6587\u4ef6\u81ea\u52a8\u56de\u7b54\u6240\u6709\u65b0\u914d\u7f6e\u9879\n make olddefconfig\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%AE%9E%E9%AA%8C/#_6","title":"\u73af\u5883\u9a8c\u8bc1","text":"<p>\u5728\u914d\u7f6e\u597d\u7684\u73af\u5883\u4e2d\uff0c\u5c1d\u8bd5\u5199\u4e00\u4e2asys_hello\u7cfb\u7edf\u8c03\u7528\u4ee5\u9a8c\u8bc1\u73af\u5883\u6b63\u5e38\u5e76\u719f\u6089\u7f16\u5199\u7cfb\u7edf\u8c03\u7528\u7684\u8fc7\u7a0b\u3002</p> <ol> <li>\u5206\u914d\u7cfb\u7edf\u8c03\u7528\u53f7</li> </ol> <p>\u7f16\u8f91 <code>arch/x86/entry/syscalls/syscall_64.tbl</code> \u6587\u4ef6\u3002\u5728\u6700\u540e\u4e00\u884c\u6dfb\u52a0\uff1a<code>548 64  hello           sys_hello</code>\u3002<code>548</code> \u4e3a\u65b0\u7cfb\u7edf\u8c03\u7528\u53f7\uff0c<code>64</code> \u8868\u793a\u8fd9\u662f\u4e00\u4e2a64\u4f4d\u7cfb\u7edf\u8c03\u7528\uff0c<code>hello</code> \u662f\u7cfb\u7edf\u8c03\u7528\u7684\u540d\u79f0\uff0c<code>sys_hello</code> \u662f\u5185\u6838\u4e2d\u5bf9\u5e94\u7684\u51fd\u6570\u540d\u3002</p> <ol> <li>\u58f0\u660e\u51fd\u6570\u539f\u578b</li> </ol> <p>\u7f16\u8f91 <code>include/linux/syscalls.h</code> \u8fd9\u4e2a\u5934\u6587\u4ef6\uff0c\u5728\u6700\u540e\u4e00\u4e2a <code>#endif</code> \u4e4b\u524d\uff0c\u6dfb\u52a0\uff1a<code>asmlinkage long sys_hello(void)</code>; \u58f0\u660e\u6211\u4eec\u7684\u51fd\u6570\uff0c\u4ee5\u4fbf\u5185\u6838\u7684\u5176\u4ed6\u90e8\u5206\u80fd\u627e\u5230\u5b83\u3002</p> <ol> <li>\u5b9e\u73b0\u51fd\u6570</li> </ol> <p>\u7f16\u8f91 <code>kernel/sys.c</code> \u6587\u4ef6\uff0c\u5728\u6700\u672b\u5c3e\u6dfb\u52a0\u6211\u4eec\u5bf9\u7cfb\u7edf\u8c03\u7528\u7684\u51fd\u6570\u5b9e\u73b0\u3002    <pre><code> #include &lt;linux/printk.h&gt; // \u5305\u542b printk \u51fd\u6570\u7684\u5b9a\u4e49\n SYSCALL_DEFINE0(hello)\n {\n     printk(KERN_INFO \"Hello, World! My first syscall is working!\\n\");\n     return 0;\n }\n</code></pre>    \u5176\u4e2d\uff0c<code>SYSCALL_DEFINE0</code> \u662f\u4e00\u4e2a\u5b8f\uff0c\u7528\u4e8e\u5b9a\u4e49\u4e00\u4e2a\u6ca1\u6709\u53c2\u6570\u7684\u7cfb\u7edf\u8c03\u7528\uff1b<code>KERN_INFO</code> \u662f\u65e5\u5fd7\u7ea7\u522b\uff1b\u7cfb\u7edf\u8c03\u7528\u6700\u540e\u5e94\u8fd4\u56de\u4e00\u4e2a\u503c\u3002</p> <ol> <li> <p>\u7f16\u8bd1\u5e76\u5b89\u88c5\u5185\u6838 <pre><code> # -j$(nproc) \u4f1a\u4f7f\u7528\u6240\u6709\u7684 CPU \u6838\u5fc3\u6765\u5e76\u884c\u7f16\u8bd1\uff0c\u901f\u5ea6\u6700\u5feb\n make -j$(nproc)\n # \u6dfb\u52a0\u6267\u884c\u6743\u9650\n chmod +x debian/scripts/*\n # \u5b89\u88c5\u5185\u6838\u6a21\u5757\n sudo make modules_install\n # \u5b89\u88c5\u5185\u6838\n sudo make install\n # \u91cd\u542f\u865a\u62df\u673a\n sudo reboot\n</code></pre></p> </li> <li> <p>\u7f16\u5199\u7528\u6237\u6001\u6d4b\u8bd5\u7a0b\u5e8f    \u521b\u5efa\u4e00\u4e2a\u65b0\u6587\u4ef6test_hello.c\uff0c\u5199\u5165\u4ee5\u4e0b\u4ee3\u7801\u3002    <pre><code> #include &lt;stdio.h&gt;\n #include &lt;unistd.h&gt;\n #include &lt;sys/syscall.h&gt; // \u5305\u542b syscall() \u51fd\u6570\n #include &lt;errno.h&gt;       // \u5305\u542b perror()\n\n #define SYS_hello 548\n\n int main() {\n     long ret;\n     printf(\"\u6b63\u5728\u8c03\u7528 sys_hello (syscall #%d)...\\n\", SYS_hello);\n     ret = syscall(SYS_hello);\n     if (ret == 0) {\n         printf(\"\u8c03\u7528\u6210\u529f! \u8bf7\u68c0\u67e5 dmesg \u67e5\u770b\u5185\u6838\u65e5\u5fd7\u3002\\n\");\n     } else {\n         // \u5982\u679c ret \u4e0d\u662f 0 (\u6bd4\u5982 -1)\uff0c\u8bf4\u660e\u51fa\u9519\u4e86\n         // perror \u4f1a\u6839\u636e errno \u81ea\u52a8\u6253\u5370\u9519\u8bef\u4fe1\u606f\n         perror(\"syscall(sys_hello) \u5931\u8d25\");\n     }\n     return 0;\n }\n</code></pre>    \u5176\u4e2d\uff0c<code>548</code> \u662f\u5728 <code>syscall_64.tbl</code> \u4e2d\u5206\u914d\u7684\u7cfb\u7edf\u8c03\u7528\u53f7\uff1b<code>syscall()</code> \u662f\u8c03\u7528\u4efb\u610f\u7cfb\u7edf\u8c03\u7528\u7684\u6807\u51c6 C \u5e93\u51fd\u6570\u3002</p> </li> <li> <p>\u6d4b\u8bd5sys_hello\u7cfb\u7edf\u8c03\u7528 <pre><code> # \u7f16\u8bd1\n gcc ~/test_hello.c -o ~/test_hello\n # \u8fd0\u884c\n ~/test_hello\n # \u67e5\u770b\u5185\u6838\u65e5\u5fd7\n dmesg | tail -n 5\n</code></pre></p> </li> </ol>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%AE%9E%E9%AA%8C/#_7","title":"\u5b9a\u4e49\u6570\u636e\u7ed3\u6784","text":"<p>\u5728\u5185\u6838\u4e2d\u521b\u5efa\u5934\u6587\u4ef6 <code>include/linux/proc_dfs.h</code>\uff0c\u5e76\u5b9a\u4e49\u7528\u4e8e\u6570\u636e\u4ea4\u6362\u7684 <code>struct proc_dfs_info</code> \u7ed3\u6784\u4f53\uff0c\u4e3a\u540e\u7eed\u7f16\u5199\u7cfb\u7edf\u8c03\u7528\u505a\u597d\u51c6\u5907\u3002</p> <pre><code>#ifndef _LINUX_PROC_DFS_H\n#define _LINUX_PROC_DFS_H\n\n#include &lt;linux/types.h&gt;\n\nstruct proc_dfs_info {\n    pid_t pid;\n    int state;      // \u8fdb\u7a0b\u72b6\u6001\n    long utime;     // \u7528\u6237\u6001\u8fd0\u884c\u65f6\u95f4\n    long stime;     // \u5185\u6838\u6001\u8fd0\u884c\u65f6\u95f4\n    pid_t parent_pid;\n    pid_t first_child_pid;\n    pid_t next_sibling_pid;\n    u64 sched_start_ns;\n    u64 sched_end_ns;\n    int report;\n};\n#endif\n</code></pre> <p>\u5176\u4e2d\u5305\u62ec\u8be5\u8fdb\u7a0b PID\u3001\u72b6\u6001\u3001\u7528\u6237\u6001\u548c\u5185\u6838\u6001\u8fd0\u884c\u65f6\u95f4\u3001\u7236/\u5b50/\u5144\u8fdb\u7a0b PID\u3001\u4e0a\u4e00\u6b21\u8c03\u5ea6\u7684\u8d77\u6b62\u65f6\u95f4\u6233\uff0c\u4ee5\u53ca\u662f\u5426\u4e0a\u62a5\u7684\u6807\u5fd7\u3002</p>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%AE%9E%E9%AA%8C/#_8","title":"\u642d\u5efa\u7cfb\u7edf\u8c03\u7528\u6846\u67b6\u5e76\u6d4b\u8bd5","text":"<p>\u4eff\u7167\u4e4b\u524d\u7684 <code>sys_hello</code>\uff0c\u642d\u5efa <code>sys_proc_dfs</code> \u7684\u7cfb\u7edf\u8c03\u7528\u6846\u67b6\u5e76\u8fdb\u884c\u7b80\u7b54\u6d4b\u8bd5\u3002\u4e3a\u4e4b\u540e\u5b9e\u73b0dfs\u903b\u8f91\u7ec6\u8282\u7559\u4e0b\u7a7a\u95f4\u3002</p> <ol> <li> <p>\u5206\u914d\u7cfb\u7edf\u8c03\u7528\u53f7    \u7f16\u8f91 <code>arch/x86/entry/syscalls/syscall_64.tbl</code> \u6587\u4ef6\u3002\u5728\u6700\u540e\u4e00\u884c\u6dfb\u52a0\uff1a<code>549 64  proc_dfs        sys_proc_dfs</code>\u3002<code>549</code> \u4e3a\u65b0\u7cfb\u7edf\u8c03\u7528\u53f7\uff0c<code>64</code> \u8868\u793a\u8fd9\u662f\u4e00\u4e2a64\u4f4d\u7cfb\u7edf\u8c03\u7528\uff0c<code>proc_dfs</code> \u662f\u7cfb\u7edf\u8c03\u7528\u7684\u540d\u79f0\uff0c<code>sys_proc_dfs</code> \u662f\u5185\u6838\u4e2d\u5bf9\u5e94\u7684\u51fd\u6570\u540d\u3002</p> </li> <li> <p>\u58f0\u660e\u51fd\u6570\u539f\u578b</p> </li> </ol> <p>\u5728 <code>include/linux/syscalls.h</code> \u7684\u672b\u5c3e <code>#endif</code> \u524d\uff0c\u6dfb\u52a0\uff1a    <pre><code>#include &lt;linux/proc_dfs.h&gt;\nasmlinkage long sys_proc_dfs(\n    pid_t top_pid,\n    struct proc_dfs_info __user *buf,\n    size_t buf_size\n);\n</code></pre></p> <ol> <li>\u5b9e\u73b0\u7cfb\u7edf\u8c03\u7528\u51fd\u6570\u9aa8\u67b6</li> </ol> <p>\u5728 <code>kernel/sys.c</code> \u7684\u672b\u5c3e\uff0c\u7f16\u5199\u7cfb\u7edf\u8c03\u7528\u51fd\u6570\u7684\u9aa8\u67b6\u3002    <pre><code>#include &lt;linux/uaccess.h&gt;   // \u5305\u542b copy_to_user / copy_from_user\n#include &lt;linux/proc_dfs.h&gt;  // \u5305\u542b\u7ed3\u6784\u4f53\u5b9a\u4e49\n\nSYSCALL_DEFINE3(proc_dfs,\n                pid_t, top_pid,\n                struct proc_dfs_info __user *, buf,\n                size_t, buf_size)\n{\n    printk(KERN_INFO \"[proc_dfs] \u7cfb\u7edf\u8c03\u7528\u88ab\u89e6\u53d1!\\n\");\n    printk(KERN_INFO \"[proc_dfs] \u76ee\u6807 PID: %d, \u7f13\u51b2\u533a\u5730\u5740: %p, \u7f13\u51b2\u533a\u5927\u5c0f: %ld \u5b57\u8282\\n\",\n            top_pid, buf, buf_size);\n\n    /* --- \u53c2\u6570\u5408\u6cd5\u6027\u68c0\u67e5 ---\n     * \u68c0\u67e5\u7528\u6237\u4f20\u5165\u7684\u7f13\u51b2\u533a\u5730\u5740\u662f\u5426\u4e3a\u7a7a\n     * \u68c0\u67e5\u7f13\u51b2\u533a\u5927\u5c0f\u662f\u5426\u81f3\u5c11\u80fd\u5bb9\u7eb3\u4e00\u4e2a\u7ed3\u6784\u4f53\n     */\n    if (buf == NULL || buf_size &lt; sizeof(struct proc_dfs_info)) {\n        printk(KERN_WARNING \"[proc_dfs] \u7f13\u51b2\u533a\u65e0\u6548! buf: %p, buf_size: %ld\\n\",\n                buf, buf_size);\n        return -EINVAL; // \u8fd4\u56de \"Invalid Argument\" (\u65e0\u6548\u53c2\u6570) \u9519\u8bef\n    }\n\n    // \u6682\u65f6\u5148\u8fd4\u56de 0\uff0c\u8868\u793a\u6210\u529f\u627e\u5230\u4e86 0 \u4e2a\u8fdb\u7a0b\n    printk(KERN_INFO \"[proc_dfs] \u9aa8\u67b6\u6267\u884c\u5b8c\u6bd5\uff0c\u6682\u65f6\u8fd4\u56de 0\u3002\\n\");\n    return 0;\n}\n</code></pre>    \u5728\u53c2\u6570\u5217\u8868\u4e2d\uff0c<code>top_pid</code> \u4e3a\u8d77\u59cb\u8fdb\u7a0b PID\uff1b<code>buf</code> \u4e3a\u7528\u6237\u7a7a\u95f4\u6307\u9488\uff0c\u6307\u5411 proc_dfs_info \u6570\u7ec4\uff1b<code>buf_size</code>\uff1a\u7f13\u51b2\u533a\u5b57\u8282\u6570\uff0c\u7528\u4e8e\u8ba1\u7b97\u80fd\u5bb9\u7eb3\u7684\u8bb0\u5f55\u6570\u3002\u5728\u9aa8\u67b6\u4e2d\uff0c\u6253\u5370\u8c03\u8bd5\u4fe1\u606f\uff0c\u68c0\u67e5\u4f20\u5165\u53c2\u6570\u7684\u5408\u6cd5\u6027\uff0c\u5e76\u8fd4\u56de0\u3002</p> <ol> <li>\u7f16\u5199\u7528\u6237\u6001\u6d4b\u8bd5\u7a0b\u5e8f</li> </ol> <p><pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;  \n#include &lt;sys/syscall.h&gt;\n#include &lt;errno.h&gt;   \n\n#define __NR_proc_dfs 549\n\nstruct proc_dfs_info {\n    pid_t pid;\n    int state;\n    long utime;\n    long stime;\n    pid_t parent_pid;\n    pid_t first_child_pid;\n    pid_t next_sibling_pid;\n    unsigned long long sched_start_ns; // \u5728 C \u8bed\u8a00\u4e2d\u7528 unsigned long long \u5bf9\u5e94 u64\n    unsigned long long sched_end_ns;\n    int reported;\n};\n\nint main(int argc, char *argv[]) {\n    pid_t pid;\n    struct proc_dfs_info buffer[100]; // \u5728\u6808\u4e0a\u5206\u914d\u4e00\u4e2a\u80fd\u88c5100\u4e2a\u8bb0\u5f55\u7684\u7f13\u51b2\u533a\n    size_t buf_size = sizeof(buffer); // \u7f13\u51b2\u533a\u603b\u5927\u5c0f\uff08\u5b57\u8282\uff09\n    long num_procs_found;\n\n    if (argc &lt; 2) {\n        fprintf(stderr, \"\u7528\u6cd5: %s &lt;PID&gt;\\n\", argv[0]);\n        return 1;\n    }\n\n    pid = atoi(argv[1]); // \u628a\u7b2c\u4e00\u4e2a\u53c2\u6570\uff08\u5b57\u7b26\u4e32\uff09\u8f6c\u6210\u6574\u6570 PID\n\n    printf(\"\u6b63\u5728\u8c03\u7528 sys_proc_dfs (syscall #%d) ...\\n\", __NR_proc_dfs);\n    printf(\"\u76ee\u6807 PID: %d, \u7f13\u51b2\u533a\u5927\u5c0f: %ld \u5b57\u8282\\n\", pid, buf_size);\n\n    num_procs_found = syscall(__NR_proc_dfs, pid, buffer, buf_size);\n\n    if (num_procs_found &lt; 0) {\n        perror(\"syscall(proc_dfs) \u5931\u8d25\");\n        return 1;\n    }\n\n    printf(\"\u7cfb\u7edf\u8c03\u7528\u6210\u529f\uff01\\n\");\n    printf(\"\u5185\u6838\uff08\u6682\u65f6\uff09\u8fd4\u56de\u4e86 %ld \u4e2a\u8fdb\u7a0b\u3002\\n\", num_procs_found);\n    return 0;\n}\n</code></pre>    \u5728\u7528\u6237\u7a7a\u95f4\u5b9a\u4e49\u5b8c\u5168\u76f8\u540c\u7684\u7ed3\u6784\u4f53\u4ee5\u4fbf C \u7f16\u8bd1\u5668\u77e5\u9053\u5982\u4f55\u5206\u914d\u5185\u5b58\u548c\u89e3\u6790\u6570\u636e\u3002\u4e0d\u80fd <code>#include &lt;linux/proc_dfs.h&gt;</code> \u56e0\u4e3a\u90a3\u4e2a\u662f\u5185\u6838\u5934\u6587\u4ef6\uff0c\u7528\u6237\u7a7a\u95f4\u7a0b\u5e8f\u627e\u4e0d\u5230\u3002\u4f7f\u7528\u4e4b\u524d\u5206\u914d\u7684\u7cfb\u7edf\u8c03\u7528\u53f7\uff0c\u5e76\u8fdb\u884c\u7cfb\u7edf\u8c03\u7528\uff0c\u8f93\u51fa\u8c03\u8bd5\u4fe1\u606f\u3002</p> <ol> <li>\u6d4b\u8bd5\u7cfb\u7edf\u8c03\u7528\u6846\u67b6</li> </ol> <p>\u7f16\u8bd1\u4fee\u6539\u540e\u7684\u6574\u4e2a\u5185\u6838\uff0c\u5e76\u8fdb\u884c\u6d4b\u8bd5\u3002</p>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%AE%9E%E9%AA%8C/#dfs","title":"\u5b9e\u73b0\u5185\u6838\u6001\u7684\u8fdb\u7a0b\u6811 DFS \u904d\u5386","text":"<p>\u586b\u5145\u4e4b\u524d\u5b9e\u73b0\u7684\u7cfb\u7edf\u8c03\u7528\u9aa8\u67b6\uff0c\u5b9e\u73b0dfs\u904d\u5386\u7684\u903b\u8f91\u7ec6\u8282\u3002</p> <ol> <li> <p>\u521b\u5efadfs\u4e0a\u4e0b\u6587\u7ed3\u6784\u4f53 <pre><code>struct dfs_context {\n    struct proc_dfs_info __user *user_buf;\n    size_t max_count;\n    size_t current_count;\n};\n</code></pre>    \u5176\u4e2d\uff0c<code>user_buf</code> \u6307\u5411\u7528\u6237\u7f13\u51b2\u533a\uff0c<code>max_count</code> \u8868\u793a\u7f13\u51b2\u533a\u6700\u591a\u5bb9\u7eb3\u7684 proc_dfs_info \u4e2a\u6570\uff0c<code>current_count</code> \u8868\u793a\u5f53\u524d\u5df2\u5199\u5165\u591a\u5c11\u6761\u3002</p> </li> <li> <p>\u5b9e\u73b0dfs\u6838\u5fc3\u51fd\u6570 <pre><code>static void kernel_dfs_traverse(struct task_struct *task, struct dfs_context *ctx)\n{\n    struct task_struct *child;\n    struct proc_dfs_info kinfo; // \u5185\u6838\u7a7a\u95f4\u7684\u4e34\u65f6\u4fe1\u606f\n    u64 last_duration;          // \u7528\u4e8e\u8ba1\u7b97\u4e0a\u4e00\u4e2a\u65f6\u95f4\u7247\u7684\u6301\u7eed\u65f6\u957f\n\n    /* --- 1. \u7f13\u51b2\u533a\u68c0\u67e5 --- */\n    if (ctx-&gt;current_count &gt;= ctx-&gt;max_count) {\n        return;\n    }\n\n    /* --- 2. \u5f7b\u5e95\u521d\u59cb\u5316 kinfo --- */\n    memset(&amp;kinfo, 0, sizeof(kinfo));\n\n    /* --- 3. \u586b\u5145\u6240\u6709\u5b57\u6bb5 --- */\n    kinfo.pid = task-&gt;pid;\n    kinfo.state = task-&gt;__state;\n    kinfo.utime = task-&gt;utime;\n    kinfo.stime = task-&gt;stime;\n\n    if (task-&gt;real_parent) {\n        kinfo.parent_pid = task-&gt;real_parent-&gt;pid;\n    }\n\n    struct task_struct *first_child = list_first_entry_or_null(\n            &amp;task-&gt;children, struct task_struct, sibling);\n    if (first_child) {\n        kinfo.first_child_pid = first_child-&gt;pid;\n    }\n\n    struct task_struct *next_sibling = NULL;\n    if (task-&gt;real_parent &amp;&amp; \n        !list_is_last(&amp;task-&gt;sibling, &amp;task-&gt;real_parent-&gt;children)) {\n        next_sibling = list_next_entry(task, sibling);\n    }\n    if (next_sibling) {\n        kinfo.next_sibling_pid = next_sibling-&gt;pid;\n    }\n\n    kinfo.sched_start_ns = task-&gt;se.exec_start;\n\n    // \u8ba1\u7b97\u4e0a\u4e00\u4e2a\u65f6\u95f4\u7247\u7684\u6301\u7eed\u65f6\u957f\n    last_duration = task-&gt;se.sum_exec_runtime - task-&gt;se.prev_sum_exec_runtime;\n\n    // \u8ba1\u7b97\u7ed3\u675f\u65f6\u95f4 = \u5f00\u59cb\u65f6\u95f4 + \u6301\u7eed\u65f6\u957f\n    kinfo.sched_end_ns = task-&gt;se.exec_start + last_duration;\n\n    // --- \"\u662f\u5426\u4e0a\u62a5\" ---\n    kinfo.report = 0;\n\n    /* --- 4. \u4e00\u6b21\u6027\u3001\u539f\u5b50\u6027\u5730\u5199\u5165 --- */\n    if (copy_to_user(&amp;ctx-&gt;user_buf[ctx-&gt;current_count], &amp;kinfo, sizeof(kinfo))) {\n        printk(KERN_WARNING \"[proc_dfs] copy_to_user \u5931\u8d25! \u505c\u6b62\u3002\\n\");\n        ctx-&gt;max_count = 0;\n        return;\n    }\n\n    /* --- 5. \u5199\u5165\u6210\u529f\uff0c\u9012\u589e\u8ba1\u6570\u5668 --- */\n    ctx-&gt;current_count++;\n    kinfo.report = 1; // \u5df2\u4e0a\u62a5\n\n    /* --- 6. \u9012\u5f52 --- */\n    list_for_each_entry(child, &amp;task-&gt;children, sibling) {\n        kernel_dfs_traverse(child, ctx);\n\n        if (ctx-&gt;max_count == 0) {\n            return;\n        }\n    }\n}\n</code></pre>    \u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u4ece task_struct \u4e2d\u83b7\u53d6\u6240\u9700\u7684 proc_dfs_info\uff0c\u7136\u540e\u5199\u5165\u7f13\u51b2\u533a\uff0c\u6700\u540e\u4f7f\u7528 <code>list_for_each_entry</code> \u5b8f\u9012\u5f52\u5730\u5bf9\u5b50\u8fdb\u7a0b\u8fdb\u884c\u904d\u5386\u3002</p> </li> <li> <p>\u586b\u5145\u7cfb\u7edf\u8c03\u7528\u9aa8\u67b6 <pre><code>SYSCALL_DEFINE3(proc_dfs,\n                pid_t, top_pid,\n                struct proc_dfs_info __user *, buf,\n                size_t, buf_size) {\n\n    struct task_struct *start_task;\n    struct dfs_context ctx;\n    long process_count;\n\n    // \u5185\u6838\u8c03\u8bd5\u65e5\u5fd7\n    printk(KERN_INFO \"[proc_dfs] \u7cfb\u7edf\u8c03\u7528\u88ab\u89e6\u53d1!\\n\");\n    printk(KERN_INFO \"[proc_dfs] \u76ee\u6807 PID: %d, \u7f13\u51b2\u533a\u5730\u5740: %p, \u7f13\u51b2\u533a\u5927\u5c0f: %ld \u5b57\u8282\\n\", \n            top_pid, buf, buf_size);\n\n    // \u53c2\u6570\u5408\u6cd5\u6027\u68c0\u67e5\n    if (buf == NULL || buf_size &lt; sizeof(struct proc_dfs_info)) {\n        printk(KERN_WARNING \"[proc_dfs] \u7f13\u51b2\u533a\u65e0\u6548\uff01buf: %p, buf_size: %ld\\n\", \n                buf, buf_size);\n        return -EINVAL;\n    }\n\n    ctx.user_buf = buf;\n    ctx.current_count = 0;\n    ctx.max_count = buf_size / sizeof(struct proc_dfs_info);\n    printk(KERN_INFO \"[proc_dfs] \u7f13\u51b2\u533a\u6700\u591a\u53ef\u5bb9\u7eb3 %ld \u4e2a\u8fdb\u7a0b\u8bb0\u5f55\u3002\\n\", ctx.max_count);\n\n    rcu_read_lock();\n    start_task = find_task_by_vpid(top_pid);\n    if (start_task == NULL) {\n        printk(KERN_WARNING \"[porc_dfs] PID %d \u672a\u627e\u5230\uff01\\n\", top_pid);\n        rcu_read_unlock();\n        return -ESRCH;\n    }\n    printk(KERN_INFO \"[proc_dfs] \u6210\u529f\u627e\u5230 PID %d\uff0c\u5f00\u59cbDFS\u904d\u5386...\\n\", top_pid);\n\n    struct task_struct *child;\n    list_for_each_entry(child, &amp;start_task-&gt;children, sibling) {\n        kernel_dfs_traverse(child, &amp;ctx);\n    }\n\n    rcu_read_unlock();\n    process_count = ctx.current_count;\n    printk(KERN_INFO \"[proc_dfs] \u904d\u5386\u5b8c\u6210\uff0c\u603b\u5171\u627e\u5230 %ld \u4e2a\u540e\u4ee3\u8fdb\u7a0b\u3002\\n\", process_count);\n    return process_count;\n}\n</code></pre>    \u521b\u5efa\u4e00\u4e2a dfs \u7684\u4e0a\u4e0b\u6587\u53d8\u91cf ctx \u7528\u4e8e\u8bb0\u5f55\u7f13\u51b2\u533a\u4f7f\u7528\u60c5\u51b5\uff0c\u5e76\u5bf9\u5176\u8fdb\u884c\u521d\u59cb\u5316\uff1b\u5728\u7528 kernel_dfs_traverse \u5bf9\u8fdb\u7a0b\u8fdb\u884c\u8bbf\u95ee\u7684\u524d\u540e\uff0c\u4f7f\u7528 <code>rcu_read_lock()</code> \u548c <code>rcu_read_unlock()</code> \u6765\u52a0\u9501\uff0c\u4fdd\u8bc1\u8bfb\u53d6\u5b89\u5168\uff1b\u4f7f\u7528 <code>find_task_by_vpid</code> \u6765\u5f97\u5230\u4f20\u5165 id \u7684\u8fdb\u7a0b\uff1b\u5bf9\u6bcf\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u8c03\u7528 kernel_dfs_traverse \u8fdb\u884c\u904d\u5386\u3002</p> </li> <li> <p>\u4fee\u6539\u7528\u6237\u6d4b\u8bd5\u7a0b\u5e8f <pre><code>int main(int argc, char *argv[]) {\n    pid_t pid;\n    struct proc_dfs_info buffer[100];\n    size_t buf_size = sizeof(buffer);\n    long num_procs_found; // \u5185\u6838\u5c06\u8fd4\u56de\u627e\u5230\u7684\u8fdb\u7a0b\u6570\n\n    if (argc &lt; 2) {\n        fprintf(stderr, \"\u7528\u6cd5: %s &lt;PID&gt;\\n\", argv[0]);\n        fprintf(stderr, \"\u4f8b\u5982: %s 1\\n\", argv[0]);\n        return 1;\n    }\n\n    pid = atoi(argv[1]);\n\n    printf(\"\u6b63\u5728\u8c03\u7528 sys_proc_dfs (syscall #%d) ...\\n\", __NR_proc_dfs);\n    printf(\"\u76ee\u6807 PID: %d, \u7f13\u51b2\u533a\u5927\u5c0f: %ld \u5b57\u8282\\n\", pid, buf_size);\n\n    // -- \u8c03\u7528\u7cfb\u7edf\u8c03\u7528 --\n    num_procs_found = syscall(__NR_proc_dfs, pid, buffer, buf_size);\n\n    if (num_procs_found &lt; 0) {\n        perror(\"syscall(proc_dfs) \u5931\u8d25\");\n        return 1;\n    }\n\n    if (num_procs_found == 0) {\n        printf(\"\u7cfb\u7edf\u8c03\u7528\u6210\u529f\uff01\u672a\u627e\u5230\u540e\u4ee3\u8fdb\u7a0b\u3002\\n\");\n        return 0;\n    }\n\n    printf(\"\u7cfb\u7edf\u8c03\u7528\u6210\u529f\uff01\u5185\u6838\u8fd4\u56de\u4e86 %ld \u4e2a\u540e\u4ee3\u8fdb\u7a0b\u8bb0\u5f55\uff1a\\n\\n\", num_procs_found);\n\n    printf(\"PID\\t \u72b6\u6001\\t \u7236PID\\t \u9996\u5b50PID\\t \u5144PID\\t \u7528\u6237\u6001(ns)\\t \u5185\u6838\u6001(ns)\\t \u8c03\u5ea6\u5f00\u59cb(ns)\\t\\t \u8c03\u5ea6\u7ed3\u675f(ns)\\t \u662f\u5426\u4e0a\u62a5\\n\");\n    printf(\"------------------------------------------------------------------------------------------\\n\");\n\n    for (long i = 0; i &lt; num_procs_found; i++) {\n        printf(\"%d\\t %d\\t %d\\t %d\\t\\t %d\\t %ld\\t\\t %ld\\t\\t %llu\\t %llu\\t %d\\n\",\n                buffer[i].pid,\n                buffer[i].state,\n                buffer[i].parent_pid,\n                buffer[i].first_child_pid,\n                buffer[i].next_sibling_pid,\n                buffer[i].utime,\n                buffer[i].stime,\n                buffer[i].sched_start_ns,\n                buffer[i].sched_end_ns,\n                buffer[i].report\n        );\n    }\n    return 0;\n}\n</code></pre>    \u8fdb\u884c\u7cfb\u7edf\u8c03\u7528\uff0c\u5e76\u5c06\u4fe1\u606f\u6253\u5370\u6210\u8868\u683c\u3002</p> </li> <li> <p>\u5b89\u88c5\u4e0e\u6d4b\u8bd5</p> </li> </ol> <p>\u91cd\u65b0\u7f16\u8bd1\u5185\u6838\uff0c\u5b89\u88c5\u5e76\u91cd\u542f\uff0c\u7136\u540e\u7f16\u8bd1\u8fd0\u884c\u7528\u6237\u6d4b\u8bd5\u7a0b\u5e8f\u3002</p>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%AE%9E%E9%AA%8C/#_9","title":"\u5b9e\u9a8c\u7ed3\u679c","text":"<p>\u7f16\u8bd1\u6700\u540e\u7684\u6d4b\u8bd5\u7a0b\u5e8f\uff0c\u8fd0\u884c <code>test_dfs 1</code>\uff0c\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>wuyukai@wuyukai-VMware-Virtual-Platform:~$ ./test_dfs 1\n\u6b63\u5728\u8c03\u7528 sys_proc_dfs (syscall #549) ...\n\u76ee\u6807 PID: 1, \u7f13\u51b2\u533a\u5927\u5c0f: 6400 \u5b57\u8282\n\u7cfb\u7edf\u8c03\u7528\u6210\u529f\uff01\u5185\u6838\u8fd4\u56de\u4e86 100 \u4e2a\u540e\u4ee3\u8fdb\u7a0b\u8bb0\u5f55\uff1a\n\nPID      \u72b6\u6001    \u7236PID   \u9996\u5b50PID         \u5144PID   \u7528\u6237\u6001(ns)      \u5185\u6838\u6001(ns)      \u8c03\u5ea6\u5f00\u59cb(ns)           \u8c03\u5ea6\u7ed3\u675f(ns)     \u662f\u5426\u4e0a\u62a5\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\n544      1       1       0               561     107000000               118000000               79369766971     79369821202     0\n561      1       1       0               606     22000000                16000000                99864731908     99865023368     0\n606      1       1       0               613     11000000                15000000                75392887420     75393031595     0\n613      1       1       0               616     19000000                28000000                91164404923     91164554888     0\n616      1       1       0               1349    126000000               83000000                60621728406     60621928507     0\n1349     1       1       0               1351    2000000                 3000000                 12855576696     12855619296     0\n1351     1       1       1422            1352    6000000                 15000000                99815140906     99815211246     0\n1422     8193    1351    0               0       0               0               13130215843     13130219384     0\n1352     1       1       0               1357    125000000               65000000                80206570229     80206879186     0\n1357     1       1       0               1368    11000000                13000000                14002669395     14002763954     0\n1368     1       1       0               1381    83000000                54000000                76130952271     76130957691     0\n1381     8193    1       0               1382    44000000                803000000               14172405048     14172408299     0\n1382     1       1       0               1388    15000000                29000000                69696448658     69696460936     0\n1388     8193    1       0               1390    2000000                 5000000                 78964019084     78964062445     0\n1390     1       1       0               1395    9000000                 17000000                15490356330     15490420098     0\n1395     1       1       0               1400    40000000                46000000                76606692000     76606697233     0\n1400     1       1       0               1411    26000000                36000000                69696614986     69696633825     0\n1411     1       1       0               1448    18000000                6000000                 13056056773     13056124258     0\n1448     1       1       0               1451    19000000                48000000                76031503650     76031649401     0\n1451     1       1       0               1489    1000000                 19000000                93239783783     93239819667     0\n1489     1       1       0               1588    26000000                42000000                69696596147     69696610688     0\n1588     1       1       1603            1591    10000000                18000000                49233498121     49233566798     0\n1603     1       1588    0               0       3000000                 2000000                 13926085085     13926097562     0\n1591     1       1       0               1611    66000000                20000000                14017484583     14017866238     0\n1611     1       1       1617            1624    5000000                 6000000                 16714207457     16714247802     0\n1617     1       1611    1697            0       3000000                 11000000                14318180136     14318550074     0\n1697     1       1617    1738            0       4000000                 2000000                 14383255648     14383283060     0\n1738     1       1697    1740            0       1000000                 1000000                 14393999867     14394102101     0\n1740     1       1738    2281            1765    38000000                34000000                76605822162     76605959078     0\n2281     128     1740    0               0       0               1000000                 16773897505    16773901749      0\n1765     1       1738    1836            0       25000000                24000000                69695502068     69695551143     0\n1836     1       1765    1896            1956    941000000               336000000               80207991064     80208563414     0\n1896     1       1836    0               2138    40000000                41000000                41256202133     41256223190     0\n2138     1       1836    0               2143    64000000                24000000                41504245270     41504397821     0\n2143     1       1836    2155            0       19000000                8000000                 46204908663     46204916159     0\n2155     1       2143    0               2223    4000000                 1000000                 16137161008     16137182789     0\n2223     1       2143    0               0       2000000                 1000000                 16385586344     16385607663     0\n1956     1       1765    0               1959    5000000                 6000000                 16699314183     16699342785     0\n1959     1       1765    0               1977    49000000                24000000                32212090457     32212110410     0\n1977     1       1765    0               1982    20000000                26000000                42914576764     42914672637     0\n1982     1       1765    0               1985    28000000                17000000                46292998467     46293069392     0\n1985     1       1765    0               1988    6000000                 9000000                 16699226093     16699241029     0\n1988     1       1765    0               2001    3000000                 4000000                 16699004705     16699031894     0\n2001     1       1765    0               2006    5000000                 2000000                 16699079207     16699105762     0\n2006     1       1765    0               2009    5000000                 2000000                 16698925517     16698952979     0\n2009     1       1765    0               2028    36000000                22000000                69689326374     69689348540     0\n2028     1       1765    0               2030    5000000                 2000000                 16699212301     16699239200     0\n2030     1       1765    0               2036    6000000                 4000000                 16698971479     16699002186     0\n2036     1       1765    0               2041    3000000                 3000000                 16699207640     16699231871     0\n2041     1       1765    0               2048    7000000                 1000000                 46875506069     46875968787     0\n2048     1       1765    0               0       33000000                14000000                69689169401     69689204840     0\n1624     1       1       0               1630    14000000                13000000                76130943602     76130975685     0\n1630     1       1       1631            1737    88000000                34000000                46877142485     46879119226     0\n1631     8193    1630    0               1687    0               0               14123124750     14123186621     0\n1687     1       1630    0               1688    4000000                 2000000                 16771122465     16771154051     0\n1688     1       1630    0               1693    12000000                19000000                16717247308     16717261986     0\n1693     1       1630    0               1698    9000000                 2000000                 14383261257     14383267695     0\n1698     1       1630    0               1699    65000000                37000000                69695580955     69695617064     0\n1699     1       1630    0               1700    16000000                6000000                 16727499037     16727536663     0\n1700     1       1630    0               1772    2000000                 6000000                 16771089792     16771161815     0\n1772     1       1630    0               1776    7000000                 4000000                 16771135760     16771149241     0\n1776     1       1630    0               2283    6000000                 2000000                 14443816226     14443853139     0\n2283     1       1630    0               0       2000000                 5000000                 16771899040     16771932665     0\n1737     1       1       0               1754    10000000                8000000                 46781354145     46781397514     0\n1754     1       1       0               1889    13000000                18000000                69696426082     69696444731     0\n1889     1       1       1895            1899    2000000                 0               16657779189    16657841361      0\n1895     1       1889    0               0       3000000                 3000000                 16709365228     16709375860     0\n1899     1       1       0               1898    57000000                25000000                16016890997     16016897392     0\n1898     1       1       0               1933    3000000                 4000000                 16709024906     16709125173     0\n1933     1       1       0               1943    3000000                 1000000                 16247679511     16247697655     0\n1943     1       1       0               1953    10000000                9000000                 96116749338     96116785477     0\n1953     1       1       0               1941    16000000                24000000                69696581606     69696595288     0\n1941     1       1       0               2157    32000000                9000000                 36212177193     36212303057     0\n2157     1       1       0               2159    30000000                8000000                 16234133565     16234166973     0\n2159     1       1       0               2182    3000000                 1000000                 76605889353     76605902239     0\n2182     1       1       0               2227    3000000                 7000000                 16242899896     16242923677     0\n2227     1       1       0               2214    32000000                12000000                36212228032     36212349116     0\n2214     1       1       0               2274    60000000                16000000                76601876223     76601901776     0\n2274     1       1       0               2185    53000000                14000000                33217599737     33217692862     0\n2185     1       1       0               2321    8000000                 10000000                76606339717     76606346047     0\n2321     1       1       2324            2328    5000000                 7000000                 69684523983     69684562481     0\n2324     1       2321    2472            2644    7000000                 15000000                46886144628     46886166818     0\n2472     1       2324    2491            0       1000000                 7000000                 47126285332     47126528845     0\n2491     1       2472    2524            0       3000000                 8000000                 47126193896     47126200270     0\n2524     8193    2491    0               2580    40000000                51000000                100480894434    100480903653    0\n2580     8193    2491    0               0       0               2000000                 47127315917    47127378508      0\n2644     1       2321    2681            0       6000000                 8000000                 69780582492     69780622526     0\n2681     1       2644    2682            0       17000000                73000000                100480885215    100480956386    0\n2682     1       2681    2683            0       2000000                 1000000                 69784198308     69784207587     0\n2683     8193    2682    0               0       1000000                 0               69784738165    69785880778      0\n2328     1       1       2329            0       56000000                38000000                47768809274     47769250023     0\n2329     8193    2328    0               2342    0               0               46572691908     46572876578     0\n2342     1       2328    0               2343    4000000                 4000000                 46882292384     46882346218     0\n2343     1       2328    0               2345    10000000                7000000                 46806415830     46806452436     0\n2345     1       2328    0               2349    10000000                5000000                 46747240429     46747723323     0\n2349     1       2328    2633            2350    18000000                266000000               47817028499     47817466726     0\n2633     1       2349    0               0       6000000                 58000000                69690634211     69690754811     0\n2350     1       2328    0               2351    32000000                13000000                69695482399     69695536988     0\n2351     1       2328    0               2352    5000000                 9000000                 46802348549     46802373257     0\n2352     1       2328    0               2449    6000000                 8000000                 46882276093     46882385109     0\n</code></pre> <p>\u89c2\u5bdf pid \u7684\u987a\u5e8f\u53ef\u4ee5\u5f97\u77e5\uff0c\u8be5\u7cfb\u7edf\u8c03\u7528\u5df2\u7ecf\u6b63\u786e\u904d\u5386\u4e86\u8fdb\u7a0b\u6811\uff0c\u7528\u6237\u7a0b\u5e8f\u901a\u8fc7\u8bfb\u53d6\u4f20\u5165\u7684\u7f13\u51b2\u533a\uff0c\u8f93\u51fa\u4e86\u6bcf\u6761\u8fdb\u7a0b\u5bf9\u5e94\u7684\u4fe1\u606f\u3002\u6700\u540e\u4e00\u5217\"\u662f\u5426\u4e0a\u62a5\"\u5728\u6211\u8fd9\u91cc\u7684\u5b9e\u73b0\u662f\uff0c\u5199\u5165\u7f13\u51b2\u533a\u524d\u662f 0\uff0c\u5199\u5165\u4e4b\u540e\u7f6e\u4e3a 1\uff0c\u56e0\u6b64\u7f13\u51b2\u533a\u5185\u5168\u4e3a 0\uff0c\u7b26\u5408\u9884\u671f\u3002</p>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%AE%9E%E9%AA%8C/#_10","title":"\u5b9e\u9a8c\u603b\u7ed3\u4e0e\u53cd\u601d","text":"<p>\u672c\u6b21\u5b9e\u9a8c\u6210\u529f\u5730\u5728 Linux \u5185\u6838 (\u7248\u672c 6.14.0) \u4e2d\u6dfb\u52a0\u4e86\u4e00\u4e2a\u65b0\u7684\u7cfb\u7edf\u8c03\u7528 <code>sys_proc_dfs</code>\u3002\u8be5\u8c03\u7528\u80fd\u591f\u6309\u6df1\u5ea6\u4f18\u5148\u987a\u5e8f\u904d\u5386\u6307\u5b9a\u8fdb\u7a0b\u7684\u540e\u4ee3\uff0c\u6536\u96c6\u5305\u62ec PID\u3001\u72b6\u6001\u3001\u8fd0\u884c\u65f6\u95f4\u3001\u4eb2\u7f18\u5173\u7cfb\u3001\u8c03\u5ea6\u65f6\u95f4\u6233\u5728\u5185\u7684\u4fe1\u606f\uff0c\u5e76\u901a\u8fc7\u7528\u6237\u63d0\u4f9b\u7684\u7f13\u51b2\u533a\u8fd4\u56de\u7ed9\u7528\u6237\u6001\u7a0b\u5e8f\u3002\u7528\u6237\u6001\u6d4b\u8bd5\u7a0b\u5e8f\u4e5f\u6210\u529f\u5b9e\u73b0\u4e86\u5bf9\u8be5\u7cfb\u7edf\u8c03\u7528\u7684\u8c03\u7528\u548c\u7ed3\u679c\u7684\u683c\u5f0f\u5316\u5c55\u793a\u3002</p> <p>\u5728\u672c\u6b21\u5b9e\u9a8c\u4e2d\uff0c\u5927\u90e8\u5206\u65f6\u95f4\u82b1\u5728\u4e86\u73af\u5883\u914d\u7f6e\u4e0a\u3002\u6211\u8fd9\u6b21\u5148\u8dd1\u901a hello world\uff0c\u518d\u8dd1\u901a <code>sys_proc_dfs</code> \u7684\u9aa8\u67b6\uff0c\u6700\u540e\u5b9e\u73b0 dfs \u7684\u7ec6\u8282\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u770b\u4f3c\u7ed5\u8def\uff0c\u5b9e\u5219\u6211\u89c9\u5f97\u662f\u5f88\u6709\u5fc5\u8981\u7684\uff0c\u5728\u4ee3\u7801\u91cf\u4e0d\u90a3\u4e48\u5927\u7684\u65f6\u5019\uff0c\u5c31\u66b4\u9732\u5e76\u89e3\u51b3\u4e86\u5f88\u591a\u914d\u7f6e\u4e0a\u9047\u5230\u7684\u95ee\u9898\u3002</p> <p>\u53e6\u5916\uff0c\u5728\u9605\u8bfb Linux \u5185\u6838\u6e90\u4ee3\u7801\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u53d1\u73b0\uff0c\u5c3d\u7ba1\u901a\u5e38\u6765\u8bf4 C \u8bed\u8a00\u662f\u9762\u5411\u8fc7\u7a0b\u7684\uff0c\u4f46\u662f\u6e90\u4ee3\u7801\u4e2d\u6709\u5f88\u591a\u7684 struct\uff0c\u6709\u70b9\u9762\u5411\u5bf9\u8c61\u7684\u5473\u9053\uff0c\u4e95\u7136\u6709\u5e8f\uff0c\u6211\u89c9\u5f97\u8fd9\u662f\u5f88\u597d\u7684\uff0c\u9605\u8bfb\u548c\u8c03\u8bd5\u90fd\u6bd4\u8f83\u65b9\u4fbf\u3002</p>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/","title":"\u64cd\u4f5c\u7cfb\u7edf\u7b2c\u4e8c\u6b21\u4f5c\u4e1a","text":""},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#1","title":"1. \u5b9e\u9a8c\u5185\u5bb9","text":"<p>\u672c\u6b21\u5b9e\u9a8c\u7684\u4e3b\u8981\u5185\u5bb9\u662f\u5728 Linux \u5185\u6838\u4e2d\u8bbe\u8ba1\u5e76\u5b9e\u73b0\u4e00\u79cd\u4e8b\u4ef6\u540c\u6b65\u5c4f\u969c\u539f\u8bed\uff0c\u5141\u8bb8\u591a\u4e2a\u8fdb\u7a0b\u5728\u67d0\u4e2a\u4e8b\u4ef6\u53d1\u751f\u524d\u963b\u585e\uff0c\u76f4\u5230\u5176\u4ed6\u8fdb\u7a0b\u89e6\u53d1\u8be5\u4e8b\u4ef6\u3002\u5f53\u67d0\u4e2a\u8fdb\u7a0b\u89e6\u53d1\u4e8b\u4ef6\u65f6\uff0c\u6240\u6709\u56e0\u8be5\u4e8b\u4ef6\u963b\u585e\u7684\u8fdb\u7a0b\u5c06\u89e3\u9664\u963b\u585e\uff0c\u5982\u679c\u6ca1\u6709\u8fdb\u7a0b\u88ab\u963b\u585e\u5219\u4e0d\u4ea7\u751f\u4efb\u4f55\u5f71\u54cd\u3002</p> <p>\u5177\u4f53\u8981\u6c42\u662f\u5b9e\u73b0\u56db\u4e2a\u65b0\u7684\u7cfb\u7edf\u8c03\u7528\uff1a</p> <ul> <li><code>sys_eventopen()</code>\uff1a\u7528\u4e8e\u521b\u5efa\u65b0\u4e8b\u4ef6\u5e76\u8fd4\u56de\u4e00\u4e2a\u5168\u5c40\u552f\u4e00\u7684\u4e8b\u4ef6\u6807\u8bc6\u7b26 (event ID)\u3002</li> <li><code>sys_eventwait(int event_id)</code>\uff1a\u7528\u4e8e\u4f7f\u5f53\u524d\u8fdb\u7a0b\u5728\u6307\u5b9a <code>event_id</code> \u4e0a\u963b\u585e\uff08\u7761\u7720\uff09\u3002</li> <li><code>sys_eventsig(int event_id)</code>\uff1a\u7528\u4e8e\u5524\u9192\u6240\u6709\u5728\u6307\u5b9a <code>event_id</code> \u4e0a\u963b\u585e\u7684\u8fdb\u7a0b\u3002</li> <li><code>sys_eventclose(int event_id)</code>\uff1a\u7528\u4e8e\u9500\u6bc1\u4e8b\u4ef6\uff0c\u5e76\u5524\u9192\u6240\u6709\u53ef\u80fd\u4ecd\u5728\u8be5\u4e8b\u4ef6\u4e0a\u963b\u585e\u7684\u8fdb\u7a0b\u3002</li> </ul> <p>\u6700\u540e\uff0c\u9700\u8981\u7f16\u5199\u7528\u6237\u6001\u6d4b\u8bd5\u7a0b\u5e8f\uff0c\u81f3\u5c11\u8986\u76d6\u201c\u591a\u8fdb\u7a0b\u7b49\u5f85\u540c\u4e00\u4e8b\u4ef6\u201d\u548c\u201c\u591a\u8fdb\u7a0b\u591a\u4e8b\u4ef6\u5e76\u53d1\u201d\u4e24\u79cd\u573a\u666f\u3002</p>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#2","title":"2. \u5b9e\u9a8c\u601d\u8def","text":"<p>\u672c\u5b9e\u9a8c\u91c7\u53d6\u5206\u9636\u6bb5\u63a8\u8fdb\u7684\u7b56\u7565\uff0c\u9996\u5148\u642d\u5efa\u548c\u9a8c\u8bc1\u73af\u5883\uff0c\u7136\u540e\u8bbe\u8ba1\u6838\u5fc3\u6570\u636e\u7ed3\u6784\uff0c\u63a5\u7740\u5b9e\u73b0\u7cfb\u7edf\u8c03\u7528\u529f\u80fd\uff0c\u6700\u540e\u7f16\u5199\u7528\u6237\u6001\u7a0b\u5e8f\u8fdb\u884c\u6d4b\u8bd5\u3002</p>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#_2","title":"\u9636\u6bb5\u4e00 \u73af\u5883\u914d\u7f6e\u4e0e\u5185\u6838\u88c1\u526a","text":"<ul> <li>\u73af\u5883\u4f18\u5316\uff1a \u4e3a\u7f29\u77ed\u5185\u6838\u7f16\u8bd1\u7684\u8fed\u4ee3\u65f6\u95f4\uff0c\u9996\u5148\u5bf9\u7f16\u8bd1\u73af\u5883\u8fdb\u884c\u4f18\u5316\u3002</li> <li>\u4f7f\u7528 <code>make menuconfig</code> \u5bf9\u5185\u6838\u914d\u7f6e\u8fdb\u884c\u88c1\u526a\uff0c\u7981\u7528\u6240\u6709\u4e0e\u5b9e\u9a8c\u65e0\u5173\u7684\u6a21\u5757\uff08\u5982\u65e0\u7ebf\u3001\u58f0\u5361\u3001\u84dd\u7259\u7b49\u975e\u5fc5\u8981\u9a71\u52a8\uff09\u3002</li> <li>\u5b89\u88c5 <code>ccache</code> \u5e76\u914d\u7f6e <code>make CC=\"ccache gcc\"</code>\uff0c\u5229\u7528\u7f16\u8bd1\u7f13\u5b58\u5b9e\u73b0\u540e\u7eed\u7684\u5feb\u901f\u8fed\u4ee3\u3002</li> <li>\u642d\u5efa\u8c03\u7528\u6846\u67b6\uff1a \u5728 <code>syscall_64.tbl</code>\u3001<code>syscalls.h</code> \u548c <code>kernel/sys.c</code> \u4e2d\u6ce8\u518c <code>eventopen</code>\u3001<code>eventclose</code>\u3001<code>eventwait</code>\u3001<code>eventsig</code> \u56db\u4e2a\u7a7a\u7684\u7cfb\u7edf\u8c03\u7528\u3002</li> <li>\u521d\u6b65\u9a8c\u8bc1\uff1a \u7f16\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u7528\u6237\u6001\u7a0b\u5e8f <code>test_events_skeleton.c</code> \u9010\u4e00\u8c03\u7528\u8fd9\u56db\u4e2a\u201c\u7a7a\u58f3\u201d\u51fd\u6570\uff0c\u5e76\u901a\u8fc7 <code>dmesg</code> \u786e\u8ba4\u5185\u6838\u6253\u5370\u4e86\u5bf9\u5e94\u4fe1\u606f\uff0c\u786e\u4fdd\u7cfb\u7edf\u8c03\u7528\u7684\u201c\u901a\u8def\u201d\u5df2\u5168\u90e8\u6253\u901a\u3002</li> </ul>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#_3","title":"\u9636\u6bb5\u4e8c\uff1a\u6838\u5fc3\u6570\u636e\u7ed3\u6784\u8bbe\u8ba1","text":"<ul> <li> <p>\u5168\u5c40\u7ba1\u7406\uff1a \u5728 <code>kernel/sys.c</code> \u4e2d\u5b9a\u4e49\u4e00\u4e2a\u5168\u5c40\u6570\u7ec4 <code>static struct os_event event_table[MAX_EVENTS]</code> \u6765\u7ba1\u7406\u6240\u6709\u4e8b\u4ef6\u3002<code>event_id</code> \u5373\u4e3a\u8be5\u6570\u7ec4\u7684\u7d22\u5f15\u3002</p> </li> <li> <p>\u7ba1\u7a0b\u9501\uff08\u7c97\u7c92\u5ea6\uff09\uff1a \u5b9a\u4e49\u4e00\u4e2a\u5168\u5c40\u4e92\u65a5\u9501 <code>static DEFINE_MUTEX(event_table_lock)</code>\u3002\u8fd9\u628a\u9501\u53ea\u7528\u4e8e\u4fdd\u62a4 <code>event_table</code> \u6570\u7ec4\u672c\u8eab\uff0c\u5373 <code>in_use</code> \u6807\u5fd7\u7684\u5206\u914d\u4e0e\u91ca\u653e\uff0c\u786e\u4fdd\u69fd\u4f4d\u64cd\u4f5c\u7684\u539f\u5b50\u6027\u3002</p> </li> <li> <p>\u4e8b\u4ef6\u7ed3\u6784\u4f53\uff08\u7ec6\u7c92\u5ea6\uff09\uff1a \u4e3a\u4e86\u89e3\u51b3\u590d\u6742\u7684\u201c\u91ca\u653e\u540e\u91cd\u7528\u201d(Use-After-Free)\u7ade\u6001\u6761\u4ef6\uff0c\u8bbe\u8ba1\u4e86\u5305\u542b\u5f15\u7528\u8ba1\u6570\u548c\u9500\u6bc1\u961f\u5217\u7684\u4e8b\u4ef6\u7ed3\u6784\uff1a</p> </li> </ul> <pre><code>/* \u4e8b\u4ef6\u7ed3\u6784\u4f53 */\nstruct os_event {\n    bool in_use;                   // \u662f\u5426\u6b63\u5728\u4f7f\u7528\n    bool initialized;              // \u662f\u5426\u5df2\u521d\u59cb\u5316\n\n    wait_queue_head_t queue;       // \u7b49\u5f85\u961f\u5217\n    spinlock_t lock;               // \u4fdd\u62a4 gen/closing \u5b57\u6bb5\n\n    unsigned long gen;             // \u6bcf\u6b21\u5f53 eventsig \u65f6\u81ea\u589e\uff0c\u8868\u793a\u65b0\u4e00\u8f6e\u4fe1\u53f7\n    bool closing;                  // \u8868\u793a\u6b63\u5728\u5173\u95ed\n\n    atomic_t waiters;              // \u5f53\u524d\u5904\u4e8e\u7b49\u5f85\u961f\u5217\u4e2d\u7684\u7ebf\u7a0b\u6570\n    wait_queue_head_t destroy_wq;  // \u7528\u6765\u7b49\u5f85 waiters==0 \u7684\u961f\u5217\n};\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#_4","title":"\u9636\u6bb5\u4e09\uff1a\u6838\u5fc3\u903b\u8f91\u5b9e\u73b0","text":"<ul> <li><code>eventopen</code>\uff1a\u83b7\u53d6\u5168\u5c40\u9501 <code>event_table_lock</code>\uff0c\u904d\u5386\u67e5\u627e <code>in_use == false</code> \u7684\u69fd\u4f4d\u3002\u5982\u679c\u69fd\u4f4d\u662f\u9996\u6b21\u4f7f\u7528 (<code>initialized == false</code>)\uff0c\u5219\u521d\u59cb\u5316\u5176 <code>queue</code>, <code>lock</code>, <code>destroy_wq</code> \u548c <code>waiters</code> \u8ba1\u6570\u5668\u3002\u65e0\u8bba\u5982\u4f55\uff0c\u90fd\u4f1a\u91cd\u7f6e <code>gen = 0</code> \u548c <code>closing = false</code>\uff0c\u7136\u540e\u91ca\u653e\u5168\u5c40\u9501\u3002</li> <li><code>eventwait</code> \uff1a</li> <li>\u83b7\u53d6\u5168\u5c40\u9501 <code>event_table_lock</code>\uff0c\u68c0\u67e5 <code>in_use</code> \u6807\u5fd7\u3002</li> <li>\u5728\u91ca\u653e\u5168\u5c40\u9501\u4e4b\u524d\uff0c\u539f\u5b50\u5730\u589e\u52a0\u5f15\u7528\u8ba1\u6570 <code>atomic_inc(&amp;ev-&gt;waiters)</code>\u3002\u8fd9\u786e\u4fdd <code>eventclose</code> \u5728\u68c0\u67e5 <code>waiters</code> \u65f6\uff0c\u4e0d\u4f1a\u6f0f\u6389\u6b63\u5728\u8fdb\u5165\u7b49\u5f85\u7684\u672c\u8fdb\u7a0b\u3002</li> <li>\u91ca\u653e\u5168\u5c40\u9501\u3002</li> <li>\u83b7\u53d6\u5185\u90e8 <code>spinlock</code>\uff0c\u8bfb\u53d6\u5f53\u524d\u7684 <code>gen</code> \u4f5c\u4e3a\u5feb\u7167 <code>mygen</code>\u3002</li> <li>\u8c03\u7528 <code>wait_event_interruptible</code>\uff0c\u7b49\u5f85 <code>ev-&gt;gen != mygen</code> (\u88ab <code>eventsig</code> \u6539\u53d8) \u6216 <code>ev-&gt;closing == true</code> (\u88ab <code>eventclose</code> \u6539\u53d8)\u3002</li> <li>\u5524\u9192\u540e\uff0c\u8c03\u7528 <code>atomic_dec_and_test(&amp;ev-&gt;waiters)</code>\u3002\u5982\u679c\u662f\u6700\u540e\u4e00\u4e2a\u9000\u51fa\u7684\u7b49\u5f85\u8005 (<code>waiters == 0</code>) \u4e14 <code>eventclose</code> \u6b63\u5728\u8fdb\u884c (<code>closing == true</code>)\uff0c\u5219\u8d1f\u8d23\u5524\u9192\u5728 <code>destroy_wq</code> \u4e0a\u7761\u7720\u7684 <code>eventclose</code> \u8fdb\u7a0b\u3002</li> <li><code>eventsig</code>\uff1a\u83b7\u53d6\u5185\u90e8 <code>spinlock</code>\uff0c\u5c06 <code>gen</code> \u8ba1\u6570\u5668\u52a0\u4e00\uff0c\u7136\u540e\u91ca\u653e\u9501\u3002\u6700\u540e\u8c03\u7528 <code>wake_up_all(&amp;ev-&gt;queue)</code> \u5524\u9192\u6240\u6709\u7b49\u5f85\u8005\u3002</li> <li><code>eventclose</code> \uff1a</li> <li>\u83b7\u53d6\u5185\u90e8 <code>spinlock</code>\uff0c\u8bbe\u7f6e <code>closing = true</code>\u3002</li> <li>\u8c03\u7528 <code>wake_up_all(&amp;ev-&gt;queue)</code> \u5524\u9192\u6240\u6709\u7b49\u5f85\u8005\uff08\u5b83\u4eec\u4f1a\u68c0\u67e5\u5230 <code>closing == true</code> \u800c\u9000\u51fa\uff09\u3002</li> <li>\u8c03\u7528 <code>wait_event(ev-&gt;destroy_wq, ...)</code> \u5728\u9500\u6bc1\u961f\u5217\u4e0a\u7761\u7720\uff0c\u76f4\u5230 <code>waiters</code> \u8ba1\u6570\u5668\u5f52\u96f6\u3002</li> <li>\u88ab\u5524\u9192\u540e\uff08\u7531\u6700\u540e\u4e00\u4e2a <code>eventwait</code> \u8fdb\u7a0b\u5524\u9192\uff09\uff0c\u83b7\u53d6\u5168\u5c40\u9501 <code>event_table_lock</code>\uff0c\u5b89\u5168\u5730\u5c06 <code>in_use = false</code>\uff0c\u91ca\u653e\u8be5\u69fd\u4f4d\u4ee5\u4f9b <code>eventopen</code> \u91cd\u7528\u3002</li> </ul>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#_5","title":"\u9636\u6bb5\u56db\uff1a\u7f16\u5199\u7528\u6237\u6001\u6d4b\u8bd5\u7a0b\u5e8f","text":"<ul> <li>\u8bbe\u8ba1\u4e09\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u6765\u9a8c\u8bc1\u529f\u80fd\u7684\u5b8c\u5907\u6027\u548c\u5e76\u53d1\u6b63\u786e\u6027\uff1a</li> <li><code>sync_test1.c</code>\uff1a\u591a\u8fdb\u7a0b\u7b49\u5f85\u5355\u4e8b\u4ef6\u3002\u7528\u4e8e\u9a8c\u8bc1\u57fa\u672c\u7684\u201c\u7b49\u5f85-\u5524\u9192\u201d\u529f\u80fd\u3002</li> <li><code>sync_test2.c</code>\uff1a\u591a\u8fdb\u7a0b\u7b49\u5f85\u591a\u4e8b\u4ef6\u3002\u7528\u4e8e\u9a8c\u8bc1\u4e0d\u540c\u4e8b\u4ef6\u4e4b\u95f4\u7684\u9694\u79bb\u6027\u3002</li> <li><code>sync_test3.c</code>\uff1a\u9a8c\u8bc1 <code>eventclose</code> \u4e5f\u80fd\u5524\u9192\u6b63\u5728\u7b49\u5f85\u7684\u8fdb\u7a0b\u3002</li> <li><code>sync_test4.c</code>\uff1a\u9a8c\u8bc1\u5bf9\u540c\u4e00\u4e8b\u4ef6\u7684\u591a\u6b21\u91cd\u590d\u7b49\u5f85\u548c\u5524\u9192\u3002</li> <li><code>sync_test5.c</code>\uff1a\u9ad8\u5e76\u53d1\u538b\u529b\u6d4b\u8bd5\uff0c\u9a8c\u8bc1 <code>eventclose</code> \u7684\u5f15\u7528\u8ba1\u6570\u5668\u80fd\u6b63\u786e\u5904\u7406\u201c\u91ca\u653e-\u91cd\u7528\u201d\u7ade\u6001\u6761\u4ef6\u3002</li> </ul>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#3","title":"3. \u5b9e\u9a8c\u8fc7\u7a0b","text":""},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#31","title":"3.1 \u5185\u6838\u88c1\u526a\u4e0e\u73af\u5883\u914d\u7f6e","text":"<p>\u4e3a\u52a0\u901f\u5185\u6838\u7f16\u8bd1\uff0c\u7f29\u77ed\u5f00\u53d1-\u6d4b\u8bd5\u7684\u8fed\u4ee3\u5468\u671f\uff0c\u672c\u6b21\u5b9e\u9a8c\u5bf9\u7f16\u8bd1\u73af\u5883\u8fdb\u884c\u4e86\u4e24\u9879\u5173\u952e\u4f18\u5316\uff1a\u5185\u6838\u88c1\u526a\u4e0e\u7f16\u8bd1\u7f13\u5b58\u3002</p> <ol> <li> <p>\u4f7f\u7528 <code>make menuconfig</code> \u88c1\u526a\u5185\u6838</p> </li> <li> <p>\u5728\u5185\u6838\u6e90\u7801\u6839\u76ee\u5f55\u6267\u884c <code>cp /boot/config-$(uname -r) .config</code>\uff0c\u4ee5\u4e00\u4e2a\u5df2\u77e5\u7684\u3001\u53ef\u5de5\u4f5c\u7684\u914d\u7f6e\u4e3a\u57fa\u7840\u3002</p> </li> <li>\u8fd0\u884c <code>make menuconfig</code> \u8fdb\u5165\u56fe\u5f62\u5316\u914d\u7f6e\u754c\u9762\u3002</li> <li>\u88c1\u526a\u539f\u5219\uff1a \u5b9e\u9a8c\u73af\u5883\u4e3a VMware \u865a\u62df\u673a\uff0c\u4e14\u4ec5\u901a\u8fc7 SSH \u8bbf\u95ee\uff0c\u56e0\u6b64\u6240\u6709\u7269\u7406\u786c\u4ef6\u3001\u975e\u5fc5\u8981\u7684\u9a71\u52a8\u548c\u529f\u80fd\u5747\u53ef\u7981\u7528\u3002</li> <li>\u4e3b\u8981\u88c1\u526a\u9879\uff1a<ul> <li><code>Networking support ---&gt;</code></li> <li>\u7981\u7528 <code>Wireless LAN</code>\u3001<code>Bluetooth subsystem support</code>\u3001<code>NFC subsystem support</code> \u7b49\u6240\u6709\u65e0\u7ebf\u548c\u975e IP \u534f\u8bae\u3002</li> <li>\uff08\u4fdd\u7559 <code>TCP/IP networking</code> \u548c <code>Ethernet driver support</code> \u4e2d\u7684 <code>VMware VMXNET3</code> \u9a71\u52a8\u4ee5\u4fdd\u8bc1 SSH \u8fde\u901a\u6027\uff09\u3002</li> <li><code>Device Drivers ---&gt;</code></li> <li>\u7981\u7528 <code>Sound card support ---&gt;</code>\u3002</li> <li>\u7981\u7528 <code>Multimedia support ---&gt;</code> (\u6444\u50cf\u5934\u3001\u7535\u89c6\u5361\u7b49)\u3002</li> <li>\u7981\u7528 <code>Graphics support ---&gt;</code> \u5b50\u83dc\u5355\u4e2d\u9664 <code>VMware VMSVGA</code> \u548c <code>VGA text console</code> \u4e4b\u5916\u7684\u6240\u6709\u7269\u7406\u663e\u5361\u9a71\u52a8 (NVIDIA, AMD, Intel)\u3002</li> <li>\u7981\u7528 <code>USB support ---&gt;</code> (VMware \u865a\u62df\u673a\u901a\u8fc7 SSH \u8bbf\u95ee\uff0c\u65e0\u9700 USB)\u3002</li> <li>\u7981\u7528 <code>File systems ---&gt;</code> \u5b50\u83dc\u5355\u4e2d\u9664 <code>Ext4</code>\uff08\u6216\u5f53\u524d\u6839\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\uff09\u4e4b\u5916\u7684\u6240\u6709\u5176\u4ed6\u6587\u4ef6\u7cfb\u7edf\uff08\u5982 <code>XFS</code>, <code>Btrfs</code>, <code>NTFS</code>\uff09\u3002</li> </ul> </li> <li> <p>\u88c1\u526a\u540e\u4fdd\u5b58\u914d\u7f6e\uff0c\u5927\u5e45\u51cf\u5c11\u4e86\u9700\u8981\u7f16\u8bd1\u7684\u6a21\u5757\u6570\u91cf\u3002</p> </li> <li> <p>\u914d\u7f6e <code>ccache</code> \u7f16\u8bd1\u7f13\u5b58</p> </li> <li> <p><code>ccache</code> (Compiler Cache) \u662f\u4e00\u4e2a\u7f16\u8bd1\u52a0\u901f\u5de5\u5177\uff0c\u5b83\u80fd\u7f13\u5b58 <code>.c</code> \u6587\u4ef6\u4e0a\u4e00\u6b21\u7684\u7f16\u8bd1\u7ed3\u679c\uff08<code>.o</code> \u6587\u4ef6\uff09\u3002\u5f53\u4e0b\u6b21\u7f16\u8bd1\u65f6\uff0c\u82e5\u6e90\u6587\u4ef6\u672a\u66f4\u6539\uff0c<code>ccache</code> \u4f1a\u76f4\u63a5\u8fd4\u56de\u7f13\u5b58\u7684\u7ed3\u679c\uff0c\u8df3\u8fc7\u5b9e\u9645\u7684 <code>gcc</code> \u7f16\u8bd1\u8fc7\u7a0b\u3002</p> </li> <li> <p>\u5b89\u88c5\uff1a</p> <pre><code>sudo apt install ccache\n</code></pre> </li> <li> <p>\u6269\u5927\u7f13\u5b58\u7a7a\u95f4 \uff1a \u5185\u6838\u7f16\u8bd1\u4f1a\u4ea7\u751f\u5927\u91cf\u7f13\u5b58\uff0c\u9ed8\u8ba4\u7a7a\u95f4\u53ef\u80fd\u4e0d\u8db3\u3002</p> <pre><code>ccache -M 50G  # \u5c06\u7f13\u5b58\u4e0a\u9650\u8bbe\u4e3a 50GB\n</code></pre> </li> <li> <p>\u4f7f\u7528\uff1a \u5728\u8c03\u7528 <code>make</code> \u65f6\uff0c\u901a\u8fc7 <code>CC</code> \u53d8\u91cf\u6307\u5b9a <code>ccache</code> \u4f5c\u4e3a <code>gcc</code> \u7684\u201c\u5305\u88c5\u5668\u201d\u3002</p> <pre><code>make CC=\"ccache gcc\" -j$(nproc)\n</code></pre> </li> <li> <p>\u6548\u679c\uff1a \u9996\u6b21\u7f16\u8bd1\uff08\u586b\u5145\u7f13\u5b58\uff09\u4f9d\u7136\u8017\u65f6\uff0c\u4f46\u5728\u6b64\u540e\u4fee\u6539\u4ee3\u7801\uff08\u5982 <code>kernel/sys.c</code>\uff09\u540e\u518d\u6b21\u7f16\u8bd1\uff0c\u7f16\u8bd1\u94fe\u63a5\u65f6\u95f4\u4ece2\u5c0f\u65f6\u7f29\u77ed\u52302\u5206\u949f\uff0c\u6781\u5927\u5730\u63d0\u9ad8\u4e86\u8c03\u8bd5\u6548\u7387\u3002</p> </li> </ol>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#32","title":"3.2 \u642d\u5efa\u7cfb\u7edf\u8c03\u7528\u6846\u67b6","text":"<ol> <li>\u4fee\u6539 <code>arch/x86/entry/syscalls/syscall_64.tbl</code>\uff1a</li> </ol> <p>\u5206\u914d\u7cfb\u7edf\u8c03\u7528\u53f7\u3002</p> <pre><code>550 64 eventopen   sys_eventopen\n551 64 eventclose  sys_eventclose\n552 64 eventwait   sys_eventwait\n553 64 eventsig    sys_eventsig\n</code></pre> <ol> <li>\u4fee\u6539 <code>include/linux/syscalls.h</code>\uff1a</li> </ol> <p>\u58f0\u660e\u7cfb\u7edf\u8c03\u7528\u3002</p> <pre><code>asmlinkage long sys_eventopen(void);\nasmlinkage long sys_eventclose(int event_id);\nasmlinkage long sys_eventwait(int event_id);\nasmlinkage long sys_eventsig(int event_id);\n</code></pre> <ol> <li>\u4fee\u6539 <code>kernel/sys.c</code> \uff1a</li> </ol> <p>\u4e3a\u7cfb\u7edf\u8c03\u7528\u6dfb\u52a0\u7a7a\u58f3\u5b9e\u73b0\u3002</p> <pre><code>SYSCALL_DEFINE0(eventopen) { printk(KERN_INFO \"eventopen call\\n\"); return 0; }\nSYSCALL_DEFINE1(eventclose, int, event_id) { printk(KERN_INFO \"eventclose call\\n\"); return 0; }\nSYSCALL_DEFINE1(eventwait, int, event_id) { printk(KERN_INFO \"eventwait call\\n\"); return 0; }\nSYSCALL_DEFINE1(eventsig, int, event_id) { printk(KERN_INFO \"eventsig call\\n\"); return 0; }\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#33","title":"3.3 \u6838\u5fc3\u4ee3\u7801\u5b9e\u73b0","text":"<p>\u5728 <code>kernel/sys.c</code> \u9876\u90e8\u6dfb\u52a0\u5934\u6587\u4ef6\u548c\u5168\u5c40\u5b9a\u4e49\uff1a</p> <pre><code>/* \u9700\u8981\u5305\u542b\u7684\u5934\u6587\u4ef6 */\n#include &lt;linux/wait.h&gt;\n#include &lt;linux/mutex.h&gt;\n#include &lt;linux/spinlock.h&gt;\n#include &lt;linux/errno.h&gt;\n#include &lt;linux/atomic.h&gt;\n#include &lt;linux/sched.h&gt;\n#include &lt;linux/uaccess.h&gt; // (\u5982\u679c\u9700\u8981\u4e0e\u7528\u6237\u7a7a\u95f4\u4ea4\u4e92)\n\n/* \u5e38\u91cf */\n#define MAX_EVENTS 64\n\n/* \u4e8b\u4ef6\u7ed3\u6784\u4f53 */\nstruct os_event {\n    bool in_use;                   // \u662f\u5426\u6b63\u5728\u4f7f\u7528\n    bool initialized;              // \u662f\u5426\u5df2\u521d\u59cb\u5316\n\n    wait_queue_head_t queue;       // \u7b49\u5f85\u961f\u5217\n    spinlock_t lock;               // \u4fdd\u62a4 gen/closing \u5b57\u6bb5\n\n    unsigned long gen;             // \u6bcf\u6b21\u5f53 eventsig \u65f6\u81ea\u589e\uff0c\u8868\u793a\u65b0\u4e00\u8f6e\u4fe1\u53f7\n    bool closing;                  // \u8868\u793a\u6b63\u5728\u5173\u95ed\n\n    atomic_t waiters;              // \u5f53\u524d\u5904\u4e8e\u7b49\u5f85\u961f\u5217\u4e2d\u7684\u7ebf\u7a0b\u6570\n    wait_queue_head_t destroy_wq;  // \u7528\u6765\u7b49\u5f85 waiters==0 \u7684\u961f\u5217\n};\n\n/* \u5168\u5c40\u4e8b\u4ef6\u8868\u4e0e\u4fdd\u62a4\u9501 */\nstatic struct os_event event_table[MAX_EVENTS];\nstatic DEFINE_MUTEX(event_table_lock);\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#331-sys_eventopen","title":"3.3.1 <code>sys_eventopen</code> \u7684\u5b9e\u73b0","text":"<p><code>eventopen</code> \u8d1f\u8d23\u5206\u914d\u4e00\u4e2a\u4e8b\u4ef6\u69fd\u4f4d\u3002\u5b83\u4f7f\u7528 <code>event_table_lock</code> \u8fd9\u628a\u7c97\u7c92\u5ea6\u9501\u6765\u4fdd\u8bc1\u69fd\u4f4d\u5206\u914d\u7684\u539f\u5b50\u6027\u3002\u5982\u679c\u4e00\u4e2a\u69fd\u4f4d\u662f\u9996\u6b21\u88ab\u4f7f\u7528 (<code>initialized == false</code>)\uff0c\u5b83\u4f1a\u8d1f\u8d23\u521d\u59cb\u5316\u6240\u6709\u5e95\u5c42\u7684\u540c\u6b65\u539f\u8bed\uff08\u7b49\u5f85\u961f\u5217\u3001\u81ea\u65cb\u9501\u3001\u539f\u5b50\u8ba1\u6570\u5668\uff09\u3002\u65e0\u8bba\u5982\u4f55\uff0c\u5b83\u90fd\u4f1a\u91cd\u7f6e\u4e8b\u4ef6\u7684\u903b\u8f91\u72b6\u6001\uff08<code>gen</code> \u548c <code>closing</code>\uff09\uff0c\u4e3a\u65b0\u7684\u4f7f\u7528\u8005\u505a\u597d\u51c6\u5907\u3002</p> <pre><code>SYSCALL_DEFINE0(eventopen) {\n    int i, id = -1;\n\n    mutex_lock(&amp;event_table_lock);\n    for (i = 0; i &lt; MAX_EVENTS; ++i) {\n        if (!event_table[i].in_use) {\n            event_table[i].in_use = true;\n            id = i;\n            break;\n        }\n    }\n\n    if (id != -1) {\n        if (!event_table[id].initialized) {\n            init_waitqueue_head(&amp;event_table[id].queue);\n            spin_lock_init(&amp;event_table[id].lock);\n            init_waitqueue_head(&amp;event_table[id].destroy_wq);\n            atomic_set(&amp;event_table[id].waiters, 0);\n            event_table[id].initialized = true;\n        }\n\n        /* \u91cd\u7f6e\u903b\u8f91\u72b6\u6001\u4e3a\u521d\u59cb generation\uff08\u5b89\u5168\uff1aeventclose \u5df2\u7b49 waiters==0 \u518d set in_use=false\uff09 */\n        spin_lock(&amp;event_table[id].lock);\n        event_table[id].gen = 0;\n        event_table[id].closing = false;\n        spin_unlock(&amp;event_table[id].lock);\n    }\n    mutex_unlock(&amp;event_table_lock);\n\n    return id != -1 ? id : -ENOSPC;\n}\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#332-sys_eventwait","title":"3.3.2 <code>sys_eventwait</code> \u7684\u5b9e\u73b0","text":"<p><code>eventwait</code> \u662f\u6700\u590d\u6742\u7684\u8bbe\u8ba1\u3002</p> <ol> <li>\u5b83\u9996\u5148\u5728\u5168\u5c40\u9501 <code>event_table_lock</code> \u7684\u4fdd\u62a4\u4e0b\u68c0\u67e5\u4e8b\u4ef6\u662f\u5426\u5b58\u5728\uff0c\u5e76\u539f\u5b50\u5730\u9012\u589e <code>waiters</code> \u5f15\u7528\u8ba1\u6570\u3002</li> <li>\u9012\u589e\u8ba1\u6570\u540e\uff0c\u5b83\u7acb\u5373\u91ca\u653e\u5168\u5c40\u9501\uff0c\u4ee5\u5141\u8bb8\u5176\u4ed6\u8fdb\u7a0b\uff08\u5982 <code>eventsig</code>\uff09\u5e76\u53d1\u6267\u884c\u3002</li> <li>\u5b83\u4f7f\u7528\u5185\u90e8\u81ea\u65cb\u9501 <code>ev-&gt;lock</code> \u6765\u5b89\u5168\u5730\u8bfb\u53d6\u5f53\u524d <code>gen</code> \u7684\u5feb\u7167 <code>mygen</code>\u3002</li> <li>\u5b83\u8c03\u7528 <code>wait_event_interruptible</code> \u8fdb\u5165\u7761\u7720\uff0c\u7b49\u5f85 <code>gen</code> \u53d1\u751f\u53d8\u5316\uff08\u88ab <code>eventsig</code> \u89e6\u53d1\uff09\u6216 <code>closing</code> \u53d8\u4e3a <code>true</code>\uff08\u88ab <code>eventclose</code> \u89e6\u53d1\uff09\u3002</li> <li>\u5524\u9192\u540e\uff0c\u5b83\u539f\u5b50\u5730\u9012\u51cf <code>waiters</code> \u8ba1\u6570\u3002\u5982\u679c\u662f\u6700\u540e\u4e00\u4e2a\u9000\u51fa\u8005\u4e14 <code>closing</code> \u4e3a <code>true</code>\uff0c\u5b83\u8d1f\u8d23\u5524\u9192\u6b63\u5728 <code>destroy_wq</code> \u4e0a\u7b49\u5f85\u7684 <code>eventclose</code> \u8fdb\u7a0b\u3002</li> </ol> <pre><code>SYSCALL_DEFINE1(eventwait, int, event_id) {\n    struct os_event *ev;\n    unsigned long flags;\n    unsigned long mygen;\n    int ret;\n\n    if (event_id &lt; 0 || event_id &gt;= MAX_EVENTS)\n        return -EINVAL;\n\n    ev = &amp;event_table[event_id];\n\n    /* \u5728\u5168\u5c40\u9501\u4e0b\u68c0\u67e5\u662f\u5426\u5b58\u5728 */\n    mutex_lock(&amp;event_table_lock);\n    if (!ev-&gt;in_use) {\n        mutex_unlock(&amp;event_table_lock);\n        return -EINVAL;\n    }\n    /* \u8fdb\u5165\u7b49\u5f85\u524d\u8ba1\u6570 */\n    atomic_inc(&amp;ev-&gt;waiters);\n    mutex_unlock(&amp;event_table_lock);\n\n\n    /* \u8bfb\u53d6 snapshot generation\uff08\u53d7 spinlock \u4fdd\u62a4\uff0c\u907f\u514d\u540c\u65f6\u4fee\u6539\uff09 */\n    spin_lock_irqsave(&amp;ev-&gt;lock, flags);\n    mygen = ev-&gt;gen;\n    spin_unlock_irqrestore(&amp;ev-&gt;lock, flags);\n\n    /* \u7b49\u5f85\u76f4\u5230 generation \u53d1\u751f\u53d8\u5316\uff08eventsig\uff09\u6216 closing \u88ab\u8bbe\u7f6e */\n    ret = wait_event_interruptible(ev-&gt;queue, ({\n        bool cond;\n        spin_lock_irqsave(&amp;ev-&gt;lock, flags);\n        cond = (ev-&gt;gen != mygen) || ev-&gt;closing;\n        spin_unlock_irqrestore(&amp;ev-&gt;lock, flags);\n        cond;\n    }));\n\n    /* \u9000\u51fa\u65f6\u9012\u51cf waiters\uff1b\u5982\u679c\u8fd9\u662f\u6700\u540e\u4e00\u4e2a\u4e14\u6b63\u5728 closing\uff0c\u5219\u901a\u77e5 destroy_wq */\n    if (atomic_dec_and_test(&amp;ev-&gt;waiters)) {\n        spin_lock_irqsave(&amp;ev-&gt;lock, flags);\n        if (ev-&gt;closing)\n            wake_up(&amp;ev-&gt;destroy_wq);\n        spin_unlock_irqrestore(&amp;ev-&gt;lock, flags);\n    }\n\n    return ret;\n}\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#333-sys_eventsig","title":"3.3.3 <code>sys_eventsig</code> \u7684\u5b9e\u73b0","text":"<p><code>eventsig</code> \u7684\u5b9e\u73b0\u8f7b\u91cf\u4e14\u9ad8\u6548\u3002\u5b83\u4e0d\u9700\u8981\u83b7\u53d6\u5168\u5c40\u9501\uff0c\u53ea\u5728\u5185\u90e8 <code>spinlock</code> \u7684\u4fdd\u62a4\u4e0b\u5c06 <code>gen</code> \u8ba1\u6570\u5668\u52a0\u4e00\uff0c\u7136\u540e\u8c03\u7528 <code>wake_up_all</code> \u5524\u9192\u6240\u6709\u5728 <code>queue</code> \u4e0a\u7b49\u5f85\u7684\u8fdb\u7a0b\u3002</p> <pre><code>SYSCALL_DEFINE1(eventsig, int, event_id) {\n    struct os_event *ev;\n    unsigned long flags;\n\n    if (event_id &lt; 0 || event_id &gt;= MAX_EVENTS)\n        return -EINVAL;\n\n    ev = &amp;event_table[event_id];\n\n    mutex_lock(&amp;event_table_lock);\n    if (!ev-&gt;in_use) {\n        mutex_unlock(&amp;event_table_lock);\n        return -EINVAL;\n    }\n    mutex_unlock(&amp;event_table_lock);\n\n    /* \u589e\u52a0 generation\uff08\u53d7\u9501\u4fdd\u62a4\uff09\uff0c\u7136\u540e wake_up_all */\n    spin_lock_irqsave(&amp;ev-&gt;lock, flags);\n    ev-&gt;gen++;   /* \u6bcf\u6b21 signal \u90fd\u81ea\u589e generation */\n    spin_unlock_irqrestore(&amp;ev-&gt;lock, flags);\n\n    wake_up_all(&amp;ev-&gt;queue);\n    return 0;\n}\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#334-sys_eventclose","title":"3.3.4 <code>sys_eventclose</code> \u7684\u5b9e\u73b0","text":"<p><code>eventclose</code> \u662f\u786e\u4fdd\u201c\u91ca\u653e\u540e\u91cd\u7528\u201d\u5b89\u5168\u7684\u5173\u952e\u3002</p> <ol> <li>\u5b83\u9996\u5148\u8bbe\u7f6e <code>closing = true</code> \u5e76\u5524\u9192\u6240\u6709\u7b49\u5f85\u8005\u3002</li> <li>\u7136\u540e\uff0c\u5b83\u4e0d\u4f1a\u7acb\u5373\u91ca\u653e\u69fd\u4f4d\uff0c\u800c\u662f\u8c03\u7528 <code>wait_event</code> \u5728 <code>destroy_wq</code> \u4e0a\u7761\u7720\u3002</li> <li>\u5b83\u4f1a\u4e00\u76f4\u5728\u6b64\u7761\u7720\uff0c\u76f4\u5230\u6700\u540e\u4e00\u4e2a <code>eventwait</code> \u8fdb\u7a0b\u9000\u51fa\u5e76\u5524\u9192\u5b83\u3002</li> <li>\u88ab\u5524\u9192\u540e\uff0c<code>eventclose</code> \u624d\u83b7\u53d6\u5168\u5c40\u9501 <code>event_table_lock</code>\uff0c\u5e76\u5b89\u5168\u5730\u5c06 <code>in_use = false</code>\uff0c\u6b64\u65f6\u69fd\u4f4d\u624d\u88ab\u771f\u6b63\u91ca\u653e\u3002</li> </ol> <pre><code>SYSCALL_DEFINE1(eventclose, int, event_id) {\n    struct os_event *ev;\n    unsigned long flags;\n\n    if (event_id &lt; 0 || event_id &gt;= MAX_EVENTS)\n        return -EINVAL;\n\n    ev = &amp;event_table[event_id];\n\n    /* \u68c0\u67e5\u5e76\u6807\u8bb0\u4e3a\u6b63\u5728\u5173\u95ed\uff08\u4e0d\u7acb\u5373\u6e05 in_use\uff09 */\n    mutex_lock(&amp;event_table_lock);\n    if (!ev-&gt;in_use) {\n        mutex_unlock(&amp;event_table_lock);\n        return -EINVAL;\n    }\n    mutex_unlock(&amp;event_table_lock);\n\n    /* \u6807\u8bb0 closing \u5e76\u5524\u9192\u6240\u6709\u7b49\u5f85\u8005 */\n    spin_lock_irqsave(&amp;ev-&gt;lock, flags);\n    ev-&gt;closing = true;\n    spin_unlock_irqrestore(&amp;ev-&gt;lock, flags);\n\n    wake_up_all(&amp;ev-&gt;queue);\n\n    /* \u7b49\u5f85\u6240\u6709\u7b49\u5f85\u8005\u79bb\u5f00\uff08waiters==0\uff09\uff0ceventwait \u5728\u6700\u540e\u4f1a wake_up destroy_wq */\n    wait_event(ev-&gt;destroy_wq, atomic_read(&amp;ev-&gt;waiters) == 0);\n\n    /* \u73b0\u5728\u6ca1\u6709\u4efb\u4f55\u7ebf\u7a0b\u4f9d\u8d56\u6b64\u69fd\u4f4d\uff0c\u53ef\u4ee5\u5b89\u5168\u91ca\u653e in_use */\n    mutex_lock(&amp;event_table_lock);\n    ev-&gt;in_use = false;\n    ev-&gt;closing = false; /* \u590d\u4f4d closing\uff08optional: \u4fdd\u7559 initialized\uff09 */\n    mutex_unlock(&amp;event_table_lock);\n\n    return 0;\n}\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#34","title":"3.4 \u7528\u6237\u6001\u6d4b\u8bd5\u7a0b\u5e8f","text":"<p>\u4e3a\u4e86\u9a8c\u8bc1\u4e0a\u8ff0\u5185\u6838\u5b9e\u73b0\u7684\u6b63\u786e\u6027\u548c\u5065\u58ee\u6027\uff0c\u8bbe\u8ba1\u4e86\u4ee5\u4e0b\u4e94\u4e2a\u6d4b\u8bd5\u7a0b\u5e8f\u3002</p>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#341-sync_test1c","title":"3.4.1 \u6d4b\u8bd5\u4e00\uff1a\u591a\u8fdb\u7a0b\u7b49\u5f85\u5355\u4e8b\u4ef6 (sync_test1.c)","text":"<p>\u6b64\u6d4b\u8bd5\u7528\u4e8e\u9a8c\u8bc1\u57fa\u672c\u529f\u80fd\uff1a\u591a\u4e2a\u5b50\u8fdb\u7a0b\uff085\u4e2a\uff09\u540c\u65f6\u7b49\u5f85\u540c\u4e00\u4e2a\u4e8b\u4ef6\uff0c\u7236\u8fdb\u7a0b\u5728 <code>sleep(3)</code> \u540e\u8c03\u7528 <code>eventsig</code>\uff0c\u9a8c\u8bc1\u6240\u6709\u5b50\u8fdb\u7a0b\u662f\u5426\u80fd\u88ab\u540c\u65f6\u5524\u9192\u3002</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/syscall.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;errno.h&gt;\n\n#define SYS_eventopen 550\n#define sys_eventclose 551\n#define sys_eventwait 552\n#define sys_eventsig 553\n\n#define NUM_CHILDREN 5\n\nint main() {\n    long event_id;\n    int i;\n    pid_t pid;\n\n    printf(\"(2723)[Parent] \u6b63\u5728\u521b\u5efa\u65b0\u4e8b\u4ef6...\\n\");\n    event_id = syscall(SYS_eventopen);\n    if (event_id &lt; 0) {\n        perror(\"syscall(eventopen) \u5931\u8d25\");\n        return 1;\n    }\n    printf(\"(2723)[Parent] \u4e8b\u4ef6\u521b\u5efa\u6210\u529f, ID: %ld\\n\", event_id);\n\n    for (i = 0; i &lt; NUM_CHILDREN; i++) {\n        pid = fork();\n        if (pid &lt; 0) {\n            perror(\"fork \u5931\u8d25\");\n            return 1;\n        }\n        if (pid == 0) {\n            printf(\"(2723)[Child %d] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 %ld...\\n\", getpid(), event_id);\n            long ret = syscall(sys_eventwait, event_id);\n            if (ret == 0) {\n                printf(\"(2723)[Child %d] \u6210\u529f\u4ece\u4e8b\u4ef6 %ld \u5524\u9192\uff01\\n\", getpid(), event_id);\n            } else {\n                perror(\"(2723)[Child] eventwait \u5931\u8d25\\n\");\n            }\n            exit(0);\n        }\n    }\n\n    printf(\"(2723)[parent] \u7b49\u5f853\u79d2\uff0c\u786e\u4fdd\u6240\u6709\u5b50\u8fdb\u7a0b\u90fd\u5df2\u8fdb\u5165\u7761\u7720...\\n\");\n    sleep(3);\n\n    printf(\"(2723)[Parent] \u6b63\u5728\u53d1\u9001\u4fe1\u53f7(eventsig)\u5230\u4e8b\u4ef6 %ld...\\n\", event_id);\n    syscall(sys_eventsig, event_id);\n\n    for (i = 0; i &lt; NUM_CHILDREN; i++) {\n        wait(NULL);\n    }\n    printf(\"(2723)[Parent] \u6240\u6709\u5b50\u8fdb\u7a0b\u5df2\u9000\u51fa\u3002\\n\");\n\n    syscall(sys_eventclose, event_id);\n    printf(\"(2723)[Parent] \u4e8b\u4ef6 %ld \u5df2\u5173\u95ed\u3002\\n\", event_id);\n\n    return 0;\n}\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#342-sync_test2c","title":"3.4.2 \u6d4b\u8bd5\u4e8c\uff1a\u591a\u8fdb\u7a0b\u7b49\u5f85\u591a\u4e8b\u4ef6 (sync_test2.c)","text":"<p>\u6b64\u6d4b\u8bd5\u7528\u4e8e\u9a8c\u8bc1\u4e8b\u4ef6\u7684\u9694\u79bb\u6027\u3002\u521b\u5efa\u4e09\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u5206\u522b\u7b49\u5f85\u4e09\u4e2a\u4e0d\u540c\u7684\u4e8b\u4ef6 (A, B, C)\u3002\u7236\u8fdb\u7a0b\u4f9d\u6b21\u5524\u9192 B\u3001C\u3001A\uff0c\u9a8c\u8bc1\u6bcf\u6b21 <code>eventsig</code> \u53ea\u5524\u9192\u4e86\u5bf9\u5e94\u4e8b\u4ef6\u4e0a\u7684\u8fdb\u7a0b\u3002</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/syscall.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;errno.h&gt;\n\n#define SYS_eventopen 550\n#define SYS_eventclose 551\n#define SYS_eventwait 552\n#define SYS_eventsig 553\n\nvoid wait_for_event(int event_id, const char* event_name) {\n    printf(\"(2723)[Child %d] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 %s (ID: %d)...\\n\", getpid(), event_name, event_id);\n    long ret = syscall(SYS_eventwait, event_id);\n    if (ret == 0) {\n        printf(\"(2723)[Child %d] \u6210\u529f\u4ece\u4e8b\u4ef6 %s (ID: %d) \u5524\u9192!\\n\", getpid(), event_name, event_id);\n    } else {\n        perror(\"(2723)[Child] eventwait \u5931\u8d25\");\n    }\n    exit(0);\n}\n\nint main() {\n    long event_A, event_B, event_C;\n    event_A = syscall(SYS_eventopen);\n    event_B = syscall(SYS_eventopen);\n    event_C = syscall(SYS_eventopen);\n    printf(\"(2723)[Parent] \u521b\u5efa\u4e86\u4e09\u4e2a\u4e8b\u4ef6: A=%ld, B=%ld, C=%ld\", event_A, event_B, event_C);\n    if (fork() == 0) {\n        wait_for_event(event_A, \"A\");\n    }\n    if (fork() == 0) {\n        wait_for_event(event_B, \"B\");\n    }\n    if (fork() == 0) {\n        wait_for_event(event_C, \"C\");\n    }\n    printf(\"(2723)[Parent] \u7b49\u5f853\u79d2\uff0c\u786e\u4fdd\u6240\u6709\u5b50\u8fdb\u7a0b\u8fdb\u5165\u7761\u7720...\\n\");\n    sleep(3);\n    printf(\"(2723)[Parent] \u6b63\u5728\u53d1\u9001\u4fe1\u53f7(eventsig)\u5230\u4e8b\u4ef6B(ID: %ld)...\\n\", event_B);\n    syscall(SYS_eventsig, event_B);\n    sleep(1);\n    printf(\"(2723)[Parent] ---------------------------------------\\n\");\n    printf(\"(2723)[Parent] \u6b63\u5728\u53d1\u9001\u4fe1\u53f7(eventsig)\u5230\u4e8b\u4ef6C(ID: %ld)...\\n\", event_C);\n    syscall(SYS_eventsig, event_C);\n    sleep(1);\n    printf(\"(2723)[Parent] ---------------------------------------\\n\");\n    printf(\"(2723)[Parent] \u6b63\u5728\u53d1\u9001\u4fe1\u53f7(eventsig)\u5230\u4e8b\u4ef6A(ID: %ld)...\\n\", event_A);\n    syscall(SYS_eventsig, event_A);\n\n    wait(NULL);\n    wait(NULL);\n    wait(NULL);\n    printf(\"(2723)[Parent] \u6240\u6709\u5b50\u8fdb\u7a0b\u5df2\u9000\u51fa\u3002\\n\");\n\n    syscall(SYS_eventclose, event_A);\n    syscall(SYS_eventclose, event_B);\n    syscall(SYS_eventclose, event_C);\n    printf(\"(2723)[Parent] \u6240\u6709\u4e8b\u4ef6\u5df2\u5173\u95ed\u3002\\n\");\n\n    return 0;\n}\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#343-eventclose-sync_test3c","title":"3.4.3 \u6d4b\u8bd5\u4e09\uff1a<code>eventclose</code> \u5524\u9192\u6d4b\u8bd5 (sync_test3.c)","text":"<p>\u6b64\u6d4b\u8bd5\u7528\u4e8e\u9a8c\u8bc1 <code>eventclose</code> \u7684\u5524\u9192\u529f\u80fd\u3002\u7236\u8fdb\u7a0b\u4e0d\u8c03\u7528 <code>eventsig</code>\uff0c\u800c\u662f\u76f4\u63a5\u8c03\u7528 <code>eventclose</code>\uff0c\u9a8c\u8bc1\u6240\u6709\u6b63\u5728\u7b49\u5f85\u7684\u5b50\u8fdb\u7a0b\u662f\u5426\u88ab\u6b63\u786e\u5524\u9192\uff08\u5b83\u4eec\u4f1a\u68c0\u67e5\u5230 <code>closing == true</code>\uff09\u3002</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/syscall.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;errno.h&gt;\n\n#define SYS_eventopen 550\n#define SYS_eventclose 551\n#define SYS_eventwait 552\n#define SYS_eventsig 553\n\n#define NUM_CHILDREN 3\n\nint main() {\n    long event_id;\n    int i;\n    pid_t pid;\n\n    printf(\"(2723)[Parent] \u6b63\u5728\u521b\u5efa\u65b0\u4e8b\u4ef6...\\n\");\n    event_id = syscall(SYS_eventopen);\n    if (event_id &lt; 0) {\n        perror(\"syscall(eventopen) failed.\\n\");\n        return 1;\n    }\n    printf(\"(2723)[Parent] \u4e8b\u4ef6\u521b\u5efa\u6210\u529f\uff0cID: %ld\\n\", event_id);\n\n    for (i = 0; i &lt; NUM_CHILDREN; i++) {\n        if (fork() == 0) {\n            printf(\"(2723)[Child %d] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 %ld...\\n\", getpid(), event_id);\n            long ret = syscall(SYS_eventwait, event_id);\n            if (ret == 0) {\n                printf(\"(2723)[Child %d] \u6210\u529f\u4ece\u4e8b\u4ef6 %ld \u5524\u9192 (\u88abclose\u5524\u9192?)\\n\", getpid(), event_id);\n            } else {\n                printf(\"(2723)[Child %d] eventwait \u8fd4\u56de %ld, \u53ef\u80fd\u662f\u88ab close \u4e2d\u65ad\\n\", getpid(), ret);\n            }\n            exit(0);\n        }\n    }\n\n    printf(\"(2723)[Parent] \u7b49\u5f853\u79d2\uff0c\u786e\u4fdd\u6240\u6709\u5b50\u8fdb\u7a0b\u90fd\u5df2\u8fdb\u5165\u7761\u7720...\\n\");\n    sleep(3);\n\n    printf(\"(2723)[Parent] \u6b63\u5728\u5173\u95ed(eventclose)\u4e8b\u4ef6 %ld \u6765\u5524\u9192\u5b50\u8fdb\u7a0b...\\n\", event_id);\n    syscall(SYS_eventclose, event_id);\n\n    for (i = 0; i &lt; NUM_CHILDREN; i++) {\n        wait(NULL);\n    }\n    printf(\"(2723)[Parent] \u6240\u6709\u5b50\u8fdb\u7a0b\u5df2\u9000\u51fa\u3002\\n\");\n    printf(\"(2723)[Parent] \u6d4b\u8bd5\u5b8c\u6210\u3002\\n\");\n\n    return 0;\n}\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#344-sync_test4c","title":"3.4.4 \u6d4b\u8bd5\u56db\uff1a\u8fb9\u7f18\u89e6\u53d1\u6d4b\u8bd5 (sync_test4.c)","text":"<p>\u6b64\u6d4b\u8bd5\u7528\u4e8e\u9a8c\u8bc1 <code>gen</code> \u8ba1\u6570\u5668\u5b9e\u73b0\u7684\u201c\u8fb9\u7f18\u89e6\u53d1\u201d\u7279\u6027\u3002\u5b50\u8fdb\u7a0b\u5728\u4e00\u4e2a\u5faa\u73af\u4e2d\u8c03\u7528 <code>eventwait</code> 5\u6b21\uff1b\u7236\u8fdb\u7a0b\u4e5f\u5fc5\u987b\u5728\u5faa\u73af\u4e2d\u8c03\u7528 <code>eventsig</code> 5\u6b21\uff0c\u6bcf\u6b21 <code>eventsig</code> \u9012\u589e <code>gen</code>\uff0c\u624d\u80fd\u8ba9\u5b50\u8fdb\u7a0b\u5b8c\u6210\u4e00\u6b21\u5faa\u73af\u3002</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/syscall.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;errno.h&gt;\n\n#define SYS_eventopen 550\n#define SYS_eventclose 551\n#define SYS_eventwait 552\n#define SYS_eventsig 553\n\n#define LOOP_COUNT 5\n\nint main()\n{\n    long event_id;\n    int i;\n    pid_t pid;\n\n    printf(\"(2723)[Parent] \u6b63\u5728\u521b\u5efa\u65b0\u4e8b\u4ef6...\\n\");\n    event_id = syscall(SYS_eventopen);\n    printf(\"(2723)[Parent] \u4e8b\u4ef6\u521b\u5efa\u6210\u529f\uff0cID: %ld\\n\", event_id);\n\n    pid = fork();\n    if (pid == 0) {\n        // --- \u5b50\u8fdb\u7a0b\u903b\u8f91 ---\n        for (i = 0; i &lt; LOOP_COUNT; i++) {\n            printf(\"(2723)[Child %d] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 %ld (\u7b2c %d/%d \u6b21)\\n\",\n                   getpid(), event_id, i + 1, LOOP_COUNT);\n\n            long ret = syscall(SYS_eventwait, event_id); // \u7b49\u5f85\n\n            if (ret != 0) {\n                perror(\"(2723)[Child] eventwait \u5931\u8d25\");\n                exit(1);\n            }\n            printf(\"(2723)[Child %d] \u6210\u529f\u4ece\u4e8b\u4ef6 %ld \u5524\u9192 (\u7b2c %d/%d \u6b21)\\n\",\n                   getpid(), event_id, i + 1, LOOP_COUNT);\n            // \u5524\u9192\u540e\u4e0d\u9000\u51fa\uff0c\u800c\u662f\u5faa\u73af\u56de\u53bb\u518d\u6b21\u7b49\u5f85\n        }\n        printf(\"(2723)[Child %d] \u5faa\u73af\u5b8c\u6210\uff0c\u6b63\u5728\u9000\u51fa\u3002\\n\", getpid());\n        exit(0);\n        // --- \u5b50\u8fdb\u7a0b\u7ed3\u675f ---\n    }\n\n    // --- \u7236\u8fdb\u7a0b\u903b\u8f91 ---\n    printf(\"(2723)[Parent] \u7b49\u5f85 2 \u79d2\u8ba9\u5b50\u8fdb\u7a0b\u8fdb\u5165\u7761\u7720...\\n\");\n    sleep(2);\n\n    for (i = 0; i &lt; LOOP_COUNT; i++) {\n        printf(\"(2723)[Parent] \u6b63\u5728\u53d1\u9001\u4fe1\u53f7 (eventsig) \u5230\u4e8b\u4ef6 %ld (\u7b2c %d/%d \u6b21)\\n\",\n               event_id, i + 1, LOOP_COUNT);\n\n        syscall(SYS_eventsig, event_id); // \u6bcf\u6b21\u5faa\u73af\u90fd\u53d1\u4e00\u4e2a\u4fe1\u53f7\n\n        sleep(1); // \u7ed9\u5b50\u8fdb\u7a0b\u4e00\u70b9\u65f6\u95f4\u53bb\u5faa\u73af\u5e76\u518d\u6b21\u7761\u7720\n    }\n\n    wait(NULL); // \u7b49\u5f85\u5b50\u8fdb\u7a0b\u9000\u51fa\n    printf(\"(2723)[Parent] \u5b50\u8fdb\u7a0b\u5df2\u9000\u51fa\u3002\\n\");\n\n    syscall(SYS_eventclose, event_id);\n    printf(\"(2723)[Parent] \u4e8b\u4ef6 %ld \u5df2\u5173\u95ed\u3002\\n\", event_id);\n\n    return 0;\n}\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#345-sync_test5c","title":"3.4.5 \u6d4b\u8bd5\u4e94\uff1a\u91ca\u653e-\u91cd\u7528\u538b\u529b\u6d4b\u8bd5 (sync_test5.c)","text":"<p>\u6b64\u6d4b\u8bd5\u7528\u4e8e\u9a8c\u8bc1 <code>atomic_t waiters</code> \u5f15\u7528\u8ba1\u6570\u548c <code>destroy_wq</code> \u673a\u5236\u7684\u5065\u58ee\u6027\u3002</p> <ol> <li>\u9996\u5148\u586b\u6ee1\u5168\u90e8 64 \u4e2a\u4e8b\u4ef6\u69fd\u4f4d\u3002</li> <li>\u542f\u52a8\u4e00\u4e2a\u201c\u6162\u7b49\u5f85\u8005\u201d\u7ebf\u7a0b (<code>slow_waiter</code>) \u5728 <code>ID: 0</code> \u4e0a\u7761\u7720\u3002</li> <li>\u542f\u52a8\u4e00\u4e2a\u201c\u5173\u95ed\u8005\u201d\u7ebf\u7a0b (<code>closer</code>) \u8c03\u7528 <code>eventclose(0)</code>\u3002</li> <li><code>closer</code> \u4f1a\u963b\u585e\u5728 <code>destroy_wq</code> \u4e0a\uff0c\u7b49\u5f85 <code>waiters</code> \u5f52\u96f6\u3002</li> <li>\u4e3b\u7ebf\u7a0b (<code>main</code>) \u6b64\u65f6\u75af\u72c2\u5faa\u73af\u8c03\u7528 <code>eventopen</code>\u3002</li> <li>\u9884\u671f <code>main</code> \u7ebf\u7a0b\u4f1a\u4e00\u76f4\u5931\u8d25 (\u8fd4\u56de <code>-ENOSPC</code>)\uff0c\u76f4\u5230 <code>slow_waiter</code> \u9000\u51fa\u3001<code>closer</code> \u8fd4\u56de\u3001<code>ID: 0</code> \u7684 <code>in_use</code> \u6700\u7ec8\u88ab\u8bbe\u4e3a <code>false</code> \u540e\uff0c<code>eventopen</code> \u624d\u80fd\u6210\u529f\u3002</li> <li>\u6b64\u6d4b\u8bd5\u4f7f\u7528 <code>pthread</code> \u5e93\uff0c\u7f16\u8bd1\u65f6\u9700\u94fe\u63a5 <code>-lpthread</code>\u3002</li> </ol> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/syscall.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;pthread.h&gt;\n\n#define SYS_eventopen 550\n#define SYS_eventclose 551\n#define SYS_eventwait 552\n#define SYS_eventsig 553\n\n// \u4f60\u7684\u5185\u6838\u4e2d\u7684 MAX_EVENTS\n#define KERNEL_MAX_EVENTS 64 \n\nlong event_id_to_test = 0; // \u6211\u4eec\u5c06\u4e13\u95e8\u6d4b\u8bd5 ID 0\n\n// \u7ebf\u7a0b 1\uff1a\u7f13\u6162\u7684\u7b49\u5f85\u8005\nvoid* slow_waiter(void* arg) {\n    printf(\"[Waiter] \u7ebf\u7a0b\u542f\u52a8\uff0c\u51c6\u5907\u7b49\u5f85\u4e8b\u4ef6 %ld\\n\", event_id_to_test);\n    syscall(SYS_eventwait, event_id_to_test);\n\n    printf(\"[Waiter] \u521a\u521a\u88ab\u5524\u9192 (\u88ab close \u5524\u9192)\u3002\\n\");\n    printf(\"[Waiter] \u6a21\u62df\u4e00\u4e9b\u6e05\u7406\u5de5\u4f5c... (\u7761\u7720 2 \u79d2)\\n\");\n    sleep(2); // \u6a21\u62df\u5728\u9000\u51fa eventwait \u540e\u4ecd\u6301\u6709\u9501\u6216\u8d44\u6e90\n\n    printf(\"[Waiter] \u6e05\u7406\u5de5\u4f5c\u5b8c\u6210\uff0c\u7ebf\u7a0b\u9000\u51fa\u3002\\n\");\n    return NULL;\n}\n\n// \u7ebf\u7a0b 2\uff1a\u5173\u95ed\u8005\nvoid* closer(void* arg) {\n    // \u7b49\u5f85 waiter \u5148\u8fdb\u5165\u7761\u7720\n    sleep(1); \n\n    printf(\"(2723)[Closer] \u7ebf\u7a0b\u542f\u52a8\uff0c\u51c6\u5907\u5173\u95ed\u4e8b\u4ef6 %ld\\n\", event_id_to_test);\n    long ret = syscall(SYS_eventclose, event_id_to_test);\n\n    printf(\"(2723)[Closer] eventclose \u8c03\u7528\u8fd4\u56de (ret=%ld)\u3002\u8fd9\u5e94\u8be5\u5728 Waiter \u9000\u51fa\u540e\u624d\u53d1\u751f\u3002\\n\", ret);\n    return NULL;\n}\n\n\nint main()\n{\n    pthread_t waiter_tid, closer_tid;\n    long event_ids[KERNEL_MAX_EVENTS];\n    int i;\n\n    // --- \u6b65\u9aa4 1: \u586b\u6ee1\u6240\u6709\u4e8b\u4ef6\u69fd\u4f4d ---\n    printf(\"(2723)[Main] \u6b63\u5728\u586b\u6ee1\u6240\u6709 %d \u4e2a\u4e8b\u4ef6\u69fd\u4f4d...\\n\", KERNEL_MAX_EVENTS);\n    for (i = 0; i &lt; KERNEL_MAX_EVENTS; i++) {\n        event_ids[i] = syscall(SYS_eventopen);\n        if (event_ids[i] &lt; 0) {\n            perror(\"(2723)[Main] eventopen \u5931\u8d25\uff0c\u65e0\u6cd5\u586b\u6ee1 table\");\n            return 1;\n        }\n    }\n    printf(\"(2723)[Main] \u6240\u6709 %d \u4e2a\u69fd\u4f4d\u5df2\u5360\u6ee1 (0 \u5230 %d)\u3002\\n\", KERNEL_MAX_EVENTS, KERNEL_MAX_EVENTS - 1);\n\n    // \u6211\u4eec\u9009\u62e9\u7b2c\u4e00\u4e2a\u4e8b\u4ef6 ID (\u5373 0) \u6765\u8fdb\u884c\u6d4b\u8bd5\n    event_id_to_test = event_ids[0];\n\n    // --- \u6b65\u9aa4 2 &amp; 3: \u542f\u52a8 Waiter \u548c Closer ---\n    pthread_create(&amp;waiter_tid, NULL, slow_waiter, NULL);\n    pthread_create(&amp;closer_tid, NULL, closer, NULL);\n\n    // \u7b49\u5f85 Closer \u7ebf\u7a0b\u542f\u52a8 (Closer \u81ea\u5df1\u4f1a sleep 1s, \u6240\u4ee5 0.1s \u8db3\u591f)\n    usleep(100000); // 0.1 \u79d2\n\n    // --- \u6b65\u9aa4 4: \u4e3b\u7ebf\u7a0b (Churner) \u5f00\u59cb\u75af\u72c2\u5c1d\u8bd5\u91cd\u7528 ---\n    printf(\"(2723)[Main] Closer \u5df2\u542f\u52a8\u3002Main \u7ebf\u7a0b\u5f00\u59cb\u5faa\u73af\u5c1d\u8bd5 eventopen...\\n\");\n\n    long ret = -1;\n    int attempts = 0;\n    while(ret &lt; 0) {\n        attempts++;\n\n        // \u5c1d\u8bd5\u6253\u5f00\u65b0\u4e8b\u4ef6\u3002\u6211\u4eec\u5e0c\u671b\u5b83\u5931\u8d25\uff0c\u76f4\u5230 closer \u7ebf\u7a0b\u5b8c\u6210\u3002\n        ret = syscall(SYS_eventopen);\n\n        if (ret &lt; 0) {\n            // -ENOSPC (\u6216 -ENOMEM) \u662f\u6211\u4eec\u671f\u671b\u7684\n            // \u8fd9\u8bc1\u660e eventclose \u4ecd\u5728\u963b\u585e\uff0cevent_table[0].in_use \u4ecd\u4e3a true\n            if (attempts % 500000 == 0) { // \u8c03\u9ad8\u6253\u5370\u9891\u7387\n                printf(\"(2723)[Main] \u7b2c %d \u6b21 eventopen \u5931\u8d25 (errno: %d)\u3002\u8fd9\u662f\u6b63\u5e38\u7684\u3002\\n\", attempts, errno);\n            }\n        } else {\n            // \u6210\u529f\u4e86\uff01\n            printf(\"\\n(2723)[Main] *** \u6210\u529f\u5728 %d \u6b21\u5c1d\u8bd5\u540e\u6253\u5f00\u4e86\u65b0\u4e8b\u4ef6 ID %ld ***\\n\", attempts, ret);\n        }\n    }\n\n    printf(\"(2723)[Main] \u8fd9\u5e94\u8be5\u5728 Closer \u548c Waiter \u90fd\u9000\u51fa\u540e\u624d\u53d1\u751f\u3002\\n\");\n\n    // --- \u6e05\u7406 ---\n    pthread_join(waiter_tid, NULL);\n    pthread_join(closer_tid, NULL);\n\n    // \u5173\u95ed\u6211\u4eec\u65b0\u6253\u5f00\u7684\u4e8b\u4ef6\n    syscall(SYS_eventclose, ret);\n\n    // \u5173\u95ed\u5176\u4ed6\u6240\u6709\u5360\u4f4d\u7684\u4e8b\u4ef6 (ID 1 \u5230 63)\n    for (i = 1; i &lt; KERNEL_MAX_EVENTS; i++) {\n        syscall(SYS_eventclose, event_ids[i]);\n    }\n\n    printf(\"(2723)[Main] \u6d4b\u8bd5\u5b8c\u6210\u3002\\n\");\n    return 0;\n}\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#4","title":"4. \u5b9e\u9a8c\u7ed3\u679c","text":"<p>\u4ee5\u4e0b\u662f\u4e94\u4e2a\u6d4b\u8bd5\u7a0b\u5e8f\u7684\u5b9e\u9645\u8fd0\u884c\u8f93\u51fa\u7ed3\u679c\u3002</p>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#41","title":"4.1 \u6d4b\u8bd5\u4e00\uff1a\u591a\u8fdb\u7a0b\u7b49\u5f85\u5355\u4e8b\u4ef6","text":"<p>\u6d4b\u8bd5 <code>sync_test1.c</code>\uff0c\u7236\u8fdb\u7a0b <code>eventsig</code> \u6210\u529f\u5524\u9192\u4e86\u6240\u6709 5 \u4e2a\u6b63\u5728\u7b49\u5f85\u7684\u5b50\u8fdb\u7a0b\u3002</p> <pre><code>(2723)[Parent] \u6b63\u5728\u521b\u5efa\u65b0\u4e8b\u4ef6...\n(2723)[Parent] \u4e8b\u4ef6\u521b\u5efa\u6210\u529f, ID: 0\n(2723)[Child 3070] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 0...\n(2723)[Child 3071] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 0...\n(2723)[parent] \u7b49\u5f853\u79d2\uff0c\u786e\u4fdd\u6240\u6709\u5b50\u8fdb\u7a0b\u90fd\u5df2\u8fdb\u5165\u7761\u7720...\n(2723)[Child 3073] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 0...\n(2723)[Child 3072] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 0...\n(2723)[Child 3074] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 0...\n(2723)[Parent] \u6b63\u5728\u53d1\u9001\u4fe1\u53f7(eventsig)\u5230\u4e8b\u4ef6 0...\n(2723)[Child 3074] \u6210\u529f\u4ece\u4e8b\u4ef6 0 \u5524\u9192\uff01\n(2723)[Child 3071] \u6210\u529f\u4ece\u4e8b\u4ef6 0 \u5524\u9192\uff01\n(2723)[Child 3072] \u6210\u529f\u4ece\u4e8b\u4ef6 0 \u5524\u9192\uff01\n(2723)[Child 3073] \u6210\u529f\u4ece\u4e8b\u4ef6 0 \u5524\u9192\uff01\n(2723)[Child 3070] \u6210\u529f\u4ece\u4e8b\u4ef6 0 \u5524\u9192\uff01\n(2723)[Parent] \u6240\u6709\u5b50\u8fdb\u7a0b\u5df2\u9000\u51fa\u3002\n(2723)[Parent] \u4e8b\u4ef6 0 \u5df2\u5173\u95ed\u3002\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#42","title":"4.2 \u6d4b\u8bd5\u4e8c\uff1a\u591a\u8fdb\u7a0b\u7b49\u5f85\u591a\u4e8b\u4ef6","text":"<p>\u6d4b\u8bd5 <code>sync_test2.c</code>\uff0c\u7236\u8fdb\u7a0b\u5bf9 B\u3001C\u3001A \u7684 <code>eventsig</code> \u8c03\u7528\uff0c\u7cbe\u786e\u5730\u3001\u4f9d\u6b21\u5524\u9192\u4e86\u5404\u81ea\u4e8b\u4ef6\u4e0a\u7684\u7b49\u5f85\u8005\uff0c\u8bc1\u660e\u4e86\u4e8b\u4ef6\u7684\u9694\u79bb\u6027\u3002</p> <pre><code>(2723)[Parent] \u521b\u5efa\u4e86\u4e09\u4e2a\u4e8b\u4ef6: A=0, B=1, C=2(2723)[Child 3143] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 A (ID: 0)...\n(2723)[Parent] \u521b\u5efa\u4e86\u4e09\u4e2a\u4e8b\u4ef6: A=0, B=1, C=2(2723)[Child 3144] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 B (ID: 1)...\n(2723)[Parent] \u521b\u5efa\u4e86\u4e09\u4e2a\u4e8b\u4ef6: A=0, B=1, C=2(2723)[Parent] \u7b49\u5f853\u79d2\uff0c\u786e\u4fdd\u6240\u6709\u5b50\u8fdb\u7a0b\u8fdb\u5165\u7761\u7720...\n(2723)[Parent] \u521b\u5efa\u4e86\u4e09\u4e2a\u4e8b\u4ef6: A=0, B=1, C=2(2723)[Child 3145] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 C (ID: 2)...\n(2723)[Parent] \u6b63\u5728\u53d1\u9001\u4fe1\u53f7(eventsig)\u5230\u4e8b\u4ef6B(ID: 1)...\n(2723)[Child 3144] \u6210\u529f\u4ece\u4e8b\u4ef6 B (ID: 1) \u5524\u9192!\n(2723)[Parent] ---------------------------------------\n(2723)[Parent] \u6b63\u5728\u53d1\u9001\u4fe1\u53f7(eventsig)\u5230\u4e8b\u4ef6C(ID: 2)...\n(2723)[Child 3145] \u6210\u529f\u4ece\u4e8b\u4ef6 C (ID: 2) \u5524\u9192!\n(2723)[Parent] ---------------------------------------\n(2723)[Parent] \u6b63\u5728\u53d1\u9001\u4fe1\u53f7(eventsig)\u5230\u4e8b\u4ef6A(ID: 0)...\n(2723)[Child 3143] \u6210\u529f\u4ece\u4e8b\u4ef6 A (ID: 0) \u5524\u9192!\n(2723)[Parent] \u6240\u6709\u5b50\u8fdb\u7a0b\u5df2\u9000\u51fa\u3002\n(2723)[Parent] \u6240\u6709\u4e8b\u4ef6\u5df2\u5173\u95ed\u3002\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#43-eventclose","title":"4.3 \u6d4b\u8bd5\u4e09\uff1a<code>eventclose</code> \u5524\u9192\u6d4b\u8bd5","text":"<p>\u6d4b\u8bd5 <code>sync_test3.c</code>\uff0c\u7236\u8fdb\u7a0b\u76f4\u63a5\u8c03\u7528 <code>eventclose</code>\uff0c\u6240\u6709\u6b63\u5728\u7b49\u5f85\u7684\u5b50\u8fdb\u7a0b\u88ab\u6210\u529f\u5524\u9192\uff0c\u8bc1\u660e <code>eventclose</code> \u6ee1\u8db3\u4e86\u201c\u901a\u77e5\u6240\u6709\u88ab\u963b\u585e\u8fdb\u7a0b\u201d\u7684\u8981\u6c42\u3002</p> <pre><code>(2723)[Parent] \u6b63\u5728\u521b\u5efa\u65b0\u4e8b\u4ef6...\n(2723)[Parent] \u4e8b\u4ef6\u521b\u5efa\u6210\u529f\uff0cID: 0\n(2723)[Child 3236] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 0...\n(2723)[Parent] \u7b49\u5f853\u79d2\uff0c\u786e\u4fdd\u6240\u6709\u5b50\u8fdb\u7a0b\u90fd\u5df2\u8fdb\u5165\u7761\u7720...\n(2723)[Child 3237] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 0...\n(2723)[Child 3238] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 0...\n(2723)[Parent] \u6b63\u5728\u5173\u95ed(eventclose)\u4e8b\u4ef6 0 \u6765\u5524\u9192\u5b50\u8fdb\u7a0b...\n(2723)[Child 3236] \u6210\u529f\u4ece\u4e8b\u4ef6 0 \u5524\u9192 (\u88abclose\u5524\u9192?)\n(2723)[Child 3237] \u6210\u529f\u4ece\u4e8b\u4ef6 0 \u5524\u9192 (\u88abclose\u5524\u9192?)\n(2723)[Child 3238] \u6210\u529f\u4ece\u4e8b\u4ef6 0 \u5524\u9192 (\u88abclose\u5524\u9192?)\n(2723)[Parent] \u6240\u6709\u5b50\u8fdb\u7a0b\u5df2\u9000\u51fa\u3002\n(2723)[Parent] \u6d4b\u8bd5\u5b8c\u6210\u3002\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#44","title":"4.4 \u6d4b\u8bd5\u56db\uff1a\u8fb9\u7f18\u89e6\u53d1\u6d4b\u8bd5","text":"<p>\u6d4b\u8bd5 <code>sync_test4.c</code>\uff0c\u7236\u8fdb\u7a0b\u7684 5 \u6b21 <code>eventsig</code> \u8c03\u7528\uff0c\u5bf9\u5e94\u4e86\u5b50\u8fdb\u7a0b\u7684 5 \u6b21 <code>eventwait</code> \u5524\u9192\u548c\u5faa\u73af\uff0c\u8bc1\u660e\u4e86 <code>gen</code> \u8ba1\u6570\u5668\u5b9e\u73b0\u7684\u8fb9\u7f18\u89e6\u53d1\u903b\u8f91\u6b63\u786e\u3002</p> <pre><code>(2723)[Parent] \u6b63\u5728\u521b\u5efa\u65b0\u4e8b\u4ef6...\n(2723)[Parent] \u4e8b\u4ef6\u521b\u5efa\u6210\u529f\uff0cID: 0\n(2723)[Parent] \u7b49\u5f85 2 \u79d2\u8ba9\u5b50\u8fdb\u7a0b\u8fdb\u5165\u7761\u7720...\n(2723)[Child 3298] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 0 (\u7b2c 1/5 \u6b21)\n(2723)[Parent] \u6b63\u5728\u53d1\u9001\u4fe1\u53f7 (eventsig) \u5230\u4e8b\u4ef6 0 (\u7b2c 1/5 \u6b21)\n(2723)[Child 3298] \u6210\u529f\u4ece\u4e8b\u4ef6 0 \u5524\u9192 (\u7b2c 1/5 \u6b21)\n(2723)[Child 3298] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 0 (\u7b2c 2/5 \u6b21)\n(2723)[Parent] \u6b63\u5728\u53d1\u9001\u4fe1\u53f7 (eventsig) \u5230\u4e8b\u4ef6 0 (\u7b2c 2/5 \u6b21)\n(2723)[Child 3298] \u6210\u529f\u4ece\u4e8b\u4ef6 0 \u5524\u9192 (\u7b2c 2/5 \u6b21)\n(2723)[Child 3298] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 0 (\u7b2c 3/5 \u6b21)\n(2723)[Parent] \u6b63\u5728\u53d1\u9001\u4fe1\u53f7 (eventsig) \u5230\u4e8b\u4ef6 0 (\u7b2c 3/5 \u6b21)\n(2723)[Child 3298] \u6210\u529f\u4ece\u4e8b\u4ef6 0 \u5524\u9192 (\u7b2c 3/5 \u6b21)\n(2723)[Child 3298] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 0 (\u7b2c 4/5 \u6b21)\n(2723)[Parent] \u6b63\u5728\u53d1\u9001\u4fe1\u53f7 (eventsig) \u5230\u4e8b\u4ef6 0 (\u7b2c 4/5 \u6b21)\n(2723)[Child 3298] \u6210\u529f\u4ece\u4e8b\u4ef6 0 \u5524\u9192 (\u7b2c 4/5 \u6b21)\n(2723)[Child 3298] \u6b63\u5728\u7b49\u5f85\u4e8b\u4ef6 0 (\u7b2c 5/5 \u6b21)\n(2723)[Parent] \u6b63\u5728\u53d1\u9001\u4fe1\u53f7 (eventsig) \u5230\u4e8b\u4ef6 0 (\u7b2c 5/5 \u6b21)\n(2723)[Child 3298] \u6210\u529f\u4ece\u4e8b\u4ef6 0 \u5524\u9192 (\u7b2c 5/5 \u6b21)\n(2723)[Child 3298] \u5faa\u73af\u5b8c\u6210\uff0c\u6b63\u5728\u9000\u51fa\u3002\n(2723)[Parent] \u5b50\u8fdb\u7a0b\u5df2\u9000\u51fa\u3002\n(2723)[Parent] \u4e8b\u4ef6 0 \u5df2\u5173\u95ed\u3002\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#45-","title":"4.5 \u6d4b\u8bd5\u4e94\uff1a\u91ca\u653e-\u91cd\u7528\u538b\u529b\u6d4b\u8bd5","text":"<p>\u6d4b\u8bd5 <code>sync_test5.c</code>\uff0c\u4e3b\u7ebf\u7a0b\u5728 2 \u79d2\u591a\u7684\u65f6\u95f4\u5185 <code>eventopen</code> \u5931\u8d25\u4e86\u8d85\u8fc7 160 \u4e07\u6b21\uff0c\u76f4\u5230 <code>slow_waiter</code> \u7ebf\u7a0b\u9000\u51fa\u3001<code>closer</code> \u7ebf\u7a0b\u8fd4\u56de\u540e\uff0c<code>eventopen</code> \u624d\u6210\u529f\u62ff\u5230 <code>ID: 0</code>\u3002\u8fd9\u8bc1\u660e\u4e86 <code>atomic_t waiters</code> \u548c <code>destroy_wq</code> \u673a\u5236\u6210\u529f\u963b\u585e\u4e86 <code>eventclose</code>\uff0c\u907f\u514d\u4e86\u201c\u91ca\u653e\u540e\u91cd\u7528\u201d\u7684\u7ade\u6001\u6761\u4ef6\u3002</p> <pre><code>(2723)[Main] \u6b63\u5728\u586b\u6ee1\u6240\u6709 64 \u4e2a\u4e8b\u4ef6\u69fd\u4f4d...\n(2723)[Main] \u6240\u6709 64 \u4e2a\u69fd\u4f4d\u5df2\u5360\u6ee1 (0 \u5230 63)\u3002\n[Waiter] \u7ebf\u7a0b\u542f\u52a8\uff0c\u51c6\u5907\u7b49\u5f85\u4e8b\u4ef6 0\n(2723)[Main] Closer \u5df2\u542f\u52a8\u3002Main \u7ebf\u7a0b\u5f00\u59cb\u5faa\u73af\u5c1d\u8bd5 eventopen...\n(2723)[Main] \u7b2c 500000 \u6b21 eventopen \u5931\u8d25 (errno: 28)\u3002\u8fd9\u662f\u6b63\u5e38\u7684\u3002\n(2723)[Main] \u7b2c 1000000 \u6b21 eventopen \u5931\u8d25 (errno: 28)\u3002\u8fd9\u662f\u6b63\u5e38\u7684\u3002\n(2723)[Main] \u7b2c 1500000 \u6b21 eventopen \u5931\u8d25 (errno: 28)\u3002\u8fd9\u662f\u6b63\u5e38\u7684\u3002\n(2723)[Closer] \u7ebf\u7a0b\u542f\u52a8\uff0c\u51c6\u5907\u5173\u95ed\u4e8b\u4ef6 0\n[Waiter] \u521a\u521a\u88ab\u5524\u9192 (\u88ab close \u5524\u9192)\u3002\n[Waiter] \u6a21\u62df\u4e00\u4e9b\u6e05\u7406\u5de5\u4f5c... (\u7761\u7720 2 \u79d2)\n(2723)[Closer] eventclose \u8c03\u7528\u8fd4\u56de (ret=0)\u3002\u8fd9\u5e94\u8be5\u5728 Waiter \u9000\u51fa\u540e\u624d\u53d1\u751f\u3002\n\n(2723)[Main] *** \u6210\u529f\u5728 1609364 \u6b21\u5c1d\u8bd5\u540e\u6253\u5f00\u4e86\u65b0\u4e8b\u4ef6 ID 0 ***\n(2723)[Main] \u8fd9\u5e94\u8be5\u5728 Closer \u548c Waiter \u90fd\u9000\u51fa\u540e\u624d\u53d1\u751f\u3002\n[Waiter] \u6e05\u7406\u5de5\u4f5c\u5b8c\u6210\uff0c\u7ebf\u7a0b\u9000\u51fa\u3002\n(2723)[Main] \u6d4b\u8bd5\u5b8c\u6210\u3002\n</code></pre>"},{"location":"course/OperatingSystem/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C/#5","title":"5. \u5b9e\u9a8c\u603b\u7ed3\u4e0e\u53cd\u601d","text":"<p>\u672c\u6b21\u5b9e\u9a8c\u5728\u5b9e\u73b0\u8fdb\u7a0b\u540c\u6b65\u539f\u8bed\u7684\u8fc7\u7a0b\u4e2d\uff0c\u9047\u5230\u4e86\u591a\u4e2a\u5728\u8bfe\u4e0a\u8ba8\u8bba\u8fc7\u7684\u5e76\u53d1\u95ee\u9898\uff0c\u8fd9\u4e9b\u8c03\u8bd5\u7ecf\u5386\u662f\u672c\u6b21\u5b9e\u9a8c\u6700\u5927\u7684\u6536\u83b7\u3002</p> <p>\u6700\u521d\u7684\u63a2\u7d22\u662f\u5173\u4e8e\u5185\u6838\u7f16\u8bd1\u7684\u3002\u4e3a\u4e86\u52a0\u901f\u5f00\u53d1\u8fed\u4ee3\uff0c\u672c\u6b21\u5b9e\u9a8c\u5c1d\u8bd5\u4e86 <code>make localmodconfig</code> \u548c <code>make menuconfig</code> \u6765\u88c1\u526a\u5185\u6838\u3002\u4f46\u8fc7\u4e8e\u6fc0\u8fdb\u7684\u88c1\u526a\uff08\u5982\u7981\u7528\u4e86 <code>VMware PVSCSI</code> \u9a71\u52a8\uff09\u5bfc\u81f4\u4e86 <code>(initramfs)</code> \u542f\u52a8\u5931\u8d25\u3002\u901a\u8fc7 GRUB \u83dc\u5355\u5207\u6362\u56de <code>...-generic</code> \u5185\u6838\u624d\u5f97\u4ee5\u6062\u590d\uff0c\u8fd9\u8ba9\u6211\u6df1\u523b\u7406\u89e3\u5230\u5185\u6838\u5bf9\u5e95\u5c42\u786c\u4ef6\u9a71\u52a8\u7684\u4f9d\u8d56\u6027\u3002\u6700\u7ec8\uff0c\u901a\u8fc7 <code>ccache</code> \u7f16\u8bd1\u7f13\u5b58\u548c\u9488\u5bf9\u6027\u7684 <code>menuconfig</code>\uff08\u4ec5\u7981\u7528\u975e\u5fc5\u8981\u5916\u8bbe\uff0c\u4fdd\u7559\u6838\u5fc3\u9a71\u52a8\uff09\u76f8\u7ed3\u5408\uff0c\u5b9e\u73b0\u4e86\u5f00\u53d1\u6548\u7387\u7684\u5e73\u8861\u3002</p> <p>\u5728\u5b9e\u73b0\u7cfb\u7edf\u8c03\u7528\u903b\u8f91\u65f6\uff0c\u7b2c\u4e00\u4e2a\u6311\u6218\u662f\u201c\u4e22\u5931\u7684\u5524\u9192\u201d (Lost Wakeup)\u3002\u6700\u521d\u7684 <code>eventwait</code> \u8bbe\u8ba1\u662f\u57fa\u4e8e <code>schedule()</code> \u7684\u7b80\u5355\u7761\u7720\uff0c\u8fd9\u5bfc\u81f4 <code>eventsig</code> \u7684 <code>wake_up_all</code> \u5728 <code>eventwait</code> \u8fdb\u7a0b\u52a0\u5165\u7b49\u5f85\u961f\u5217\u4e4b\u524d\u5c31\u5df2\u6267\u884c\uff0c\u8fdb\u7a0b\u56e0\u6b64\u6c38\u4e45\u7761\u7720\u3002\u4e3a\u4e86\u4fee\u590d\u8fd9\u4e2a\u7ade\u6001\u6761\u4ef6\uff0c\u5f15\u5165\u4e86 <code>bool signaled</code> \u6807\u5fd7\u548c <code>wait_event_interruptible</code> \u5b8f\uff0c\u5b9e\u73b0\u4e86\u201c\u6761\u4ef6\u53d8\u91cf\u201d\u6a21\u5f0f\u3002<code>wait_event_interruptible</code> \u5b8f\u539f\u5b50\u5730\u68c0\u67e5\u6761\u4ef6\u548c\u8fdb\u5165\u7761\u7720\uff0c\u5f7b\u5e95\u89e3\u51b3\u4e86\u8fd9\u4e2aBug\u3002</p> <p>\u7136\u800c\uff0c<code>signaled</code> \u6807\u5fd7\u53c8\u5f15\u5165\u4e86\u65b0\u7684\u7ade\u6001\u6761\u4ef6\uff0c\u5373 <code>eventclose</code> \u548c <code>eventopen</code> \u4e4b\u95f4\u5bf9 <code>signaled</code> \u6807\u5fd7\u7684\u91cd\u7f6e\u51b2\u7a81\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5c06 <code>signaled</code> \u5347\u7ea7\u4e3a <code>unsigned long gen</code> \u8ba1\u6570\u5668\uff0c\u5b9e\u73b0\u4e86\u8fb9\u7f18\u89e6\u53d1\u3002</p> <p>\u6700\u5927\u7684\u6311\u6218\u6765\u81ea\u4e8e <code>eventclose</code>\u3002<code>eventclose</code> \u5fc5\u987b\u5524\u9192\u6240\u6709\u7b49\u5f85\u8005\uff0c\u5e76\u5b89\u5168\u91ca\u653e\u69fd\u4f4d\u3002\u5982\u679c <code>eventclose</code> \u7acb\u5373\u91ca\u653e <code>in_use = false</code>\uff0c\u53e6\u4e00\u4e2a <code>eventopen</code> \u8fdb\u7a0b\u5c31\u53ef\u80fd\u91cd\u7528\u8fd9\u4e2a\u69fd\u4f4d\uff0c\u5e76\u91cd\u7f6e\u5b83\u7684\u540c\u6b65\u539f\u8bed\uff08\u5982 <code>gen</code> \u8ba1\u6570\u5668\uff09\u3002\u800c\u6b64\u65f6\uff0c\u88ab <code>eventclose</code> \u5524\u9192\u7684\u65e7\u8fdb\u7a0b\u53ef\u80fd\u624d\u521a\u88ab\u8c03\u5ea6\uff0c\u5b83\u4eec\u5728\u68c0\u67e5 <code>gen</code> \u6216 <code>closing</code> \u6807\u5fd7\u65f6\uff0c\u4f1a\u8bfb\u5230\u88ab\u65b0\u8fdb\u7a0b\u91cd\u7f6e\u7684\u810f\u6570\u636e\uff0c\u5bfc\u81f4\u518d\u6b21\u7761\u7720\u6216\u5d29\u6e83\u3002\u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684\u201c\u91ca\u653e\u540e\u91cd\u7528\u201d\u7ade\u6001\u6761\u4ef6\u3002\u6700\u7ec8\u7684\u89e3\u51b3\u65b9\u6848\u662f\u5f15\u5165\u4e86 <code>atomic_t waiters</code> \u5f15\u7528\u8ba1\u6570\u5668\u548c <code>wait_queue_head_t destroy_wq</code> \u9500\u6bc1\u961f\u5217\u3002<code>eventwait</code> \u5728\u8fdb\u5165\u65f6 <code>atomic_inc</code>\uff0c\u9000\u51fa\u65f6 <code>atomic_dec</code>\uff1b<code>eventclose</code> \u5219\u5fc5\u987b\u963b\u585e\u5728 <code>destroy_wq</code> \u4e0a\uff0c\u76f4\u5230 <code>waiters</code> \u5f52\u96f6\uff0c\u624d\u88ab\u6700\u540e\u4e00\u4e2a\u9000\u51fa\u7684 <code>eventwait</code> \u8fdb\u7a0b\u5524\u9192\uff0c\u5e76\u6700\u7ec8\u5b89\u5168\u5730\u91ca\u653e\u69fd\u4f4d\u3002\u538b\u529b\u6d4b\u8bd5\uff08<code>sync_test5.c</code>\uff09\u4e2d <code>eventopen</code> \u5931\u8d25\u4e86 160 \u4e07\u6b21\uff0c\u4e5f\u8bc1\u660e\u4e86\u8fd9\u4e00\u673a\u5236\u7684\u5065\u58ee\u6027\u3002</p>"},{"location":"project/","title":"\u9879\u76ee","text":"<p>\u8fd9\u91cc\u5c06\u4f1a\u6536\u5f55\u4e00\u4e9b\u6211\u505a\u8fc7\u7684\u9879\u76ee\u3002</p>"},{"location":"project/LuoguAgent/","title":"LuoguAgent","text":"<p>\u9879\u76ee\u5730\u5740</p> <p>\u8fd9\u662f\u4e00\u4e2a\u7f16\u7a0b\u7ade\u8d5b\u8f85\u52a9Agent\u7684\u9879\u76ee\uff0c\u76ee\u524d\u5df2\u5b8c\u6210\u57fa\u672c\u529f\u80fd\u3002\u6211\u5c06\u5728\u8fd9\u91cc\u8bb0\u5f55\u6211\u662f\u5982\u4f55\u5b8c\u6210\u8fd9\u4e2a\u9879\u76ee\u7684\u3002</p>"},{"location":"project/LuoguAgent/#_1","title":"\u2728 \u529f\u80fd\u7279\u6027","text":"<ul> <li>\u9898\u76ee\u722c\u53d6: \u8f93\u5165\u6d1b\u8c37\u9898\u76ee URL\uff0c\u81ea\u52a8\u6293\u53d6\u9898\u76ee\u6b63\u6587\u3001\u8f93\u5165\u8f93\u51fa\u3001\u6837\u4f8b\u6570\u636e\u3002</li> <li>\u9898\u89e3\u5206\u6790: \u81ea\u52a8\u722c\u53d6\u8be5\u9898\u76ee\u7684\u73b0\u6709\u9898\u89e3\uff0c\u5e76\u5c06\u5176\u63d0\u4ea4\u7ed9 LLM\uff08\u5927\u8bed\u8a00\u6a21\u578b\uff09\u8fdb\u884c\u5206\u6790\u3002</li> <li>\u667a\u80fd\u8f85\u5bfc: LLM \u57fa\u4e8e\u5bf9\u9898\u76ee\u548c\u73b0\u6709\u9898\u89e3\u7684\u5206\u6790\uff0c\u751f\u6210\u4e00\u4efd\u66f4\u8be6\u7ec6\u3001\u66f4\u5177\u542f\u53d1\u6027\u7684\u5168\u65b0\u9898\u89e3\u548c\u4ee3\u7801\u5b9e\u73b0\u3002</li> <li>Web \u754c\u9762: \u4f7f\u7528 Streamlit \u642d\u5efa\u7684\u4ea4\u4e92\u5f0f\u524d\u7aef\uff0c\u65b9\u4fbf\u8f93\u5165 URL \u5e76\u67e5\u770b\u7ed3\u679c\u3002</li> </ul>"},{"location":"project/LuoguAgent/#_2","title":"\ud83d\udee0\ufe0f \u6280\u672f\u6808","text":"<ul> <li>\u6838\u5fc3: Python 3.12</li> <li>\u524d\u7aef: Streamlit</li> <li>\u722c\u866b: crawl4ai</li> <li>LLM / Agent: glm-4.6, deepseek-chat</li> </ul>"},{"location":"project/LuoguAgent/#_3","title":"\u26a1\u4e91\u7aef\u4f53\u9a8c","text":"<p>\u70b9\u51fb\u94fe\u63a5\u5373\u53ef\u76f4\u63a5\u8bbf\u95eeLuoguAgent!</p>"},{"location":"project/LuoguAgent/#_4","title":"\ud83d\ude80 \u672c\u5730\u90e8\u7f72","text":""},{"location":"project/LuoguAgent/#1","title":"1. \u514b\u9686\u4ed3\u5e93","text":"<pre><code>git clone https://github.com/\u4f60\u7684\u7528\u6237\u540d/LuoguAgent.git\ncd LuoguAgent\n</code></pre>"},{"location":"project/LuoguAgent/#2","title":"2. \u5b89\u88c5\u4f9d\u8d56","text":"<p>\u5efa\u8bae\u4f7f\u7528\u865a\u62df\u73af\u5883\u3002</p> <pre><code># (\u53ef\u9009) \u521b\u5efa\u5e76\u6fc0\u6d3b\u865a\u62df\u73af\u5883\npython -m venv venv\nsource venv/bin/activate  # on Windows, use `venv\\Scripts\\activate`\n\n# \u5b89\u88c5\u6240\u6709\u5fc5\u9700\u7684\u5e93\npip install -r requirements.txt\n</code></pre>"},{"location":"project/LuoguAgent/#3","title":"3. \u914d\u7f6e\u73af\u5883\u53d8\u91cf(\u53ef\u9009)","text":"<p>\u76ee\u524dapi_key\u548cbase_url\u4ece\u524d\u7aef\u8f93\u5165\uff0c\u4e0d\u9700\u8981\u914d\u7f6e\uff01</p> <p>\u5728\u9879\u76ee\u6839\u76ee\u5f55\uff08\u4e0e <code>app.py</code> \u540c\u7ea7\uff09\u521b\u5efa\u4e00\u4e2a <code>.env</code> \u6587\u4ef6\u3002\u8fd9\u662f\u4f60\u7684 <code>constant.py</code> \u811a\u672c\u52a0\u8f7d API \u5bc6\u94a5\u7684\u5730\u65b9\u3002</p> <pre><code># .env\nZHIPU_API_KEY=sk-\u4f60\u7684\u667a\u8c31API\u5bc6\u94a5\nDMX_API_KEY=\u4f60\u7684DMX-API\u5bc6\u94a5\n</code></pre>"},{"location":"project/LuoguAgent/#4","title":"4. \u8fd0\u884c\u5e94\u7528","text":"<p>\u786e\u4fdd\u4f60\u5728\u9879\u76ee\u6839\u76ee\u5f55\u3002</p> <pre><code>streamlit run app.py\n</code></pre> <p>\u542f\u52a8\u540e\uff0c\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00 <code>http://localhost:8501</code> \u5373\u53ef\u5f00\u59cb\u4f7f\u7528\u3002</p>"},{"location":"project/LuoguAgent/#_5","title":"\ud83d\udcc2 \u9879\u76ee\u7ed3\u6784","text":"<pre><code>.\n\u251c\u2500\u2500 .env                # (\u4f60\u9700\u8981\u81ea\u5df1\u521b\u5efa) \u5b58\u653e API \u5bc6\u94a5\n\u251c\u2500\u2500 .gitignore\n\u251c\u2500\u2500 app.py              # \ud83d\udc48 Streamlit \u5e94\u7528\u5165\u53e3\n\u251c\u2500\u2500 requirements.txt    # \u4f9d\u8d56\u5217\u8868\n\u251c\u2500\u2500 packages.txt        # \u7ed9 streamlit cloud \u4f7f\u7528\u7684\u6240\u9700\u4f9d\u8d56\n\u2502\n\u251c\u2500\u2500 luogu_agent/        # \ud83d\udce6 \u6838\u5fc3\u903b\u8f91\u5305\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 analysis.py     # \u5206\u6790 Agent (LLM)\n\u2502   \u251c\u2500\u2500 crawler.py      # \u722c\u866b Agent\n\u2502   \u2502\n\u2502   \u2514\u2500\u2500 core/           # \ud83e\uddec \u6838\u5fc3\u5b9a\u4e49 (\u914d\u7f6e\u3001\u6570\u636e\u7ed3\u6784)\n\u2502       \u251c\u2500\u2500 __init__.py\n\u2502       \u251c\u2500\u2500 constant.py   # \u5e38\u91cf\n\u2502       \u251c\u2500\u2500 prompts.py    # \u63d0\u793a\u8bcd\n\u2502       \u251c\u2500\u2500 schema.py     # Pydantic \u6570\u636e\u6a21\u578b\n\u2502       \u2514\u2500\u2500 strategy.py   # \u722c\u866b\u89e3\u6790\u7b56\u7565\n\u2502\n\u251c\u2500\u2500 tests/              # \ud83e\uddea \u6d4b\u8bd5\u811a\u672c\n\u2502   \u251c\u2500\u2500 test_agent.ipynb\n\u2502   \u2514\u2500\u2500 ...\n\u2502\n\u251c\u2500\u2500 luogu_cache/        # (\u81ea\u52a8\u751f\u6210) \u722c\u866b\u7f13\u5b58\n\u2514\u2500\u2500 analysis_cache/     # (\u81ea\u52a8\u751f\u6210) \u5206\u6790\u7f13\u5b58\n</code></pre>"},{"location":"project/LuoguAgent/#_6","title":"\ud83d\udcc4 \u8bb8\u53ef\u8bc1","text":"<p>\u672c\u9879\u76ee\u91c7\u7528 MIT \u8bb8\u53ef\u8bc1\u3002</p>"},{"location":"project/LuoguAgent/agent/","title":"Agent","text":"<p>\u6211\u4eec\u5c06\u722c\u866b\u6574\u5408\u4e00\u4e0b\uff0c\u53d8\u6210\u4e00\u4e2a <code>LuoguCrawlerAgent</code> \u7c7b\uff0c\u4e3b\u8981\u804c\u8d23\u662f\u722c\u53d6\u9898\u76ee\u548c\u9898\u89e3\u3002\u5e76\u987a\u4fbf\u6dfb\u52a0\u7f13\u5b58\u529f\u80fd\uff0c\u907f\u514d\u5728\u6d4b\u8bd5\u9636\u6bb5\u591a\u6b21\u5728\u722c\u53d6\u548c\u89e3\u6790\u4e0a\u6d6a\u8d39\u65f6\u95f4\u3002</p> <p>\u521b\u5efa\u4e00\u4e2a <code>AnalysisAgent</code> \u7c7b\uff0c\u7528\u4e8e\u63a5\u6536\u9898\u76ee\u6570\u636e\uff0c\u751f\u6210 prompt \u5582\u7ed9\u5927\u6a21\u578b\uff0c\u7136\u540e\u7ed9\u51fa\u7ed3\u6784\u5316\u8f93\u51fa\u3002\u8fd9\u662f\u672c\u9879\u76ee\u7684\u6838\u5fc3\u3002</p>"},{"location":"project/LuoguAgent/agent/#luogucrawleragent","title":"LuoguCrawlerAgent\uff1a\u722c\u866b\u7b56\u7565\u7684\u6267\u884c\u5b98","text":"<p>\u5728\u4e0a\u4e00\u7bc7\u6587\u7ae0\u4e2d\uff0c\u6211\u4eec\u63a2\u8ba8\u4e86\u722c\u53d6\u6d1b\u8c37\u7684\u201c\u6df7\u5408\u52a8\u529b\u201d\u7b56\u7565\uff08<code>requests</code> + <code>bs4</code> + <code>Crawl4ai</code>\uff09\u4ee5\u53ca\u8e29\u8fc7\u7684\u5751\u3002\u4eca\u5929\uff0c\u6211\u4eec\u628a\u8fd9\u4e2a\u7b56\u7565\u5c01\u88c5\u6210\u4e00\u4e2a\u53ef\u91cd\u7528\u3001\u6709\u72b6\u6001\u7684 <code>LuoguCrawlerAgent</code> \u7c7b\u3002</p> <p>\u8fd9\u4e2a Agent \u662f\u6574\u4e2a\u722c\u866b\u7684\u201c\u5927\u8111\u201d\u548c\u201c\u6307\u6325\u5b98\u201d\u3002\u5b83\u7684\u6838\u5fc3\u804c\u8d23\u662f\u5c06\u4e4b\u524d\u96f6\u6563\u7684\u51fd\u6570\uff08\u5982 <code>search_for_solution_urls</code> \u548c <code>extract_solution_content</code>\uff09\u7f16\u6392\u6210\u4e00\u4e2a\u5065\u58ee\u7684\u3001\u81ea\u52a8\u5316\u7684\u6d41\u6c34\u7ebf\u3002</p>"},{"location":"project/LuoguAgent/agent/#_1","title":"\u6838\u5fc3\u8bbe\u8ba1\uff1a\u6307\u6325\u5b98\u4e0e\u6d41\u6c34\u7ebf","text":"<p>\u7ecf\u8fc7\u91cd\u6784\uff0c<code>LuoguCrawlerAgent</code> \u7684\u804c\u8d23\u975e\u5e38\u6e05\u6670\u3002\u5b83\u7684\u516c\u5171\u5165\u53e3\u53ea\u6709\u4e00\u4e2a\uff1a</p> <pre><code>async def run(self, problem_id: str, max_solutions: int = 3) -&gt; Dict[str, Any]:\n</code></pre> <p>\u8fd9\u4e2a <code>run</code> \u65b9\u6cd5\u672c\u8eab\u4e0d\u6267\u884c\u4efb\u4f55\u722c\u866b\uff0c\u5b83\u53ea\u505a\u4e09\u4ef6\u4e8b\uff1a\u68c0\u67e5\u7f13\u5b58\u3001\u6267\u884c\u4efb\u52a1\u3001\u4fdd\u5b58\u7f13\u5b58\u3002</p>"},{"location":"project/LuoguAgent/agent/#1-caching","title":"1. \u7f13\u5b58\u4f18\u5148 (Caching)","text":"<p>\u8fd9\u662f Agent \u6700\u91cd\u8981\u7684\u529f\u80fd\u4e4b\u4e00\u3002<code>run</code> \u65b9\u6cd5\u4f1a\u9996\u5148\u8c03\u7528 <code>_load_from_cache</code>\u3002</p> <p>\u5982\u679c\u5b83\u5728\u672c\u5730\uff08\u4f8b\u5982 <code>./luogu_cache/P4137.json</code>\uff09\u627e\u5230\u4e86\u7f13\u5b58\u6587\u4ef6\uff0c\u5e76\u4e14\u7f13\u5b58\u7684\u9898\u89e3\u6570\u91cf\u5927\u4e8e\u7b49\u4e8e\u672c\u6b21\u8bf7\u6c42\u7684 <code>max_solutions</code>\uff0c\u5b83\u4f1a\u7acb\u523b\u8fd4\u56de\u6570\u636e\uff0c\u4e0d\u6267\u884c\u4efb\u4f55\u722c\u866b\u3002\u8fd9\u6781\u5927\u5730\u8282\u7701\u4e86\u65f6\u95f4\u548c LLM Token\u3002\u5f53\u6211\u4eec\u540e\u7eed\u5f00\u53d1\u201c\u5206\u6790 Agent\u201d\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u53cd\u590d\u8fd0\u884c\u7a0b\u5e8f\uff0c\u800c\u722c\u866b Agent \u4f1a\u7acb\u5373\u4ece\u672c\u5730\u8fd4\u56de\u6570\u636e\uff0c\u8ba9\u6211\u4eec\u80fd\u4e13\u6ce8\u4e8e\u8c03\u8bd5 AI \u7684\u90e8\u5206\u3002</p>"},{"location":"project/LuoguAgent/agent/#2-pipeline","title":"2. \u722c\u53d6\u6d41\u6c34\u7ebf (Pipeline)","text":"<p>\u5982\u679c\u7f13\u5b58\u672a\u547d\u4e2d\uff0c<code>run</code> \u65b9\u6cd5\u4f1a\u8c03\u7528 <code>_execute_crawl_pipeline</code> \u6765\u6267\u884c\u5b9e\u9645\u7684\u722c\u53d6\u5de5\u4f5c\u3002\u8fd9\u4e2a\u6d41\u6c34\u7ebf\u5c31\u662f\u57fa\u4e8e\u6211\u4eec\u6628\u5929\u7684\u7b56\u7565\u3002</p> <ol> <li>\u5e76\u53d1\u542f\u52a8: \u4f7f\u7528 <code>asyncio.gather</code> \u540c\u65f6\u542f\u52a8\u4e24\u4e2a\u4efb\u52a1\uff1a<ul> <li>\u4efb\u52a1A (<code>_fetch_problem_details</code>): \u7528 <code>Crawl4ai</code> \u63d0\u53d6\u9898\u76ee\u8be6\u60c5\u3002</li> <li>\u4efb\u52a1B (<code>_search_solution_urls</code>): \u7528 <code>requests+bs4</code>\uff08\u5728 <code>run_in_executor</code> \u4e2d\u8fd0\u884c\uff09\u641c\u7d22\u9898\u89e3\u94fe\u63a5\u5217\u8868\u3002</li> </ul> </li> <li>\u5e76\u53d1\u63d0\u53d6: \u62ff\u5230\u9898\u89e3 URL \u5217\u8868\u540e\uff0c\u518d\u6b21\u4f7f\u7528 <code>asyncio.gather</code> \u5e76\u53d1\u722c\u53d6\uff08<code>_fetch_solution_content</code>\uff09<code>max_solutions</code> \u7bc7\u9898\u89e3\u7684\u8be6\u7ec6\u5185\u5bb9\u3002</li> <li>\u6c47\u603b: \u6536\u96c6\u6240\u6709\u7ed3\u679c\uff0c\u6253\u5305\u6210 <code>final_output</code> \u5b57\u5178\u3002</li> </ol>"},{"location":"project/LuoguAgent/agent/#3-saving","title":"3. \u4fdd\u5b58\u7ed3\u679c (Saving)","text":"<p>\u722c\u53d6\u6d41\u6c34\u7ebf\u8fd4\u56de\u7ed3\u679c\u540e\uff0c<code>run</code> \u65b9\u6cd5\u4f1a\u8c03\u7528 <code>_save_to_cache</code>\uff0c\u4f7f\u7528 <code>aiofiles</code> \u5f02\u6b65\u5730\u5c06 <code>final_output</code> \u5199\u5165 JSON \u6587\u4ef6\uff0c\u4f9b\u4e0b\u4e00\u6b21\u8fd0\u884c\u4f7f\u7528\u3002</p>"},{"location":"project/LuoguAgent/agent/#_2","title":"\u603b\u7ed3","text":"<p>\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u6211\u4eec\u5c06\u590d\u6742\u7684\u722c\u53d6\u903b\u8f91\u5c01\u88c5\u6210\u4e86\u4e00\u4e2a\u201c\u9ed1\u76d2\u201d\u3002\u4e3b\u7a0b\u5e8f\uff08<code>main</code>\uff09\u4e0d\u518d\u5173\u5fc3\u722c\u866b\u7684\u5185\u90e8\u7ec6\u8282\uff0c\u5b83\u53ea\u9700\u8981\u77e5\u9053\uff1a</p> <pre><code># \u53ea\u9700\u8981\u5b9e\u4f8b\u5316\uff0c\u7136\u540e\u8fd0\u884c\nagent = LuoguCrawlerAgent(crawler)\nfinal_data = await agent.run(TEST_PROBLEM_ID, max_solutions=3)\n</code></pre> <p><code>LuoguCrawlerAgent</code> \u4f1a\u81ea\u52a8\u5904\u7406\u7f13\u5b58\u3001\u5e76\u53d1\u548c\u9519\u8bef\uff0c\u4ea4\u4ed8\u4e00\u4efd\u5e72\u51c0\u7684\u6570\u636e\u3002</p>"},{"location":"project/LuoguAgent/agent/#_3","title":"\u6838\u5fc3\u4ee3\u7801","text":"<pre><code>class LuoguCrawlerAgent:\n    \"\"\"\n    \u8d1f\u8d23\u6d1b\u8c37\u9898\u76ee\u548c\u9898\u89e3\u7684\u722c\u53d6\u3001\u63d0\u53d6\u548c\u7f13\u5b58\u3002\n    \"\"\"\n\n    def __init__(self, crawler: AsyncWebCrawler, cache_dir: str = CACHE_DIR):\n        self.crawler = crawler\n        self.cache_dir = cache_dir\n        os.makedirs(self.cache_dir, exist_ok=True)\n        print(f\"[CrawlerAgent] \u521d\u59cb\u5316\u5b8c\u6210\uff0c\u7f13\u5b58\u76ee\u5f55: {self.cache_dir}\")\n\n    # --- 1. \u516c\u5171\u4e3b\u5165\u53e3 (\u6307\u6325\u5b98) ---\n\n    async def run(self, problem_id: str, max_solutions: int = 3) -&gt; Dict[str, Any]:\n        \"\"\"\n        [\u4e3b\u5165\u53e3] \u6267\u884c\u5b8c\u6574\u7684\u722c\u53d6\u548c\u63d0\u53d6\u6d41\u7a0b\u3002\n        \"\"\"\n        print(f\"\\n--- [CrawlerAgent] \u542f\u52a8 {problem_id} \u4efb\u52a1 (max={max_solutions}) ---\")\n\n        # 1. \u5c1d\u8bd5\u4ece\u7f13\u5b58\u52a0\u8f7d\n        cached_data = await self._load_from_cache(problem_id, max_solutions)\n        if cached_data:\n            print(f\"--- [CrawlerAgent] {problem_id} \u4efb\u52a1\u5b8c\u6210 (\u6765\u81ea\u7f13\u5b58) ---\")\n            return cached_data\n\n        # 2. \u7f13\u5b58\u672a\u547d\u4e2d\uff0c\u6267\u884c\u722c\u53d6\u6d41\u6c34\u7ebf\n        print(f\"[CrawlerAgent] CACHE MISS: {problem_id}\u3002\u5f00\u59cb\u5b9e\u65f6\u722c\u53d6...\")\n        final_output = await self._execute_crawl_pipeline(problem_id, max_solutions)\n\n        # 3. \u4ec5\u5728\u722c\u53d6\u6210\u529f\u65f6\u4fdd\u5b58\u5230\u7f13\u5b58\n        if \"error\" not in final_output.get(\"problem\", {}):\n            await self._save_to_cache(problem_id, final_output)\n        else:\n            print(f\"[CrawlerAgent] \u9898\u76ee\u722c\u53d6\u5931\u8d25\uff0c\u4e0d\u4fdd\u5b58\u7f13\u5b58\u3002\")\n\n        print(f\"--- [CrawlerAgent] {problem_id} \u4efb\u52a1\u5b8c\u6210 (\u5b9e\u65f6\u722c\u53d6)\u3002---\")\n        return final_output\n\n    # --- 2. \u7f13\u5b58\u5904\u7406 (I/O) ---\n\n    async def _load_from_cache(self, problem_id: str, max_solutions: int) -&gt; Optional[Dict[str, Any]]:\n        \"\"\"(\u804c\u8d231) \u5c1d\u8bd5\u4ece\u672c\u5730 JSON \u52a0\u8f7d\u5e76\u9a8c\u8bc1\u7f13\u5b58\"\"\"\n        cache_file = os.path.join(self.cache_dir, f\"{problem_id}.json\")\n        try:\n            async with aiofiles.open(cache_file, 'r', encoding='utf-8') as f:\n                content = await f.read()\n                cached_data = json.loads(content)\n\n            # \u9a8c\u8bc1\u7f13\u5b58\u6570\u636e\n            if 'problem' not in cached_data or \"error\" in cached_data['problem']:\n                print(f\"[CrawlerAgent] CACHE INVALID: {problem_id} \u7f13\u5b58\u635f\u574f\u3002\")\n                return None\n\n            # \u9a8c\u8bc1\u7f13\u5b58\u6570\u91cf\n            cached_solutions_count = len(cached_data.get(\"solutions\", []))\n            if cached_solutions_count &gt;= max_solutions:\n                print(f\"[CrawlerAgent] CACHE HIT: {problem_id} (\u542b {cached_solutions_count} \u7bc7\u9898\u89e3) \u6ee1\u8db3\u9700\u6c42\u3002\")\n                return cached_data\n            else:\n                print(f\"[CrawlerAgent] CACHE PARTIAL: \u7f13\u5b58 {cached_solutions_count} \u7bc7, \u9700\u6c42 {max_solutions}\u3002\")\n                return None\n\n        except FileNotFoundError:\n            return None  # \u7f13\u5b58\u672a\u547d\u4e2d\uff0c\u6b63\u5e38\n        except Exception as e:\n            print(f\"[CrawlerAgent] CACHE ERROR: \u52a0\u8f7d {cache_file} \u5931\u8d25 ({e})\u3002\")\n            return None # \u7f13\u5b58\u8bfb\u53d6\u5931\u8d25\uff0c\u5f53\u4f5c\u672a\u547d\u4e2d\u5904\u7406\n\n    async def _save_to_cache(self, problem_id: str, data: Dict[str, Any]):\n        \"\"\"(\u804c\u8d232) \u5f02\u6b65\u4fdd\u5b58\u7ed3\u679c\u5230 JSON \u7f13\u5b58\"\"\"\n        cache_file = os.path.join(self.cache_dir, f\"{problem_id}.json\")\n        try:\n            async with aiofiles.open(cache_file, 'w', encoding='utf-8') as f:\n                content_to_save = json.dumps(data, indent=2, ensure_ascii=False)\n                await f.write(content_to_save)\n            print(f\"[CrawlerAgent] CACHE SAVE: \u6210\u529f\u4fdd\u5b58 {problem_id} \u5230 {cache_file}\")\n        except Exception as e:\n            print(f\"[CrawlerAgent] CACHE SAVE FAILED: \u5199\u5165 {cache_file} \u5931\u8d25: {e}\")\n\n    # --- 3. \u6838\u5fc3\u722c\u53d6\u6d41\u6c34\u7ebf (\u5e72\u6d3b\u7684) ---\n\n    async def _execute_crawl_pipeline(self, problem_id: str, max_solutions: int) -&gt; Dict[str, Any]:\n        \"\"\"(\u804c\u8d233) \u6267\u884c\u6240\u6709\u722c\u53d6\u3001\u641c\u7d22\u548c\u63d0\u53d6\u4efb\u52a1\"\"\"\n\n        # 3.1. \u5e76\u884c\u6267\u884c\u201c\u722c\u9898\u76ee\u201d\u548c\u201c\u641c\u9898\u89e3\u5217\u8868\u201d\n        problem_task = self._fetch_problem_details(problem_id)\n        search_task = self._search_solution_urls(problem_id)\n\n        problem_result, solution_urls = await asyncio.gather(problem_task, search_task)\n\n        final_output = {\n            \"problem\": problem_result,\n            \"solutions\": []\n        }\n\n        # \u5982\u679c\u9898\u76ee\u722c\u53d6\u5931\u8d25\uff0c\u5219\u4e2d\u6b62\n        if \"error\" in problem_result:\n            print(f\"[CrawlerAgent] \u4e25\u91cd\u9519\u8bef\uff1a\u9898\u76ee {problem_id} \u722c\u53d6\u5931\u8d25\u3002\u4efb\u52a1\u4e2d\u6b62\u3002\")\n            return final_output\n\n        # \u5982\u679c\u6ca1\u6709\u9898\u89e3\uff0c\u4e5f\u63d0\u524d\u8fd4\u56de\n        if not solution_urls:\n            print(f\"[CrawlerAgent] \u8b66\u544a\uff1a\u6ca1\u6709\u627e\u5230 {problem_id} \u7684\u9898\u89e3\u94fe\u63a5\u3002\")\n            return final_output\n\n        # 3.2. \u5e76\u884c\u63d0\u53d6 N \u7bc7\u9898\u89e3\n        urls_to_fetch = solution_urls[:max_solutions]\n        print(f\"[CrawlerAgent] \u51c6\u5907\u4ece {len(urls_to_fetch)} \u4e2a\u94fe\u63a5\u4e2d\u63d0\u53d6\u9898\u89e3\u5185\u5bb9...\")\n\n        solution_tasks = [self._fetch_solution_content(article) for article in urls_to_fetch]\n        solution_results = await asyncio.gather(*solution_tasks)\n\n        # 3.3. \u6e05\u6d17\u9898\u89e3\u7ed3\u679c\n        successful_solutions = []\n        for i, res in enumerate(solution_results):\n            if \"error\" not in res:\n                successful_solutions.append(res)\n            else:\n                print(f\"[CrawlerAgent] \u63d0\u53d6 {urls_to_fetch[i]['url']} \u5931\u8d25: {res['error']}\")\n\n        final_output[\"solutions\"] = successful_solutions\n        print(f\"[CrawlerAgent] \u63d0\u53d6\u5b8c\u6210\uff0c\u6210\u529f {len(successful_solutions)} / {len(urls_to_fetch)} \u7bc7\u3002\")\n        return final_output\n\n    # --- 4. \u5b50\u4efb\u52a1  ---\n\n    async def _fetch_problem_details(self, problem_id: str) -&gt; Dict[str, Any]:\n        \"\"\"[\u5b50\u4efb\u52a1] \u722c\u53d6\u5e76\u63d0\u53d6\u5355\u4e2a\u9898\u76ee\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\"\"\"\n        url = f\"https://www.luogu.com.cn/problem/{problem_id}\"\n        print(f\"[CrawlerAgent.Problem] \u6b63\u5728\u722c\u53d6\u9898\u76ee: {url}\")\n\n        config = CrawlerRunConfig(\n            cache_mode=CacheMode.ENABLED, # \u9898\u76ee\u9875\u53ef\u4ee5\u7f13\u5b58\n            extraction_strategy=PROBLEM_STRATEGY,\n            delay_before_return_html=1\n        )\n        result = await self.crawler.arun(url, config=config)\n\n        if not (result.success and result.extracted_content):\n            return {\"error\": \"crawl4ai \u722c\u53d6\u9898\u76ee\u5931\u8d25\", \"details\": result.error_message}\n\n        try:\n            data_list = json.loads(result.extracted_content)\n            if not data_list:\n                return {\"error\": \"LLM \u4ece\u9898\u76ee\u9875\u8fd4\u56de\u4e86\u7a7a\u5217\u8868\"}\n\n            problem_data = ProblemDetails.model_validate(data_list[0])\n            print(f\"[CrawlerAgent.Problem] \u9898\u76ee {problem_id} \u63d0\u53d6\u6210\u529f\u3002\")\n            return problem_data.model_dump()\n\n        except json.JSONDecodeError:\n            return {\"error\": \"LLM \u8fd4\u56de\u4e86\u65e0\u6548\u7684 JSON\", \"raw\": result.extracted_content}\n        except Exception as e:\n            return {\"error\": f\"Pydantic \u9a8c\u8bc1\u5931\u8d25: {e}\", \"raw\": result.extracted_content}\n\n    async def _search_solution_urls(self, problem_id: str) -&gt; List[Dict[str, str]]:\n        \"\"\"[\u5b50\u4efb\u52a1] \u5f02\u6b65\u6267\u884c\u540c\u6b65\u7684 URL \u641c\u7d22\u3002\"\"\"\n        loop = asyncio.get_running_loop()\n        # \u5728\u4e00\u4e2a\u5355\u72ec\u7684\u7ebf\u7a0b\u4e2d\u8fd0\u884c\u540c\u6b65\u7684 blocking IO\n        results = await loop.run_in_executor(\n            None, self._sync_search_solutions, problem_id\n        )\n        return results\n\n    def _sync_search_solutions(self, problem_id: str) -&gt; List[Dict[str, str]]:\n        \"\"\"[\u5b50\u4efb\u52a1] \u540c\u6b65\u4f7f\u7528 requests \u641c\u7d22\u9898\u89e3 URL\u3002\"\"\"\n        search_url = f\"https://www.luogu.com.cn/article?keyword={problem_id}&amp;page=1\"\n        headers = {\n            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\"\n        }\n        print(f\"[CrawlerAgent.Search] \u6b63\u5728\u7528 requests \u641c\u7d22: {search_url} ...\")\n\n        try:\n            response = requests.get(search_url, headers=headers, timeout=10)\n            soup = BeautifulSoup(response.text, 'html.parser')\n            article_links = soup.find_all('a', href=re.compile(r'^/article/[a-zA-Z0-9]{8}$'))\n\n            if not article_links:\n                print(\"[CrawlerAgent.Search] \u5931\u8d25\uff1a\u6ca1\u6709\u627e\u5230\u4efb\u4f55 /article/... \u94fe\u63a5\u3002\")\n                return []\n\n            results = []\n            seen_urls = set()\n            for link in article_links:\n                href = link.get('href')\n                if href in seen_urls:\n                    continue\n\n                title = link.get_text(strip=True)\n                if href and (problem_id in title or problem_id.lower() in title):\n                    results.append({\"title\": title, \"url\": href})\n                    seen_urls.add(href)\n\n            print(f\"[CrawlerAgent.Search] \u6210\u529f\uff1a\u627e\u5230 {len(results)} \u7bc7\u76f8\u5173\u9898\u89e3\u94fe\u63a5\u3002\")\n            return results\n\n        except requests.RequestException as e:\n            print(f\"[CrawlerAgent.Search] \u5f02\u5e38: {e}\")\n            return []\n\n    async def _fetch_solution_content(self, article: Dict[str, str]) -&gt; Dict[str, Any]:\n        \"\"\"[\u5b50\u4efb\u52a1] \u722c\u53d6\u5e76\u63d0\u53d6\u5355\u7bc7\u9898\u89e3\u7684\u8be6\u7ec6\u5185\u5bb9\u3002\"\"\"\n        full_url = f\"https://www.luogu.com.cn{article['url']}\"\n        print(f\"[CrawlerAgent.Solution] \u6b63\u5728\u63d0\u53d6: {full_url} ...\")\n\n        config = CrawlerRunConfig(\n            cache_mode=CacheMode.BYPASS, # \u9898\u89e3\u9875\u4e0d\u5e94\u7f13\u5b58\n            extraction_strategy=SOLUTION_STRATEGY,\n            delay_before_return_html=1\n        )\n        result = await self.crawler.arun(full_url, config=config)\n\n        if not (result.success and result.extracted_content):\n             return {\"error\": \"crawl4ai \u722c\u53d6\u9898\u89e3\u5931\u8d25\"}\n\n        try:\n            data_list = json.loads(result.extracted_content)\n            if not data_list:\n                return {\"error\": \"LLM \u4ece\u9898\u89e3\u9875\u8fd4\u56de\u4e86\u7a7a\u5217\u8868\"}\n\n            raw_data = data_list[0]\n            clean_data = SolutionDetails.model_validate(raw_data)\n\n            if not clean_data.solution_text:\n                return {\"error\": \"LLM \u8fd4\u56de\u4e86\u7a7a\u5185\u5bb9\"}\n\n            # \u9644\u52a0\u4e0a title \u548c url\n            final_data = clean_data.model_dump()\n            final_data['title'] = article['title']\n            final_data['url'] = article['url']\n            return final_data\n\n        except json.JSONDecodeError:\n            return {\"error\": \"LLM \u8fd4\u56de\u4e86\u65e0\u6548\u7684 JSON\", \"raw\": result.extracted_content}\n        except Exception as e:\n            return {\"error\": f\"Pydantic \u9a8c\u8bc1\u5931\u8d25: {e}\", \"raw\": result.extracted_content}\n</code></pre>"},{"location":"project/LuoguAgent/agent/#analysisagent","title":"AnalysisAgent","text":"<p>\u8c03\u7528 chatglm \u7684\u8fc7\u7a0b\u4e2d\u6211\u9047\u5230\u4e86\u8f83\u591a\u7684\u56f0\u96be\uff0c\u6bd4\u5982\u4e00\u5f00\u59cb\u6211\u5e0c\u671b\u76f4\u63a5\u4e0a langchain \u67b6\u6784\uff0c\u4f46\u662f\u9047\u5230\u4e86 <code>with_structured_output</code> \u4e0d\u652f\u6301\u7684\u95ee\u9898\u3002\u540e\u9762\u5c31\u5c1d\u8bd5\u4ece zhipu \u7684\u5b98\u65b9 api \u5f00\u59cb\u8c03\u8bd5\uff0c\u5bf9\u7740\u5b98\u65b9\u6587\u6863\uff0c\u8d39\u4e86\u70b9\u529f\u592b\u8c03\u901a\u4e86\u3002\u8fd8\u6709\u4e2a\u95ee\u9898\u662f\u6211\u4e00\u5f00\u59cb\u8c03 api \u975e\u5e38\u7684\u6162\uff0c\u4e00\u5ea6\u8ba9\u6211\u4ee5\u4e3a\u662f\u7f51\u7edc\u95ee\u9898\u6216\u8005\u5355\u7eaf\u5361\u4f4f\u4e86\uff0c\u540e\u9762\u53d1\u73b0\u662f\u9ed8\u8ba4\u6253\u5f00\u4e86\u601d\u8003\u6a21\u5f0f emmmmm....</p> <p><code>AnalysisAgent</code> \u662f\u6211\u4eec\u6d41\u6c34\u7ebf\u7684\u201c\u5927\u8111\u201d\u3002<code>LuoguCrawlerAgent</code> \u8d1f\u8d23\u201c\u641c\u96c6\u98df\u6750\u201d\uff08\u722c\u53d6\u9898\u76ee\u548c\u9898\u89e3\uff09\uff0c\u800c <code>AnalysisAgent</code> \u5219\u8d1f\u8d23\u5c06\u8fd9\u4e9b\u539f\u59cb\u3001\u6742\u4e71\u7684\u201c\u98df\u6750\u201d\u52a0\u5de5\u6210\u4e00\u9053\u201c\u7c73\u5176\u6797\u5927\u9910\u201d\uff08\u4e00\u4efd\u9ad8\u8d28\u91cf\u3001\u7efc\u5408\u7684\u5206\u6790\u62a5\u544a\uff09\u3002</p> <p>\u5b83\u7684\u6838\u5fc3\u804c\u8d23\u662f\u8c03\u7528\u5927\u6a21\u578b\uff08ZhipuAI\uff09\uff0c\u5e76\u5065\u58ee\u5730\u5904\u7406\u6a21\u578b\u7684\u8f93\u51fa\u3002</p>"},{"location":"project/LuoguAgent/agent/#_4","title":"\u6838\u5fc3\u8bbe\u8ba1\uff1a\u63d0\u793a\u3001\u89e3\u6790\u4e0e\u53cc\u91cd\u4fdd\u5b58","text":"<p>\u4e0e\u722c\u866b Agent \u7c7b\u4f3c\uff0c<code>AnalysisAgent</code> \u4e5f\u88ab\u91cd\u6784\u6210\u4e86\u4e00\u4e2a\u6e05\u6670\u7684\u6d41\u6c34\u7ebf\uff0c\u7531 <code>run</code> \u65b9\u6cd5\u7edf\u4e00\u6307\u6325\u3002</p>"},{"location":"project/LuoguAgent/agent/#1-_build_prompts","title":"1. \u6784\u5efa\u63d0\u793a (<code>_build_prompts</code>)","text":"<p>\u8fd9\u662f\u6700\u5173\u952e\u7684\u4e00\u6b65\u3002\u6211\u4eec\u52a8\u6001\u6784\u5efa\u4e24\u6761 Prompt\uff1a * System Prompt: \u544a\u8bc9 LLM \u5b83\u662f\u4e00\u4e2a\u201c\u7b97\u6cd5\u7ade\u8d5b\u91d1\u724c\u6559\u7ec3\u201d\uff0c\u5e76\u628a <code>ProblemAnalysis</code> Pydantic \u6a21\u578b\u7684 Schema\uff08<code>model_fields</code>\uff09\u5582\u7ed9\u5b83\uff0c\u547d\u4ee4\u5b83\u5fc5\u987b\u6309\u8fd9\u4e2a\u683c\u5f0f\u8fd4\u56de\u3002 * User Prompt: \u628a <code>LuoguCrawlerAgent</code> \u722c\u6765\u7684 <code>problem_data</code> \u548c <code>solutions_data</code> \u4e24\u4e2a\u5927 JSON \u5757\u585e\u8fdb\u53bb\uff0c\u4f5c\u4e3a LLM \u5206\u6790\u7684\u201c\u539f\u6750\u6599\u201d\u3002</p>"},{"location":"project/LuoguAgent/agent/#2-llm-_stream_llm_response","title":"2. LLM \u8c03\u7528 (<code>_stream_llm_response</code>)","text":"<p>\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u4f7f\u7528\u4e86 ZhipuAI \u7684\u5b98\u65b9 API\u3002\u5982\u5f15\u8a00\u6240\u8bf4\uff0c\u4e00\u4e2a\u5173\u952e\u4f18\u5316\u662f\u8bbe\u7f6e <code>thinking={\"type\": \"disabled\"}</code>\uff0c\u8fd9\u80fd\u663e\u8457\u52a0\u5feb\u54cd\u5e94\u901f\u5ea6\u3002\u53e6\u5916\u5f00\u542f\u6d41\u5f0f\u8f93\u51fa\uff0c\u8ba9\u6211\u4eec\u80fd\u5b9e\u65f6\u770b\u5230\u201c\u6253\u5b57\u201d\u8fc7\u7a0b\u3002</p>"},{"location":"project/LuoguAgent/agent/#3-_parse_to_dict","title":"3. \u201c\u53cc\u4fdd\u9669\u201d\u89e3\u6790 (<code>_parse_to_dict</code>)","text":"<p>LLM \u7684\u8f93\u51fa\u5e76\u4e0d\u603b\u662f\u4e25\u683c\u7684 JSON\u3002\u6709\u65f6\u5b83\u8fd4\u56de\u7684\u662f\u6807\u51c6 JSON\uff08\u53cc\u5f15\u53f7\uff09\uff0c\u6709\u65f6\u5b83\u8fd4\u56de\u7684\u662f Python \u5b57\u5178\u3002</p> <p><code>_parse_to_dict</code> \u65b9\u6cd5\u5b9e\u73b0\u4e86\u4e00\u4e2a\u201c\u53cc\u4fdd\u9669\u201d\uff1a     1.  \u9996\u5148\uff0c\u7528 <code>json.loads()</code> \u5c1d\u8bd5\u6309\u6807\u51c6 JSON \u89e3\u6790\u3002     2.  \u5982\u679c\u5931\u8d25\u4e86\uff08<code>JSONDecodeError</code>\uff09\uff0c\u5b83\u4e0d\u4f1a\u7acb\u5373\u653e\u5f03\uff0c\u800c\u662f\u4f1a\u7528 <code>ast.literal_eval()</code> \u518d\u6b21\u5c1d\u8bd5\u3002<code>ast.literal_eval</code> \u53ef\u4ee5\u5b89\u5168\u5730\u5c06 Python \u5b57\u5178\u683c\u5f0f\u7684\u5b57\u7b26\u4e32\u89e3\u6790\u6210 Python \u5bf9\u8c61\uff0c\u5b8c\u7f8e\u89e3\u51b3\u4e86 LLM\u201c\u4e0d\u5b88\u89c4\u77e9\u201d\u7684\u95ee\u9898\u3002</p>"},{"location":"project/LuoguAgent/agent/#4-_save__result","title":"4. \u53cc\u91cd\u4fdd\u5b58 (<code>_save_..._result</code>)","text":"<p>\u5728\u6210\u529f\u89e3\u6790\u51fa Python \u5b57\u5178\u540e\uff0cAgent \u4f1a\u540c\u65f6\u4fdd\u5b58\u4e24\u79cd\u683c\u5f0f\u7684\u6587\u4ef6\uff1a 1.  <code>_analysis.json</code>: \u4fdd\u5b58\u4e3a\u6807\u51c6 JSON \u6587\u4ef6\uff0c\u7528\u4e8e\u540e\u7eed\u7684\u673a\u5668\u8bfb\u53d6\u6216\u7a0b\u5e8f\u8c03\u7528\u3002 2.  <code>_analysis.md</code>: \u63d0\u53d6\u5b57\u5178\u4e2d\u7684 <code>detailed_solution</code> \u548c <code>sample_code</code> \u7b49\u5b57\u6bb5\uff0c\u653e\u5230markdown\u4e2d\uff0c\u8fd9\u4e2a\u4e3b\u8981\u662f\u7ed9\u6211\u770b\u7684\u3002</p> <p>\u901a\u8fc7\u8fd9\u4e2a\u6d41\u7a0b\uff0c<code>AnalysisAgent</code> \u786e\u4fdd\u4e86\u65e0\u8bba\u722c\u866b\u6570\u636e\u591a\u4e71\u3001LLM \u56de\u7b54\u591a\u201c\u968f\u610f\u201d\uff0c\u6211\u4eec\u6700\u7ec8\u90fd\u80fd\u5f97\u5230\u4e00\u4efd\u7ed3\u6784\u5316\u3001\u6613\u4e8e\u9605\u8bfb\u7684\u9ad8\u8d28\u91cf\u5206\u6790\u62a5\u544a\u3002</p>"},{"location":"project/LuoguAgent/agent/#_5","title":"\u6838\u5fc3\u4ee3\u7801","text":"<pre><code>class AnalysisAgent:\n    \"\"\"\n    \u8d1f\u8d23\u8c03\u7528 LLM \u5206\u6790\u95ee\u9898\u6570\u636e\uff0c\u5e76\u5904\u7406\u548c\u4fdd\u5b58\u7ed3\u679c\u3002\n    \u4f1a\u540c\u65f6\u4fdd\u5b58 .json (\u673a\u5668\u53ef\u8bfb) \u548c .md (\u4eba\u7c7b\u53ef\u8bfb) \u4e24\u79cd\u683c\u5f0f\u3002\n    \"\"\"\n\n    def __init__(self):\n        self.llm = ZhipuAiClient(ZHIPU_API_KEY, ZHIPU_BASE_URL)\n        self.schema = ProblemAnalysis  \n        self.analysis_cache_dir = ANALYSIS_CACHE_DIR\n        os.makedirs(self.analysis_cache_dir, exist_ok=True)\n        print(f\"[Agent] \u521d\u59cb\u5316\u5b8c\u6210 (ZhipuAI)\uff0c\u7ed3\u679c\u4fdd\u5b58\u81f3 {self.analysis_cache_dir}\")\n\n    def _build_prompts(self, problem_data: Dict[str, Any], solutions_data: List[Dict[str, Any]]) -&gt; Tuple[str, str]:\n        \"\"\"\u6784\u5efa\u7cfb\u7edf\u548c\u7528\u6237\u63d0\u793a\u8bcd\"\"\"\n        system_prompt = get_system_prompt(self.schema.model_fields)\n        user_prompt = get_user_prompt(problem_data, solutions_data)\n        return system_prompt, user_prompt\n\n    def _stream_llm_response(self, system_prompt: str, user_prompt: str) -&gt; str:\n        \"\"\"\u8c03\u7528 LLM \u5e76\u6d41\u5f0f\u83b7\u53d6\u5b8c\u6574\u54cd\u5e94\"\"\"\n        print(\"[Agent] \u6b63\u5728\u6d41\u5f0f\u63a5\u6536 LLM \u54cd\u5e94...\")\n        response = self.llm.chat.completions.create(\n            model=\"glm-4.6\", \n            messages=[\n                {\"role\": \"system\", \"content\": system_prompt},\n                {\"role\": \"user\", \"content\": user_prompt}\n            ],\n            thinking={\"type\": \"disabled\"},\n            stream=True\n        )\n\n        full_content = \"\"\n        for chunk in response:\n            if not chunk.choices: continue\n            delta = chunk.choices[0].delta\n            if hasattr(delta, 'content') and delta.content:\n                full_content += delta.content\n                print(delta.content, end=\"\", flush=True) \n\n            if chunk.choices[0].finish_reason:\n                print(f\"\\n\\n[Agent] \u5b8c\u6210\u539f\u56e0: {chunk.choices[0].finish_reason}\")\n                if hasattr(chunk, 'usage') and chunk.usage:\n                    print(f\"[Agent] \u4ee4\u724c\u4f7f\u7528: \u8f93\u5165 {chunk.usage.prompt_tokens}, \u8f93\u51fa {chunk.usage.completion_tokens}\")\n\n        print(\"\\n[Agent] LLM \u54cd\u5e94\u63a5\u6536\u5b8c\u6bd5\u3002\")\n        return full_content\n\n    def _extract_json_string(self, raw_content: str) -&gt; str:\n        \"\"\"\u4ece LLM \u7684\u539f\u59cb\u8f93\u51fa\u4e2d\u63d0\u53d6 { ... } \u5757\"\"\"\n        match = re.search(r'\\{.*\\}', raw_content, re.DOTALL)\n        if match:\n            print(\"[Agent] \u5df2\u4ece LLM \u54cd\u5e94\u4e2d\u63d0\u53d6 { } \u5757\u3002\")\n            return match.group(0)\n\n        print(\"[Agent] \u65e0\u6cd5\u63d0\u53d6 { } \u5757\uff0c\u5c06\u5c1d\u8bd5\u89e3\u6790\u5b8c\u6574\u54cd\u5e94\u3002\")\n        return raw_content\n\n    def _parse_to_dict(self, s: str) -&gt; Optional[Dict[str, Any]]:\n        \"\"\"\u4f7f\u7528\u53cc\u4fdd\u9669 (json / ast) \u89e3\u6790\u5b57\u7b26\u4e32\u4e3a\u5b57\u5178\"\"\"\n        try:\n            parsed = json.loads(s)\n            print(\"[Agent] \u6210\u529f\u89e3\u6790\u4e3a JSON\u3002\")\n            return parsed\n        except json.JSONDecodeError:\n            print(\"[Agent] JSON \u89e3\u6790\u5931\u8d25\uff0c\u5c1d\u8bd5 ast.literal_eval (Python \u5b57\u5178)...\")\n            try:\n                parsed = ast.literal_eval(s)\n                print(\"[Agent] \u6210\u529f\u89e3\u6790\u4e3a Python \u5b57\u9762\u91cf\u3002\")\n                return parsed\n            except Exception as e:\n                print(f\"[Agent] \u6240\u6709\u89e3\u6790\u5747\u5931\u8d25: {e}\")\n                return None\n\n    def _save_json_result(self, problem_id: str, data: Dict[str, Any]):\n        \"\"\"\u5c06\u89e3\u6790\u6210\u529f\u7684\u5b57\u5178\u4fdd\u5b58\u4e3a\u7f8e\u5316\u7684 .json \u6587\u4ef6\"\"\"\n        save_path = os.path.join(self.analysis_cache_dir, f\"{problem_id}_analysis.json\")\n        try:\n            with open(save_path, 'w', encoding='utf-8') as f:\n                json.dump(data, f, indent=2, ensure_ascii=False)\n            print(f\"[Agent] \u5206\u6790\u7ed3\u679c (JSON) \u5df2\u4fdd\u5b58\u5230: {save_path}\")\n        except Exception as e:\n            print(f\"[Agent] \u4fdd\u5b58 .json \u6587\u4ef6\u65f6\u51fa\u9519: {e}\")\n\n    def _save_markdown_result(self, problem_id: str, data: Dict[str, Any]):\n        \"\"\"[!] \u5c06\u89e3\u6790\u7ed3\u679c\u4e2d\u7684\u5173\u952e\u5b57\u6bb5\u63d0\u53d6\u5e76\u4fdd\u5b58\u4e3a .md \u6587\u4ef6\"\"\"\n        save_path = os.path.join(self.analysis_cache_dir, f\"{problem_id}_analysis.md\")\n\n        # 1. \u4ece\u5b57\u5178\u4e2d\u63d0\u53d6\u5185\u5bb9\n        solution_text = data.get('detailed_solution', 'LLM \u672a\u63d0\u4f9b\u8be6\u7ec6\u9898\u89e3\u3002')\n        sample_code = data.get('sample_code', 'LLM \u672a\u63d0\u4f9b\u793a\u4f8b\u4ee3\u7801\u3002')\n        keywords = data.get('keywords', [])\n\n        # \u6211\u4eec\u7684 Pydantic \u63cf\u8ff0\u91cc\u5199\u4e86\u662f C++\n        code_lang = \"cpp\"\n\n        # 2. \u6784\u5efa Markdown \u5b57\u7b26\u4e32\n        md_content = f\"# {problem_id} \u8be6\u7ec6\u9898\u89e3\\n\\n\"\n        md_content += f\"{solution_text}\\n\\n\"\n\n        md_content += f\"# \u53c2\u8003\u4ee3\u7801 ({code_lang})\\n\\n\"\n        md_content += f\"```{code_lang}\\n\"\n        md_content += f\"{sample_code}\\n\"\n        md_content += \"```\\n\\n\"\n\n        md_content += \"# \u6838\u5fc3\u77e5\u8bc6\u70b9\\n\\n\"\n        if keywords:\n            for keyword in keywords:\n                md_content += f\"* {keyword}\\n\"\n        else:\n            md_content += \"\u65e0\\n\"\n\n        # 3. \u4fdd\u5b58\u6587\u4ef6\n        try:\n            with open(save_path, 'w', encoding='utf-8') as f:\n                f.write(md_content)\n            print(f\"[Agent] \u5206\u6790\u7ed3\u679c (Markdown) \u5df2\u4fdd\u5b58\u5230: {save_path}\")\n        except Exception as e:\n            print(f\"[Agent] \u4fdd\u5b58 .md \u6587\u4ef6\u65f6\u51fa\u9519: {e}\")\n\n    def _save_error(self, problem_id: str, raw_content: str):\n        \"\"\"\u4fdd\u5b58\u539f\u59cb\u7684\u3001\u65e0\u6cd5\u89e3\u6790\u7684 LLM \u54cd\u5e94\"\"\"\n        error_path = os.path.join(self.analysis_cache_dir, f\"{problem_id}_error.txt\")\n        try:\n            with open(error_path, 'w', encoding='utf-8') as f:\n                f.write(raw_content)\n            print(f\"[Agent] \u539f\u59cb\u9519\u8bef\u54cd\u5e94\u5df2\u4fdd\u5b58\u5230: {error_path}\")\n        except Exception as e:\n            print(f\"[Agent] \u4fdd\u5b58 _error.txt \u6587\u4ef6\u65f6\u51fa\u9519: {e}\")\n\n    def run(self, problem_id: str, problem_data: Dict[str, Any], solutions_data: List[Dict[str, Any]]) -&gt; str:\n        \"\"\"\n        [\u4e3b\u5165\u53e3] \u6267\u884c\u5b8c\u6574\u7684\u5206\u6790\u3001\u89e3\u6790\u548c\u4fdd\u5b58\u6d41\u7a0b\u3002\n        \u8fd4\u56de LLM \u7684\u539f\u59cb\u5b57\u7b26\u4e32\u54cd\u5e94\u3002\n        \"\"\"\n        print(f\"\\n--- [Agent] \u5f00\u59cb\u5206\u6790 {problem_id} ---\")\n\n        # 1. \u6784\u5efa\u63d0\u793a\n        system_prompt, user_prompt = self._build_prompts(problem_data, solutions_data)\n\n        # 2. \u83b7\u53d6 LLM \u54cd\u5e94\n        full_content = self._stream_llm_response(system_prompt, user_prompt)\n        if not full_content:\n            print(\"[Agent] LLM \u54cd\u5e94\u4e3a\u7a7a\uff0c\u4efb\u52a1\u4e2d\u6b62\u3002\")\n            return full_content\n\n        # 3. \u63d0\u53d6\n        extracted_str = self._extract_json_string(full_content)\n\n        # 4. \u89e3\u6790\n        parsed_data = self._parse_to_dict(extracted_str)\n\n        # 5. \u4fdd\u5b58\n        if parsed_data:\n            # [!] \u540c\u65f6\u8c03\u7528\u4e24\u4e2a\u4fdd\u5b58\u65b9\u6cd5\n            self._save_json_result(problem_id, parsed_data)\n            self._save_markdown_result(problem_id, parsed_data)\n        else:\n            self._save_error(problem_id, full_content)\n\n        return full_content\n</code></pre>"},{"location":"project/LuoguAgent/agent/#_6","title":"\u6548\u679c","text":"<p>\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c\u5728\u8c03\u901a\u4e4b\u540e\uff0c\u6211\u5c1d\u8bd5\u628a\u6a21\u578b\u7684\u8f93\u51fa\u62ff\u53bb\u63d0\u4ea4\uff0c\u4ee5luogu\u7d2b\u9898P4137\u4e3a\u4f8b\uff0c\u57285\u6b21\u6d4b\u8bd5\u4e2d\uff0c\u53ea\u6709\u4e00\u6b21\u4ee3\u7801\u662f\u53ef\u4ee5\u4ea4\u4e0a\u53bb\u76f4\u63a5AC\u7684\u3002\u5728P1117\u8fd9\u9053\u9898\u751a\u81f3\u51fa\u73b0\u4e86\u7f16\u8bd1\u9519\u8bef\uff08\u5c3d\u7ba1\u540e\u9762\u6211\u770b\u4e86\u4e00\u4e0b\u662f\u4e2a\u5c0f\u9519\u8bef\uff09\u3002\u8fd9\u8bf4\u660e\u4e0d\u5f00\u601d\u8003\u6a21\u5f0f\u7684\u80fd\u529b\u8fd8\u662f\u6bd4\u8f83\u6709\u9650\u7684\u3002\u4f46\u662f\u4ece\u9898\u89e3\u7684\u8d28\u91cf\u4e0a\u6765\u8bf4\u7ed3\u6784\u4e0a\u662f\u6bd4\u8f83\u5408\u7406\u7684\uff0c\u4e5f\u6bd4\u4eba\u7c7b\u7684\u9898\u89e3\u76f8\u5bf9\u6765\u8bf4\u8981\u66f4\u52a0\u8be6\u7ec6\u3002</p> <p>\u53e6\u5916\uff0c\u6211\u53d1\u73b0\u5728\u722c\u866b\u9636\u6bb5\u722c\u53d6\u5230\u7684\u524d\u4e09\u6761\u5e76\u975e\u662f\u6700\u9ad8\u8d5e\u7684\u56de\u7b54\uff0c\u8fd9\u662f\u4e00\u4e2a\u722c\u866b\u7b56\u7565\u7684\u9057\u7559\u95ee\u9898\uff1a\u5728solution/\u91cc\u9762\u9898\u89e3\u786e\u5b9e\u662f\u6309\u7167\u70b9\u8d5e\u6570\u6392\u5e8f\u7684\uff0c\u4f46\u662farticle\u91cc\u5e76\u975e\u5982\u6b64\u3002\u53e6\u5916\u50cfP4137\u8fd9\u79cd\u9898\u76ee\u6709\u591a\u4e2a\u89e3\u6cd5\u7684\u53ef\u80fd\u5bf9LLM\u5e76\u4e0d\u662f\u5f88\u53cb\u597d\u3002\u5982\u679c\u80fd\u540c\u4e00\u79cd\u89e3\u6cd5\u591a\u4e2a\u9898\u89e3\u53ef\u80fd\u6548\u679c\u66f4\u597d\u3002\u8fd9\u65b9\u9762\u8fd8\u662f\u53ef\u4ee5\u7ee7\u7eed\u4f18\u5316\u7684\u3002</p>"},{"location":"project/LuoguAgent/streamlit/","title":"\u524d\u7aef","text":"<p>\u7531\u4e8e\u6211\u5bf9\u524d\u7aef\u7684\u82e5\u5e72\u6280\u672f\u51e0\u4e4e\u4e00\u65e0\u6240\u77e5\uff0c\u5e76\u4e14\u4ec5\u4f5c\u5c55\u793a\u7528\uff0c\u6240\u4ee5\u6211\u4f7f\u7528streamlit\u6765\u6784\u5efa\u524d\u7aef\u754c\u9762\u3002\u5f88\u4e45\u4ee5\u524d\u5c31\u542c\u8bf4\u8fc7streamlit\uff0c\u4eca\u5929\u624d\u53d1\u73b0\u5b83\u662f\u5982\u6b64\u7684\u597d\u7528\u3002</p>"},{"location":"project/LuoguAgent/streamlit/#streamlit","title":"\u5b89\u88c5streamlit","text":"<pre><code>pip install streamlit\n</code></pre> <p>\u9a8c\u8bc1\u5b89\u88c5\u6210\u529f:</p> <pre><code>streamlit hello\n</code></pre> <p></p> <p>\u89c1\u5230\u8fd9\u4e2a\u754c\u9762\uff0c\u8bf4\u660e\u5b89\u88c5\u6210\u529f\u4e86\u3002</p>"},{"location":"project/LuoguAgent/streamlit/#_2","title":"\u5b66\u4e60\u5982\u4f55\u4f7f\u7528","text":"<p>\u6211\u5b66\u4e60\u4e86\u8fd9\u7bc7\u5b98\u65b9\u6587\u6863\u3002</p> <p>\u4ec5\u752818\u884c\u4ee3\u7801\uff0c\u5c31\u6784\u5efa\u4e86\u4e00\u4e2allm\u7684\u754c\u9762\u3002</p> <pre><code>import streamlit as st\nfrom langchain.llms import OpenAI\n\nst.title('\ud83e\udd9c\ud83d\udd17 Quickstart App')\n\nopenai_api_key = st.sidebar.text_input('OpenAI API Key')\n\ndef generate_response(input_text):\n  llm = OpenAI(temperature=0.7, openai_api_key=openai_api_key)\n  st.info(llm(input_text))\n\nwith st.form('my_form'):\n  text = st.text_area('Enter text:', 'What are the three key pieces of advice for learning how to code?')\n  submitted = st.form_submit_button('Submit')\n  if not openai_api_key.startswith('sk-'):\n    st.warning('Please enter your OpenAI API key!', icon='\u26a0')\n  if submitted and openai_api_key.startswith('sk-'):\n    generate_response(text)\n</code></pre> <p>\u6211\u4eec\u53ea\u9700\u8981\u5728\u6b64\u57fa\u7840\u4e0a\u8fdb\u884c\u6539\u8fdb\u5373\u53ef\u3002</p>"},{"location":"project/LuoguAgent/streamlit/#apppy","title":"\u6784\u5efaapp.py","text":""},{"location":"project/LuoguAgent/streamlit/#_3","title":"\u4fa7\u8fb9\u680f","text":"<p>\u9996\u5148\uff0c\u7531\u4e8e\u9700\u8981\u5728\u7f51\u9875\u4e0a\u5c55\u793a\uff0c\u80af\u5b9a\u4e0d\u80fd\u4f7f\u7528\u6211\u4eec\u672c\u5730.env\u6587\u4ef6\u4e2d\u7684api_key\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u653e\u4e00\u4e2a\u4fa7\u8fb9\u680f\u6765\u8ba9\u7528\u6237\u586b\u5199api_key\u548cbase_url\u3002</p> <pre><code>st.sidebar.title(\"\ud83d\udd11 \u914d\u7f6e API\")\nst.sidebar.markdown(\"\u5bc6\u94a5\u4e0d\u4f1a\u88ab\u5b58\u50a8\uff0c\u4ec5\u7528\u4e8e\u5f53\u524d\u4f1a\u8bdd\u3002\")\n\napi_key_input = st.sidebar.text_input(\n    \"API Key\", \n    type=\"password\", # \u4f7f\u7528 type=\"password\" \u6765\u9690\u85cf\u5bc6\u94a5\n    help=\"\u8f93\u5165\u4f60\u7684 API Key (\u4f8b\u5982 sk-...)\"\n)\n\nbase_url_input = st.sidebar.text_input(\n    \"Base URL\", \n    value=\"https://www.dmxapi.cn/v1\", # \u7ed9\u4e2a\u9ed8\u8ba4\u503c\n    help=\"\u8f93\u5165\u4f60\u7684 API Base URL\"\n)\n</code></pre> <p>\u8fd9\u65f6\u5c31\u5f97\u540c\u6b65\u4fee\u6539\u540e\u7aef\u7684\u903b\u8f91\u4e86\uff0c\u4e4b\u524d\u90fd\u662f\u5199\u6b7b\u7684\uff0c\u73b0\u5728\u5f97\u4f20\u53c2\u624d\u884c\u3002\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u5728__init__\u65f6\u4f20\u5165\u8fd9\u4e24\u4e2a\u53c2\u6570\uff0c\u7136\u540e\u5efa\u7acbself.llm\u6216self.problem_strategy/self.solution_strategy\uff0c\u6b64\u5904\u5c31\u7565\u53bb\u4e86\u3002</p>"},{"location":"project/LuoguAgent/streamlit/#_4","title":"\u4e3b\u754c\u9762","text":"<p>\u5148\u68c0\u67e5\u662f\u5426\u586b\u5199\u4e86api_key\uff0c\u5982\u679c\u6ca1\u6709\u90a3\u5c31\u4e0d\u663e\u793a\u540e\u7eed\u754c\u9762\u3002</p> <pre><code>st.title(\"\ud83e\udd9c\ud83d\udd17 Luogu Agent\")\n\n@st.cache_resource\ndef get_analysis_agent(api_key, base_url):\n    print(f\"--- [Streamlit] \u6b63\u5728\u5c1d\u8bd5\u521d\u59cb\u5316 AnalysisAgent... ---\")\n    return AnalysisAgent(api_key, base_url)\n\nanalysis_agent = None\nif api_key_input and base_url_input:\n    try:\n        analysis_agent = get_analysis_agent(api_key_input, base_url_input)\n    except Exception as e:\n        st.error(f\"\ud83d\udeab Agent \u521d\u59cb\u5316\u5931\u8d25: {e}\")\n        st.warning(\"\u8bf7\u68c0\u67e5\u4fa7\u8fb9\u680f\u7684 API Key \u548c Base URL \u662f\u5426\u6b63\u786e\u3002\")\n        st.stop()\nelse:\n    st.info(\"\ud83d\udc48 \u8bf7\u5728\u5de6\u4fa7\u8fb9\u680f\u8f93\u5165 API Key \u548c Base URL \u6765\u542f\u52a8\u5e94\u7528\u3002\")\n    st.stop() # \u5982\u679c\u6ca1\u63d0\u4f9b\u5bc6\u94a5\uff0c\u5c31\u505c\u5728\u8fd9\u91cc\uff0c\u4e0d\u663e\u793a\u540e\u7eed\u754c\u9762\n</code></pre> <p>\u5982\u679c\u5df2\u7ecf\u586b\u5199\u5b8c\u4e86\uff0c\u90a3\u4e48\u5c31\u5c55\u793a\u9898\u76ee\u8f93\u5165\u6846\u3002</p> <pre><code>problemid = st.text_input(\"\u8f93\u5165\u6d1b\u8c37\u9898\u76ee ID (\u4f8b\u5982: P1238)\", \"P1238\")\n</code></pre> <p>\u63a5\u4e0b\u6765\uff0c\u505a\u4e00\u4e2a\u5f00\u59cb\u5206\u6790\u7684\u6309\u94ae\uff0c\u5e76\u5199\u51fa\u4e3b\u8981\u7684\u903b\u8f91\uff1a</p> <ol> <li>\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u5f02\u6b65\u7684\u72b6\u6001\u680f\uff0c\u7b49\u5f85\u722c\u866b\u8fd4\u56de\u9898\u76ee\u548c\u9898\u89e3\u3002</li> <li>\u6211\u4eec\u9700\u8981\u8c03\u7528LLM\uff0c\u751f\u6210\u8be6\u7ec6\u7684\u9898\u89e3\u548c\u4ee3\u7801\u3002\u8fd9\u91cc\u4e3a\u4e86\u9632\u6b62\u7528\u6237\u7b49\u592a\u4e45\uff0c\u8fd8\u9700\u8981\u6d41\u5f0f\u8f93\u51fa\u3002</li> <li>\u89e3\u6790\u6a21\u578b\u7ed9\u51fa\u7684json\u6587\u4ef6\uff0c\u5e76\u751f\u6210markdown\u8fdb\u884c\u5c55\u793a</li> </ol> <pre><code>if st.button(\"\ud83d\ude80 \u5f00\u59cb\u5206\u6790\"):\n    if not problemid:\n        st.warning(\"\u8bf7\u8f93\u5165\u9898\u76ee ID\")\n        st.stop()\n\n    # [!] \u6838\u5fc3\uff1a\u8fd9\u662f\u6211\u4eec\u7684\u201c\u821e\u53f0\u201d\uff0c\u6240\u6709\u5185\u5bb9\u90fd\u4f1a\u5728\u8fd9\u91cc\u66f4\u65b0\n    placeholder = st.empty()\n\n    raw_crawler_data = {}\n\n    # --- 1. \u722c\u866b (\u5904\u7406\u5f02\u6b65) ---\n    try:\n        with st.status(f\"\ud83d\udd0d \u6b63\u5728\u722c\u53d6 {problemid} \u9898\u76ee\u548c\u9898\u89e3...\", expanded=True) as status:\n            brouser_config = BrowserConfig(headless=True, proxy=None)\n\n            async def crawl_main():\n                async with AsyncWebCrawler(config=brouser_config) as crawler:\n                    agent = LuoguCrawlerAgent(api_key_input, base_url_input, crawler, cache_dir=CACHE_DIR)\n                    st.write(f\"\u6b63\u5728\u6293\u53d6 {problemid}...(\u7b2c\u4e00\u6b21\u6293\u53d6\u53ef\u80fd\u9700\u8981\u8f83\u957f\u7684\u65f6\u95f4\u23f3)\")\n                    data = await agent.run(problemid, max_solutions=3)\n                    st.write(\"\u2705 \u6293\u53d6\u5b8c\u6210\")\n                    return data\n\n            # \u5728\u540c\u6b65\u7684 Streamlit \u56de\u8c03\u4e2d\u8fd0\u884c\u5f02\u6b65\u722c\u866b\n            raw_crawler_data = asyncio.run(crawl_main()) \n            status.update(label=\"\u722c\u53d6\u6210\u529f!\", state=\"complete\")\n\n    except Exception as e:\n        placeholder.error(f\"\u722c\u866b\u9636\u6bb5\u5931\u8d25: {e}\")\n        traceback.print_exc() # \u6253\u5370\u5230\u7ec8\u7aef\n        st.stop()\n\n    # --- 2. \u68c0\u67e5\u722c\u866b\u6570\u636e ---\n    problem_data = raw_crawler_data.get(\"problem\", {})\n    solutions_data = raw_crawler_data.get(\"solutions\", [])\n    if \"error\" in problem_data or not problem_data:\n        placeholder.error(f\"\u722c\u866b\u672a\u83b7\u53d6\u5230\u6709\u6548\u6570\u636e: {problem_data.get('error', '\u672a\u77e5\u9519\u8bef')}\")\n        st.stop()\n\n    # --- 3. \u6784\u5efa\u63d0\u793a &amp; \u8c03\u7528 LLM (\u6d41\u5f0f) ---\n    placeholder.info(\"\ud83e\udde0 \u6b63\u5728\u8c03\u7528 LLM...\")\n\n    try:\n        # [!] \u8c03\u7528 Agent \u7684\u201c\u96f6\u4ef6\u201d\n        system_prompt, user_prompt = analysis_agent._build_prompts(problem_data, solutions_data)\n\n        # [!] \u76f4\u63a5\u8bbf\u95ee agent \u7684 llm \u5c5e\u6027\u6765\u83b7\u53d6\u6d41\n        stream = analysis_agent.llm.chat.completions.create(\n            model=\"glm-4.6\", \n            messages=[\n                {\"role\": \"system\", \"content\": system_prompt},\n                {\"role\": \"user\", \"content\": user_prompt}\n            ],\n            thinking={\"type\": \"disabled\"},\n            stream=True\n        )\n\n        full_content = \"\"\n        stream_display = \"\" # \u8fd9\u662f\u6d41\u5f0f\u5c55\u793a\u7ed9\u7528\u6237\u7684\n\n        for chunk in stream:\n            if not chunk.choices: continue\n            delta = chunk.choices[0].delta\n            if hasattr(delta, 'content') and delta.content:\n                full_content += delta.content\n                stream_display += delta.content\n                placeholder.write(stream_display + \"\u258c\")\n\n        # \u6d41\u5f0f\u7ed3\u675f\uff0c\u663e\u793a\u5b8c\u6574 JSON\n        placeholder.code(full_content, language=\"json\")\n        st.success(\"\u2705 LLM \u6d41\u5f0f\u54cd\u5e94\u63a5\u6536\u5b8c\u6bd5\")\n\n    except Exception as e:\n        placeholder.error(f\"LLM \u8c03\u7528\u5931\u8d25: {e}\")\n        traceback.print_exc()\n        st.stop()\n\n    # --- 4. \u89e3\u6790 &amp; \u8986\u76d6 ---\n    with st.spinner(\"\u6b63\u5728\u89e3\u6790\u7ed3\u679c\u5e76\u751f\u6210\u62a5\u544a...\"):\n        # [!] \u590d\u7528 Agent \u7684\u89e3\u6790\u548c\u63d0\u53d6\u201c\u96f6\u4ef6\u201d\n        extracted_str = analysis_agent._extract_json_string(full_content)\n        parsed_data = analysis_agent._parse_to_dict(extracted_str)\n\n        if parsed_data:\n            # [!] \u7528\u6211\u4eec\u524d\u7aef\u7684\u8f85\u52a9\u51fd\u6570\u751f\u6210 Markdown\n            final_md = build_markdown_from_data(problemid, parsed_data)\n\n            # [!] \u5173\u952e\uff1a\u7528 Markdown \u8986\u76d6\u6389 placeholder \u91cc\u7684 code\n            placeholder.markdown(final_md)\n\n            try:\n                analysis_agent._save_json_result(problemid, parsed_data)\n                analysis_agent._save_markdown_result(problemid, parsed_data)\n            except Exception as e:\n                st.warning(f\"\u4fdd\u5b58\u6587\u4ef6\u65f6\u51fa\u9519 (\u4f46\u4e0d\u5f71\u54cd\u663e\u793a): {e}\")\n\n        else:\n            # \u89e3\u6790\u5931\u8d25\n            st.error(\"\u274c \u65e0\u6cd5\u89e3\u6790 LLM \u7684 JSON \u54cd\u5e94\u3002\")\n            analysis_agent._save_error(problemid, full_content)\n            # \u6b64\u65f6 placeholder \u91cc\u4ecd\u7136\u663e\u793a\u7684\u662f\u5b8c\u6574\u7684\u539f\u59cb JSON\uff0c\u65b9\u4fbf\u8c03\u8bd5\n</code></pre>"},{"location":"project/LuoguAgent/streamlit/#_5","title":"\u90e8\u7f72","text":"<p>\u5728\u865a\u62df\u73af\u5883\u4e2d\uff0c\u8fd0\u884c\uff1a</p> <pre><code>pip freeze &gt; requirements.txt\n</code></pre> <p>\u5bfc\u51fapython\u4f9d\u8d56\uff0c\u5e76\u5220\u6389\u5176\u4e2d\u6240\u6709\u542b\u6709 <code>@file:///</code> \u7684\u5305\uff0c\u8fd9\u4e9b\u662f\u672c\u5730\u7684\uff0cstreamlit\u4e91\u7aef\u4e0d\u8ba4\u8bc6\u3002</p> <p>\u7531\u4e8eplaywright\u6d4f\u89c8\u5668\u8fd0\u884c\u53ef\u80fd\u8fd8\u9700\u8981\u4e00\u4e9b\u7cfb\u7edf\u5e93\uff0c\u9700\u8981\u5199\u5165packages.txt\u4e2d\uff1a</p> <pre><code>libnss3\nlibnspr4\nlibdbus-1-3\nlibatk1.0-0  \nlibatk-bridge2.0-0\nlibcups2\nlibdrm2\nlibatspi2.0-0\nlibxcomposite1\nlibxcursor1\nlibxdamage1\nlibxfixes3\nlibxrandr2\nlibgbm1\nlibxkbcommon0\nlibpango-1.0-0\nlibcairo2\nlibgdk-pixbuf2.0-0 \nlibgtk-3-0\n</code></pre> <p>\u4e0a\u9762\u7684\u6b65\u9aa4\u90fd\u5b8c\u6210\u540e\uff0c\u53d1\u73b0\u4f9d\u7136\u4e0d\u884c\uff0c\u8fd8\u9700\u8981\u8fd0\u884c <code>playwright install</code>\u3002\u800cstreamlit\u597d\u50cf\u4e0d\u63d0\u4f9b\u7ec8\u7aef\uff0c\u56e0\u6b64\u9009\u62e9\u5728 <code>app.py</code> \u7684\u5f00\u5934\u8c03\u7528 <code>subprocess</code> \u5c1d\u8bd5\u5b89\u88c5\uff0c\u53d1\u73b0\u5c45\u7136\u6210\u529f\u4e86\u3002</p> <pre><code>@st.cache_resource\ndef install_playwright():\n    \"\"\"\n    \u4e00\u4e2a\u53ea\u8fd0\u884c\u4e00\u6b21\u7684\u51fd\u6570\uff0c\u7528\u4e8e\u5728 Streamlit Cloud \u542f\u52a8\u65f6\n    \u5b89\u88c5 Playwright \u6240\u9700\u7684\u6d4f\u89c8\u5668\u3002\n    \"\"\"\n    print(\"--- [Playwright] \u6b63\u5728\u5b89\u88c5\u6d4f\u89c8\u5668... ---\")\n\n    # \u6211\u4eec\u8c03\u7528 \"python -m playwright install chromium\"\n    # \"sys.executable\" \u786e\u4fdd\u6211\u4eec\u7528\u7684\u662f\u5f53\u524d\u73af\u5883\u7684 python\n    command = [sys.executable, \"-m\", \"playwright\", \"install\", \"chromium\"]\n\n    try:\n        # \u8fd0\u884c\u547d\u4ee4\n        result = subprocess.run(\n            command,\n            stdout=subprocess.PIPE,\n            stderr=subprocess.PIPE,\n            text=True,\n            check=True  # \u5982\u679c\u547d\u4ee4\u5931\u8d25\uff0c\u5219\u629b\u51fa\u5f02\u5e38\n        )\n        print(f\"--- [Playwright] \u5b89\u88c5\u6210\u529f: {result.stdout} ---\")\n    except subprocess.CalledProcessError as e:\n        # \u5982\u679c\u5b89\u88c5\u5931\u8d25\uff0c\u663e\u793a\u9519\u8bef\u5e76\u505c\u6b62\u5e94\u7528\n        print(f\"--- [Playwright] \u5b89\u88c5\u5931\u8d25: {e.stderr} ---\")\n        st.error(f\"Playwright \u6d4f\u89c8\u5668\u5b89\u88c5\u5931\u8d25: {e.stderr}\")\n        st.stop()\n    except FileNotFoundError:\n        st.error(\"\u65e0\u6cd5\u6267\u884c Playwright \u547d\u4ee4\u3002\u8bf7\u786e\u4fdd 'playwright' \u5728 requirements.txt \u4e2d\u3002\")\n        st.stop()\n\ninstall_playwright()\n</code></pre> <p>\u81f3\u6b64\uff0c\u8fd9\u4e2a\u9879\u76ee\u7684\u57fa\u672c\u529f\u80fd\u5c31\u7b97\u5b8c\u6210\u4e86\ud83e\udd73</p>"},{"location":"project/LuoguAgent/%E7%88%AC%E8%99%AB/","title":"\u722c\u866b","text":"<p>\u722c\u866b\u8981\u505a\u7684\u662f\uff1a\u7ed9\u5b9aLuogu\u4e0a\u7684\u9898\u76eeurl\uff0c\u81ea\u52a8\u722c\u53d6\u9898\u76ee\u548c\u9898\u89e3\uff0c\u5e76\u8fdb\u884c\u4e00\u5b9a\u7684\u89e3\u6790\u3002</p> <p>\u7701\u6d41\uff1a\u5bf9\u4e8e\u9898\u76ee\uff0c\u7528 Crawl4ai \u6e32\u67d3\u9898\u76ee\u9875\uff0c\u8c03\u7528 LLM \u6309 Pydantic schema \u63d0\u53d6\u5e76\u7ed3\u6784\u5316\u9898\u76ee\u4fe1\u606f\uff1b\u5bf9\u4e8e\u9898\u89e3\uff0c\u5148\u7528 requests + BeautifulSoup \u5728 <code>luogu.com.cn</code> \u641c\u7d22\u6587\u7ae0\u62ff\u5230 <code>/article/...</code> \u94fe\u63a5\uff0c\u518d\u7528 Crawl4ai \u6e32\u67d3\u8fd9\u4e9b\u516c\u5f00\u6587\u7ae0\u5e76\u7528 LLM \u6309 schema \u63d0\u53d6\u9898\u89e3\u4e0e\u4ee3\u7801\uff08\u7ed5\u8fc7\u9700\u767b\u5f55\u7684 <code>/solution/</code> \u9875\u9762\uff09\u3002</p>"},{"location":"project/LuoguAgent/%E7%88%AC%E8%99%AB/#_2","title":"\u5de5\u5177\u4ecb\u7ecd","text":"<p>\u9996\u5148\uff0c\u5e94\u8be5\u53bbGitHub\u4e0a\u770b\u6709\u6ca1\u6709\u522b\u4eba\u5199\u597d\u7684Luogu\u722c\u866b\uff0c\u5f88\u53ef\u60dc\u6211\u76f4\u5230\u5f00\u59cb\u5199\u4ee3\u7801\u4e00\u4e2a\u5c0f\u65f6\u540e\u624d\u60f3\u8d77\u6765\u53bb\u8fd9\u4e48\u5e72\uff0c\u5e78\u597dGitHub\u4e0a\u9762\u6ca1\u6709\u80fd\u7528\u7684\u3002</p> <p>\u7ecf\u8fc7\u591a\u6b21\u8bd5\u9519\uff0c\u8fd9\u4e2a\u9879\u76ee\u6700\u7ec8\u6f14\u53d8\u6210\u4e86\u4e00\u4e2a\u201c\u6df7\u5408\u52a8\u529b\u201d\u7684\u722c\u866b\u7cfb\u7edf\uff0c\u6ca1\u6709\u4e00\u4e2a\u5de5\u5177\u662f\u4e07\u80fd\u7684\uff0c\u6211\u7528\u4e86\u4e09\u79cd\u5de5\u5177\uff0c\u8ba9\u5b83\u4eec\u5404\u53f8\u5176\u804c\uff1a</p>"},{"location":"project/LuoguAgent/%E7%88%AC%E8%99%AB/#crawl4ai","title":"Crawl4ai","text":""},{"location":"project/LuoguAgent/%E7%88%AC%E8%99%AB/#_3","title":"\u4ecb\u7ecd","text":"<p>\u5b83\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a <code>Playwright</code>\uff08\u65e0\u5934\u6d4f\u89c8\u5668\uff09+ <code>LLM</code>\uff08\u5927\u8bed\u8a00\u6a21\u578b\uff09\u7684\u7ec4\u5408\u4f53\u3002</p> <ul> <li>\u4f18\u70b9\uff1a \u4e0d\u5fc5\u50cfrequests\u5e93\u90a3\u6837\u5199\u8bf7\u6c42\u6807\u5934\uff0c\u5e76\u4e14\u53ef\u4ee5\u8ba9LLM\u6765\u89e3\u6790\u5185\u5bb9\u3002\u5185\u7f6e\u4e86\u5f3a\u5927\u7684\u65b9\u6cd5\u5c06html\u8f6c\u4e3amarkdown\uff0c\u4f7f\u7528\u8d77\u6765\u975e\u5e38\u65b9\u4fbf\u3002</li> <li>\u7f3a\u70b9\uff1a \u5904\u7406\u901f\u5ea6\u6162\uff0c\u4e14\u9700\u8981token\u6d88\u8017\u3002\u56e0\u6b64\u5728\u7ed3\u6784\u5316\u7f51\u9875\u6700\u597d\u4e0d\u8981\u4f7f\u7528LLM\u3002</li> </ul>"},{"location":"project/LuoguAgent/%E7%88%AC%E8%99%AB/#_4","title":"\u5b89\u88c5","text":"<pre><code># Install the package\npip install -U crawl4ai\n\n# For pre release versions\npip install crawl4ai --pre\n\n# Run post-installation setup\ncrawl4ai-setup\n\n# Verify your installation\ncrawl4ai-doctor\n</code></pre>"},{"location":"project/LuoguAgent/%E7%88%AC%E8%99%AB/#requests","title":"requests","text":""},{"location":"project/LuoguAgent/%E7%88%AC%E8%99%AB/#_5","title":"\u4ecb\u7ecd","text":"<p>\u8fd9\u662f\u57fa\u672c\u7684HTTP\u8bf7\u6c42\u5e93\u3002 * \u4f18\u70b9\uff1a \u6781\u5feb\uff0c\u8f7b\u91cf\uff0c0 Token\u6d88\u8017\u3002 * \u7f3a\u70b9\uff1a \u5b83\u53ea\u80fd\u6293\u53d6\u9759\u6001\u7684HTML\u6e90\u7801\uff0c\u65e0\u6cd5\u6267\u884cJavaScript\u3002\u5982\u679c\u9875\u9762\u662f\u52a8\u6001\u6e32\u67d3\u7684\uff0c\u5b83\u5c31\u6293\u778e\u4e86\u3002</p>"},{"location":"project/LuoguAgent/%E7%88%AC%E8%99%AB/#_6","title":"\u5b89\u88c5","text":"<pre><code>pip install requests\n</code></pre>"},{"location":"project/LuoguAgent/%E7%88%AC%E8%99%AB/#beautifulsoup","title":"BeautifulSoup","text":""},{"location":"project/LuoguAgent/%E7%88%AC%E8%99%AB/#_7","title":"\u4ecb\u7ecd","text":"<p>\u7528\u4e8e\u89e3\u6790HTML\u6e90\u7801\u3002 * \u4f18\u70b9\uff1a \u80fd\u901a\u8fc7CSS\u9009\u62e9\u5668\u6216\u6b63\u5219\u8868\u8fbe\u5f0f\uff08<code>re</code>\uff09\u7cbe\u786e\u5730\u201c\u62a0\u201d\u51fa\u60f3\u8981\u7684\u4efb\u4f55\u6807\u7b7e\u6216\u94fe\u63a5\u3002 * \u7f3a\u70b9\uff1a \u5f3a\u4f9d\u8d56\u4e8e\u56fa\u5b9a\u7684HTML\u7ed3\u6784\u3002\u5982\u679c\u7f51\u7ad9\u4e00\u6539\u7248\uff0c\u4ee3\u7801\u5c31\u5f97\u91cd\u5199\u3002</p>"},{"location":"project/LuoguAgent/%E7%88%AC%E8%99%AB/#_8","title":"\u5b89\u88c5","text":"<pre><code>pip install beautifulsoup4\n</code></pre>"},{"location":"project/LuoguAgent/%E7%88%AC%E8%99%AB/#_9","title":"\u9898\u76ee\u9875\u722c\u53d6","text":"<p>\u722c\u53d6\u9898\u76ee\u9875\uff08<code>.../problem/P1254</code>\uff09\u662f\u7b2c\u4e00\u6b65\u3002\u8fd9\u4e2a\u9875\u9762\u662f\u516c\u5f00\u7684\uff0c\u4e0d\u9700\u8981\u767b\u5f55\u3002</p> <p>\u867d\u7136 <code>requests+beautifulsoup</code> \u4e5f\u80fd\u6293\u53d6\uff0c\u4f46\u6211\u4e00\u5f00\u59cb\u5c31\u9009\u62e9\u4e86 <code>Crawl4ai</code>\u3002\u4e3b\u8981\u539f\u56e0\u662f\uff0c\u6d1b\u8c37\u7684\u9898\u76ee\u683c\u5f0f\u5e76\u4e0d\u7edf\u4e00\uff08\u6bd4\u5982\u6709\u7684\u9898\u6ca1\u6709\u201c\u9898\u76ee\u80cc\u666f\u201d\uff0c\u6709\u7684\u662f\u4e2d\u82f1\u6587\u6df7\u6742\uff09\u3002\u53e6\u4e00\u4e2a\u539f\u56e0\u662f\u4e4b\u540e\u6216\u8bb8\u53ef\u4ee5\u6539\u6539\u7528\u4e8e\u5176\u4ed6\u7f51\u7ad9\u3002</p> <p>\u9996\u5148\uff0c\u5b9a\u4e49\u9700\u8981\u7684\u5b57\u6bb5\uff1a\u9898\u76ee\u80cc\u666f\u3001\u9898\u76ee\u63cf\u8ff0\u3001\u8f93\u5165\u683c\u5f0f\u3001\u8f93\u51fa\u683c\u5f0f\u3001\u8f93\u5165\u8f93\u51fa\u6837\u4f8b\u3001\u8bf4\u660e/\u63d0\u793a\u3002</p> <pre><code>from pydantic import BaseModel, Field\nfrom typing import List\nclass ProblemDetails(BaseModel):\n    background: str = Field(..., description=\"\u63d0\u53d6\u9898\u76ee\u80cc\u666f\uff0c\u5982\u679c\u6ca1\u6709\u5219\u8fd4\u56de '\u65e0'\")\n    description: str = Field(..., description=\"\u63d0\u53d6\u5b8c\u6574\u7684\u9898\u76ee\u63cf\u8ff0\")\n    input_format: str = Field(..., description=\"\u63d0\u53d6\u8f93\u5165\u683c\u5f0f\u8bf4\u660e\")\n    output_format: str = Field(..., description=\"\u63d0\u53d6\u8f93\u51fa\u683c\u5f0f\u8bf4\u660e\")\n    examples: List[dict] = Field(..., description=\"\u63d0\u53d6\u6240\u6709\u7684\u8f93\u5165\u8f93\u51fa\u6837\u4f8b\u3002\u6bcf\u4e2a\u6837\u4f8b\u662f\u4e00\u4e2a\u5b57\u5178\uff0c\u5305\u542b 'input' \u548c 'output' \u952e\")\n    notes: str = Field(..., description=\"\u63d0\u53d6\u8bf4\u660e/\u63d0\u793a\u90e8\u5206\u3002\u6ce8\u610f\uff1a\u5fc5\u987b\u4fdd\u7559\u6240\u6709\u7684\u6570\u5b66\u7b26\u53f7\u3001\u4e0a\u6807\u548c\u683c\u5f0f\u3002\u5982\u679c\u6ca1\u6709\u5219\u8fd4\u56de '\u65e0'\")\n</code></pre> <p>\u63a5\u7740\uff0c\u5b9a\u4e49LLM\u53ca\u5176\u63d0\u53d6\u7b56\u7565\u3002\u6211\u770b\u4e86crawl4ai\u652f\u6301\u7684\u6a21\u578b\uff0c\u9009\u4e86\u6700\u4fbf\u5b9c\u7684deepseek\u3002</p> <pre><code>from crawl4ai import *\nfrom constant import DMX_API_KEY\nstrategy = LLMExtractionStrategy(\n    llm_config=LLMConfig(\n        provider=\"deepseek/deepseek-chat\", \n        api_token=DMX_API_KEY,\n        base_url=\"https://www.dmxapi.cn/v1\"\n    ),\n    schema=ProblemDetails.model_json_schema(),\n    extraction_type=\"schema\",\n    instruction=\"\u4f60\u662f\u4e00\u4e2a\u722c\u866b\u52a9\u624b\uff0c\u8bf7\u4ece\u7ed9\u5b9a\u7684\u7f51\u9875 Markdown \u4e2d\u63d0\u53d6\u7b97\u6cd5\u9898\u76ee\u7684\u5173\u952e\u4fe1\u606f\u3002\", #\n    apply_chunking=False,\n    input_format=\"markdown\", # \u8fd9\u91cc\u53ef\u80fd\u9700\u8981html, \u76ee\u524d\u5148\u6682\u65f6\u8fd9\u6837\n    extra_args={\"temperature\": 0.1, \"max_tokens\": 2000} \n)\n</code></pre> <p>\u5728\u4e3b\u51fd\u6570\u5185\uff0c\u5f02\u6b65\u5730\u8fdb\u884c\u722c\u53d6\uff0cdelay_before_return_html\u7684\u8bbe\u7f6e\u662f\u4e3a\u4e86\u8ba9js\u52a8\u6001\u52a0\u8f7d\u3002</p> <pre><code>import json, asyncio, os\n\ntest_url = \"https://www.luogu.com.cn/problem/P1254\"\n\nasync def main():\n    brouser_config = BrowserConfig(headless=True, proxy=None)\n\n    config = CrawlerRunConfig(\n        cache_mode=CacheMode.ENABLED,\n        extraction_strategy=strategy,\n        delay_before_return_html=3\n    )\n\n    async with AsyncWebCrawler(config=brouser_config) as crawler:\n        print(f\"\u6b63\u5728\u722c\u53d6 {test_url} \u5e76\u63d0\u53d6...\")\n        result = await crawler.arun(test_url, config=config)\n        if result.success and result.extracted_content:\n            try:\n                data = json.loads(result.extracted_content)\n                print(\"--- \u63d0\u53d6\u6210\u529f ---\")\n                print(json.dumps(data, indent=2, ensure_ascii=False))\n\n                # \u6253\u5370 Token \u6d88\u8017\n                strategy.show_usage() \n\n            except json.JSONDecodeError:\n                print(\"--- \u63d0\u53d6\u5931\u8d25 ---\")\n                print(\"LLM \u8fd4\u56de\u7684\u4e0d\u662f\u4e00\u4e2a\u6709\u6548\u7684 JSON:\")\n                print(result.extracted_content)\n        else:\n            print(\"--- \u63d0\u53d6\u5931\u8d25 ---\")\n            print(\"\u722c\u866b\u6216\u63d0\u53d6\u6b65\u9aa4\u51fa\u9519\u3002\")\n            if result.error_message:\n                print(f\"\u9519\u8bef\u4fe1\u606f: {result.error_message}\")\n\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n</code></pre> <p>\u5b8c\u6574\u4ee3\u7801\uff1a</p> <pre><code>from pydantic import BaseModel, Field\nimport json, asyncio, os\nfrom crawl4ai import *\nfrom typing import List\nfrom constant import DMX_API_KEY\n\nclass ProblemDetails(BaseModel):\n    background: str = Field(..., description=\"\u63d0\u53d6\u9898\u76ee\u80cc\u666f\uff0c\u5982\u679c\u6ca1\u6709\u5219\u8fd4\u56de '\u65e0'\")\n    description: str = Field(..., description=\"\u63d0\u53d6\u5b8c\u6574\u7684\u9898\u76ee\u63cf\u8ff0\")\n    input_format: str = Field(..., description=\"\u63d0\u53d6\u8f93\u5165\u683c\u5f0f\u8bf4\u660e\")\n    output_format: str = Field(..., description=\"\u63d0\u53d6\u8f93\u51fa\u683c\u5f0f\u8bf4\u660e\")\n    examples: List[dict] = Field(..., description=\"\u63d0\u53d6\u6240\u6709\u7684\u8f93\u5165\u8f93\u51fa\u6837\u4f8b\u3002\u6bcf\u4e2a\u6837\u4f8b\u662f\u4e00\u4e2a\u5b57\u5178\uff0c\u5305\u542b 'input' \u548c 'output' \u952e\")\n    notes: str = Field(..., description=\"\u63d0\u53d6\u8bf4\u660e/\u63d0\u793a\u90e8\u5206\u3002\u6ce8\u610f\uff1a\u5fc5\u987b\u4fdd\u7559\u6240\u6709\u7684\u6570\u5b66\u7b26\u53f7\u3001\u4e0a\u6807\u548c\u683c\u5f0f\u3002\u5982\u679c\u6ca1\u6709\u5219\u8fd4\u56de '\u65e0'\")\n\nstrategy = LLMExtractionStrategy(\n    llm_config=LLMConfig(\n        provider=\"deepseek/deepseek-chat\", \n        api_token=DMX_API_KEY,\n        base_url=\"https://www.dmxapi.cn/v1\"\n    ),\n    schema=ProblemDetails.model_json_schema(),\n    extraction_type=\"schema\",\n    instruction=\"\u4f60\u662f\u4e00\u4e2a\u722c\u866b\u52a9\u624b\uff0c\u8bf7\u4ece\u7ed9\u5b9a\u7684\u7f51\u9875 Markdown \u4e2d\u63d0\u53d6\u7b97\u6cd5\u9898\u76ee\u7684\u5173\u952e\u4fe1\u606f\u3002\", #\n    apply_chunking=False,\n    input_format=\"markdown\", # \u8fd9\u91cc\u53ef\u80fd\u9700\u8981html, \u76ee\u524d\u5148\u6682\u65f6\u8fd9\u6837\n    extra_args={\"temperature\": 0.1, \"max_tokens\": 2000} \n)\n\n\ntest_url = \"https://www.luogu.com.cn/article/syub6c8r\"\n\nasync def main():\n    brouser_config = BrowserConfig(headless=True, proxy=None)\n\n    config = CrawlerRunConfig(\n        cache_mode=CacheMode.ENABLED,\n        extraction_strategy=strategy,\n        delay_before_return_html=3\n    )\n\n    async with AsyncWebCrawler(config=brouser_config) as crawler:\n        print(f\"\u6b63\u5728\u722c\u53d6 {test_url} \u5e76\u63d0\u53d6...\")\n        result = await crawler.arun(test_url, config=config)\n        if result.success and result.extracted_content:\n            try:\n                data = json.loads(result.extracted_content)\n                print(\"--- \u63d0\u53d6\u6210\u529f ---\")\n                print(json.dumps(data, indent=2, ensure_ascii=False))\n\n                # \u6253\u5370 Token \u6d88\u8017\n                strategy.show_usage() \n\n            except json.JSONDecodeError:\n                print(\"--- \u63d0\u53d6\u5931\u8d25 ---\")\n                print(\"LLM \u8fd4\u56de\u7684\u4e0d\u662f\u4e00\u4e2a\u6709\u6548\u7684 JSON:\")\n                print(result.extracted_content)\n        else:\n            print(\"--- \u63d0\u53d6\u5931\u8d25 ---\")\n            print(\"\u722c\u866b\u6216\u63d0\u53d6\u6b65\u9aa4\u51fa\u9519\u3002\")\n            if result.error_message:\n                print(f\"\u9519\u8bef\u4fe1\u606f: {result.error_message}\")\n\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n</code></pre>"},{"location":"project/LuoguAgent/%E7%88%AC%E8%99%AB/#_10","title":"\u9898\u89e3\u9875\u722c\u53d6","text":"<p>\u5bf9\u4e8e\u9898\u76ee\u7684\u722c\u53d6\u65b9\u6cd5\u5728\u722c\u53d6\u9898\u89e3\u7684\u65f6\u5019\u5931\u6548\u4e86\uff0c\u56e0\u4e3a\u76f4\u63a5\u8bbf\u95ee <code>.../solution/</code> \u9875\u9762\u9700\u8981\u767b\u9646\u3002</p> <p>\u8fd9\u5f00\u542f\u4e86\u6211\u6f2b\u957f\u7684\u201c\u8e29\u5751\u201d\u4e4b\u65c5\u3002</p>"},{"location":"project/LuoguAgent/%E7%88%AC%E8%99%AB/#_11","title":"\u65b9\u6848\u4e00\uff1a\u76f4\u63a5\u722c\u53d6 (\u5931\u8d25)","text":"<ul> <li>\u5c1d\u8bd5\uff1a \u4fdd\u6301\u548c\u722c\u53d6\u9898\u76ee\u9875\u4e00\u6837\u7684\u903b\u8f91\uff0c\u76f4\u63a5\u7528 <code>Crawl4ai</code> \u8bbf\u95ee <code>.../solution/P1254</code>\u3002</li> <li>\u7ed3\u679c\uff1a <code>Crawl4ai</code> \u5e95\u5c42\u7684\u6d4f\u89c8\u5668\u56e0\u4e3a\u6ca1\u6709\u767b\u5f55\uff0c\u88ab\u6d1b\u8c37\u7684\u767b\u5f55\u5899\u6321\u4f4f\uff0c\u53ea\u722c\u56de\u6765\u201c\u8bf7\u5148\u767b\u5f55\u201d\u7684HTML\u3002</li> </ul>"},{"location":"project/LuoguAgent/%E7%88%AC%E8%99%AB/#cookie","title":"\u65b9\u6848\u4e8c\uff1a\u6ce8\u5165 Cookie (\u5931\u8d25)","text":"<ul> <li>\u5c1d\u8bd5\uff1a \u65e2\u7136\u8981\u767b\u5f55\uff0c\u6211\u5c31\u5728\u6d4f\u89c8\u5668\u4e0a\u624b\u52a8\u767b\u5f55\uff0c\u7136\u540e\u6309 <code>F12</code> \u6293\u5230\u4e86\u6211\u7684\u767b\u5f55 Cookie\uff08<code>_uid</code>, <code>__client_id</code>\u7b49\uff09[cite: <code>_uid: 1022761</code>, <code>__client_id: 0b76e9e1441a36f9b7a73f0436accc308dfcd6fb</code>, <code>C3VK: 957d42</code>]\u3002\u7136\u540e\uff0c\u6211\u4f7f\u7528 <code>Crawl4ai</code> \u63d0\u4f9b\u7684 <code>on_page_context_created</code> \u94a9\u5b50\uff0c\u5728\u6d4f\u89c8\u5668\u5bfc\u822a\u524d\u5c31\u628a\u6211\u7684 Cookie \u6ce8\u5165\u8fdb\u53bb\u3002</li> <li>\u7ed3\u679c\uff1a \u4f9d\u7136\u5931\u8d25\u3002\u5177\u4f53\u539f\u56e0\u5c1a\u4e0d\u660e\u786e\uff0c\u56e0\u4e3ahook\u7684\u5177\u4f53\u5b9e\u73b0\u6211\u6ca1\u4ed4\u7ec6\u770b\uff0c\u4e5f\u53ef\u80fd\u662f\u5b9e\u73b0\u6709\u95ee\u9898\u3002gemini\u8bf4\u662f\u6d1b\u8c37\u4f7f\u7528\u4e86\u201c\u53cc\u91cd\u4fdd\u9669\u201d\uff1a\u5b83\u4e0d\u4ec5\u9a8c\u8bc1 Cookie\uff0c\u8fd8\u9a8c\u8bc1\u4e00\u4e2a\u52a8\u6001\u7684 <code>CSRF-Token</code>\uff08\u4f60\u662f\u5426\u4ece\u6d1b\u8c37\u7f51\u7ad9\u672c\u8eab\u53d1\u8d77\u7684\u8bf7\u6c42\uff09\u3002\u6211\u722c\u866b\u867d\u7136\u201c\u767b\u5f55\u201d\u4e86\uff0c\u4f46\u88ab\u5f53\u6210\u4e86CSRF\u653b\u51fb\uff0c\u8fd8\u662f\u88ab\u62d2\u4e86\u3002</li> </ul>"},{"location":"project/LuoguAgent/%E7%88%AC%E8%99%AB/#requests-beautifulsoup-crawl4ai","title":"\u6700\u7ec8\u65b9\u6848\uff1aRequests + BeautifulSoup + Crawl4ai","text":"<p>\u6211\u770b\u4e86\u4e00\u4f1aurl\u4e4b\u540e\uff0c\u60f3\u8d77\u6765Luogu\u6709\u4e00\u4e2a <code>luogu.com</code> \u548c\u4e00\u4e2a <code>luogu.com.cn</code> \u3002\u6211\u5bfb\u601d\u8fd9\u4e24\u4e2a\u5e94\u8be5\u662f\u6709\u6240\u4e0d\u540c\u7684\uff0c<code>luogu.com</code> \u6211\u8bb0\u5f97\u662f2025\u5e74\u5e74\u521d\u505a\u7684\uff0c\u597d\u50cf\u662f\u4e13\u95e8\u7528\u6765\u5b58\u653e\u8ba8\u8bba\u533a\u548c\u6587\u7ae0\uff0c\u5e78\u8fd0\u7684\u662f\uff0c\u8fd9\u4e2a\u662f\u4e0d\u9700\u8981\u767b\u9646\u7684\u3002\u552f\u4e00\u7684\u95ee\u9898\u5728\u4e8e\u6211\u4eec\u9700\u8981\u5728\u6587\u7ae0\u533a\u901a\u8fc7\u641c\u7d22\u627e\u5230\u9898\u76ee\u5bf9\u5e94\u7684\u9898\u89e3url\u3002</p> <p>**\u9636\u6bb5\u4e00\uff1a<code>requests</code> + <code>BeautifulSoup</code> ** \u7528 <code>requests</code> \u4e0b\u8f7d\u641c\u7d22\u9875 (<code>.../article?keyword=P1254</code>)\uff0c\u7136\u540e\u7528 <code>BeautifulSoup</code> \u914d\u5408\u6b63\u5219\u8868\u8fbe\u5f0f <code>re.compile(r'^/article/...')</code>\uff0c\u7cbe\u786e\u5730\u628a\u6240\u6709\u6587\u7ae0\u94fe\u63a5\uff08\u5982 <code>/article/syub6c8r</code>\uff09 \u63d0\u53d6\u51fa\u6765\u3002\u4e3a\u4e86\u786e\u4fdd\u6587\u7ae0\u6807\u9898\u91cc\u5305\u542b\"P1254\" \u518d\u6dfb\u52a0\u4e00\u4e2a\u5b50\u4e32\u5224\u65ad\uff0c\u6392\u9664\u641c\u7d22\u5230\u7684\u522b\u7684\u6587\u7ae0\u3002</p> <pre><code># --- \u7b2c 1 \u9636\u6bb5\uff1a\u641c\u7d22 (requests + bs4) ---\nasync def search_for_solution_urls(problem_id: str) -&gt; List[dict]:\n    search_url = f\"https://www.luogu.com.cn/article?keyword={problem_id}&amp;page=1\"\n    headers = {\n        \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\"\n    }\n\n    print(f\"[Phase 1] \u6b63\u5728\u7528 requests \u641c\u7d22: {search_url} ...\")\n\n    try:\n        response = requests.get(search_url, headers=headers)\n        soup = BeautifulSoup(response.text, 'html.parser')\n        article_links = soup.find_all('a', href=re.compile(r'^/article/[a-zA-Z0-9]{8}$'))\n\n        if not article_links:\n            print(\"[Phase 1] \u5931\u8d25\uff1a\u6ca1\u6709\u627e\u5230\u4efb\u4f55 /article/... \u94fe\u63a5\u3002\")\n            return []\n\n        results = []\n        for link in article_links:\n            href = link.get('href')\n            title = link.get_text(strip=True)\n\n            if href and (problem_id in title or problem_id in href):\n                if href not in [r['url'] for r in results]: \n                    results.append({\"title\": title, \"url\": href})\n\n        print(f\"[Phase 1] \u6210\u529f\uff1a\u627e\u5230 {len(results)} \u7bc7\u76f8\u5173\u9898\u89e3\u94fe\u63a5\u3002\")\n        return results\n\n    except requests.RequestException as e:\n        print(f\"[Phase 1] \u5f02\u5e38: {e}\")\n        return []\n</code></pre> <p>**\u9636\u6bb5\u4e8c\uff1a<code>Crawl4ai</code> ** \u5230\u8fd9\u91cc\u5df2\u7ecf\u62ff\u5230\u9636\u6bb5\u4e00\u4ea7\u51fa\u7684\u5e72\u51c0\u7684\u6587\u7ae0 URL \u5217\u8868\u3002\u73b0\u5728\uff0c<code>Crawl4ai</code> \u7ec8\u4e8e\u53ef\u4ee5\u4e0a\u573a\u4e86\u3002\u6211\u4eec\u5faa\u73af\u8fd9\u4e2a\u5217\u8868\uff0c\u8ba9 <code>Crawl4ai</code> \u8bbf\u95ee\u8fd9\u4e9b\u516c\u5f00\u7684\u6587\u7ae0\u9875\u3002</p> <p>\u8fd9\u6b21\uff0c\u6211\u4eec\u4f7f\u7528\u4e86\u201c\u5bbd\u5bb9\u201d\u7684 <code>SolutionDetails</code> Schema\uff0c\u53ea\u8981\u6c42 <code>solution_text</code>  \u5fc5\u987b\u5b58\u5728\uff0c<code>author</code> \u548c <code>code</code>  \u90fd\u662f\u53ef\u9009\u7684\uff0c\u8fd9\u5927\u5927\u63d0\u9ad8\u4e86LLM\u7684\u63d0\u53d6\u6210\u529f\u7387\u3002</p> <p>\u6700\u540e\uff0c\u6211\u4eec\u7528 <code>SolutionDetails.model_validate(raw_data)</code>  \u6765\u201c\u6e05\u6d17\u201dLLM\u8fd4\u56de\u7684\u3001\u53ef\u80fd\u5e26\u6709 <code>{'error': false}</code> \u5b57\u6bb5\u7684JSON\uff08\u76ee\u524d\u539f\u56e0\u5c1a\u4e0d\u660e\u786e\uff09\uff0c\u5f97\u5230\u53ef\u4ee5\u4ea4\u4ed8\u7684\u5e72\u51c0\u6570\u636e\u3002</p> <pre><code># --- \u7b2c 2 \u9636\u6bb5\uff1a\u63d0\u53d6 (crawl4ai + LLM) ---\nclass SolutionDetails(BaseModel):\n    solution_text: str = Field(..., description=\"\u63d0\u53d6\u5b8c\u6574\u7684\u9898\u89e3\u601d\u8def\u548c\u6587\u5b57\u8bf4\u660e (\u5fc5\u987b\u4fdd\u7559\u6240\u6709 LaTeX \u6570\u5b66\u516c\u5f0f)\")\n    author: Optional[str] = Field(None, description=\"\u63d0\u53d6\u9898\u89e3\u7684\u4f5c\u8005\u7528\u6237\u540d\")\n    code: Optional[str] = Field(None, description=\"\u63d0\u53d6\u8be5\u9898\u89e3\u5bf9\u5e94\u7684\u5b8c\u6574\u4ee3\u7801\u5757\")\n    code_language: Optional[str] = Field(None, description=\"\u63d0\u53d6\u4ee3\u7801\u5757\u7684\u7f16\u7a0b\u8bed\u8a00 (\u4f8b\u5982 C++, Python)\")\n\nstrategy = LLMExtractionStrategy(\n    llm_config=LLMConfig(\n        provider=\"deepseek/deepseek-chat\", \n        api_token=DMX_API_KEY,\n        base_url=\"https://www.dmxapi.cn/v1\"\n    ),\n    schema=SolutionDetails.model_json_schema(),\n    extraction_type=\"schema\",\n    instruction=\"\u4f60\u662f\u4e00\u4e2a\u722c\u866b\u52a9\u624b\uff0c\u8bf7\u4ece\u7ed9\u5b9a\u7684\u6587\u7ae0\u9875\u4e2d\u63d0\u53d6\u4f5c\u8005\u3001\u9898\u89e3\u601d\u8def\u548c\u4ee3\u7801\u3002\",\n    apply_chunking=False,\n    input_format=\"markdown\", \n    extra_args={\"temperature\": 0.1, \"max_tokens\": 4096} \n)\n\nasync def extract_solution_content(article_url: str, crawler: AsyncWebCrawler) -&gt; dict:\n    \"\"\"\n    \u4f7f\u7528 crawl4ai \u63d0\u53d6\u4e00\u7bc7\u516c\u5f00\u6587\u7ae0\u9875\u7684\u5177\u4f53\u5185\u5bb9\u3002\n    \"\"\"\n    full_url = f\"https://www.luogu.com.cn{article_url}\"\n    print(f\"[Phase 2] \u6b63\u5728\u7528 crawl4ai \u63d0\u53d6: {full_url} ...\")\n\n    config = CrawlerRunConfig(\n        cache_mode=CacheMode.BYPASS, \n        extraction_strategy=strategy,\n        delay_before_return_html=3 \n    )\n\n    result = await crawler.arun(full_url, config=config)\n\n    if result.success and result.extracted_content:\n        try:\n            data_list = json.loads(result.extracted_content)\n            if not data_list:\n                return {\"error\": \"LLM \u8fd4\u56de\u4e86\u7a7a\u5217\u8868\"}\n\n            raw_data = data_list[0] \n\n            clean_data_model = SolutionDetails.model_validate(raw_data)\n\n            return clean_data_model.model_dump()\n\n        except json.JSONDecodeError:\n            return {\"error\": \"LLM \u8fd4\u56de\u4e86\u65e0\u6548\u7684 JSON\", \"raw_content\": result.extracted_content}\n        except Exception as e:\n            return {\"error\": f\"Pydantic \u9a8c\u8bc1\u5931\u8d25: {e}\", \"raw_data\": raw_data}\n    else:\n        return {\"error\": \"crawl4ai \u722c\u53d6\u5931\u8d25\"}\n\nasync def main():\n    PROBLEM_ID = \"P1268\"\n\n    article_urls = await search_for_solution_urls(PROBLEM_ID)\n\n    if not article_urls:\n        print(\"\u6ca1\u6709\u627e\u5230\u4efb\u4f55\u9898\u89e3 URL\uff0c\u7a0b\u5e8f\u9000\u51fa\u3002\")\n        return\n\n    print(f\"\\n--- \u51c6\u5907\u63d0\u53d6 {len(article_urls)} \u7bc7\u6587\u7ae0\u7684\u8be6\u7ec6\u5185\u5bb9 ---\")\n\n    brouser_config = BrowserConfig(headless=True, proxy=None)\n\n    async with AsyncWebCrawler(config=brouser_config) as crawler:\n        all_solutions = []\n        for article in article_urls[:3]:\n            solution_data = await extract_solution_content(article['url'], crawler)\n\n            if \"error\" in solution_data:\n                print(f\"\u63d0\u53d6 {article['url']} \u5931\u8d25: {solution_data['error']}\")\n            elif not solution_data.get(\"solution_text\"):\n                print(f\"\u63d0\u53d6 {article['url']} \u5931\u8d25: LLM \u8fd4\u56de\u4e86\u7a7a\u5185\u5bb9\u3002\")\n            else:\n                solution_data['title'] = article['title']\n                solution_data['url'] = article['url']\n                all_solutions.append(solution_data)\n\n            await asyncio.sleep(1) # \u522b\u722c\u592a\u5feb\n\n    print(\"\\n\\n--- \u722c\u53d6\u5b8c\u6bd5\uff1a\u6240\u6709\u63d0\u53d6\u6210\u529f\u7684\u9898\u89e3 ---\")\n    print(json.dumps(all_solutions, indent=2, ensure_ascii=False))\n    print(f\"\\n\u6210\u529f\u4ece {len(article_urls)} \u4e2a\u94fe\u63a5\u4e2d\u63d0\u53d6\u4e86 {len(all_solutions)} \u7bc7\u9898\u89e3\u3002\")\n\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n</code></pre> <p>\u5b8c\u6574\u4ee3\u7801\uff1a</p> <pre><code>import requests\nfrom bs4 import BeautifulSoup\nimport re\nimport json\nimport asyncio\nimport os\nfrom pydantic import BaseModel, Field\nfrom typing import List, Optional \nfrom crawl4ai import *\nfrom constant import DMX_API_KEY \n\n# --- \u7b2c 1 \u9636\u6bb5\uff1a\u641c\u7d22 (requests + bs4) ---\nasync def search_for_solution_urls(problem_id: str) -&gt; List[dict]:\n    search_url = f\"https://www.luogu.com.cn/article?keyword={problem_id}&amp;page=1\"\n    headers = {\n        \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\"\n    }\n\n    print(f\"[Phase 1] \u6b63\u5728\u7528 requests \u641c\u7d22: {search_url} ...\")\n\n    try:\n        response = requests.get(search_url, headers=headers)\n        soup = BeautifulSoup(response.text, 'html.parser')\n        article_links = soup.find_all('a', href=re.compile(r'^/article/[a-zA-Z0-9]{8}$'))\n\n        if not article_links:\n            print(\"[Phase 1] \u5931\u8d25\uff1a\u6ca1\u6709\u627e\u5230\u4efb\u4f55 /article/... \u94fe\u63a5\u3002\")\n            return []\n\n        results = []\n        for link in article_links:\n            href = link.get('href')\n            title = link.get_text(strip=True)\n\n            if href and (problem_id in title or problem_id in href):\n                if href not in [r['url'] for r in results]: \n                    results.append({\"title\": title, \"url\": href})\n\n        print(f\"[Phase 1] \u6210\u529f\uff1a\u627e\u5230 {len(results)} \u7bc7\u76f8\u5173\u9898\u89e3\u94fe\u63a5\u3002\")\n        return results\n\n    except requests.RequestException as e:\n        print(f\"[Phase 1] \u5f02\u5e38: {e}\")\n        return []\n\n# --- \u7b2c 2 \u9636\u6bb5\uff1a\u63d0\u53d6 (crawl4ai + LLM) ---\nclass SolutionDetails(BaseModel):\n    solution_text: str = Field(..., description=\"\u63d0\u53d6\u5b8c\u6574\u7684\u9898\u89e3\u601d\u8def\u548c\u6587\u5b57\u8bf4\u660e (\u5fc5\u987b\u4fdd\u7559\u6240\u6709 LaTeX \u6570\u5b66\u516c\u5f0f)\")\n    author: Optional[str] = Field(None, description=\"\u63d0\u53d6\u9898\u89e3\u7684\u4f5c\u8005\u7528\u6237\u540d\")\n    code: Optional[str] = Field(None, description=\"\u63d0\u53d6\u8be5\u9898\u89e3\u5bf9\u5e94\u7684\u5b8c\u6574\u4ee3\u7801\u5757\")\n    code_language: Optional[str] = Field(None, description=\"\u63d0\u53d6\u4ee3\u7801\u5757\u7684\u7f16\u7a0b\u8bed\u8a00 (\u4f8b\u5982 C++, Python)\")\n\nstrategy = LLMExtractionStrategy(\n    llm_config=LLMConfig(\n        provider=\"deepseek/deepseek-chat\", \n        api_token=DMX_API_KEY,\n        base_url=\"https://www.dmxapi.cn/v1\"\n    ),\n    schema=SolutionDetails.model_json_schema(),\n    extraction_type=\"schema\",\n    instruction=\"\u4f60\u662f\u4e00\u4e2a\u722c\u866b\u52a9\u624b\uff0c\u8bf7\u4ece\u7ed9\u5b9a\u7684\u6587\u7ae0\u9875\u4e2d\u63d0\u53d6\u4f5c\u8005\u3001\u9898\u89e3\u601d\u8def\u548c\u4ee3\u7801\u3002\",\n    apply_chunking=False,\n    input_format=\"markdown\", \n    extra_args={\"temperature\": 0.1, \"max_tokens\": 4096} \n)\n\nasync def extract_solution_content(article_url: str, crawler: AsyncWebCrawler) -&gt; dict:\n    \"\"\"\n    \u4f7f\u7528 crawl4ai \u63d0\u53d6\u4e00\u7bc7\u516c\u5f00\u6587\u7ae0\u9875\u7684\u5177\u4f53\u5185\u5bb9\u3002\n    \"\"\"\n    full_url = f\"https://www.luogu.com.cn{article_url}\"\n    print(f\"[Phase 2] \u6b63\u5728\u7528 crawl4ai \u63d0\u53d6: {full_url} ...\")\n\n    config = CrawlerRunConfig(\n        cache_mode=CacheMode.BYPASS, \n        extraction_strategy=strategy,\n        delay_before_return_html=3 \n    )\n\n    result = await crawler.arun(full_url, config=config)\n\n    if result.success and result.extracted_content:\n        try:\n            data_list = json.loads(result.extracted_content)\n            if not data_list:\n                return {\"error\": \"LLM \u8fd4\u56de\u4e86\u7a7a\u5217\u8868\"}\n\n            raw_data = data_list[0] \n\n            clean_data_model = SolutionDetails.model_validate(raw_data)\n\n            return clean_data_model.model_dump()\n\n        except json.JSONDecodeError:\n            return {\"error\": \"LLM \u8fd4\u56de\u4e86\u65e0\u6548\u7684 JSON\", \"raw_content\": result.extracted_content}\n        except Exception as e:\n            return {\"error\": f\"Pydantic \u9a8c\u8bc1\u5931\u8d25: {e}\", \"raw_data\": raw_data}\n    else:\n        return {\"error\": \"crawl4ai \u722c\u53d6\u5931\u8d25\"}\n\nasync def main():\n    PROBLEM_ID = \"P1268\"\n\n    article_urls = await search_for_solution_urls(PROBLEM_ID)\n\n    if not article_urls:\n        print(\"\u6ca1\u6709\u627e\u5230\u4efb\u4f55\u9898\u89e3 URL\uff0c\u7a0b\u5e8f\u9000\u51fa\u3002\")\n        return\n\n    print(f\"\\n--- \u51c6\u5907\u63d0\u53d6 {len(article_urls)} \u7bc7\u6587\u7ae0\u7684\u8be6\u7ec6\u5185\u5bb9 ---\")\n\n    brouser_config = BrowserConfig(headless=True, proxy=None)\n\n    async with AsyncWebCrawler(config=brouser_config) as crawler:\n        all_solutions = []\n        for article in article_urls[:3]:\n            solution_data = await extract_solution_content(article['url'], crawler)\n\n            if \"error\" in solution_data:\n                print(f\"\u63d0\u53d6 {article['url']} \u5931\u8d25: {solution_data['error']}\")\n            elif not solution_data.get(\"solution_text\"):\n                print(f\"\u63d0\u53d6 {article['url']} \u5931\u8d25: LLM \u8fd4\u56de\u4e86\u7a7a\u5185\u5bb9\u3002\")\n            else:\n                solution_data['title'] = article['title']\n                solution_data['url'] = article['url']\n                all_solutions.append(solution_data)\n\n            await asyncio.sleep(1) # \u522b\u722c\u592a\u5feb\n\n    print(\"\\n\\n--- \u722c\u53d6\u5b8c\u6bd5\uff1a\u6240\u6709\u63d0\u53d6\u6210\u529f\u7684\u9898\u89e3 ---\")\n    print(json.dumps(all_solutions, indent=2, ensure_ascii=False))\n    print(f\"\\n\u6210\u529f\u4ece {len(article_urls)} \u4e2a\u94fe\u63a5\u4e2d\u63d0\u53d6\u4e86 {len(all_solutions)} \u7bc7\u9898\u89e3\u3002\")\n\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n</code></pre>"}]}