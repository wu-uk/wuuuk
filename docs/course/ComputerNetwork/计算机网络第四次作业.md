# 计算机网络第四次作业

## 第一题 R14

只有FIFO能确保分组以到达次序离开，其他方式都不行。

## 第二题 R18

TTL字段确保数据包不会永远在网络中循环，每经一个路由器处理，TTL值减一，当TTL为0时数据报被丢弃。

## 第三题 R22

11011111.00000001.00000011.00011011

## 第四题 R27

“路由聚合”指的是使用单个网络前缀通告多个网络的能力。一个组织通常被分配一块连续的地址，这种情况下，组织内部的设备IP地址将共享相同的前缀。当组织外部的一台路由器转发一个数据报，且该数据报的目的地址位于该组织内部时，仅需要考虑该地址前的x比特。这相当大地减少了在这些路由器中的转发表的长度。

## 第五题 P6

**a.**

| 分组 | 到达时间 | 离开时间 | 时延 |
| ---- | -------- | -------- | ---- |
| 2    | 0        | 2        | 2    |
| 3    | 1        | 3        | 2    |
| 4    | 1        | 4        | 3    |
| 5    | 3        | 6        | 3    |
| 6    | 2        | 5        | 3    |
| 7    | 3        | 7        | 4    |
| 8    | 5        | 8        | 3    |
| 9    | 5        | 9        | 4    |
| 10   | 7        | 10       | 3    |
| 11   | 8        | 11       | 3    |
| 12   | 8        | 12       | 4    |

$$
\text{平均时延}=3.091
$$

**b.**

| 分组 | 到达时间 | 离开时间 | 时延 |
| ---- | -------- | -------- | ---- |
| 2    | 0        | 3        | 3    |
| 3    | 1        | 2        | 1    |
| 4    | 1        | 7        | 6    |
| 5    | 3        | 4        | 1    |
| 6    | 2        | 8        | 6    |
| 7    | 3        | 5        | 2    |
| 8    | 5        | 10       | 5    |
| 9    | 5        | 6        | 1    |
| 10   | 7        | 11       | 4    |
| 11   | 8        | 9        | 1    |
| 12   | 8        | 12       | 4    |

$$
\text{平均时延}=3.091
$$

**c.**

| 分组 | 到达时间 | 离开时间 | 时延 |
| ---- | -------- | -------- | ---- |
| 2    | 0        | 3        | 3    |
| 3    | 1        | 5        | 4    |
| 4    | 1        | 2        | 1    |
| 5    | 3        | 4        | 1    |
| 6    | 2        | 7        | 5    |
| 7    | 3        | 6        | 3    |
| 8    | 5        | 8        | 3    |
| 9    | 5        | 10       | 5    |
| 10   | 7        | 12       | 5    |
| 11   | 8        | 9        | 1    |
| 12   | 8        | 11       | 3    |

$$
\text{平均时延}=3.091
$$

**d.**

| 分组 | 到达时间 | 离开时间 | 时延 |
| ---- | -------- | -------- | ---- |
| 2    | 0        | 3        | 3    |
| 3    | 1        | 2        | 1    |
| 4    | 1        | 6        | 5    |
| 5    | 3        | 4        | 1    |
| 6    | 2        | 8        | 6    |
| 7    | 3        | 5        | 2    |
| 8    | 5        | 10       | 5    |
| 9    | 5        | 7        | 2    |
| 10   | 7        | 11       | 4    |
| 11   | 8        | 9        | 1    |
| 12   | 8        | 12       | 4    |

第一类权重是2，但是当第一类为空时选择处理第二类。

$$
\text{平均时延}=3.091
$$

**e.**

上述四种情况，不管采用什么策略，平均时延都相等。

## 第六题 P8

**a.**

| 前缀匹配          | 转发端口 |
| ----------------- | -------- |
| 11100000 00       | 0        |
| 11100000 01000000 | 1        |
| 1110000           | 2        |
| 11100001 1        | 3        |
| 其他              | 3        |

**b.**

 11001000 10010001 01010001 01010101

不能匹配任意已知前缀，转发到端口3。

 11100001 01000000 11000011 00111100

前缀匹配1110000，转发到端口2。

11100001 10000000 00010001 01110111

前缀匹配11100001 1，转发到端口3。

## 第七题 P10

| 接口 | 地址范围          | 地址数量 |
| ---- | ----------------- | -------- |
| 0    | 11000000~11011111 | 32       |
| 1    | 10000000~10111111 | 64       |
| 2    | 11100000~11111111 | 32       |
| 3    | 00000000~01111111 | 128      |

## 第八题 P15

**a.**

| 子网 | 地址              |
| ---- | ----------------- |
| A    | 214.97.254.0/24   |
| B    | 214.97.255.0/25   |
| C    | 214.97.255.128/25 |
| D    | 214.98.0.0/30     |
| E    | 214.98.0.4/30     |
| F    | 214.98.0.8/30     |

**b.**

R1：

| 最长前缀匹配                      | 转发到子网 |
| --------------------------------- | ---------- |
| 11010110 01100010 00000000 000000 | D          |
| 11010110 01100010 00000000 000010 | F          |
| 11010110 01100001 11111110        | A          |

R2：

| 最长前缀匹配                      | 转发到子网 |
| --------------------------------- | ---------- |
| 11010110 01100010 00000000 000000 | D          |
| 11010110 01100010 00000000 000001 | E          |
| 11010110 01100001 11111111 0      | B          |

R3：

| 最长前缀匹配                      | 转发到子网 |
| --------------------------------- | ---------- |
| 11010110 01100010 00000000 000001 | E          |
| 11010110 01100010 00000000 000010 | F          |
| 11010110 01100001 11111111 1      | C          |

## 第九题 P18

**a.**

主机的端口地址：192.168.1.1，192.168.1.2，192.168.1.3

路由器端口地址：192.168.1.4

**b.**

| WAN 端             | LAN 端         |
| ------------------ | -------------- |
| 24.34.112.235,5001 | 192.168.1,3345 |
| 24.34.112.235,5002 | 192.168.1,3346 |
| 24.34.112.235,5003 | 192.168.2,3345 |
| 24.34.112.235,5004 | 192.168.2,3346 |
| 24.34.112.235,5005 | 192.168.3,3345 |
| 24.34.112.235,5006 | 192.168.3,3346 |

## 第十题 P19

**a.**

在捕获到的所有NAT向外部发送的分组中，查看所有标识号落在的连续区间个数，有多少标识号的连续区间就有多少台主机。

**b.**

如果随机分配标识号，那么就无法将标识号的连续区间对应到一台主机，上述方法也就无法工作。
